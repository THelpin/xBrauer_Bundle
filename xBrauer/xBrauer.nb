(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1021306,      21756]
NotebookOptionsPosition[    992105,      21263]
NotebookOutlinePosition[    992772,      21285]
CellTagsIndexPosition[    992729,      21282]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["              xBrauer : Application of the Brauer \
algebra to tensor calculus",
 FontSize->46]], "Chapter",
 CellChangeTimes->{{3.811398606371326*^9, 3.811398631557423*^9}, {
   3.8113999655067453`*^9, 3.811399995406973*^9}, {3.811432810485012*^9, 
   3.811432812158496*^9}, {3.821109586823344*^9, 3.821109631185769*^9}, {
   3.827055038953705*^9, 3.827055070631023*^9}, 3.828698926055389*^9, {
   3.830580112752308*^9, 3.8305801190366793`*^9}, 3.876027732517459*^9, {
   3.8766326049825697`*^9, 3.876632605703614*^9}, {3.8766334560806923`*^9, 
   3.876633469020391*^9}, {3.876970439499382*^9, 3.876970460482041*^9}, {
   3.8833096004608088`*^9, 3.8833096229214363`*^9}},
 Background->RGBColor[
  0.8156862745098039, 0.8156862745098039, 
   0.8156862745098039],ExpressionUUID->"52886c0e-0117-4f34-9f17-2333192fb30d"],

Cell[TextData[{
 StyleBox["Contact",
  FontSize->18],
 " :  thomas.helpin@gmail.com\nAffiliation : Institut Denis Poisson Orl\
\[EAcute]ans-Tours : Mathematics and Theoretical Physics\nUniversity of \
Tours, France\n\n(c) 2011-2022, under GPL"
}], "Subsubtitle",
 CellChangeTimes->{{3.515744127407694*^9, 3.515744214153655*^9}, {
   3.515938182944235*^9, 3.515938183474636*^9}, {3.5354546450794406`*^9, 
   3.5354546469202437`*^9}, {3.5671882614270687`*^9, 
   3.5671882618482695`*^9}, {3.582348307226815*^9, 3.5823483224212418`*^9}, {
   3.5823483575213037`*^9, 3.5823483734177313`*^9}, {3.582348422418418*^9, 
   3.5823484604200845`*^9}, {3.5891985108400106`*^9, 3.589198511947613*^9}, 
   3.5981700712236423`*^9, {3.6483947941911917`*^9, 3.648394815851222*^9}, {
   3.648394855558444*^9, 3.6483949282986045`*^9}, {3.6800036704406137`*^9, 
   3.680003688900429*^9}, {3.8387105765180273`*^9, 3.8387105767075214`*^9}, {
   3.83880384888338*^9, 3.8388038521975555`*^9}, 3.8388039492294655`*^9, 
   3.8388206260743427`*^9, {3.8718088916546707`*^9, 3.871808892368607*^9}, {
   3.876632355128375*^9, 3.8766323687507353`*^9}, {3.876632422125925*^9, 
   3.876632425661956*^9}, {3.876632457757015*^9, 3.876632536864045*^9}, {
   3.876637775267975*^9, 3.876637775397697*^9}, {3.877335575013228*^9, 
   3.877335596961872*^9}},ExpressionUUID->"2c0ff4c3-d842-450f-a54c-\
b762f1845f31"],

Cell[TextData[{
 StyleBox["xBrauer; Application of the Brauer algebra to tensor calculus.\n",
  FontSize->16,
  FontColor->GrayLevel[0]],
 "\nVia the xBrauer companion package, BrauerAlgebra is link to the xAct \
(xTensor)  bundle  for tensorial calculus (Jos\[EAcute] M. Martin-Garcia, GPL \
2002-2022) which is widely used in theoretical physics. ",
 StyleBox["http://www.xAct.es/",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.419078218575598*^9, 3.419078246806376*^9}, {
   3.425990024306922*^9, 3.425990025430625*^9}, {3.4941363300431013`*^9, 
   3.494136333188654*^9}, {3.5157442219230995`*^9, 3.5157442456454563`*^9}, {
   3.5159381900578475`*^9, 3.51593820845028*^9}, {3.5292378115451984`*^9, 
   3.529237844414456*^9}, {3.87663254025564*^9, 3.876633056491083*^9}, {
   3.876633118076743*^9, 3.876633167734235*^9}, {3.876633281776719*^9, 
   3.876633445327248*^9}, 3.8766335564629087`*^9, {3.876637714279846*^9, 
   3.876637717150145*^9}, {3.876643519275476*^9, 3.876643628456698*^9}, {
   3.8766437692288094`*^9, 3.876643802854598*^9}, {3.876643833912631*^9, 
   3.8766438716073027`*^9}, {3.8767598668536654`*^9, 3.87675995039565*^9}, {
   3.8767600186013536`*^9, 3.876760046861269*^9}, 3.8768081994740067`*^9, {
   3.876847196832494*^9, 3.8768472522065697`*^9}, {3.876970432502273*^9, 
   3.876970433373456*^9}, {3.8769712383487673`*^9, 3.8769712498068953`*^9}, {
   3.876971332914233*^9, 3.876971333859096*^9}, {3.8769714279595757`*^9, 
   3.876971429831646*^9}, {3.8769810144499702`*^9, 3.876981021524485*^9}, {
   3.8770117496596403`*^9, 3.8770117610603333`*^9}, {3.8771690868605556`*^9, 
   3.877169090082616*^9}, {3.8773355532284517`*^9, 3.8773355544451427`*^9}, {
   3.877369560785166*^9, 3.877369563288556*^9}, {3.877369634159874*^9, 
   3.877369638222724*^9}, {3.8773697273005667`*^9, 3.8773697278412037`*^9}, 
   3.883471185634531*^9},ExpressionUUID->"22e3d543-18da-4759-b461-\
b14ae684f794"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xAct`xBrauer`$Version", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<0.1.0\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2022", ",", "28", ",", "10"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`xBrauer`$xTensorVersionExpected", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<1.2.0\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2021", ",", "10", ",", "17"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`xTras`$xTrasVersionExpected", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<1.0.6\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2014", ",", "10", ",", "30"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81139626259147*^9, 3.811396304850363*^9}, {
   3.811396484034244*^9, 3.811396560131448*^9}, {3.811398664688491*^9, 
   3.811398666672017*^9}, {3.8116990709109993`*^9, 3.811699082179538*^9}, {
   3.821109542338601*^9, 3.8211095558958797`*^9}, 3.830678280224725*^9, 
   3.834150922484911*^9, {3.845457444100778*^9, 3.8454574465688353`*^9}, {
   3.862384973876252*^9, 3.862385000082041*^9}, {3.875954754191032*^9, 
   3.875954768589704*^9}, {3.8759552901606073`*^9, 3.8759553022775803`*^9}, 
   3.875955470772641*^9, 3.8769704350891457`*^9, {3.878025102220237*^9, 
   3.878025116455068*^9}, {3.8833070420958223`*^9, 3.883307043233097*^9}, {
   3.888569481867296*^9, 3.888569483516182*^9}, {3.893500478184561*^9, 
   3.893500489343968*^9}},ExpressionUUID->"528dbdcb-3a1e-4c3f-adac-\
ac5334040dae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"0.0.2\"\>", ",", 
   RowBox[{"{", 
    RowBox[{"2021", ",", "31", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.811397377458762*^9, 3.811397380485265*^9}, {
   3.811397744466978*^9, 3.811397760871364*^9}, {3.811399022113348*^9, 
   3.81139902390485*^9}, {3.811399139874096*^9, 3.811399142075317*^9}, {
   3.8113991762640257`*^9, 3.811399177736569*^9}, {3.811399250760915*^9, 
   3.8113992522485723`*^9}, {3.8113994490043364`*^9, 
   3.8113994503394423`*^9}, {3.811406480410471*^9, 3.8114064822714577`*^9}, {
   3.8114068560407457`*^9, 3.811406857729357*^9}, {3.811406906014289*^9, 
   3.811406936202816*^9}, {3.8114074588800173`*^9, 3.81140746077551*^9}, {
   3.811408145988536*^9, 3.811408147816787*^9}, {3.811408189990241*^9, 
   3.811408191528987*^9}, 3.8114087800457*^9, {3.811408814245327*^9, 
   3.811408815699943*^9}, {3.8114088612983*^9, 3.81140886270457*^9}, {
   3.811408996505719*^9, 3.811408997873681*^9}, {3.811409061025668*^9, 
   3.81140906242458*^9}, 3.811409269558753*^9, {3.811409303109399*^9, 
   3.811409304617024*^9}, {3.811409611380794*^9, 3.811409612753873*^9}, {
   3.81140979122491*^9, 3.81140979255377*^9}, {3.811411450266959*^9, 
   3.811411451854135*^9}, {3.8114118626323023`*^9, 3.811411864024199*^9}, {
   3.811411918617886*^9, 3.811411919954327*^9}, {3.811412614663911*^9, 
   3.811412616025074*^9}, {3.8114127140500317`*^9, 3.811412715457077*^9}, {
   3.811413262527727*^9, 3.811413263883082*^9}, {3.811413330975697*^9, 
   3.81141333238829*^9}, {3.811413628472694*^9, 3.8114136298273087`*^9}, {
   3.811413772988455*^9, 3.811413774371023*^9}, {3.8114138932385607`*^9, 
   3.811413894640465*^9}, 3.8114143285654373`*^9, 3.8114144082060337`*^9, {
   3.81141464826581*^9, 3.811414649674642*^9}, {3.811415040739604*^9, 
   3.811415042200739*^9}, {3.811415879781273*^9, 3.811415881675165*^9}, {
   3.811416422648335*^9, 3.811416424423725*^9}, {3.8114165132613373`*^9, 
   3.811416514688826*^9}, {3.811416942165362*^9, 3.811416943609891*^9}, {
   3.811417007945484*^9, 3.811417009447076*^9}, {3.811419099048777*^9, 
   3.81141910106359*^9}, {3.8114192200802317`*^9, 3.8114192219115562`*^9}, {
   3.811419393331602*^9, 3.811419394814056*^9}, {3.8114196131899977`*^9, 
   3.8114196146105137`*^9}, {3.811419719942127*^9, 3.8114197213738337`*^9}, {
   3.8114202771862383`*^9, 3.8114202786476994`*^9}, {3.811420495396826*^9, 
   3.8114204968315783`*^9}, {3.811420764254183*^9, 3.811420765723751*^9}, {
   3.811420874416781*^9, 3.811420875865346*^9}, {3.811420993804948*^9, 
   3.811420995487363*^9}, {3.811423397382081*^9, 3.811423399389174*^9}, {
   3.811423430949759*^9, 3.811423432374399*^9}, {3.811423900379952*^9, 
   3.811423901987409*^9}, {3.811424939241089*^9, 3.811424941205276*^9}, {
   3.811425127288106*^9, 3.811425128897554*^9}, {3.811425229587435*^9, 
   3.8114252312747726`*^9}, {3.811425360305561*^9, 3.8114253619530153`*^9}, {
   3.8114254057661953`*^9, 3.8114254075849257`*^9}, {3.811425647213292*^9, 
   3.811425648892376*^9}, {3.811425738558983*^9, 3.811425740039638*^9}, {
   3.811425800798649*^9, 3.81142580230348*^9}, {3.811426020356147*^9, 
   3.81142602189403*^9}, {3.811426572148302*^9, 3.811426574119986*^9}, {
   3.811427719595792*^9, 3.811427721081555*^9}, {3.81143117617977*^9, 
   3.811431178330562*^9}, {3.8114314589470663`*^9, 3.811431460503222*^9}, {
   3.8114319961274767`*^9, 3.81143199780441*^9}, {3.811432630481481*^9, 
   3.81143263227391*^9}, {3.811434789066729*^9, 3.811434791320949*^9}, {
   3.811435082366954*^9, 3.8114350839541607`*^9}, {3.811435685772868*^9, 
   3.811435687459755*^9}, {3.81143577766889*^9, 3.811435779289843*^9}, {
   3.811435827901354*^9, 3.8114358295158978`*^9}, {3.811436513578053*^9, 
   3.811436515191186*^9}, 3.811437052795992*^9, 3.811437273406105*^9, {
   3.8114373434408207`*^9, 3.811437346576415*^9}, {3.811442054661501*^9, 
   3.811442057139761*^9}, {3.811484934920599*^9, 3.8114849377154903`*^9}, {
   3.811508863955359*^9, 3.811508866003261*^9}, {3.811509009403594*^9, 
   3.811509011028995*^9}, {3.81150916464305*^9, 3.811509166261235*^9}, {
   3.8115092191820803`*^9, 3.8115092208518867`*^9}, {3.8115093231945953`*^9, 
   3.811509324960857*^9}, {3.811510767787903*^9, 3.81151076942556*^9}, {
   3.8115108861510153`*^9, 3.811510887760219*^9}, {3.8115109575066566`*^9, 
   3.811510959094647*^9}, {3.811511148201427*^9, 3.811511149802597*^9}, {
   3.8115116725747833`*^9, 3.8115116746236763`*^9}, {3.8115118370968*^9, 
   3.811511838734604*^9}, {3.811511930786787*^9, 3.811511932422393*^9}, {
   3.811517912212002*^9, 3.81151791410408*^9}, {3.811518118208623*^9, 
   3.811518120229103*^9}, {3.8115182775899754`*^9, 3.811518279667419*^9}, {
   3.811518453134012*^9, 3.811518454757197*^9}, {3.811518522738245*^9, 
   3.811518524409919*^9}, {3.8115185871619*^9, 3.8115185888972273`*^9}, {
   3.811518778676116*^9, 3.811518780348339*^9}, {3.8115188237454453`*^9, 
   3.811518825381185*^9}, {3.811519073813136*^9, 3.81151907574016*^9}, {
   3.811519194651554*^9, 3.811519196262533*^9}, 3.811519273584044*^9, {
   3.811520939730625*^9, 3.81152094137074*^9}, {3.81152219169212*^9, 
   3.8115221936662407`*^9}, {3.811522268122958*^9, 3.8115222697616673`*^9}, {
   3.811522389602913*^9, 3.811522391909546*^9}, {3.811522433802478*^9, 
   3.8115224354467278`*^9}, {3.811522536435297*^9, 3.811522538100857*^9}, {
   3.811522592685603*^9, 3.811522594377693*^9}, {3.811523887565413*^9, 
   3.811523914872892*^9}, {3.8115239742844667`*^9, 3.81152397592896*^9}, {
   3.811524080064577*^9, 3.811524081719694*^9}, {3.811524217455348*^9, 
   3.811524219087113*^9}, {3.811524255427864*^9, 3.811524257890411*^9}, {
   3.811524334651697*^9, 3.811524336312895*^9}, {3.811524610293565*^9, 
   3.811524642946289*^9}, {3.811525681899817*^9, 3.8115256841083*^9}, {
   3.8115258888775177`*^9, 3.811525890645441*^9}, {3.8115262312230186`*^9, 
   3.811526233521517*^9}, {3.811526629522182*^9, 3.811526631347011*^9}, {
   3.81152676756385*^9, 3.8115267692264347`*^9}, {3.811527005601239*^9, 
   3.811527007361918*^9}, {3.8115272361153507`*^9, 3.811527237873529*^9}, {
   3.811527433307929*^9, 3.8115274349346457`*^9}, {3.8115278142900543`*^9, 
   3.811527815948579*^9}, {3.81152880302713*^9, 3.81152880503011*^9}, {
   3.8115716839224977`*^9, 3.811571685903511*^9}, {3.811591047353465*^9, 
   3.8115910497191896`*^9}, {3.811591681914317*^9, 3.811591683608708*^9}, {
   3.811591906283455*^9, 3.811591907941105*^9}, {3.811592146706353*^9, 
   3.8115921483753843`*^9}, {3.8115922601636343`*^9, 3.811592261829918*^9}, {
   3.811593652050009*^9, 3.8115936537996264`*^9}, {3.8115939535569057`*^9, 
   3.8115939562857656`*^9}, {3.811594050230755*^9, 3.8115940520779133`*^9}, {
   3.8116740399367*^9, 3.811674042676098*^9}, {3.811680788656749*^9, 
   3.8116807944629517`*^9}, {3.811680855354879*^9, 3.8116808591813297`*^9}, {
   3.811697551882399*^9, 3.81169755420212*^9}, {3.811697912547332*^9, 
   3.811697914645803*^9}, {3.811754741445668*^9, 3.811754743672927*^9}, {
   3.812098225719301*^9, 3.812098228152375*^9}, {3.8120984682985163`*^9, 
   3.812098470277672*^9}, {3.8120990897766647`*^9, 3.812099091775817*^9}, {
   3.8120992038932343`*^9, 3.812099205651053*^9}, {3.8120994952462673`*^9, 
   3.812099496996502*^9}, {3.812099703657751*^9, 3.8120997054216948`*^9}, 
   3.812099840179605*^9, {3.812100833786414*^9, 3.8121008355422077`*^9}, {
   3.8121009968552437`*^9, 3.8121009985934267`*^9}, 3.812101199131467*^9, {
   3.812105781281108*^9, 3.812105801152742*^9}, {3.81210620948372*^9, 
   3.8121062119257517`*^9}, {3.8121065155533743`*^9, 3.812106517719316*^9}, {
   3.812106625661915*^9, 3.8121066278049097`*^9}, {3.812107356513426*^9, 
   3.812107358739615*^9}, {3.812108060237226*^9, 3.812108062638522*^9}, {
   3.812108504337365*^9, 3.812108506645163*^9}, {3.812108749914246*^9, 
   3.812108752381412*^9}, {3.812110464352149*^9, 3.8121104683107643`*^9}, {
   3.812110605135491*^9, 3.81211062200158*^9}, {3.812128610573111*^9, 
   3.8121286129803553`*^9}, {3.812142010539606*^9, 3.8121420131833153`*^9}, {
   3.812143617203286*^9, 3.8121436195796747`*^9}, {3.8121699833302393`*^9, 
   3.812169987779561*^9}, {3.812170316586129*^9, 3.8121703212132397`*^9}, {
   3.812170615537086*^9, 3.812170619529192*^9}, {3.8121706525707693`*^9, 
   3.812170656653325*^9}, {3.8121749665903378`*^9, 3.812174968429756*^9}, {
   3.812191393135559*^9, 3.812191397589096*^9}, {3.812191819800208*^9, 
   3.812191821748227*^9}, {3.812192178650344*^9, 3.812192182279469*^9}, {
   3.8121935061578407`*^9, 3.8121935080920277`*^9}, {3.812193976479465*^9, 
   3.8121939783908663`*^9}, {3.812194326978443*^9, 3.812194329524386*^9}, {
   3.812195356572761*^9, 3.812195358861621*^9}, {3.812195408946018*^9, 
   3.812195410832106*^9}, {3.8121956273147783`*^9, 3.812195629216116*^9}, {
   3.812195746211384*^9, 3.812195748088016*^9}, {3.812195804367073*^9, 
   3.812195806339731*^9}, {3.8121962390713587`*^9, 3.812196241193775*^9}, {
   3.812198082933777*^9, 3.812198084904944*^9}, {3.812198696006831*^9, 
   3.812198698396015*^9}, {3.812261281485424*^9, 3.812261284211845*^9}, {
   3.812261846027584*^9, 3.812261848113764*^9}, {3.812262189319601*^9, 
   3.812262191127041*^9}, {3.8122625148083687`*^9, 3.81226251684521*^9}, {
   3.812262730276697*^9, 3.812262734561883*^9}, {3.812263778956959*^9, 
   3.8122637809859667`*^9}, {3.8122642327279863`*^9, 3.812264234714703*^9}, {
   3.812264327281001*^9, 3.812264329137903*^9}, {3.812264752466259*^9, 
   3.812264754449531*^9}, {3.8122694267971983`*^9, 3.812269429351927*^9}, {
   3.8122697811360273`*^9, 3.8122697833547487`*^9}, {3.812269954274487*^9, 
   3.812269956158403*^9}, {3.812270078181388*^9, 3.8122700805765133`*^9}, 
   3.812270513975327*^9, {3.812272259548471*^9, 3.8122722622158737`*^9}, {
   3.812272619957736*^9, 3.812272622157702*^9}, {3.812272784052638*^9, 
   3.8122727859867163`*^9}, {3.81227311608564*^9, 3.8122731180686207`*^9}, {
   3.8122749778427877`*^9, 3.8122749802435513`*^9}, {3.8122868205293217`*^9, 
   3.812286822743165*^9}, {3.8122869409382257`*^9, 3.812286942826729*^9}, {
   3.812290770073715*^9, 3.812290772060029*^9}, {3.812291580913219*^9, 
   3.8122915829433737`*^9}, {3.812292612718045*^9, 3.8122926147256327`*^9}, {
   3.812292665267342*^9, 3.8122926672366133`*^9}, {3.812292860930417*^9, 
   3.812292862900951*^9}, {3.8122992498967743`*^9, 3.812299252156209*^9}, {
   3.812302860803133*^9, 3.8123028649506702`*^9}, {3.812344961682892*^9, 
   3.8123449643797283`*^9}, {3.812345104564934*^9, 3.812345106843801*^9}, {
   3.81234542492109*^9, 3.8123454271952343`*^9}, {3.8123460156404552`*^9, 
   3.812346017707794*^9}, {3.812349661334577*^9, 3.812349665376162*^9}, {
   3.812349993461878*^9, 3.81234999591313*^9}, {3.812350222579938*^9, 
   3.812350225086626*^9}, {3.812358951014721*^9, 3.8123589549676113`*^9}, {
   3.81235948358077*^9, 3.8123594872777967`*^9}, {3.8123609597115507`*^9, 
   3.812360962204823*^9}, {3.8123624511751328`*^9, 3.812362453569025*^9}, {
   3.8123644516691523`*^9, 3.812364454212365*^9}, {3.8123652563265553`*^9, 
   3.81236525886675*^9}, {3.812371335894516*^9, 3.812371338466466*^9}, {
   3.812372109164692*^9, 3.812372111749032*^9}, {3.812372513981345*^9, 
   3.8123725160690937`*^9}, {3.812375212224031*^9, 3.812375214966868*^9}, {
   3.81237534157559*^9, 3.812375343537986*^9}, {3.812375737642232*^9, 
   3.812375740103758*^9}, {3.812376059085671*^9, 3.8123760618346767`*^9}, {
   3.812376326372573*^9, 3.812376328419291*^9}, {3.812436375184273*^9, 
   3.812436378743931*^9}, {3.81244344950204*^9, 3.812443452102466*^9}, {
   3.8124442468172693`*^9, 3.812444249479066*^9}, {3.8124480366786337`*^9, 
   3.8124480393622932`*^9}, {3.8124483140165873`*^9, 3.812448316106731*^9}, {
   3.812448635065241*^9, 3.812448637141121*^9}, {3.8124518630806*^9, 
   3.812451865304504*^9}, {3.812458809939905*^9, 3.8124588126058283`*^9}, {
   3.812459064894678*^9, 3.812459067035882*^9}, {3.8124595807609377`*^9, 
   3.812459583500577*^9}, {3.812459719479279*^9, 3.8124597216739063`*^9}, {
   3.812459844042509*^9, 3.81245984633591*^9}, {3.812459945932599*^9, 
   3.8124599480831614`*^9}, {3.8124600744163027`*^9, 3.812460076663028*^9}, {
   3.812461335131876*^9, 3.812461337457872*^9}, {3.8124616226041927`*^9, 
   3.812461625034689*^9}, {3.8124632318378077`*^9, 3.812463234552555*^9}, {
   3.812463725929393*^9, 3.8124637283502274`*^9}, {3.812464007158477*^9, 
   3.812464010704486*^9}, {3.812464245545899*^9, 3.812464248158711*^9}, {
   3.812465522566121*^9, 3.8124655251484118`*^9}, {3.8124658573116007`*^9, 
   3.8124658597092*^9}, {3.81246612221922*^9, 3.812466124758437*^9}, {
   3.812525070109009*^9, 3.812525073047521*^9}, {3.812530196499112*^9, 
   3.812530199279361*^9}, {3.812533186696274*^9, 3.812533189059408*^9}, {
   3.812538964279998*^9, 3.812538968154158*^9}, {3.812539128316957*^9, 
   3.812539130531241*^9}, {3.812539167503578*^9, 3.812539169746628*^9}, {
   3.81253925969007*^9, 3.812539262105426*^9}, {3.812539517133795*^9, 
   3.812539519298011*^9}, {3.812539922961123*^9, 3.812539925043557*^9}, {
   3.812539972473143*^9, 3.812539974648953*^9}, {3.812540023534878*^9, 
   3.812540025620841*^9}, {3.812540261853485*^9, 3.812540264105781*^9}, {
   3.812540593085381*^9, 3.8125405958930283`*^9}, {3.812540938358425*^9, 
   3.812540940526208*^9}, {3.81254137076019*^9, 3.812541372815349*^9}, {
   3.812541797150283*^9, 3.812541799437235*^9}, {3.812543514036644*^9, 
   3.812543516460517*^9}, {3.812553679279879*^9, 3.812553681712661*^9}, {
   3.812553929294407*^9, 3.812553931431126*^9}, {3.812558026905319*^9, 
   3.812558029228376*^9}, {3.812561237515415*^9, 3.812561240113503*^9}, {
   3.8125614277279587`*^9, 3.812561430057756*^9}, {3.812561641642584*^9, 
   3.812561643968628*^9}, {3.812562510329899*^9, 3.812562512751667*^9}, {
   3.812706974230735*^9, 3.812706979641552*^9}, {3.812707157679551*^9, 
   3.8127071637201967`*^9}, {3.81270818011208*^9, 3.812708185470175*^9}, {
   3.81270852082899*^9, 3.812708525389648*^9}, {3.812709545371488*^9, 
   3.812709550502122*^9}, {3.812782685126588*^9, 3.812782690391457*^9}, {
   3.813410992156014*^9, 3.81341099444621*^9}, {3.813412565260203*^9, 
   3.813412567311161*^9}, {3.813412756662026*^9, 3.813412758661189*^9}, {
   3.813822977569117*^9, 3.813822980210453*^9}, {3.813823275613369*^9, 
   3.813823293139448*^9}, {3.8138235954560432`*^9, 3.813823597664497*^9}, {
   3.813823702311646*^9, 3.813823706252931*^9}, {3.8140796038050413`*^9, 
   3.814079606144341*^9}, {3.814080162778571*^9, 3.81408016501685*^9}, {
   3.814080413672201*^9, 3.8140804158056183`*^9}, {3.814080473447933*^9, 
   3.814080475662871*^9}, {3.814081042346938*^9, 3.814081044644555*^9}, {
   3.814081167395596*^9, 3.8140811696140614`*^9}, {3.814081324040975*^9, 
   3.814081326293817*^9}, {3.814084457477632*^9, 3.814084459444907*^9}, {
   3.814086044484161*^9, 3.814086046649082*^9}, {3.814086580839065*^9, 
   3.814086583044899*^9}, {3.814086871379266*^9, 3.8140868736799583`*^9}, {
   3.814087220682115*^9, 3.814087222773658*^9}, {3.814087680471377*^9, 
   3.814087682671844*^9}, {3.81408787219304*^9, 3.814087876854125*^9}, {
   3.8140882971186867`*^9, 3.814088299232841*^9}, {3.814088398289165*^9, 
   3.814088400653244*^9}, {3.814088592710821*^9, 3.814088594743969*^9}, {
   3.814088721594771*^9, 3.814088723709012*^9}, {3.814166914871345*^9, 
   3.814166916815487*^9}, {3.8141686613094597`*^9, 3.814168663314687*^9}, {
   3.8141737820515614`*^9, 3.8141737844010973`*^9}, {3.81417392688133*^9, 
   3.814173928893731*^9}, {3.8141746137151737`*^9, 3.814174615775346*^9}, {
   3.814175269310081*^9, 3.814175271456627*^9}, {3.814181248277985*^9, 
   3.814181250928999*^9}, {3.8141816073160887`*^9, 3.8141816187676086`*^9}, {
   3.814181820311122*^9, 3.814181822565598*^9}, {3.814182052184639*^9, 
   3.814182054225382*^9}, {3.8141824343099213`*^9, 3.814182436462121*^9}, {
   3.8141834462667522`*^9, 3.814183448547871*^9}, {3.814183794568681*^9, 
   3.814183796647595*^9}, {3.814184038828411*^9, 3.814184040903879*^9}, {
   3.814184167397976*^9, 3.814184169662665*^9}, {3.814184403294862*^9, 
   3.814184405344331*^9}, {3.814185175319215*^9, 3.814185177506757*^9}, {
   3.814185212640544*^9, 3.814185214758678*^9}, {3.8141854648841047`*^9, 
   3.814185467058929*^9}, {3.814185597372319*^9, 3.814185599443632*^9}, {
   3.8141864919442053`*^9, 3.8141864939532757`*^9}, 3.814186560097211*^9, {
   3.814186613175529*^9, 3.814186615451441*^9}, {3.814188571420106*^9, 
   3.814188573844698*^9}, {3.814188932041193*^9, 3.814188934144669*^9}, {
   3.814189015043069*^9, 3.8141890171654177`*^9}, {3.814189117657855*^9, 
   3.814189119727622*^9}, {3.814189408648222*^9, 3.814189410714181*^9}, {
   3.814190322028068*^9, 3.814190324341449*^9}, {3.814190485340208*^9, 
   3.814190487481359*^9}, {3.814190822284096*^9, 3.8141908244057417`*^9}, {
   3.8141908817658367`*^9, 3.814190883897567*^9}, {3.8141910344637947`*^9, 
   3.8141910365093517`*^9}, {3.81419111436339*^9, 3.814191116608912*^9}, {
   3.814191319972777*^9, 3.8141913221786118`*^9}, {3.8141925280512877`*^9, 
   3.814192530148684*^9}, {3.8141925871196003`*^9, 3.814192589278726*^9}, {
   3.814192736096703*^9, 3.8141927383355017`*^9}, {3.814193234514598*^9, 
   3.814193236604418*^9}, {3.8141934096826763`*^9, 3.8141934118168907`*^9}, {
   3.814193568107147*^9, 3.814193572238719*^9}, {3.814193702495264*^9, 
   3.814193704819798*^9}, {3.814193903925933*^9, 3.814193906811962*^9}, {
   3.814194235349001*^9, 3.814194237725219*^9}, {3.814194778409259*^9, 
   3.8141947811959953`*^9}, {3.814194872308482*^9, 3.8141948746551123`*^9}, {
   3.81419505171605*^9, 3.8141950539383707`*^9}, {3.814195165041966*^9, 
   3.814195167329813*^9}, {3.8141961149659853`*^9, 3.8141961175278587`*^9}, {
   3.814201462428227*^9, 3.814201465318254*^9}, {3.814202514488419*^9, 
   3.814202516997239*^9}, {3.814202657929777*^9, 3.8142026604046164`*^9}, {
   3.814202789944704*^9, 3.814202792502572*^9}, {3.814203338691642*^9, 
   3.814203341129416*^9}, {3.8142036431732817`*^9, 3.814203645566944*^9}, {
   3.814203854650566*^9, 3.814203857161471*^9}, {3.814204021894991*^9, 
   3.8142040246007338`*^9}, {3.814204321736588*^9, 3.814204324253615*^9}, {
   3.814204710687338*^9, 3.81420471330956*^9}, {3.814205303697669*^9, 
   3.814205306283723*^9}, {3.814205874083356*^9, 3.814205877658256*^9}, {
   3.814206027729166*^9, 3.814206030271657*^9}, {3.814206306896222*^9, 
   3.814206309573406*^9}, {3.814206409035581*^9, 3.814206411729217*^9}, {
   3.8142085734491777`*^9, 3.81420859082801*^9}, {3.814208773682539*^9, 
   3.814208776422277*^9}, {3.814208817167588*^9, 3.814208819946863*^9}, {
   3.814209223661315*^9, 3.814209226244775*^9}, {3.814342964551488*^9, 
   3.814342987056006*^9}, {3.8143433889364347`*^9, 3.8143433916971073`*^9}, {
   3.814343451469179*^9, 3.814343454091181*^9}, {3.814343612522962*^9, 
   3.81434361589345*^9}, {3.814360788095408*^9, 3.814360790925819*^9}, {
   3.814361141628705*^9, 3.8143611441288567`*^9}, {3.81477271318125*^9, 
   3.814772715879468*^9}, {3.814818967140544*^9, 3.8148189699343452`*^9}, {
   3.8148933170032454`*^9, 3.814893320639909*^9}, {3.815561807116763*^9, 
   3.815561811047056*^9}, {3.815674112897756*^9, 3.815674116795689*^9}, {
   3.815674483145269*^9, 3.815674486816883*^9}, {3.815674583465364*^9, 
   3.815674587645926*^9}, {3.815675446702072*^9, 3.8156754507731*^9}, {
   3.815675723812805*^9, 3.815675726612404*^9}, {3.815677559923547*^9, 
   3.815677564064171*^9}, {3.8156788959904613`*^9, 3.815678898712597*^9}, {
   3.8157372492489653`*^9, 3.815737252414378*^9}, {3.815739441506493*^9, 
   3.8157394441416807`*^9}, {3.8157396705309353`*^9, 3.815739672946999*^9}, {
   3.815739952182103*^9, 3.815739954911107*^9}, {3.8157405646251793`*^9, 
   3.8157405671921873`*^9}, {3.815740840893463*^9, 3.815740843266814*^9}, {
   3.815756164096713*^9, 3.815756167067443*^9}, {3.815756373637348*^9, 
   3.815756376441429*^9}, {3.8157565145363207`*^9, 3.815756516985959*^9}, {
   3.8157567364933558`*^9, 3.815756738776677*^9}, {3.81575691142894*^9, 
   3.815756913750643*^9}, {3.815757467812187*^9, 3.815757470120165*^9}, {
   3.815757628749271*^9, 3.8157576310826607`*^9}, {3.8157577432980433`*^9, 
   3.815757745673403*^9}, {3.815757925408731*^9, 3.815757927912776*^9}, {
   3.815758502263973*^9, 3.8157585050187063`*^9}, {3.8157599496965437`*^9, 
   3.8157599523655787`*^9}, {3.815807671952351*^9, 3.8158076764913397`*^9}, {
   3.8158478265028267`*^9, 3.815847829374333*^9}, {3.816272519875782*^9, 
   3.816272522716222*^9}, {3.816273435225423*^9, 3.816273453178952*^9}, {
   3.81627402677772*^9, 3.8162740433166027`*^9}, {3.816367088849147*^9, 
   3.816367091709963*^9}, {3.8163674670838118`*^9, 3.816367495326399*^9}, {
   3.816367700110374*^9, 3.8163677030263443`*^9}, {3.816432366467956*^9, 
   3.816432383727195*^9}, {3.816432890297573*^9, 3.816432892678884*^9}, {
   3.816434394670598*^9, 3.816434397449801*^9}, {3.816435119874084*^9, 
   3.816435123428753*^9}, {3.816435247720501*^9, 3.8164352502199507`*^9}, {
   3.816437182446773*^9, 3.8164371851950293`*^9}, {3.8164381166537323`*^9, 
   3.816438119109576*^9}, {3.816438372195285*^9, 3.8164383747732162`*^9}, {
   3.816443560752285*^9, 3.8164435630839043`*^9}, {3.816449986293899*^9, 
   3.816449989361495*^9}, {3.8164500416019173`*^9, 3.816450045355052*^9}, {
   3.816450256111651*^9, 3.816450258632635*^9}, {3.8165202255377913`*^9, 
   3.816520228493339*^9}, {3.816520276138735*^9, 3.816520278495509*^9}, {
   3.821112248247272*^9, 3.8211122499340067`*^9}, 3.8211125823402576`*^9, {
   3.821112638957426*^9, 3.8211126404533453`*^9}, {3.8211134504785843`*^9, 
   3.821113452165578*^9}, {3.821113559314838*^9, 3.8211135607158537`*^9}, {
   3.821113674014234*^9, 3.821113675440147*^9}, {3.821115355778998*^9, 
   3.821115357179041*^9}, {3.821115438441927*^9, 3.821115439886298*^9}, {
   3.821115569771562*^9, 3.821115571190168*^9}, {3.821115607606412*^9, 
   3.821115609027944*^9}, {3.821115643493499*^9, 3.82111564491823*^9}, 
   3.821115698982127*^9, {3.821116525995029*^9, 3.821116527569503*^9}, {
   3.8211807933246517`*^9, 3.821180797134564*^9}, {3.821181369019555*^9, 
   3.821181370682086*^9}, {3.82118155007795*^9, 3.821181551712942*^9}, {
   3.821181648663204*^9, 3.821181650329311*^9}, {3.821181766366767*^9, 
   3.821181767919774*^9}, {3.821181850695466*^9, 3.8211818522436857`*^9}, {
   3.821182195675105*^9, 3.821182197409617*^9}, {3.8211822341197653`*^9, 
   3.821182235760687*^9}, {3.821182289256035*^9, 3.821182291491358*^9}, {
   3.821182447232856*^9, 3.821182448815895*^9}, {3.821182545695263*^9, 
   3.8211825473371696`*^9}, {3.821182803695034*^9, 3.821182826420697*^9}, {
   3.821182890867529*^9, 3.8211828924725657`*^9}, {3.821183843583189*^9, 
   3.821183846214291*^9}, {3.821183932403427*^9, 3.82118393411684*^9}, {
   3.821185403844445*^9, 3.821185406489559*^9}, {3.821185895061553*^9, 
   3.8211858967432127`*^9}, {3.8211859977708273`*^9, 3.821185999414528*^9}, {
   3.82118652255777*^9, 3.82118652429946*^9}, {3.821188196614212*^9, 
   3.821188198984503*^9}, {3.8211888218892736`*^9, 3.821188823587648*^9}, {
   3.821189023332006*^9, 3.821189024901043*^9}, {3.821200358388598*^9, 
   3.821200360723811*^9}, {3.82125230811371*^9, 3.821252310425384*^9}, {
   3.82125324026995*^9, 3.821253242000938*^9}, {3.821253371365123*^9, 
   3.8212533730312977`*^9}, {3.82125463372829*^9, 3.82125463532833*^9}, {
   3.8212665284004297`*^9, 3.82126653058568*^9}, {3.821269756607106*^9, 
   3.821269758269957*^9}, {3.8212699915543127`*^9, 3.821269993253598*^9}, {
   3.821270509712674*^9, 3.821270511252757*^9}, {3.821270714841835*^9, 
   3.8212707163553953`*^9}, {3.821857066418799*^9, 3.821857068436179*^9}, {
   3.821857238848073*^9, 3.8218572406080837`*^9}, {3.821857306961193*^9, 
   3.821857308815687*^9}, {3.821858329161891*^9, 3.821858330921257*^9}, {
   3.821858533588607*^9, 3.821858535393834*^9}, {3.822466930610661*^9, 
   3.822466932711265*^9}, {3.82246755017793*^9, 3.822467552426691*^9}, {
   3.822467749673311*^9, 3.822467751455882*^9}, {3.822573430907197*^9, 
   3.822573433060669*^9}, {3.822573589252286*^9, 3.822573591586359*^9}, {
   3.822573761382971*^9, 3.822573762982388*^9}, {3.822645938191208*^9, 
   3.822645940439321*^9}, {3.822646089925147*^9, 3.822646091588183*^9}, {
   3.822647063134713*^9, 3.822647065170986*^9}, {3.82264989003335*^9, 
   3.822649892246587*^9}, {3.822650020132606*^9, 3.822650021780541*^9}, {
   3.822666070508794*^9, 3.8226660725473022`*^9}, {3.822680886091876*^9, 
   3.822680888292263*^9}, {3.822749716556568*^9, 3.8227497182590733`*^9}, {
   3.822753599563224*^9, 3.822753603427362*^9}, {3.822850659192142*^9, 
   3.8228506617024517`*^9}, {3.822851348179101*^9, 3.822851350294177*^9}, {
   3.8229175130225487`*^9, 3.8229175151498413`*^9}, {3.8230693065739727`*^9, 
   3.823069309209519*^9}, {3.823069935561988*^9, 3.8230699378994017`*^9}, {
   3.8230941515697937`*^9, 3.823094153220969*^9}, {3.823097646942124*^9, 
   3.8230976487034283`*^9}, {3.823097783913177*^9, 3.8230977856429367`*^9}, {
   3.823254480421237*^9, 3.8232544829781837`*^9}, {3.8232552616464043`*^9, 
   3.823255263228126*^9}, {3.823266389133399*^9, 3.823266391390469*^9}, {
   3.823277944542283*^9, 3.823277946952321*^9}, {3.823278049855897*^9, 
   3.823278051539062*^9}, {3.8240296379322863`*^9, 3.824029640152253*^9}, {
   3.824030011795867*^9, 3.824030013583274*^9}, {3.824030057757848*^9, 
   3.824030059462328*^9}, {3.824030101892935*^9, 3.824030154676828*^9}, {
   3.824058516673664*^9, 3.824058519016489*^9}, {3.82411175449552*^9, 
   3.8241117572271347`*^9}, {3.8345697939401207`*^9, 3.834569797837585*^9}, {
   3.834570585918673*^9, 3.8345705892628603`*^9}, {3.834571450101981*^9, 
   3.834571454366171*^9}, {3.834571993229724*^9, 3.8345719958067217`*^9}, {
   3.834573833769699*^9, 3.83457383643392*^9}},
 CellLabel->
  "Out[373]=",ExpressionUUID->"284f956a-bad8-4d2a-b29f-05baeae3f695"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1. ",
 StyleBox["Initialization",
  FontColor->RGBColor[0, 0, 1]]
}], "Section",
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"452e7aa3-04d7-4f81-bb10-d8f1e3a8706e"],

Cell[CellGroupData[{

Cell["1.0. To do list (open to suggestions)", "Subsubsection",
 CellChangeTimes->{{3.876125911843934*^9, 3.876125918201146*^9}, {
  3.8762422443938704`*^9, 
  3.876242252715769*^9}},ExpressionUUID->"14ec624c-f949-412b-bad8-\
8639d36d5b9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "1.", " ", "Highligth", " ", "modifications", " ", "on", " ", "functions", 
    " ", "of", " ", "xTensor", " ", "like", " ", "defcovdTangentFrozen", " ", 
    "with", " ", "Background", " ", "color"}], " ", "*)"}], " "}]], "Input",
 CellChangeTimes->{{3.893513418004965*^9, 3.893513482100918*^9}, 
   3.8935135223196173`*^9},ExpressionUUID->"af9cc293-5c86-4a84-a230-\
155ac904fb37"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.1. GPL", "Subsubsection",ExpressionUUID->"6c7b7745-4d1b-4902-879a-a236450fd7f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"xBrauer", " ", ":", " ", 
    RowBox[{
    "Applications", " ", "of", " ", "the", " ", "Brauer", " ", "algebra", " ",
      "for", " ", "tensor", " ", "calculus"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Copyright", " ", 
    RowBox[{"(", "C", ")"}], " ", "2020", " ", 
    RowBox[{"T", ".", " ", "Helpin"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], " ", "modify", " ", "it", " ", "under", " ",
       "the", " ", "terms", " ", "of", " ", "the", " ", "GNU", " ", "General",
       " ", "Public", " ", "License", " ", "as", " ", "published", " ", "by", 
      " ", "the", " ", "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", " ", "the", " ", 
      "License"}]}], ",", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", " ", "MERCHANTABILITY", " ", "or", " ", "FITNESS", " ", "FOR", 
      " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", " ", 
      "General", " ", "Public", " ", "License", " ", "for", " ", "more", " ", 
      
      RowBox[{"details", "."}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811396989571898*^9, 3.8113970461420307`*^9}, {
   3.8211096799186583`*^9, 3.821109703475609*^9}, 3.875954844964786*^9, {
   3.8768474361487503`*^9, 3.8768474392095747`*^9}, 3.876970435721333*^9, {
   3.878025139641973*^9, 
   3.878025174741592*^9}},ExpressionUUID->"e5b23ef2-606b-4ba0-a720-\
a469c2133c48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.2. Info package", "Subsubsection",ExpressionUUID->"8db9a4ee-4177-4195-9b3d-727eccc96972"],

Cell["\<\
(* :Title: xBrauer *)

(* :Author: Thomas Helpin *)

(* :Summary: xBrauer; Application of the Brauer algebra to tensor calculus. *)

(* :Brief Discussion:  *)
  
(* :Context: xBrauer` *)

(* :Package Version: 0.1.0 *)

(* :Copyright: T.Helpin (2020) *)

(* :History: TODO *)

(* :Keywords: TODO *)

(* :Source: xBrauer.nb *)

(* :Warning:  *)

(* :Mathematica Version: 8.0 and later *)

(* :Limitations: *)
\t
(* :Acknowledgements: *)\
\>", "Input",
 PageWidth:>PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True,
 CellChangeTimes->{{3.81139705816584*^9, 3.8113971135526857`*^9}, {
   3.821109711251081*^9, 3.8211097374712257`*^9}, 3.8306782820355387`*^9, {
   3.862384731591366*^9, 3.8623847413092413`*^9}, 3.8623850057030497`*^9, 
   3.8759548586454897`*^9, {3.876143411163309*^9, 3.876143418127839*^9}, {
   3.87624223299439*^9, 3.8762422396756144`*^9}, {3.87697043624072*^9, 
   3.876970436905416*^9}, {3.878025151839576*^9, 3.878025190907267*^9}, {
   3.8833096752089157`*^9, 
   3.883309695500255*^9}},ExpressionUUID->"653c46e6-9402-4994-ba04-\
39c497d51544"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.3. BeginPackage", "Subsubsection",ExpressionUUID->"53873783-da1d-4c42-8d90-f0ebc5b46037"],

Cell["Explicit (not hidden) import of other packages:", "Text",
 CellChangeTimes->{{3.811397148571397*^9, 3.8113971515773697`*^9}, {
  3.8113971895168*^9, 3.811397205114863*^9}, {3.8113991204497633`*^9, 
  3.811399127238121*^9}},ExpressionUUID->"dbd169e2-e4a0-491b-bcb9-\
71c8d803b504"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`xBrauer`\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  StyleBox[
   RowBox[{"General", "::", "nostdvar"}], "MessageName"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   StyleBox[
    RowBox[{"General", "::", "nostdopt"}], "MessageName"], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`xBrauer`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xTensor`\>\"", ",", "\"\<xAct`xPerm`\>\"", ",", 
     "\"\<xAct`xCore`\>\"", ",", "\"\<xAct`Invar`\>\"", ",", 
     "\"\<xAct`SymManipulator`\>\"", ",", "\"\<xAct`xPert`\>\"", ",", 
     "\"\<xAct`xTras`\>\"", ",", "\"\<xAct`SymmetricFunctions`\>\"", ",", 
     "\"\<xAct`BrauerAlgebra`\>\""}], "}"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811397210011499*^9, 3.811397231517387*^9}, {
   3.8113991040362997`*^9, 3.8113991127834473`*^9}, {3.811399236445691*^9, 
   3.8113992372681704`*^9}, {3.8114192103551292`*^9, 3.81141921070119*^9}, 
   3.8211097653397207`*^9, 3.830678282302866*^9, 3.831626926259672*^9, {
   3.847169106523905*^9, 3.847169137793591*^9}, {3.8623847612117577`*^9, 
   3.8623847660598927`*^9}, 3.862384939958562*^9, {3.865503433309306*^9, 
   3.865503436185557*^9}, {3.865503485456088*^9, 3.865503494552191*^9}, {
   3.865504582509095*^9, 3.865504584315671*^9}, {3.871113700660293*^9, 
   3.871113704433076*^9}, {3.875954877462573*^9, 3.8759548995389214`*^9}, 
   3.875955490328168*^9, 3.876970437092945*^9, {3.878025219807323*^9, 
   3.878025241521077*^9}, {3.878025302971929*^9, 3.878025308274407*^9}, {
   3.883307042101296*^9, 3.8833070810143423`*^9}, 3.883307816266827*^9, {
   3.883309156940713*^9, 3.88330915694423*^9}, 3.8833093177571917`*^9, {
   3.888569503808371*^9, 3.888569509655438*^9}, {3.888570286316152*^9, 
   3.8885702877354317`*^9}, {3.891338777825851*^9, 3.891338787226453*^9}, {
   3.892271609441966*^9, 3.892271611408506*^9}, {3.89323180302431*^9, 
   3.893231803229947*^9}, {3.8934891333687887`*^9, 3.893489151126618*^9}, {
   3.893500503358468*^9, 
   3.893500522079238*^9}},ExpressionUUID->"c890133e-8df5-4972-906c-\
bbda724bbc68"],

Cell[TextData[{
 "Check version of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". We simply compare dates:"
}], "Text",
 CellChangeTimes->{
  3.862384774912628*^9},ExpressionUUID->"389103e4-2622-4249-864e-\
1ba3754c11dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"OrderedQ", "@", 
      RowBox[{"Map", "[", 
       RowBox[{"Last", ",", 
        RowBox[{"{", 
         RowBox[{"$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}], 
         "}"}]}], "]"}]}]}], ",", 
    RowBox[{"Throw", "@", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"General", "::", "versions"}], ",", "\"\<xTensor\>\"", ",", 
       "xAct`xTensor`$Version", ",", "$xTensorVersionExpected"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"OrderedQ", "@", 
       RowBox[{"Map", "[", 
        RowBox[{"Last", ",", 
         RowBox[{"{", 
          RowBox[{"$xTrasVersionExpected", ",", "xAct`xTras`$Version"}], 
          "}"}]}], "]"}]}]}], ",", 
     RowBox[{"Throw", "@", 
      RowBox[{"Message", "[", 
       RowBox[{
        RowBox[{"General", "::", "versions"}], ",", "\"\<xTras\>\"", ",", 
        "xAct`xTras`$Version", ",", "$xTrasVersionExpected"}], "]"}]}]}], 
    "]"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81139877523311*^9, 3.811398792138245*^9}, 
   3.847169154486466*^9, 3.8655033483386717`*^9, 
   3.865503502157617*^9},ExpressionUUID->"da3d03b6-896a-4a67-9cbd-\
af24c41194f9"],

Cell["Welcome message:", "Text",
 CellChangeTimes->{
  3.8780253487426*^9},ExpressionUUID->"143af8a5-d855-4fc5-896a-7ebef2f1c576"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Print", "[", "xAct`xCore`Private`bars", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`xBrauer`  version \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<Copyright (C) 2020-2022, Thomas Helpin, under the General Public \
License.\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.81139726521101*^9, 3.8113972913333073`*^9}, 
   3.821109768278029*^9, 3.8306782823413773`*^9, 3.83162692627306*^9, {
   3.8623850230263853`*^9, 3.862385024585629*^9}, {3.875954916930093*^9, 
   3.875954937129417*^9}, 3.876970437360468*^9, 3.878025361268449*^9, 
   3.88330704210646*^9, 
   3.88330915545662*^9},ExpressionUUID->"2cf45679-4fef-4a58-8aaf-\
531208a1712c"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.811397380255863*^9, 3.8113976734081097`*^9, {3.811397745978087*^9, 
   3.811397760983447*^9}, {3.811399023755513*^9, 3.811399024034425*^9}, {
   3.811399141919792*^9, 3.81139914222785*^9}, {3.811399177590304*^9, 
   3.811399177876423*^9}, {3.8113992520861053`*^9, 3.8113992524163723`*^9}, {
   3.811399450230728*^9, 3.8113994504442053`*^9}, {3.811406482054153*^9, 
   3.8114064823771763`*^9}, {3.811406857514288*^9, 3.811406857838578*^9}, {
   3.8114069073980303`*^9, 3.811406936363989*^9}, {3.8114074605153103`*^9, 
   3.811407460919879*^9}, {3.8114081475873013`*^9, 3.811408147936496*^9}, {
   3.8114081912936983`*^9, 3.811408191639731*^9}, 3.8114087801506*^9, {
   3.8114088154796953`*^9, 3.811408815830575*^9}, {3.811408862489479*^9, 
   3.8114088628092823`*^9}, {3.811408997672443*^9, 3.811408997972644*^9}, {
   3.811409062199967*^9, 3.811409062560708*^9}, 3.811409269741153*^9, {
   3.811409304393887*^9, 3.8114093047316523`*^9}, {3.811409612545312*^9, 
   3.811409612871463*^9}, {3.811409792383432*^9, 3.81140979264503*^9}, {
   3.8114114516810293`*^9, 3.811411451954177*^9}, {3.8114118638170557`*^9, 
   3.811411864137804*^9}, {3.8114119197658863`*^9, 3.8114119200533752`*^9}, {
   3.811412615844184*^9, 3.811412616118388*^9}, {3.811412715264756*^9, 
   3.81141271556739*^9}, {3.811413263697074*^9, 3.8114132639764347`*^9}, {
   3.81141333216614*^9, 3.811413332508459*^9}, {3.8114136296302567`*^9, 
   3.811413629932342*^9}, {3.811413774183793*^9, 3.811413774483966*^9}, {
   3.811413894473914*^9, 3.811413894742936*^9}, 3.811414328663225*^9, 
   3.811414409420786*^9, {3.8114146494418592`*^9, 3.811414649791082*^9}, {
   3.811415041992805*^9, 3.811415042314645*^9}, {3.8114158813939857`*^9, 
   3.811415881817687*^9}, {3.811416424175036*^9, 3.811416424542282*^9}, {
   3.81141651448024*^9, 3.8114165147818623`*^9}, {3.811416943395186*^9, 
   3.811416943700404*^9}, {3.8114170092299623`*^9, 3.8114170095421553`*^9}, {
   3.81141910080551*^9, 3.811419101168853*^9}, {3.811419221332913*^9, 
   3.811419222217*^9}, {3.811419394504477*^9, 3.811419394922099*^9}, {
   3.81141961436992*^9, 3.8114196147085114`*^9}, {3.8114197211279917`*^9, 
   3.811419721463704*^9}, {3.811420278374814*^9, 3.811420278750799*^9}, {
   3.8114204965624447`*^9, 3.8114204969294167`*^9}, {3.8114207654378643`*^9, 
   3.811420765826226*^9}, {3.8114208756007967`*^9, 3.811420875961768*^9}, {
   3.8114209951492987`*^9, 3.81142099564255*^9}, {3.811423399120966*^9, 
   3.811423399497507*^9}, {3.8114234321181917`*^9, 3.8114234324752207`*^9}, {
   3.811423901691526*^9, 3.811423902138219*^9}, {3.81142494089266*^9, 
   3.811424941342019*^9}, {3.811425128625205*^9, 3.8114251290157747`*^9}, {
   3.811425230953362*^9, 3.8114252313951893`*^9}, {3.8114253616516237`*^9, 
   3.8114253620864763`*^9}, {3.811425407286655*^9, 3.8114254077167673`*^9}, {
   3.811425648622707*^9, 3.811425649007204*^9}, {3.811425739775928*^9, 
   3.811425740148724*^9}, {3.811425802047525*^9, 3.811425802419311*^9}, {
   3.811426021625207*^9, 3.811426021999112*^9}, {3.811426573816395*^9, 
   3.811426574261427*^9}, {3.811427720817814*^9, 3.811427721181036*^9}, {
   3.811431178013152*^9, 3.8114311784290743`*^9}, {3.811431460179394*^9, 
   3.811431460603293*^9}, {3.8114319974694977`*^9, 3.811431997902873*^9}, {
   3.8114326319011927`*^9, 3.8114326324062357`*^9}, {3.8114347908791037`*^9, 
   3.811434791453148*^9}, {3.811435083597364*^9, 3.811435084057816*^9}, {
   3.811435687012912*^9, 3.811435687591379*^9}, {3.811435778921373*^9, 
   3.811435779414921*^9}, {3.811435829146523*^9, 3.811435829620166*^9}, {
   3.811436514793991*^9, 3.8114365152949867`*^9}, 3.8114370529200706`*^9, 
   3.811437273582306*^9, {3.811437345253675*^9, 3.8114373468140087`*^9}, {
   3.8114420566234083`*^9, 3.811442057269763*^9}, {3.811484937224011*^9, 
   3.8114849383588257`*^9}, {3.81150886561022*^9, 3.8115088661019382`*^9}, {
   3.81150901060539*^9, 3.811509011146083*^9}, {3.811509165836363*^9, 
   3.81150916637247*^9}, {3.811509220423718*^9, 3.811509220984604*^9}, {
   3.81150932454107*^9, 3.811509325081565*^9}, {3.811510768993325*^9, 
   3.811510769545199*^9}, {3.8115108873365517`*^9, 3.811510887881638*^9}, {
   3.811510958688545*^9, 3.81151095921633*^9}, {3.811511149384656*^9, 
   3.811511149922365*^9}, {3.8115116742260017`*^9, 3.811511674743322*^9}, {
   3.81151183831352*^9, 3.811511838856657*^9}, {3.811511931984598*^9, 
   3.81151193254609*^9}, {3.811517913695464*^9, 3.81151791419833*^9}, {
   3.811518119669978*^9, 3.811518120331017*^9}, {3.811518279285968*^9, 
   3.811518279756792*^9}, {3.811518454353118*^9, 3.8115184548471603`*^9}, {
   3.8115185239898987`*^9, 3.811518524527364*^9}, {3.8115185884391317`*^9, 
   3.811518589049789*^9}, {3.811518779913629*^9, 3.811518780475634*^9}, {
   3.811518824987791*^9, 3.811518825474622*^9}, {3.8115190753371553`*^9, 
   3.811519075828248*^9}, {3.81151919588023*^9, 3.8115191963599577`*^9}, 
   3.81151927370893*^9, {3.811520940954657*^9, 3.811520941467544*^9}, {
   3.811522193160576*^9, 3.811522193758127*^9}, {3.8115222693502197`*^9, 
   3.8115222698555107`*^9}, {3.811522391112768*^9, 3.8115223921904783`*^9}, {
   3.8115224350291986`*^9, 3.811522435551996*^9}, {3.811522537668714*^9, 
   3.811522538204536*^9}, {3.811522593945785*^9, 3.8115225944826307`*^9}, {
   3.811523888759894*^9, 3.8115239149877653`*^9}, {3.811523975460766*^9, 
   3.8115239760526133`*^9}, {3.81152408125178*^9, 3.811524081855679*^9}, {
   3.8115242186455107`*^9, 3.8115242191965322`*^9}, {3.811524257423635*^9, 
   3.811524258031362*^9}, {3.8115243358445263`*^9, 3.811524336442563*^9}, {
   3.8115246114680557`*^9, 3.811524612070348*^9}, {3.8115246424829206`*^9, 
   3.8115246430586863`*^9}, {3.811525683654154*^9, 3.811525684214143*^9}, {
   3.811525890128848*^9, 3.8115258907950363`*^9}, {3.811526232978079*^9, 
   3.811526233683413*^9}, {3.811526630867503*^9, 3.811526631451227*^9}, {
   3.8115267687707653`*^9, 3.81152676933543*^9}, {3.811527006850094*^9, 
   3.811527007492984*^9}, {3.811527237331669*^9, 3.81152723800994*^9}, {
   3.811527434499577*^9, 3.811527435035942*^9}, {3.81152781548516*^9, 
   3.811527816052124*^9}, {3.811528804617424*^9, 3.811528805128271*^9}, {
   3.8115716854335012`*^9, 3.81157168600708*^9}, {3.8115910492875957`*^9, 
   3.811591049819941*^9}, {3.811591683058972*^9, 3.8115916837199383`*^9}, {
   3.811591907441052*^9, 3.811591908034089*^9}, {3.8115921478669653`*^9, 
   3.811592148473164*^9}, {3.811592261334196*^9, 3.8115922619247713`*^9}, {
   3.811593653253026*^9, 3.811593653910493*^9}, {3.8115939556965427`*^9, 
   3.8115939564233627`*^9}, {3.8115940515357313`*^9, 
   3.8115940521810303`*^9}, {3.811674041743834*^9, 3.811674042778859*^9}, {
   3.811680792977523*^9, 3.811680794669155*^9}, {3.811680857014598*^9, 
   3.811680859363141*^9}, {3.811697553489249*^9, 3.8116975543500853`*^9}, {
   3.8116979140091543`*^9, 3.811697914783626*^9}, {3.8117547430726643`*^9, 
   3.811754743779047*^9}, {3.812098227542214*^9, 3.8120982282700043`*^9}, {
   3.812098469697813*^9, 3.812098470392009*^9}, {3.8120990911618032`*^9, 
   3.812099091931766*^9}, {3.812099205094201*^9, 3.81209920575681*^9}, {
   3.812099496445903*^9, 3.812099497099246*^9}, {3.812099704827511*^9, 
   3.812099705524568*^9}, 3.812099841373004*^9, {3.8121008349827127`*^9, 
   3.8121008356452723`*^9}, {3.812100998031687*^9, 3.812100998699497*^9}, 
   3.812101199244226*^9, {3.812105781422167*^9, 3.8121058012696333`*^9}, {
   3.812106210992141*^9, 3.812106212086731*^9}, {3.812106517020553*^9, 
   3.812106517861352*^9}, {3.81210662705794*^9, 3.8121066279513817`*^9}, {
   3.812107358053319*^9, 3.81210735886729*^9}, {3.812108061804627*^9, 
   3.812108062795374*^9}, {3.81210850594429*^9, 3.812108506763496*^9}, {
   3.8121087516485043`*^9, 3.812108752553528*^9}, {3.812110466583847*^9, 
   3.812110468418062*^9}, {3.8121106052389297`*^9, 3.812110622217564*^9}, {
   3.812128612258595*^9, 3.8121286130930767`*^9}, {3.812142012154276*^9, 
   3.812142013370919*^9}, {3.8121436187461243`*^9, 3.812143619726426*^9}, {
   3.812169986280006*^9, 3.8121699880846853`*^9}, {3.812170318401219*^9, 
   3.812170321597624*^9}, {3.812170617382443*^9, 3.812170619688922*^9}, {
   3.8121706543787937`*^9, 3.8121706568061333`*^9}, {3.812174967812786*^9, 
   3.8121749685329*^9}, {3.8121913946828737`*^9, 3.812191397705915*^9}, {
   3.8121918210762587`*^9, 3.812191821891308*^9}, {3.812192180334764*^9, 
   3.8121921824101*^9}, {3.81219350741434*^9, 3.8121935082680387`*^9}, {
   3.812193977731657*^9, 3.812193978538468*^9}, {3.812194328835504*^9, 
   3.812194329680163*^9}, {3.8121953582059193`*^9, 3.8121953589764223`*^9}, {
   3.812195410179782*^9, 3.812195410951828*^9}, {3.81219562855984*^9, 
   3.812195629337537*^9}, {3.812195747436954*^9, 3.812195748208564*^9}, {
   3.8121958057103453`*^9, 3.81219580646887*^9}, {3.8121962405147333`*^9, 
   3.812196241351693*^9}, {3.81219808421192*^9, 3.812198085033792*^9}, {
   3.8121986977920303`*^9, 3.812198698507237*^9}, {3.8122612832926197`*^9, 
   3.8122612843691273`*^9}, {3.812261847475174*^9, 3.8122618482206793`*^9}, {
   3.8122621905503798`*^9, 3.8122621912422953`*^9}, {3.812262516180772*^9, 
   3.8122625170336742`*^9}, {3.812262732994528*^9, 3.812262734810576*^9}, {
   3.8122637803136168`*^9, 3.812263781175597*^9}, {3.81226423405247*^9, 
   3.812264234828869*^9}, {3.812264328507156*^9, 3.8122643292569323`*^9}, {
   3.8122647537178173`*^9, 3.81226475459415*^9}, {3.8122694287586937`*^9, 
   3.812269429467114*^9}, {3.8122697825943413`*^9, 3.812269783587479*^9}, {
   3.812269955534123*^9, 3.812269956294467*^9}, {3.812270079703095*^9, 
   3.812270080733671*^9}, 3.812270515227173*^9, {3.81227226100237*^9, 
   3.81227226239818*^9}, {3.812272621416738*^9, 3.812272622344799*^9}, {
   3.812272785332284*^9, 3.812272786113269*^9}, {3.812273117409337*^9, 
   3.8122731181998672`*^9}, {3.8122749791546803`*^9, 3.812274980467044*^9}, {
   3.812286822071122*^9, 3.812286822865263*^9}, {3.812286942168477*^9, 
   3.812286942954629*^9}, {3.81229077138659*^9, 3.8122907721881437`*^9}, {
   3.812291582239973*^9, 3.812291583088977*^9}, {3.8122926139943132`*^9, 
   3.8122926148596163`*^9}, {3.812292666537876*^9, 3.8122926673672237`*^9}, {
   3.812292862208189*^9, 3.8122928630362883`*^9}, {3.8122992513698473`*^9, 
   3.812299252280985*^9}, {3.812302863020978*^9, 3.8123028652674723`*^9}, {
   3.812344963602908*^9, 3.812344964501193*^9}, {3.812345105959405*^9, 
   3.8123451070454884`*^9}, {3.812345426346874*^9, 3.812345427410276*^9}, {
   3.812346016924399*^9, 3.8123460178394003`*^9}, {3.812349663424943*^9, 
   3.812349665627651*^9}, {3.8123499949774313`*^9, 3.8123499961761627`*^9}, {
   3.812350224046137*^9, 3.812350225338702*^9}, {3.8123589538014517`*^9, 
   3.8123589553092337`*^9}, {3.8123594855574713`*^9, 3.812359487421733*^9}, {
   3.812360961148768*^9, 3.812360962368731*^9}, {3.812362452759049*^9, 
   3.812362453702977*^9}, {3.812364453516747*^9, 3.812364454331821*^9}, {
   3.81236525793226*^9, 3.8123652590174513`*^9}, {3.812371337745275*^9, 
   3.812371338604307*^9}, {3.8123721106841583`*^9, 3.81237211186156*^9}, {
   3.812372515320086*^9, 3.812372516243149*^9}, {3.812375214247716*^9, 
   3.812375215099021*^9}, {3.812375342847501*^9, 3.8123753436690817`*^9}, {
   3.8123757391679983`*^9, 3.8123757402111197`*^9}, {3.81237606081752*^9, 
   3.812376061939822*^9}, {3.812376327688859*^9, 3.812376328606831*^9}, {
   3.812436376507328*^9, 3.8124363789421883`*^9}, {3.812443451309087*^9, 
   3.8124434522255383`*^9}, {3.812444248710919*^9, 3.812444249614787*^9}, {
   3.812448038501151*^9, 3.812448039546247*^9}, {3.81244831530435*^9, 
   3.812448316233657*^9}, {3.8124486363355618`*^9, 3.8124486372671556`*^9}, {
   3.8124518644526243`*^9, 3.8124518654314747`*^9}, {3.812458811680997*^9, 
   3.8124588127468033`*^9}, {3.812459066174507*^9, 3.812459067173732*^9}, {
   3.812459582111031*^9, 3.812459583678068*^9}, {3.81245972079722*^9, 
   3.812459721823489*^9}, {3.8124598454571466`*^9, 3.812459846509017*^9}, {
   3.812459947241436*^9, 3.812459948224428*^9}, {3.8124600757815638`*^9, 
   3.812460076801516*^9}, {3.812461336668906*^9, 3.812461337585135*^9}, {
   3.8124616241752996`*^9, 3.8124616251881657`*^9}, {3.812463233490924*^9, 
   3.812463235270775*^9}, {3.812463727360817*^9, 3.81246372850745*^9}, {
   3.8124640089450817`*^9, 3.812464010975403*^9}, {3.81246424710325*^9, 
   3.8124642483824*^9}, {3.812465524234055*^9, 3.812465525305538*^9}, {
   3.81246585873085*^9, 3.812465859860059*^9}, {3.812466123758388*^9, 
   3.812466124910141*^9}, {3.8125250720057573`*^9, 3.812525073135898*^9}, {
   3.812530198045361*^9, 3.81253019941866*^9}, {3.812533188180385*^9, 
   3.8125331891857443`*^9}, {3.812538966342523*^9, 3.812538968326033*^9}, {
   3.8125391296450777`*^9, 3.812539130659049*^9}, {3.812539168853022*^9, 
   3.8125391698988323`*^9}, {3.812539261174241*^9, 3.812539262246491*^9}, {
   3.812539518455678*^9, 3.812539519422278*^9}, {3.812539924202053*^9, 
   3.812539925162333*^9}, {3.812539973803845*^9, 3.812539974772622*^9}, {
   3.812540024793345*^9, 3.812540025747508*^9}, {3.812540263248914*^9, 
   3.8125402642313347`*^9}, {3.8125405947892637`*^9, 3.8125405966475*^9}, {
   3.812540939722726*^9, 3.8125409406463337`*^9}, {3.812541372007876*^9, 
   3.81254137294447*^9}, {3.812541798530163*^9, 3.8125417996324863`*^9}, {
   3.8125435153637867`*^9, 3.812543516583379*^9}, {3.812553680816134*^9, 
   3.812553681894978*^9}, {3.812553930612842*^9, 3.812553931568891*^9}, {
   3.812558028327196*^9, 3.812558029358966*^9}, {3.812561239308052*^9, 
   3.812561240231329*^9}, {3.8125614291203833`*^9, 3.812561430198328*^9}, {
   3.8125616430396748`*^9, 3.81256164417385*^9}, {3.812562511748394*^9, 
   3.8125625128929443`*^9}, {3.812706976637849*^9, 3.812706979962562*^9}, {
   3.8127071598669777`*^9, 3.812707164126863*^9}, {3.812708183113777*^9, 
   3.8127081857163763`*^9}, {3.812708522813237*^9, 3.812708525635468*^9}, {
   3.812709547351074*^9, 3.812709550731619*^9}, {3.812782687120266*^9, 
   3.812782690618472*^9}, {3.813410993383992*^9, 3.813410994576764*^9}, {
   3.813412566604192*^9, 3.8134125674338083`*^9}, {3.8134127579465237`*^9, 
   3.8134127587752323`*^9}, {3.813822979157645*^9, 3.813822980330248*^9}, {
   3.8138232757369432`*^9, 3.813823293263588*^9}, {3.8138235968281603`*^9, 
   3.813823597804474*^9}, {3.813823703955678*^9, 3.8138237064098053`*^9}, {
   3.8140796053163424`*^9, 3.814079606256981*^9}, {3.814080164120528*^9, 
   3.814080165120304*^9}, {3.814080414990753*^9, 3.814080415924144*^9}, {
   3.814080474781807*^9, 3.814080476166952*^9}, {3.8140810437760344`*^9, 
   3.814081044796678*^9}, {3.814081168761175*^9, 3.814081169730785*^9}, {
   3.8140813254356737`*^9, 3.81408132645538*^9}, {3.8140844586704063`*^9, 
   3.8140844595527687`*^9}, {3.814086045834732*^9, 3.8140860467720137`*^9}, {
   3.81408658221922*^9, 3.8140865831561337`*^9}, {3.814086872837978*^9, 
   3.814086873790084*^9}, {3.814087221935574*^9, 3.8140872228954763`*^9}, {
   3.814087681841282*^9, 3.814087682791913*^9}, {3.814087873810609*^9, 
   3.814087877464333*^9}, {3.814088298406973*^9, 3.8140882993639393`*^9}, {
   3.8140883997866592`*^9, 3.814088400778584*^9}, {3.814088593936247*^9, 
   3.814088594855906*^9}, {3.814088722889249*^9, 3.814088723838442*^9}, {
   3.814166916077825*^9, 3.814166916944319*^9}, {3.814168662500589*^9, 
   3.814168663417635*^9}, {3.814173783472522*^9, 3.814173784523691*^9}, {
   3.814173928073472*^9, 3.8141739290065527`*^9}, {3.8141746149378843`*^9, 
   3.814174615900647*^9}, {3.8141752705181017`*^9, 3.814175271604598*^9}, {
   3.8141812497509937`*^9, 3.8141812510541897`*^9}, {3.814181608548785*^9, 
   3.814181618874796*^9}, {3.814181821635119*^9, 3.8141818226830606`*^9}, {
   3.8141820534184933`*^9, 3.814182054334454*^9}, {3.814182435644566*^9, 
   3.8141824365728073`*^9}, {3.814183447599062*^9, 3.814183448718457*^9}, {
   3.814183795786852*^9, 3.814183796767351*^9}, {3.81418404004837*^9, 
   3.814184041025722*^9}, {3.814184168735621*^9, 3.8141841698062973`*^9}, {
   3.814184404513424*^9, 3.81418440545724*^9}, {3.8141851765141077`*^9, 
   3.8141851776244707`*^9}, {3.8141852139320803`*^9, 
   3.8141852148759747`*^9}, {3.814185466158214*^9, 3.8141854672296124`*^9}, {
   3.814185598596582*^9, 3.814185599562307*^9}, {3.814186493141219*^9, 
   3.81418649406635*^9}, 3.8141865602773237`*^9, {3.8141866145327787`*^9, 
   3.814186615629122*^9}, {3.814188572970359*^9, 3.8141885739677143`*^9}, {
   3.814188933269041*^9, 3.814188934263117*^9}, {3.814189016320849*^9, 
   3.8141890172889957`*^9}, {3.81418911889135*^9, 3.814189119850498*^9}, {
   3.814189409890736*^9, 3.8141894108280373`*^9}, {3.814190323342215*^9, 
   3.81419032458144*^9}, {3.814190486577489*^9, 3.8141904876033154`*^9}, {
   3.814190823504459*^9, 3.814190824524486*^9}, {3.8141908830044613`*^9, 
   3.8141908840172377`*^9}, {3.814191035666112*^9, 3.814191036617738*^9}, {
   3.8141911156126738`*^9, 3.8141911167478228`*^9}, {3.8141913212388563`*^9, 
   3.814191322312356*^9}, {3.814192529253978*^9, 3.814192530249302*^9}, {
   3.81419258834061*^9, 3.814192589391933*^9}, {3.814192737331789*^9, 
   3.814192738456406*^9}, {3.814193235685817*^9, 3.814193236716303*^9}, {
   3.814193410893179*^9, 3.814193411936633*^9}, {3.814193569810049*^9, 
   3.81419357240104*^9}, {3.814193703782576*^9, 3.814193704951481*^9}, {
   3.814193905679385*^9, 3.814193906937128*^9}, {3.81419423669919*^9, 
   3.814194237900447*^9}, {3.814194780224231*^9, 3.814194781353258*^9}, {
   3.814194873669276*^9, 3.814194874811592*^9}, {3.8141950529442263`*^9, 
   3.814195054066959*^9}, {3.814195166306581*^9, 3.81419516748411*^9}, {
   3.81419611653411*^9, 3.8141961177224083`*^9}, {3.8142014639164953`*^9, 
   3.814201465979793*^9}, {3.8142025158387012`*^9, 3.814202517134471*^9}, {
   3.81420265932931*^9, 3.814202660550437*^9}, {3.814202791363394*^9, 
   3.8142027926576147`*^9}, {3.814203340035961*^9, 3.814203341308709*^9}, {
   3.81420364450329*^9, 3.8142036457266903`*^9}, {3.81420385603505*^9, 
   3.814203857315226*^9}, {3.814204023304307*^9, 3.8142040255286827`*^9}, {
   3.8142043230883493`*^9, 3.814204324415008*^9}, {3.814204712076153*^9, 
   3.814204713489345*^9}, {3.814205305110921*^9, 3.814205306438252*^9}, {
   3.8142058757620573`*^9, 3.814205877889819*^9}, {3.814206029109167*^9, 
   3.8142060304307833`*^9}, {3.8142063083473577`*^9, 3.814206309726329*^9}, {
   3.814206410518965*^9, 3.814206411904018*^9}, {3.8142085735915327`*^9, 
   3.814208590972432*^9}, {3.814208775177754*^9, 3.814208776577031*^9}, {
   3.8142088186051826`*^9, 3.814208820692593*^9}, {3.814209225089054*^9, 
   3.814209226406355*^9}, {3.814342965910305*^9, 3.8143429872081347`*^9}, {
   3.814343390515142*^9, 3.814343392413073*^9}, {3.814343452872057*^9, 
   3.814343455021332*^9}, {3.814343614217101*^9, 3.814343616096754*^9}, {
   3.8143607899715357`*^9, 3.814360791038642*^9}, {3.814361143140748*^9, 
   3.8143611442436028`*^9}, {3.814772714654235*^9, 3.814772715991809*^9}, {
   3.814818968823441*^9, 3.8148189700599003`*^9}, {3.8148933189748573`*^9, 
   3.814893320760762*^9}, {3.815561808747508*^9, 3.8155618111516*^9}, {
   3.815674114651132*^9, 3.815674117010906*^9}, {3.8156744848160677`*^9, 
   3.815674486978104*^9}, {3.8156745852076607`*^9, 3.815674587885024*^9}, {
   3.815675448208078*^9, 3.815675451029479*^9}, {3.815675725382246*^9, 
   3.8156757275789137`*^9}, {3.815677561771618*^9, 3.81567756420613*^9}, {
   3.815678897402625*^9, 3.8156788988523397`*^9}, {3.81573725102108*^9, 
   3.8157372525791273`*^9}, {3.815739443036553*^9, 3.815739444265828*^9}, {
   3.81573967179202*^9, 3.815739673066986*^9}, {3.81573995371598*^9, 
   3.815739955041967*^9}, {3.815740565982479*^9, 3.815740567361084*^9}, {
   3.8157408421261377`*^9, 3.815740843387848*^9}, {3.815756165916871*^9, 
   3.815756167215746*^9}, {3.815756374831921*^9, 3.815756377022533*^9}, {
   3.815756515873468*^9, 3.8157565170975113`*^9}, {3.815756737697599*^9, 
   3.815756738886368*^9}, {3.815756912641284*^9, 3.815756913870631*^9}, {
   3.815757469026896*^9, 3.815757470231365*^9}, {3.8157576299709806`*^9, 
   3.815757631204486*^9}, {3.815757744547206*^9, 3.81575774578642*^9}, {
   3.8157579267744417`*^9, 3.815757928032988*^9}, {3.8157585035711403`*^9, 
   3.8157585051676693`*^9}, {3.815759951021625*^9, 3.815759952523006*^9}, {
   3.815807674191361*^9, 3.8158076766437817`*^9}, {3.815847828052081*^9, 
   3.815847829502673*^9}, {3.816272521496202*^9, 3.816272523416675*^9}, {
   3.8162734353962593`*^9, 3.816273453353211*^9}, {3.8162740284706717`*^9, 
   3.816274043487958*^9}, {3.816367090627037*^9, 3.816367091816229*^9}, {
   3.816367468576915*^9, 3.81636749543927*^9}, {3.816367701650299*^9, 
   3.816367703155589*^9}, {3.8164323670342083`*^9, 3.816432383848708*^9}, {
   3.816432891542562*^9, 3.816432892887658*^9}, {3.816434396175179*^9, 
   3.816434397585774*^9}, {3.8164351216687517`*^9, 3.816435123564144*^9}, {
   3.816435248981833*^9, 3.816435250367354*^9}, {3.816437183874897*^9, 
   3.816437185334961*^9}, {3.8164381178970013`*^9, 3.816438119228179*^9}, {
   3.8164383734646883`*^9, 3.8164383749177303`*^9}, {3.8164435619642677`*^9, 
   3.816443563180097*^9}, {3.8164499880493183`*^9, 3.816449989490609*^9}, {
   3.816450042908894*^9, 3.816450045595969*^9}, {3.816450257391241*^9, 
   3.816450258750896*^9}, {3.8165202272829237`*^9, 3.816520228608399*^9}, {
   3.816520277351425*^9, 3.8165202786002502`*^9}, {3.821112249678904*^9, 
   3.821112250050354*^9}, 3.8211125825087843`*^9, {3.821112640211882*^9, 
   3.821112640561884*^9}, {3.821113451957233*^9, 3.8211134523254337`*^9}, {
   3.821113560518621*^9, 3.821113560849469*^9}, {3.821113675229727*^9, 
   3.82111367557193*^9}, {3.821115356991377*^9, 3.82111535731015*^9}, {
   3.821115439669619*^9, 3.821115440034708*^9}, {3.821115570992855*^9, 
   3.821115571336377*^9}, {3.8211156088256893`*^9, 3.8211156091715384`*^9}, {
   3.821115644726082*^9, 3.821115645065947*^9}, 3.821115699133977*^9, {
   3.8211165272878103`*^9, 3.821116527724565*^9}, {3.821180795227831*^9, 
   3.821180797375515*^9}, {3.82118137031039*^9, 3.82118137083827*^9}, {
   3.821181551354388*^9, 3.821181551912361*^9}, {3.821181649986902*^9, 
   3.821181650553647*^9}, {3.821181767612211*^9, 3.821181768067232*^9}, {
   3.821181851941969*^9, 3.821181852392371*^9}, {3.821182197037973*^9, 
   3.821182197610447*^9}, {3.821182235404653*^9, 3.821182235970077*^9}, {
   3.821182290978977*^9, 3.82118229171334*^9}, {3.821182448477248*^9, 
   3.8211824489799757`*^9}, {3.821182547005341*^9, 3.8211825475485477`*^9}, {
   3.821182804946787*^9, 3.821182826691269*^9}, {3.821182892141664*^9, 
   3.8211828926480513`*^9}, {3.821183845762949*^9, 3.821183847298177*^9}, {
   3.821183933762973*^9, 3.8211839343135433`*^9}, {3.821185406072815*^9, 
   3.821185407382416*^9}, {3.82118589636624*^9, 3.8211858969542027`*^9}, {
   3.821185999085608*^9, 3.821185999584466*^9}, {3.821186523905665*^9, 
   3.8211865245517273`*^9}, {3.8211881986212263`*^9, 3.821188199163307*^9}, {
   3.821188823196363*^9, 3.821188823794189*^9}, {3.8211890245707417`*^9, 
   3.821189025059708*^9}, {3.821200360312541*^9, 3.821200360898416*^9}, {
   3.821252310038846*^9, 3.821252310586355*^9}, {3.82125324163515*^9, 
   3.8212532421440783`*^9}, {3.821253372638462*^9, 3.821253373264234*^9}, {
   3.821254634962702*^9, 3.821254635465993*^9}, {3.8212665302659903`*^9, 
   3.821266530701689*^9}, {3.821269757940619*^9, 3.821269758385137*^9}, {
   3.82126999290799*^9, 3.82126999340336*^9}, {3.821270510943091*^9, 
   3.821270511362616*^9}, {3.821270716036574*^9, 3.821270716465823*^9}, {
   3.821857067972818*^9, 3.821857068588994*^9}, {3.821857240144565*^9, 
   3.82185724076777*^9}, {3.821857308367276*^9, 3.8218573089588003`*^9}, {
   3.8218583304546757`*^9, 3.821858331086363*^9}, {3.821858534883319*^9, 
   3.82185853558987*^9}, {3.822466932274735*^9, 3.8224669328553457`*^9}, {
   3.822467552000757*^9, 3.822467552568399*^9}, {3.822467751007707*^9, 
   3.822467751622408*^9}, {3.822573432645184*^9, 3.822573433210372*^9}, {
   3.8225735911009207`*^9, 3.822573591775455*^9}, {3.8225737625735188`*^9, 
   3.8225737631255913`*^9}, {3.8226459398300323`*^9, 
   3.8226459405624523`*^9}, {3.8226460911572943`*^9, 3.822646091730842*^9}, {
   3.8226470647428493`*^9, 3.822647065289651*^9}, {3.8226498918052683`*^9, 
   3.8226498923725443`*^9}, {3.822650021336521*^9, 3.8226500219104147`*^9}, {
   3.822666072119204*^9, 3.822666072665133*^9}, {3.822680887876027*^9, 
   3.8226808884063377`*^9}, {3.8227497177779007`*^9, 3.822749718388955*^9}, {
   3.822753601504898*^9, 3.822753603697702*^9}, {3.822850661236842*^9, 
   3.822850661837858*^9}, {3.822851349836226*^9, 3.822851350406176*^9}, {
   3.822917514659238*^9, 3.822917515277445*^9}, {3.8230693087306433`*^9, 
   3.823069309351078*^9}, {3.823069937427669*^9, 3.8230699380120497`*^9}, {
   3.8230941527675343`*^9, 3.823094153331086*^9}, {3.823097648210432*^9, 
   3.823097648837817*^9}, {3.823097785161274*^9, 3.823097785755184*^9}, {
   3.82325448254525*^9, 3.82325448308298*^9}, {3.82325526280291*^9, 
   3.82325526333504*^9}, {3.823266390925638*^9, 3.823266391496557*^9}, {
   3.8232779464926853`*^9, 3.823277947053817*^9}, {3.823278051059163*^9, 
   3.8232780516391363`*^9}, {3.824029639655892*^9, 3.8240296402899647`*^9}, {
   3.824030013058543*^9, 3.824030013712633*^9}, {3.824030058962261*^9, 
   3.824030059590209*^9}, {3.824030103117957*^9, 3.8240301548113413`*^9}, {
   3.8240585183747463`*^9, 3.824058519146846*^9}, {3.824111756597373*^9, 
   3.8241117574512873`*^9}, {3.8345697956881943`*^9, 3.834569798070191*^9}, {
   3.834570587807617*^9, 3.8345705899722033`*^9}, {3.834571451984952*^9, 
   3.834571454626636*^9}, {3.8345719945864477`*^9, 3.8345719961195517`*^9}, {
   3.8345738350479794`*^9, 3.834573837128971*^9}},
 CellLabel->
  "During evaluation of \
In[416]:=",ExpressionUUID->"69c48794-0225-476f-9946-765b28b1fa5e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xBrauer`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.0.2\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2021", ",", "31", ",", "1"}], "}"}]}],
  SequenceForm[
  "Package xAct`xBrauer`  version ", "0.0.2", ", ", {2021, 31, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.811397380255863*^9, 3.8113976734081097`*^9, {3.811397745978087*^9, 
   3.811397760983447*^9}, {3.811399023755513*^9, 3.811399024034425*^9}, {
   3.811399141919792*^9, 3.81139914222785*^9}, {3.811399177590304*^9, 
   3.811399177876423*^9}, {3.8113992520861053`*^9, 3.8113992524163723`*^9}, {
   3.811399450230728*^9, 3.8113994504442053`*^9}, {3.811406482054153*^9, 
   3.8114064823771763`*^9}, {3.811406857514288*^9, 3.811406857838578*^9}, {
   3.8114069073980303`*^9, 3.811406936363989*^9}, {3.8114074605153103`*^9, 
   3.811407460919879*^9}, {3.8114081475873013`*^9, 3.811408147936496*^9}, {
   3.8114081912936983`*^9, 3.811408191639731*^9}, 3.8114087801506*^9, {
   3.8114088154796953`*^9, 3.811408815830575*^9}, {3.811408862489479*^9, 
   3.8114088628092823`*^9}, {3.811408997672443*^9, 3.811408997972644*^9}, {
   3.811409062199967*^9, 3.811409062560708*^9}, 3.811409269741153*^9, {
   3.811409304393887*^9, 3.8114093047316523`*^9}, {3.811409612545312*^9, 
   3.811409612871463*^9}, {3.811409792383432*^9, 3.81140979264503*^9}, {
   3.8114114516810293`*^9, 3.811411451954177*^9}, {3.8114118638170557`*^9, 
   3.811411864137804*^9}, {3.8114119197658863`*^9, 3.8114119200533752`*^9}, {
   3.811412615844184*^9, 3.811412616118388*^9}, {3.811412715264756*^9, 
   3.81141271556739*^9}, {3.811413263697074*^9, 3.8114132639764347`*^9}, {
   3.81141333216614*^9, 3.811413332508459*^9}, {3.8114136296302567`*^9, 
   3.811413629932342*^9}, {3.811413774183793*^9, 3.811413774483966*^9}, {
   3.811413894473914*^9, 3.811413894742936*^9}, 3.811414328663225*^9, 
   3.811414409420786*^9, {3.8114146494418592`*^9, 3.811414649791082*^9}, {
   3.811415041992805*^9, 3.811415042314645*^9}, {3.8114158813939857`*^9, 
   3.811415881817687*^9}, {3.811416424175036*^9, 3.811416424542282*^9}, {
   3.81141651448024*^9, 3.8114165147818623`*^9}, {3.811416943395186*^9, 
   3.811416943700404*^9}, {3.8114170092299623`*^9, 3.8114170095421553`*^9}, {
   3.81141910080551*^9, 3.811419101168853*^9}, {3.811419221332913*^9, 
   3.811419222217*^9}, {3.811419394504477*^9, 3.811419394922099*^9}, {
   3.81141961436992*^9, 3.8114196147085114`*^9}, {3.8114197211279917`*^9, 
   3.811419721463704*^9}, {3.811420278374814*^9, 3.811420278750799*^9}, {
   3.8114204965624447`*^9, 3.8114204969294167`*^9}, {3.8114207654378643`*^9, 
   3.811420765826226*^9}, {3.8114208756007967`*^9, 3.811420875961768*^9}, {
   3.8114209951492987`*^9, 3.81142099564255*^9}, {3.811423399120966*^9, 
   3.811423399497507*^9}, {3.8114234321181917`*^9, 3.8114234324752207`*^9}, {
   3.811423901691526*^9, 3.811423902138219*^9}, {3.81142494089266*^9, 
   3.811424941342019*^9}, {3.811425128625205*^9, 3.8114251290157747`*^9}, {
   3.811425230953362*^9, 3.8114252313951893`*^9}, {3.8114253616516237`*^9, 
   3.8114253620864763`*^9}, {3.811425407286655*^9, 3.8114254077167673`*^9}, {
   3.811425648622707*^9, 3.811425649007204*^9}, {3.811425739775928*^9, 
   3.811425740148724*^9}, {3.811425802047525*^9, 3.811425802419311*^9}, {
   3.811426021625207*^9, 3.811426021999112*^9}, {3.811426573816395*^9, 
   3.811426574261427*^9}, {3.811427720817814*^9, 3.811427721181036*^9}, {
   3.811431178013152*^9, 3.8114311784290743`*^9}, {3.811431460179394*^9, 
   3.811431460603293*^9}, {3.8114319974694977`*^9, 3.811431997902873*^9}, {
   3.8114326319011927`*^9, 3.8114326324062357`*^9}, {3.8114347908791037`*^9, 
   3.811434791453148*^9}, {3.811435083597364*^9, 3.811435084057816*^9}, {
   3.811435687012912*^9, 3.811435687591379*^9}, {3.811435778921373*^9, 
   3.811435779414921*^9}, {3.811435829146523*^9, 3.811435829620166*^9}, {
   3.811436514793991*^9, 3.8114365152949867`*^9}, 3.8114370529200706`*^9, 
   3.811437273582306*^9, {3.811437345253675*^9, 3.8114373468140087`*^9}, {
   3.8114420566234083`*^9, 3.811442057269763*^9}, {3.811484937224011*^9, 
   3.8114849383588257`*^9}, {3.81150886561022*^9, 3.8115088661019382`*^9}, {
   3.81150901060539*^9, 3.811509011146083*^9}, {3.811509165836363*^9, 
   3.81150916637247*^9}, {3.811509220423718*^9, 3.811509220984604*^9}, {
   3.81150932454107*^9, 3.811509325081565*^9}, {3.811510768993325*^9, 
   3.811510769545199*^9}, {3.8115108873365517`*^9, 3.811510887881638*^9}, {
   3.811510958688545*^9, 3.81151095921633*^9}, {3.811511149384656*^9, 
   3.811511149922365*^9}, {3.8115116742260017`*^9, 3.811511674743322*^9}, {
   3.81151183831352*^9, 3.811511838856657*^9}, {3.811511931984598*^9, 
   3.81151193254609*^9}, {3.811517913695464*^9, 3.81151791419833*^9}, {
   3.811518119669978*^9, 3.811518120331017*^9}, {3.811518279285968*^9, 
   3.811518279756792*^9}, {3.811518454353118*^9, 3.8115184548471603`*^9}, {
   3.8115185239898987`*^9, 3.811518524527364*^9}, {3.8115185884391317`*^9, 
   3.811518589049789*^9}, {3.811518779913629*^9, 3.811518780475634*^9}, {
   3.811518824987791*^9, 3.811518825474622*^9}, {3.8115190753371553`*^9, 
   3.811519075828248*^9}, {3.81151919588023*^9, 3.8115191963599577`*^9}, 
   3.81151927370893*^9, {3.811520940954657*^9, 3.811520941467544*^9}, {
   3.811522193160576*^9, 3.811522193758127*^9}, {3.8115222693502197`*^9, 
   3.8115222698555107`*^9}, {3.811522391112768*^9, 3.8115223921904783`*^9}, {
   3.8115224350291986`*^9, 3.811522435551996*^9}, {3.811522537668714*^9, 
   3.811522538204536*^9}, {3.811522593945785*^9, 3.8115225944826307`*^9}, {
   3.811523888759894*^9, 3.8115239149877653`*^9}, {3.811523975460766*^9, 
   3.8115239760526133`*^9}, {3.81152408125178*^9, 3.811524081855679*^9}, {
   3.8115242186455107`*^9, 3.8115242191965322`*^9}, {3.811524257423635*^9, 
   3.811524258031362*^9}, {3.8115243358445263`*^9, 3.811524336442563*^9}, {
   3.8115246114680557`*^9, 3.811524612070348*^9}, {3.8115246424829206`*^9, 
   3.8115246430586863`*^9}, {3.811525683654154*^9, 3.811525684214143*^9}, {
   3.811525890128848*^9, 3.8115258907950363`*^9}, {3.811526232978079*^9, 
   3.811526233683413*^9}, {3.811526630867503*^9, 3.811526631451227*^9}, {
   3.8115267687707653`*^9, 3.81152676933543*^9}, {3.811527006850094*^9, 
   3.811527007492984*^9}, {3.811527237331669*^9, 3.81152723800994*^9}, {
   3.811527434499577*^9, 3.811527435035942*^9}, {3.81152781548516*^9, 
   3.811527816052124*^9}, {3.811528804617424*^9, 3.811528805128271*^9}, {
   3.8115716854335012`*^9, 3.81157168600708*^9}, {3.8115910492875957`*^9, 
   3.811591049819941*^9}, {3.811591683058972*^9, 3.8115916837199383`*^9}, {
   3.811591907441052*^9, 3.811591908034089*^9}, {3.8115921478669653`*^9, 
   3.811592148473164*^9}, {3.811592261334196*^9, 3.8115922619247713`*^9}, {
   3.811593653253026*^9, 3.811593653910493*^9}, {3.8115939556965427`*^9, 
   3.8115939564233627`*^9}, {3.8115940515357313`*^9, 
   3.8115940521810303`*^9}, {3.811674041743834*^9, 3.811674042778859*^9}, {
   3.811680792977523*^9, 3.811680794669155*^9}, {3.811680857014598*^9, 
   3.811680859363141*^9}, {3.811697553489249*^9, 3.8116975543500853`*^9}, {
   3.8116979140091543`*^9, 3.811697914783626*^9}, {3.8117547430726643`*^9, 
   3.811754743779047*^9}, {3.812098227542214*^9, 3.8120982282700043`*^9}, {
   3.812098469697813*^9, 3.812098470392009*^9}, {3.8120990911618032`*^9, 
   3.812099091931766*^9}, {3.812099205094201*^9, 3.81209920575681*^9}, {
   3.812099496445903*^9, 3.812099497099246*^9}, {3.812099704827511*^9, 
   3.812099705524568*^9}, 3.812099841373004*^9, {3.8121008349827127`*^9, 
   3.8121008356452723`*^9}, {3.812100998031687*^9, 3.812100998699497*^9}, 
   3.812101199244226*^9, {3.812105781422167*^9, 3.8121058012696333`*^9}, {
   3.812106210992141*^9, 3.812106212086731*^9}, {3.812106517020553*^9, 
   3.812106517861352*^9}, {3.81210662705794*^9, 3.8121066279513817`*^9}, {
   3.812107358053319*^9, 3.81210735886729*^9}, {3.812108061804627*^9, 
   3.812108062795374*^9}, {3.81210850594429*^9, 3.812108506763496*^9}, {
   3.8121087516485043`*^9, 3.812108752553528*^9}, {3.812110466583847*^9, 
   3.812110468418062*^9}, {3.8121106052389297`*^9, 3.812110622217564*^9}, {
   3.812128612258595*^9, 3.8121286130930767`*^9}, {3.812142012154276*^9, 
   3.812142013370919*^9}, {3.8121436187461243`*^9, 3.812143619726426*^9}, {
   3.812169986280006*^9, 3.8121699880846853`*^9}, {3.812170318401219*^9, 
   3.812170321597624*^9}, {3.812170617382443*^9, 3.812170619688922*^9}, {
   3.8121706543787937`*^9, 3.8121706568061333`*^9}, {3.812174967812786*^9, 
   3.8121749685329*^9}, {3.8121913946828737`*^9, 3.812191397705915*^9}, {
   3.8121918210762587`*^9, 3.812191821891308*^9}, {3.812192180334764*^9, 
   3.8121921824101*^9}, {3.81219350741434*^9, 3.8121935082680387`*^9}, {
   3.812193977731657*^9, 3.812193978538468*^9}, {3.812194328835504*^9, 
   3.812194329680163*^9}, {3.8121953582059193`*^9, 3.8121953589764223`*^9}, {
   3.812195410179782*^9, 3.812195410951828*^9}, {3.81219562855984*^9, 
   3.812195629337537*^9}, {3.812195747436954*^9, 3.812195748208564*^9}, {
   3.8121958057103453`*^9, 3.81219580646887*^9}, {3.8121962405147333`*^9, 
   3.812196241351693*^9}, {3.81219808421192*^9, 3.812198085033792*^9}, {
   3.8121986977920303`*^9, 3.812198698507237*^9}, {3.8122612832926197`*^9, 
   3.8122612843691273`*^9}, {3.812261847475174*^9, 3.8122618482206793`*^9}, {
   3.8122621905503798`*^9, 3.8122621912422953`*^9}, {3.812262516180772*^9, 
   3.8122625170336742`*^9}, {3.812262732994528*^9, 3.812262734810576*^9}, {
   3.8122637803136168`*^9, 3.812263781175597*^9}, {3.81226423405247*^9, 
   3.812264234828869*^9}, {3.812264328507156*^9, 3.8122643292569323`*^9}, {
   3.8122647537178173`*^9, 3.81226475459415*^9}, {3.8122694287586937`*^9, 
   3.812269429467114*^9}, {3.8122697825943413`*^9, 3.812269783587479*^9}, {
   3.812269955534123*^9, 3.812269956294467*^9}, {3.812270079703095*^9, 
   3.812270080733671*^9}, 3.812270515227173*^9, {3.81227226100237*^9, 
   3.81227226239818*^9}, {3.812272621416738*^9, 3.812272622344799*^9}, {
   3.812272785332284*^9, 3.812272786113269*^9}, {3.812273117409337*^9, 
   3.8122731181998672`*^9}, {3.8122749791546803`*^9, 3.812274980467044*^9}, {
   3.812286822071122*^9, 3.812286822865263*^9}, {3.812286942168477*^9, 
   3.812286942954629*^9}, {3.81229077138659*^9, 3.8122907721881437`*^9}, {
   3.812291582239973*^9, 3.812291583088977*^9}, {3.8122926139943132`*^9, 
   3.8122926148596163`*^9}, {3.812292666537876*^9, 3.8122926673672237`*^9}, {
   3.812292862208189*^9, 3.8122928630362883`*^9}, {3.8122992513698473`*^9, 
   3.812299252280985*^9}, {3.812302863020978*^9, 3.8123028652674723`*^9}, {
   3.812344963602908*^9, 3.812344964501193*^9}, {3.812345105959405*^9, 
   3.8123451070454884`*^9}, {3.812345426346874*^9, 3.812345427410276*^9}, {
   3.812346016924399*^9, 3.8123460178394003`*^9}, {3.812349663424943*^9, 
   3.812349665627651*^9}, {3.8123499949774313`*^9, 3.8123499961761627`*^9}, {
   3.812350224046137*^9, 3.812350225338702*^9}, {3.8123589538014517`*^9, 
   3.8123589553092337`*^9}, {3.8123594855574713`*^9, 3.812359487421733*^9}, {
   3.812360961148768*^9, 3.812360962368731*^9}, {3.812362452759049*^9, 
   3.812362453702977*^9}, {3.812364453516747*^9, 3.812364454331821*^9}, {
   3.81236525793226*^9, 3.8123652590174513`*^9}, {3.812371337745275*^9, 
   3.812371338604307*^9}, {3.8123721106841583`*^9, 3.81237211186156*^9}, {
   3.812372515320086*^9, 3.812372516243149*^9}, {3.812375214247716*^9, 
   3.812375215099021*^9}, {3.812375342847501*^9, 3.8123753436690817`*^9}, {
   3.8123757391679983`*^9, 3.8123757402111197`*^9}, {3.81237606081752*^9, 
   3.812376061939822*^9}, {3.812376327688859*^9, 3.812376328606831*^9}, {
   3.812436376507328*^9, 3.8124363789421883`*^9}, {3.812443451309087*^9, 
   3.8124434522255383`*^9}, {3.812444248710919*^9, 3.812444249614787*^9}, {
   3.812448038501151*^9, 3.812448039546247*^9}, {3.81244831530435*^9, 
   3.812448316233657*^9}, {3.8124486363355618`*^9, 3.8124486372671556`*^9}, {
   3.8124518644526243`*^9, 3.8124518654314747`*^9}, {3.812458811680997*^9, 
   3.8124588127468033`*^9}, {3.812459066174507*^9, 3.812459067173732*^9}, {
   3.812459582111031*^9, 3.812459583678068*^9}, {3.81245972079722*^9, 
   3.812459721823489*^9}, {3.8124598454571466`*^9, 3.812459846509017*^9}, {
   3.812459947241436*^9, 3.812459948224428*^9}, {3.8124600757815638`*^9, 
   3.812460076801516*^9}, {3.812461336668906*^9, 3.812461337585135*^9}, {
   3.8124616241752996`*^9, 3.8124616251881657`*^9}, {3.812463233490924*^9, 
   3.812463235270775*^9}, {3.812463727360817*^9, 3.81246372850745*^9}, {
   3.8124640089450817`*^9, 3.812464010975403*^9}, {3.81246424710325*^9, 
   3.8124642483824*^9}, {3.812465524234055*^9, 3.812465525305538*^9}, {
   3.81246585873085*^9, 3.812465859860059*^9}, {3.812466123758388*^9, 
   3.812466124910141*^9}, {3.8125250720057573`*^9, 3.812525073135898*^9}, {
   3.812530198045361*^9, 3.81253019941866*^9}, {3.812533188180385*^9, 
   3.8125331891857443`*^9}, {3.812538966342523*^9, 3.812538968326033*^9}, {
   3.8125391296450777`*^9, 3.812539130659049*^9}, {3.812539168853022*^9, 
   3.8125391698988323`*^9}, {3.812539261174241*^9, 3.812539262246491*^9}, {
   3.812539518455678*^9, 3.812539519422278*^9}, {3.812539924202053*^9, 
   3.812539925162333*^9}, {3.812539973803845*^9, 3.812539974772622*^9}, {
   3.812540024793345*^9, 3.812540025747508*^9}, {3.812540263248914*^9, 
   3.8125402642313347`*^9}, {3.8125405947892637`*^9, 3.8125405966475*^9}, {
   3.812540939722726*^9, 3.8125409406463337`*^9}, {3.812541372007876*^9, 
   3.81254137294447*^9}, {3.812541798530163*^9, 3.8125417996324863`*^9}, {
   3.8125435153637867`*^9, 3.812543516583379*^9}, {3.812553680816134*^9, 
   3.812553681894978*^9}, {3.812553930612842*^9, 3.812553931568891*^9}, {
   3.812558028327196*^9, 3.812558029358966*^9}, {3.812561239308052*^9, 
   3.812561240231329*^9}, {3.8125614291203833`*^9, 3.812561430198328*^9}, {
   3.8125616430396748`*^9, 3.81256164417385*^9}, {3.812562511748394*^9, 
   3.8125625128929443`*^9}, {3.812706976637849*^9, 3.812706979962562*^9}, {
   3.8127071598669777`*^9, 3.812707164126863*^9}, {3.812708183113777*^9, 
   3.8127081857163763`*^9}, {3.812708522813237*^9, 3.812708525635468*^9}, {
   3.812709547351074*^9, 3.812709550731619*^9}, {3.812782687120266*^9, 
   3.812782690618472*^9}, {3.813410993383992*^9, 3.813410994576764*^9}, {
   3.813412566604192*^9, 3.8134125674338083`*^9}, {3.8134127579465237`*^9, 
   3.8134127587752323`*^9}, {3.813822979157645*^9, 3.813822980330248*^9}, {
   3.8138232757369432`*^9, 3.813823293263588*^9}, {3.8138235968281603`*^9, 
   3.813823597804474*^9}, {3.813823703955678*^9, 3.8138237064098053`*^9}, {
   3.8140796053163424`*^9, 3.814079606256981*^9}, {3.814080164120528*^9, 
   3.814080165120304*^9}, {3.814080414990753*^9, 3.814080415924144*^9}, {
   3.814080474781807*^9, 3.814080476166952*^9}, {3.8140810437760344`*^9, 
   3.814081044796678*^9}, {3.814081168761175*^9, 3.814081169730785*^9}, {
   3.8140813254356737`*^9, 3.81408132645538*^9}, {3.8140844586704063`*^9, 
   3.8140844595527687`*^9}, {3.814086045834732*^9, 3.8140860467720137`*^9}, {
   3.81408658221922*^9, 3.8140865831561337`*^9}, {3.814086872837978*^9, 
   3.814086873790084*^9}, {3.814087221935574*^9, 3.8140872228954763`*^9}, {
   3.814087681841282*^9, 3.814087682791913*^9}, {3.814087873810609*^9, 
   3.814087877464333*^9}, {3.814088298406973*^9, 3.8140882993639393`*^9}, {
   3.8140883997866592`*^9, 3.814088400778584*^9}, {3.814088593936247*^9, 
   3.814088594855906*^9}, {3.814088722889249*^9, 3.814088723838442*^9}, {
   3.814166916077825*^9, 3.814166916944319*^9}, {3.814168662500589*^9, 
   3.814168663417635*^9}, {3.814173783472522*^9, 3.814173784523691*^9}, {
   3.814173928073472*^9, 3.8141739290065527`*^9}, {3.8141746149378843`*^9, 
   3.814174615900647*^9}, {3.8141752705181017`*^9, 3.814175271604598*^9}, {
   3.8141812497509937`*^9, 3.8141812510541897`*^9}, {3.814181608548785*^9, 
   3.814181618874796*^9}, {3.814181821635119*^9, 3.8141818226830606`*^9}, {
   3.8141820534184933`*^9, 3.814182054334454*^9}, {3.814182435644566*^9, 
   3.8141824365728073`*^9}, {3.814183447599062*^9, 3.814183448718457*^9}, {
   3.814183795786852*^9, 3.814183796767351*^9}, {3.81418404004837*^9, 
   3.814184041025722*^9}, {3.814184168735621*^9, 3.8141841698062973`*^9}, {
   3.814184404513424*^9, 3.81418440545724*^9}, {3.8141851765141077`*^9, 
   3.8141851776244707`*^9}, {3.8141852139320803`*^9, 
   3.8141852148759747`*^9}, {3.814185466158214*^9, 3.8141854672296124`*^9}, {
   3.814185598596582*^9, 3.814185599562307*^9}, {3.814186493141219*^9, 
   3.81418649406635*^9}, 3.8141865602773237`*^9, {3.8141866145327787`*^9, 
   3.814186615629122*^9}, {3.814188572970359*^9, 3.8141885739677143`*^9}, {
   3.814188933269041*^9, 3.814188934263117*^9}, {3.814189016320849*^9, 
   3.8141890172889957`*^9}, {3.81418911889135*^9, 3.814189119850498*^9}, {
   3.814189409890736*^9, 3.8141894108280373`*^9}, {3.814190323342215*^9, 
   3.81419032458144*^9}, {3.814190486577489*^9, 3.8141904876033154`*^9}, {
   3.814190823504459*^9, 3.814190824524486*^9}, {3.8141908830044613`*^9, 
   3.8141908840172377`*^9}, {3.814191035666112*^9, 3.814191036617738*^9}, {
   3.8141911156126738`*^9, 3.8141911167478228`*^9}, {3.8141913212388563`*^9, 
   3.814191322312356*^9}, {3.814192529253978*^9, 3.814192530249302*^9}, {
   3.81419258834061*^9, 3.814192589391933*^9}, {3.814192737331789*^9, 
   3.814192738456406*^9}, {3.814193235685817*^9, 3.814193236716303*^9}, {
   3.814193410893179*^9, 3.814193411936633*^9}, {3.814193569810049*^9, 
   3.81419357240104*^9}, {3.814193703782576*^9, 3.814193704951481*^9}, {
   3.814193905679385*^9, 3.814193906937128*^9}, {3.81419423669919*^9, 
   3.814194237900447*^9}, {3.814194780224231*^9, 3.814194781353258*^9}, {
   3.814194873669276*^9, 3.814194874811592*^9}, {3.8141950529442263`*^9, 
   3.814195054066959*^9}, {3.814195166306581*^9, 3.81419516748411*^9}, {
   3.81419611653411*^9, 3.8141961177224083`*^9}, {3.8142014639164953`*^9, 
   3.814201465979793*^9}, {3.8142025158387012`*^9, 3.814202517134471*^9}, {
   3.81420265932931*^9, 3.814202660550437*^9}, {3.814202791363394*^9, 
   3.8142027926576147`*^9}, {3.814203340035961*^9, 3.814203341308709*^9}, {
   3.81420364450329*^9, 3.8142036457266903`*^9}, {3.81420385603505*^9, 
   3.814203857315226*^9}, {3.814204023304307*^9, 3.8142040255286827`*^9}, {
   3.8142043230883493`*^9, 3.814204324415008*^9}, {3.814204712076153*^9, 
   3.814204713489345*^9}, {3.814205305110921*^9, 3.814205306438252*^9}, {
   3.8142058757620573`*^9, 3.814205877889819*^9}, {3.814206029109167*^9, 
   3.8142060304307833`*^9}, {3.8142063083473577`*^9, 3.814206309726329*^9}, {
   3.814206410518965*^9, 3.814206411904018*^9}, {3.8142085735915327`*^9, 
   3.814208590972432*^9}, {3.814208775177754*^9, 3.814208776577031*^9}, {
   3.8142088186051826`*^9, 3.814208820692593*^9}, {3.814209225089054*^9, 
   3.814209226406355*^9}, {3.814342965910305*^9, 3.8143429872081347`*^9}, {
   3.814343390515142*^9, 3.814343392413073*^9}, {3.814343452872057*^9, 
   3.814343455021332*^9}, {3.814343614217101*^9, 3.814343616096754*^9}, {
   3.8143607899715357`*^9, 3.814360791038642*^9}, {3.814361143140748*^9, 
   3.8143611442436028`*^9}, {3.814772714654235*^9, 3.814772715991809*^9}, {
   3.814818968823441*^9, 3.8148189700599003`*^9}, {3.8148933189748573`*^9, 
   3.814893320760762*^9}, {3.815561808747508*^9, 3.8155618111516*^9}, {
   3.815674114651132*^9, 3.815674117010906*^9}, {3.8156744848160677`*^9, 
   3.815674486978104*^9}, {3.8156745852076607`*^9, 3.815674587885024*^9}, {
   3.815675448208078*^9, 3.815675451029479*^9}, {3.815675725382246*^9, 
   3.8156757275789137`*^9}, {3.815677561771618*^9, 3.81567756420613*^9}, {
   3.815678897402625*^9, 3.8156788988523397`*^9}, {3.81573725102108*^9, 
   3.8157372525791273`*^9}, {3.815739443036553*^9, 3.815739444265828*^9}, {
   3.81573967179202*^9, 3.815739673066986*^9}, {3.81573995371598*^9, 
   3.815739955041967*^9}, {3.815740565982479*^9, 3.815740567361084*^9}, {
   3.8157408421261377`*^9, 3.815740843387848*^9}, {3.815756165916871*^9, 
   3.815756167215746*^9}, {3.815756374831921*^9, 3.815756377022533*^9}, {
   3.815756515873468*^9, 3.8157565170975113`*^9}, {3.815756737697599*^9, 
   3.815756738886368*^9}, {3.815756912641284*^9, 3.815756913870631*^9}, {
   3.815757469026896*^9, 3.815757470231365*^9}, {3.8157576299709806`*^9, 
   3.815757631204486*^9}, {3.815757744547206*^9, 3.81575774578642*^9}, {
   3.8157579267744417`*^9, 3.815757928032988*^9}, {3.8157585035711403`*^9, 
   3.8157585051676693`*^9}, {3.815759951021625*^9, 3.815759952523006*^9}, {
   3.815807674191361*^9, 3.8158076766437817`*^9}, {3.815847828052081*^9, 
   3.815847829502673*^9}, {3.816272521496202*^9, 3.816272523416675*^9}, {
   3.8162734353962593`*^9, 3.816273453353211*^9}, {3.8162740284706717`*^9, 
   3.816274043487958*^9}, {3.816367090627037*^9, 3.816367091816229*^9}, {
   3.816367468576915*^9, 3.81636749543927*^9}, {3.816367701650299*^9, 
   3.816367703155589*^9}, {3.8164323670342083`*^9, 3.816432383848708*^9}, {
   3.816432891542562*^9, 3.816432892887658*^9}, {3.816434396175179*^9, 
   3.816434397585774*^9}, {3.8164351216687517`*^9, 3.816435123564144*^9}, {
   3.816435248981833*^9, 3.816435250367354*^9}, {3.816437183874897*^9, 
   3.816437185334961*^9}, {3.8164381178970013`*^9, 3.816438119228179*^9}, {
   3.8164383734646883`*^9, 3.8164383749177303`*^9}, {3.8164435619642677`*^9, 
   3.816443563180097*^9}, {3.8164499880493183`*^9, 3.816449989490609*^9}, {
   3.816450042908894*^9, 3.816450045595969*^9}, {3.816450257391241*^9, 
   3.816450258750896*^9}, {3.8165202272829237`*^9, 3.816520228608399*^9}, {
   3.816520277351425*^9, 3.8165202786002502`*^9}, {3.821112249678904*^9, 
   3.821112250050354*^9}, 3.8211125825087843`*^9, {3.821112640211882*^9, 
   3.821112640561884*^9}, {3.821113451957233*^9, 3.8211134523254337`*^9}, {
   3.821113560518621*^9, 3.821113560849469*^9}, {3.821113675229727*^9, 
   3.82111367557193*^9}, {3.821115356991377*^9, 3.82111535731015*^9}, {
   3.821115439669619*^9, 3.821115440034708*^9}, {3.821115570992855*^9, 
   3.821115571336377*^9}, {3.8211156088256893`*^9, 3.8211156091715384`*^9}, {
   3.821115644726082*^9, 3.821115645065947*^9}, 3.821115699133977*^9, {
   3.8211165272878103`*^9, 3.821116527724565*^9}, {3.821180795227831*^9, 
   3.821180797375515*^9}, {3.82118137031039*^9, 3.82118137083827*^9}, {
   3.821181551354388*^9, 3.821181551912361*^9}, {3.821181649986902*^9, 
   3.821181650553647*^9}, {3.821181767612211*^9, 3.821181768067232*^9}, {
   3.821181851941969*^9, 3.821181852392371*^9}, {3.821182197037973*^9, 
   3.821182197610447*^9}, {3.821182235404653*^9, 3.821182235970077*^9}, {
   3.821182290978977*^9, 3.82118229171334*^9}, {3.821182448477248*^9, 
   3.8211824489799757`*^9}, {3.821182547005341*^9, 3.8211825475485477`*^9}, {
   3.821182804946787*^9, 3.821182826691269*^9}, {3.821182892141664*^9, 
   3.8211828926480513`*^9}, {3.821183845762949*^9, 3.821183847298177*^9}, {
   3.821183933762973*^9, 3.8211839343135433`*^9}, {3.821185406072815*^9, 
   3.821185407382416*^9}, {3.82118589636624*^9, 3.8211858969542027`*^9}, {
   3.821185999085608*^9, 3.821185999584466*^9}, {3.821186523905665*^9, 
   3.8211865245517273`*^9}, {3.8211881986212263`*^9, 3.821188199163307*^9}, {
   3.821188823196363*^9, 3.821188823794189*^9}, {3.8211890245707417`*^9, 
   3.821189025059708*^9}, {3.821200360312541*^9, 3.821200360898416*^9}, {
   3.821252310038846*^9, 3.821252310586355*^9}, {3.82125324163515*^9, 
   3.8212532421440783`*^9}, {3.821253372638462*^9, 3.821253373264234*^9}, {
   3.821254634962702*^9, 3.821254635465993*^9}, {3.8212665302659903`*^9, 
   3.821266530701689*^9}, {3.821269757940619*^9, 3.821269758385137*^9}, {
   3.82126999290799*^9, 3.82126999340336*^9}, {3.821270510943091*^9, 
   3.821270511362616*^9}, {3.821270716036574*^9, 3.821270716465823*^9}, {
   3.821857067972818*^9, 3.821857068588994*^9}, {3.821857240144565*^9, 
   3.82185724076777*^9}, {3.821857308367276*^9, 3.8218573089588003`*^9}, {
   3.8218583304546757`*^9, 3.821858331086363*^9}, {3.821858534883319*^9, 
   3.82185853558987*^9}, {3.822466932274735*^9, 3.8224669328553457`*^9}, {
   3.822467552000757*^9, 3.822467552568399*^9}, {3.822467751007707*^9, 
   3.822467751622408*^9}, {3.822573432645184*^9, 3.822573433210372*^9}, {
   3.8225735911009207`*^9, 3.822573591775455*^9}, {3.8225737625735188`*^9, 
   3.8225737631255913`*^9}, {3.8226459398300323`*^9, 
   3.8226459405624523`*^9}, {3.8226460911572943`*^9, 3.822646091730842*^9}, {
   3.8226470647428493`*^9, 3.822647065289651*^9}, {3.8226498918052683`*^9, 
   3.8226498923725443`*^9}, {3.822650021336521*^9, 3.8226500219104147`*^9}, {
   3.822666072119204*^9, 3.822666072665133*^9}, {3.822680887876027*^9, 
   3.8226808884063377`*^9}, {3.8227497177779007`*^9, 3.822749718388955*^9}, {
   3.822753601504898*^9, 3.822753603697702*^9}, {3.822850661236842*^9, 
   3.822850661837858*^9}, {3.822851349836226*^9, 3.822851350406176*^9}, {
   3.822917514659238*^9, 3.822917515277445*^9}, {3.8230693087306433`*^9, 
   3.823069309351078*^9}, {3.823069937427669*^9, 3.8230699380120497`*^9}, {
   3.8230941527675343`*^9, 3.823094153331086*^9}, {3.823097648210432*^9, 
   3.823097648837817*^9}, {3.823097785161274*^9, 3.823097785755184*^9}, {
   3.82325448254525*^9, 3.82325448308298*^9}, {3.82325526280291*^9, 
   3.82325526333504*^9}, {3.823266390925638*^9, 3.823266391496557*^9}, {
   3.8232779464926853`*^9, 3.823277947053817*^9}, {3.823278051059163*^9, 
   3.8232780516391363`*^9}, {3.824029639655892*^9, 3.8240296402899647`*^9}, {
   3.824030013058543*^9, 3.824030013712633*^9}, {3.824030058962261*^9, 
   3.824030059590209*^9}, {3.824030103117957*^9, 3.8240301548113413`*^9}, {
   3.8240585183747463`*^9, 3.824058519146846*^9}, {3.824111756597373*^9, 
   3.8241117574512873`*^9}, {3.8345697956881943`*^9, 3.834569798070191*^9}, {
   3.834570587807617*^9, 3.8345705899722033`*^9}, {3.834571451984952*^9, 
   3.834571454626636*^9}, {3.8345719945864477`*^9, 3.8345719961195517`*^9}, {
   3.8345738350479794`*^9, 3.834573837131181*^9}},
 CellLabel->
  "During evaluation of \
In[416]:=",ExpressionUUID->"30ce9503-b1e5-46b0-9623-aa61fcd66282"],

Cell[BoxData["\<\"Copyright (C) 2020, Thomas Helpin, under the General Public \
License.\"\>"], "Print",
 CellChangeTimes->{
  3.811397380255863*^9, 3.8113976734081097`*^9, {3.811397745978087*^9, 
   3.811397760983447*^9}, {3.811399023755513*^9, 3.811399024034425*^9}, {
   3.811399141919792*^9, 3.81139914222785*^9}, {3.811399177590304*^9, 
   3.811399177876423*^9}, {3.8113992520861053`*^9, 3.8113992524163723`*^9}, {
   3.811399450230728*^9, 3.8113994504442053`*^9}, {3.811406482054153*^9, 
   3.8114064823771763`*^9}, {3.811406857514288*^9, 3.811406857838578*^9}, {
   3.8114069073980303`*^9, 3.811406936363989*^9}, {3.8114074605153103`*^9, 
   3.811407460919879*^9}, {3.8114081475873013`*^9, 3.811408147936496*^9}, {
   3.8114081912936983`*^9, 3.811408191639731*^9}, 3.8114087801506*^9, {
   3.8114088154796953`*^9, 3.811408815830575*^9}, {3.811408862489479*^9, 
   3.8114088628092823`*^9}, {3.811408997672443*^9, 3.811408997972644*^9}, {
   3.811409062199967*^9, 3.811409062560708*^9}, 3.811409269741153*^9, {
   3.811409304393887*^9, 3.8114093047316523`*^9}, {3.811409612545312*^9, 
   3.811409612871463*^9}, {3.811409792383432*^9, 3.81140979264503*^9}, {
   3.8114114516810293`*^9, 3.811411451954177*^9}, {3.8114118638170557`*^9, 
   3.811411864137804*^9}, {3.8114119197658863`*^9, 3.8114119200533752`*^9}, {
   3.811412615844184*^9, 3.811412616118388*^9}, {3.811412715264756*^9, 
   3.81141271556739*^9}, {3.811413263697074*^9, 3.8114132639764347`*^9}, {
   3.81141333216614*^9, 3.811413332508459*^9}, {3.8114136296302567`*^9, 
   3.811413629932342*^9}, {3.811413774183793*^9, 3.811413774483966*^9}, {
   3.811413894473914*^9, 3.811413894742936*^9}, 3.811414328663225*^9, 
   3.811414409420786*^9, {3.8114146494418592`*^9, 3.811414649791082*^9}, {
   3.811415041992805*^9, 3.811415042314645*^9}, {3.8114158813939857`*^9, 
   3.811415881817687*^9}, {3.811416424175036*^9, 3.811416424542282*^9}, {
   3.81141651448024*^9, 3.8114165147818623`*^9}, {3.811416943395186*^9, 
   3.811416943700404*^9}, {3.8114170092299623`*^9, 3.8114170095421553`*^9}, {
   3.81141910080551*^9, 3.811419101168853*^9}, {3.811419221332913*^9, 
   3.811419222217*^9}, {3.811419394504477*^9, 3.811419394922099*^9}, {
   3.81141961436992*^9, 3.8114196147085114`*^9}, {3.8114197211279917`*^9, 
   3.811419721463704*^9}, {3.811420278374814*^9, 3.811420278750799*^9}, {
   3.8114204965624447`*^9, 3.8114204969294167`*^9}, {3.8114207654378643`*^9, 
   3.811420765826226*^9}, {3.8114208756007967`*^9, 3.811420875961768*^9}, {
   3.8114209951492987`*^9, 3.81142099564255*^9}, {3.811423399120966*^9, 
   3.811423399497507*^9}, {3.8114234321181917`*^9, 3.8114234324752207`*^9}, {
   3.811423901691526*^9, 3.811423902138219*^9}, {3.81142494089266*^9, 
   3.811424941342019*^9}, {3.811425128625205*^9, 3.8114251290157747`*^9}, {
   3.811425230953362*^9, 3.8114252313951893`*^9}, {3.8114253616516237`*^9, 
   3.8114253620864763`*^9}, {3.811425407286655*^9, 3.8114254077167673`*^9}, {
   3.811425648622707*^9, 3.811425649007204*^9}, {3.811425739775928*^9, 
   3.811425740148724*^9}, {3.811425802047525*^9, 3.811425802419311*^9}, {
   3.811426021625207*^9, 3.811426021999112*^9}, {3.811426573816395*^9, 
   3.811426574261427*^9}, {3.811427720817814*^9, 3.811427721181036*^9}, {
   3.811431178013152*^9, 3.8114311784290743`*^9}, {3.811431460179394*^9, 
   3.811431460603293*^9}, {3.8114319974694977`*^9, 3.811431997902873*^9}, {
   3.8114326319011927`*^9, 3.8114326324062357`*^9}, {3.8114347908791037`*^9, 
   3.811434791453148*^9}, {3.811435083597364*^9, 3.811435084057816*^9}, {
   3.811435687012912*^9, 3.811435687591379*^9}, {3.811435778921373*^9, 
   3.811435779414921*^9}, {3.811435829146523*^9, 3.811435829620166*^9}, {
   3.811436514793991*^9, 3.8114365152949867`*^9}, 3.8114370529200706`*^9, 
   3.811437273582306*^9, {3.811437345253675*^9, 3.8114373468140087`*^9}, {
   3.8114420566234083`*^9, 3.811442057269763*^9}, {3.811484937224011*^9, 
   3.8114849383588257`*^9}, {3.81150886561022*^9, 3.8115088661019382`*^9}, {
   3.81150901060539*^9, 3.811509011146083*^9}, {3.811509165836363*^9, 
   3.81150916637247*^9}, {3.811509220423718*^9, 3.811509220984604*^9}, {
   3.81150932454107*^9, 3.811509325081565*^9}, {3.811510768993325*^9, 
   3.811510769545199*^9}, {3.8115108873365517`*^9, 3.811510887881638*^9}, {
   3.811510958688545*^9, 3.81151095921633*^9}, {3.811511149384656*^9, 
   3.811511149922365*^9}, {3.8115116742260017`*^9, 3.811511674743322*^9}, {
   3.81151183831352*^9, 3.811511838856657*^9}, {3.811511931984598*^9, 
   3.81151193254609*^9}, {3.811517913695464*^9, 3.81151791419833*^9}, {
   3.811518119669978*^9, 3.811518120331017*^9}, {3.811518279285968*^9, 
   3.811518279756792*^9}, {3.811518454353118*^9, 3.8115184548471603`*^9}, {
   3.8115185239898987`*^9, 3.811518524527364*^9}, {3.8115185884391317`*^9, 
   3.811518589049789*^9}, {3.811518779913629*^9, 3.811518780475634*^9}, {
   3.811518824987791*^9, 3.811518825474622*^9}, {3.8115190753371553`*^9, 
   3.811519075828248*^9}, {3.81151919588023*^9, 3.8115191963599577`*^9}, 
   3.81151927370893*^9, {3.811520940954657*^9, 3.811520941467544*^9}, {
   3.811522193160576*^9, 3.811522193758127*^9}, {3.8115222693502197`*^9, 
   3.8115222698555107`*^9}, {3.811522391112768*^9, 3.8115223921904783`*^9}, {
   3.8115224350291986`*^9, 3.811522435551996*^9}, {3.811522537668714*^9, 
   3.811522538204536*^9}, {3.811522593945785*^9, 3.8115225944826307`*^9}, {
   3.811523888759894*^9, 3.8115239149877653`*^9}, {3.811523975460766*^9, 
   3.8115239760526133`*^9}, {3.81152408125178*^9, 3.811524081855679*^9}, {
   3.8115242186455107`*^9, 3.8115242191965322`*^9}, {3.811524257423635*^9, 
   3.811524258031362*^9}, {3.8115243358445263`*^9, 3.811524336442563*^9}, {
   3.8115246114680557`*^9, 3.811524612070348*^9}, {3.8115246424829206`*^9, 
   3.8115246430586863`*^9}, {3.811525683654154*^9, 3.811525684214143*^9}, {
   3.811525890128848*^9, 3.8115258907950363`*^9}, {3.811526232978079*^9, 
   3.811526233683413*^9}, {3.811526630867503*^9, 3.811526631451227*^9}, {
   3.8115267687707653`*^9, 3.81152676933543*^9}, {3.811527006850094*^9, 
   3.811527007492984*^9}, {3.811527237331669*^9, 3.81152723800994*^9}, {
   3.811527434499577*^9, 3.811527435035942*^9}, {3.81152781548516*^9, 
   3.811527816052124*^9}, {3.811528804617424*^9, 3.811528805128271*^9}, {
   3.8115716854335012`*^9, 3.81157168600708*^9}, {3.8115910492875957`*^9, 
   3.811591049819941*^9}, {3.811591683058972*^9, 3.8115916837199383`*^9}, {
   3.811591907441052*^9, 3.811591908034089*^9}, {3.8115921478669653`*^9, 
   3.811592148473164*^9}, {3.811592261334196*^9, 3.8115922619247713`*^9}, {
   3.811593653253026*^9, 3.811593653910493*^9}, {3.8115939556965427`*^9, 
   3.8115939564233627`*^9}, {3.8115940515357313`*^9, 
   3.8115940521810303`*^9}, {3.811674041743834*^9, 3.811674042778859*^9}, {
   3.811680792977523*^9, 3.811680794669155*^9}, {3.811680857014598*^9, 
   3.811680859363141*^9}, {3.811697553489249*^9, 3.8116975543500853`*^9}, {
   3.8116979140091543`*^9, 3.811697914783626*^9}, {3.8117547430726643`*^9, 
   3.811754743779047*^9}, {3.812098227542214*^9, 3.8120982282700043`*^9}, {
   3.812098469697813*^9, 3.812098470392009*^9}, {3.8120990911618032`*^9, 
   3.812099091931766*^9}, {3.812099205094201*^9, 3.81209920575681*^9}, {
   3.812099496445903*^9, 3.812099497099246*^9}, {3.812099704827511*^9, 
   3.812099705524568*^9}, 3.812099841373004*^9, {3.8121008349827127`*^9, 
   3.8121008356452723`*^9}, {3.812100998031687*^9, 3.812100998699497*^9}, 
   3.812101199244226*^9, {3.812105781422167*^9, 3.8121058012696333`*^9}, {
   3.812106210992141*^9, 3.812106212086731*^9}, {3.812106517020553*^9, 
   3.812106517861352*^9}, {3.81210662705794*^9, 3.8121066279513817`*^9}, {
   3.812107358053319*^9, 3.81210735886729*^9}, {3.812108061804627*^9, 
   3.812108062795374*^9}, {3.81210850594429*^9, 3.812108506763496*^9}, {
   3.8121087516485043`*^9, 3.812108752553528*^9}, {3.812110466583847*^9, 
   3.812110468418062*^9}, {3.8121106052389297`*^9, 3.812110622217564*^9}, {
   3.812128612258595*^9, 3.8121286130930767`*^9}, {3.812142012154276*^9, 
   3.812142013370919*^9}, {3.8121436187461243`*^9, 3.812143619726426*^9}, {
   3.812169986280006*^9, 3.8121699880846853`*^9}, {3.812170318401219*^9, 
   3.812170321597624*^9}, {3.812170617382443*^9, 3.812170619688922*^9}, {
   3.8121706543787937`*^9, 3.8121706568061333`*^9}, {3.812174967812786*^9, 
   3.8121749685329*^9}, {3.8121913946828737`*^9, 3.812191397705915*^9}, {
   3.8121918210762587`*^9, 3.812191821891308*^9}, {3.812192180334764*^9, 
   3.8121921824101*^9}, {3.81219350741434*^9, 3.8121935082680387`*^9}, {
   3.812193977731657*^9, 3.812193978538468*^9}, {3.812194328835504*^9, 
   3.812194329680163*^9}, {3.8121953582059193`*^9, 3.8121953589764223`*^9}, {
   3.812195410179782*^9, 3.812195410951828*^9}, {3.81219562855984*^9, 
   3.812195629337537*^9}, {3.812195747436954*^9, 3.812195748208564*^9}, {
   3.8121958057103453`*^9, 3.81219580646887*^9}, {3.8121962405147333`*^9, 
   3.812196241351693*^9}, {3.81219808421192*^9, 3.812198085033792*^9}, {
   3.8121986977920303`*^9, 3.812198698507237*^9}, {3.8122612832926197`*^9, 
   3.8122612843691273`*^9}, {3.812261847475174*^9, 3.8122618482206793`*^9}, {
   3.8122621905503798`*^9, 3.8122621912422953`*^9}, {3.812262516180772*^9, 
   3.8122625170336742`*^9}, {3.812262732994528*^9, 3.812262734810576*^9}, {
   3.8122637803136168`*^9, 3.812263781175597*^9}, {3.81226423405247*^9, 
   3.812264234828869*^9}, {3.812264328507156*^9, 3.8122643292569323`*^9}, {
   3.8122647537178173`*^9, 3.81226475459415*^9}, {3.8122694287586937`*^9, 
   3.812269429467114*^9}, {3.8122697825943413`*^9, 3.812269783587479*^9}, {
   3.812269955534123*^9, 3.812269956294467*^9}, {3.812270079703095*^9, 
   3.812270080733671*^9}, 3.812270515227173*^9, {3.81227226100237*^9, 
   3.81227226239818*^9}, {3.812272621416738*^9, 3.812272622344799*^9}, {
   3.812272785332284*^9, 3.812272786113269*^9}, {3.812273117409337*^9, 
   3.8122731181998672`*^9}, {3.8122749791546803`*^9, 3.812274980467044*^9}, {
   3.812286822071122*^9, 3.812286822865263*^9}, {3.812286942168477*^9, 
   3.812286942954629*^9}, {3.81229077138659*^9, 3.8122907721881437`*^9}, {
   3.812291582239973*^9, 3.812291583088977*^9}, {3.8122926139943132`*^9, 
   3.8122926148596163`*^9}, {3.812292666537876*^9, 3.8122926673672237`*^9}, {
   3.812292862208189*^9, 3.8122928630362883`*^9}, {3.8122992513698473`*^9, 
   3.812299252280985*^9}, {3.812302863020978*^9, 3.8123028652674723`*^9}, {
   3.812344963602908*^9, 3.812344964501193*^9}, {3.812345105959405*^9, 
   3.8123451070454884`*^9}, {3.812345426346874*^9, 3.812345427410276*^9}, {
   3.812346016924399*^9, 3.8123460178394003`*^9}, {3.812349663424943*^9, 
   3.812349665627651*^9}, {3.8123499949774313`*^9, 3.8123499961761627`*^9}, {
   3.812350224046137*^9, 3.812350225338702*^9}, {3.8123589538014517`*^9, 
   3.8123589553092337`*^9}, {3.8123594855574713`*^9, 3.812359487421733*^9}, {
   3.812360961148768*^9, 3.812360962368731*^9}, {3.812362452759049*^9, 
   3.812362453702977*^9}, {3.812364453516747*^9, 3.812364454331821*^9}, {
   3.81236525793226*^9, 3.8123652590174513`*^9}, {3.812371337745275*^9, 
   3.812371338604307*^9}, {3.8123721106841583`*^9, 3.81237211186156*^9}, {
   3.812372515320086*^9, 3.812372516243149*^9}, {3.812375214247716*^9, 
   3.812375215099021*^9}, {3.812375342847501*^9, 3.8123753436690817`*^9}, {
   3.8123757391679983`*^9, 3.8123757402111197`*^9}, {3.81237606081752*^9, 
   3.812376061939822*^9}, {3.812376327688859*^9, 3.812376328606831*^9}, {
   3.812436376507328*^9, 3.8124363789421883`*^9}, {3.812443451309087*^9, 
   3.8124434522255383`*^9}, {3.812444248710919*^9, 3.812444249614787*^9}, {
   3.812448038501151*^9, 3.812448039546247*^9}, {3.81244831530435*^9, 
   3.812448316233657*^9}, {3.8124486363355618`*^9, 3.8124486372671556`*^9}, {
   3.8124518644526243`*^9, 3.8124518654314747`*^9}, {3.812458811680997*^9, 
   3.8124588127468033`*^9}, {3.812459066174507*^9, 3.812459067173732*^9}, {
   3.812459582111031*^9, 3.812459583678068*^9}, {3.81245972079722*^9, 
   3.812459721823489*^9}, {3.8124598454571466`*^9, 3.812459846509017*^9}, {
   3.812459947241436*^9, 3.812459948224428*^9}, {3.8124600757815638`*^9, 
   3.812460076801516*^9}, {3.812461336668906*^9, 3.812461337585135*^9}, {
   3.8124616241752996`*^9, 3.8124616251881657`*^9}, {3.812463233490924*^9, 
   3.812463235270775*^9}, {3.812463727360817*^9, 3.81246372850745*^9}, {
   3.8124640089450817`*^9, 3.812464010975403*^9}, {3.81246424710325*^9, 
   3.8124642483824*^9}, {3.812465524234055*^9, 3.812465525305538*^9}, {
   3.81246585873085*^9, 3.812465859860059*^9}, {3.812466123758388*^9, 
   3.812466124910141*^9}, {3.8125250720057573`*^9, 3.812525073135898*^9}, {
   3.812530198045361*^9, 3.81253019941866*^9}, {3.812533188180385*^9, 
   3.8125331891857443`*^9}, {3.812538966342523*^9, 3.812538968326033*^9}, {
   3.8125391296450777`*^9, 3.812539130659049*^9}, {3.812539168853022*^9, 
   3.8125391698988323`*^9}, {3.812539261174241*^9, 3.812539262246491*^9}, {
   3.812539518455678*^9, 3.812539519422278*^9}, {3.812539924202053*^9, 
   3.812539925162333*^9}, {3.812539973803845*^9, 3.812539974772622*^9}, {
   3.812540024793345*^9, 3.812540025747508*^9}, {3.812540263248914*^9, 
   3.8125402642313347`*^9}, {3.8125405947892637`*^9, 3.8125405966475*^9}, {
   3.812540939722726*^9, 3.8125409406463337`*^9}, {3.812541372007876*^9, 
   3.81254137294447*^9}, {3.812541798530163*^9, 3.8125417996324863`*^9}, {
   3.8125435153637867`*^9, 3.812543516583379*^9}, {3.812553680816134*^9, 
   3.812553681894978*^9}, {3.812553930612842*^9, 3.812553931568891*^9}, {
   3.812558028327196*^9, 3.812558029358966*^9}, {3.812561239308052*^9, 
   3.812561240231329*^9}, {3.8125614291203833`*^9, 3.812561430198328*^9}, {
   3.8125616430396748`*^9, 3.81256164417385*^9}, {3.812562511748394*^9, 
   3.8125625128929443`*^9}, {3.812706976637849*^9, 3.812706979962562*^9}, {
   3.8127071598669777`*^9, 3.812707164126863*^9}, {3.812708183113777*^9, 
   3.8127081857163763`*^9}, {3.812708522813237*^9, 3.812708525635468*^9}, {
   3.812709547351074*^9, 3.812709550731619*^9}, {3.812782687120266*^9, 
   3.812782690618472*^9}, {3.813410993383992*^9, 3.813410994576764*^9}, {
   3.813412566604192*^9, 3.8134125674338083`*^9}, {3.8134127579465237`*^9, 
   3.8134127587752323`*^9}, {3.813822979157645*^9, 3.813822980330248*^9}, {
   3.8138232757369432`*^9, 3.813823293263588*^9}, {3.8138235968281603`*^9, 
   3.813823597804474*^9}, {3.813823703955678*^9, 3.8138237064098053`*^9}, {
   3.8140796053163424`*^9, 3.814079606256981*^9}, {3.814080164120528*^9, 
   3.814080165120304*^9}, {3.814080414990753*^9, 3.814080415924144*^9}, {
   3.814080474781807*^9, 3.814080476166952*^9}, {3.8140810437760344`*^9, 
   3.814081044796678*^9}, {3.814081168761175*^9, 3.814081169730785*^9}, {
   3.8140813254356737`*^9, 3.81408132645538*^9}, {3.8140844586704063`*^9, 
   3.8140844595527687`*^9}, {3.814086045834732*^9, 3.8140860467720137`*^9}, {
   3.81408658221922*^9, 3.8140865831561337`*^9}, {3.814086872837978*^9, 
   3.814086873790084*^9}, {3.814087221935574*^9, 3.8140872228954763`*^9}, {
   3.814087681841282*^9, 3.814087682791913*^9}, {3.814087873810609*^9, 
   3.814087877464333*^9}, {3.814088298406973*^9, 3.8140882993639393`*^9}, {
   3.8140883997866592`*^9, 3.814088400778584*^9}, {3.814088593936247*^9, 
   3.814088594855906*^9}, {3.814088722889249*^9, 3.814088723838442*^9}, {
   3.814166916077825*^9, 3.814166916944319*^9}, {3.814168662500589*^9, 
   3.814168663417635*^9}, {3.814173783472522*^9, 3.814173784523691*^9}, {
   3.814173928073472*^9, 3.8141739290065527`*^9}, {3.8141746149378843`*^9, 
   3.814174615900647*^9}, {3.8141752705181017`*^9, 3.814175271604598*^9}, {
   3.8141812497509937`*^9, 3.8141812510541897`*^9}, {3.814181608548785*^9, 
   3.814181618874796*^9}, {3.814181821635119*^9, 3.8141818226830606`*^9}, {
   3.8141820534184933`*^9, 3.814182054334454*^9}, {3.814182435644566*^9, 
   3.8141824365728073`*^9}, {3.814183447599062*^9, 3.814183448718457*^9}, {
   3.814183795786852*^9, 3.814183796767351*^9}, {3.81418404004837*^9, 
   3.814184041025722*^9}, {3.814184168735621*^9, 3.8141841698062973`*^9}, {
   3.814184404513424*^9, 3.81418440545724*^9}, {3.8141851765141077`*^9, 
   3.8141851776244707`*^9}, {3.8141852139320803`*^9, 
   3.8141852148759747`*^9}, {3.814185466158214*^9, 3.8141854672296124`*^9}, {
   3.814185598596582*^9, 3.814185599562307*^9}, {3.814186493141219*^9, 
   3.81418649406635*^9}, 3.8141865602773237`*^9, {3.8141866145327787`*^9, 
   3.814186615629122*^9}, {3.814188572970359*^9, 3.8141885739677143`*^9}, {
   3.814188933269041*^9, 3.814188934263117*^9}, {3.814189016320849*^9, 
   3.8141890172889957`*^9}, {3.81418911889135*^9, 3.814189119850498*^9}, {
   3.814189409890736*^9, 3.8141894108280373`*^9}, {3.814190323342215*^9, 
   3.81419032458144*^9}, {3.814190486577489*^9, 3.8141904876033154`*^9}, {
   3.814190823504459*^9, 3.814190824524486*^9}, {3.8141908830044613`*^9, 
   3.8141908840172377`*^9}, {3.814191035666112*^9, 3.814191036617738*^9}, {
   3.8141911156126738`*^9, 3.8141911167478228`*^9}, {3.8141913212388563`*^9, 
   3.814191322312356*^9}, {3.814192529253978*^9, 3.814192530249302*^9}, {
   3.81419258834061*^9, 3.814192589391933*^9}, {3.814192737331789*^9, 
   3.814192738456406*^9}, {3.814193235685817*^9, 3.814193236716303*^9}, {
   3.814193410893179*^9, 3.814193411936633*^9}, {3.814193569810049*^9, 
   3.81419357240104*^9}, {3.814193703782576*^9, 3.814193704951481*^9}, {
   3.814193905679385*^9, 3.814193906937128*^9}, {3.81419423669919*^9, 
   3.814194237900447*^9}, {3.814194780224231*^9, 3.814194781353258*^9}, {
   3.814194873669276*^9, 3.814194874811592*^9}, {3.8141950529442263`*^9, 
   3.814195054066959*^9}, {3.814195166306581*^9, 3.81419516748411*^9}, {
   3.81419611653411*^9, 3.8141961177224083`*^9}, {3.8142014639164953`*^9, 
   3.814201465979793*^9}, {3.8142025158387012`*^9, 3.814202517134471*^9}, {
   3.81420265932931*^9, 3.814202660550437*^9}, {3.814202791363394*^9, 
   3.8142027926576147`*^9}, {3.814203340035961*^9, 3.814203341308709*^9}, {
   3.81420364450329*^9, 3.8142036457266903`*^9}, {3.81420385603505*^9, 
   3.814203857315226*^9}, {3.814204023304307*^9, 3.8142040255286827`*^9}, {
   3.8142043230883493`*^9, 3.814204324415008*^9}, {3.814204712076153*^9, 
   3.814204713489345*^9}, {3.814205305110921*^9, 3.814205306438252*^9}, {
   3.8142058757620573`*^9, 3.814205877889819*^9}, {3.814206029109167*^9, 
   3.8142060304307833`*^9}, {3.8142063083473577`*^9, 3.814206309726329*^9}, {
   3.814206410518965*^9, 3.814206411904018*^9}, {3.8142085735915327`*^9, 
   3.814208590972432*^9}, {3.814208775177754*^9, 3.814208776577031*^9}, {
   3.8142088186051826`*^9, 3.814208820692593*^9}, {3.814209225089054*^9, 
   3.814209226406355*^9}, {3.814342965910305*^9, 3.8143429872081347`*^9}, {
   3.814343390515142*^9, 3.814343392413073*^9}, {3.814343452872057*^9, 
   3.814343455021332*^9}, {3.814343614217101*^9, 3.814343616096754*^9}, {
   3.8143607899715357`*^9, 3.814360791038642*^9}, {3.814361143140748*^9, 
   3.8143611442436028`*^9}, {3.814772714654235*^9, 3.814772715991809*^9}, {
   3.814818968823441*^9, 3.8148189700599003`*^9}, {3.8148933189748573`*^9, 
   3.814893320760762*^9}, {3.815561808747508*^9, 3.8155618111516*^9}, {
   3.815674114651132*^9, 3.815674117010906*^9}, {3.8156744848160677`*^9, 
   3.815674486978104*^9}, {3.8156745852076607`*^9, 3.815674587885024*^9}, {
   3.815675448208078*^9, 3.815675451029479*^9}, {3.815675725382246*^9, 
   3.8156757275789137`*^9}, {3.815677561771618*^9, 3.81567756420613*^9}, {
   3.815678897402625*^9, 3.8156788988523397`*^9}, {3.81573725102108*^9, 
   3.8157372525791273`*^9}, {3.815739443036553*^9, 3.815739444265828*^9}, {
   3.81573967179202*^9, 3.815739673066986*^9}, {3.81573995371598*^9, 
   3.815739955041967*^9}, {3.815740565982479*^9, 3.815740567361084*^9}, {
   3.8157408421261377`*^9, 3.815740843387848*^9}, {3.815756165916871*^9, 
   3.815756167215746*^9}, {3.815756374831921*^9, 3.815756377022533*^9}, {
   3.815756515873468*^9, 3.8157565170975113`*^9}, {3.815756737697599*^9, 
   3.815756738886368*^9}, {3.815756912641284*^9, 3.815756913870631*^9}, {
   3.815757469026896*^9, 3.815757470231365*^9}, {3.8157576299709806`*^9, 
   3.815757631204486*^9}, {3.815757744547206*^9, 3.81575774578642*^9}, {
   3.8157579267744417`*^9, 3.815757928032988*^9}, {3.8157585035711403`*^9, 
   3.8157585051676693`*^9}, {3.815759951021625*^9, 3.815759952523006*^9}, {
   3.815807674191361*^9, 3.8158076766437817`*^9}, {3.815847828052081*^9, 
   3.815847829502673*^9}, {3.816272521496202*^9, 3.816272523416675*^9}, {
   3.8162734353962593`*^9, 3.816273453353211*^9}, {3.8162740284706717`*^9, 
   3.816274043487958*^9}, {3.816367090627037*^9, 3.816367091816229*^9}, {
   3.816367468576915*^9, 3.81636749543927*^9}, {3.816367701650299*^9, 
   3.816367703155589*^9}, {3.8164323670342083`*^9, 3.816432383848708*^9}, {
   3.816432891542562*^9, 3.816432892887658*^9}, {3.816434396175179*^9, 
   3.816434397585774*^9}, {3.8164351216687517`*^9, 3.816435123564144*^9}, {
   3.816435248981833*^9, 3.816435250367354*^9}, {3.816437183874897*^9, 
   3.816437185334961*^9}, {3.8164381178970013`*^9, 3.816438119228179*^9}, {
   3.8164383734646883`*^9, 3.8164383749177303`*^9}, {3.8164435619642677`*^9, 
   3.816443563180097*^9}, {3.8164499880493183`*^9, 3.816449989490609*^9}, {
   3.816450042908894*^9, 3.816450045595969*^9}, {3.816450257391241*^9, 
   3.816450258750896*^9}, {3.8165202272829237`*^9, 3.816520228608399*^9}, {
   3.816520277351425*^9, 3.8165202786002502`*^9}, {3.821112249678904*^9, 
   3.821112250050354*^9}, 3.8211125825087843`*^9, {3.821112640211882*^9, 
   3.821112640561884*^9}, {3.821113451957233*^9, 3.8211134523254337`*^9}, {
   3.821113560518621*^9, 3.821113560849469*^9}, {3.821113675229727*^9, 
   3.82111367557193*^9}, {3.821115356991377*^9, 3.82111535731015*^9}, {
   3.821115439669619*^9, 3.821115440034708*^9}, {3.821115570992855*^9, 
   3.821115571336377*^9}, {3.8211156088256893`*^9, 3.8211156091715384`*^9}, {
   3.821115644726082*^9, 3.821115645065947*^9}, 3.821115699133977*^9, {
   3.8211165272878103`*^9, 3.821116527724565*^9}, {3.821180795227831*^9, 
   3.821180797375515*^9}, {3.82118137031039*^9, 3.82118137083827*^9}, {
   3.821181551354388*^9, 3.821181551912361*^9}, {3.821181649986902*^9, 
   3.821181650553647*^9}, {3.821181767612211*^9, 3.821181768067232*^9}, {
   3.821181851941969*^9, 3.821181852392371*^9}, {3.821182197037973*^9, 
   3.821182197610447*^9}, {3.821182235404653*^9, 3.821182235970077*^9}, {
   3.821182290978977*^9, 3.82118229171334*^9}, {3.821182448477248*^9, 
   3.8211824489799757`*^9}, {3.821182547005341*^9, 3.8211825475485477`*^9}, {
   3.821182804946787*^9, 3.821182826691269*^9}, {3.821182892141664*^9, 
   3.8211828926480513`*^9}, {3.821183845762949*^9, 3.821183847298177*^9}, {
   3.821183933762973*^9, 3.8211839343135433`*^9}, {3.821185406072815*^9, 
   3.821185407382416*^9}, {3.82118589636624*^9, 3.8211858969542027`*^9}, {
   3.821185999085608*^9, 3.821185999584466*^9}, {3.821186523905665*^9, 
   3.8211865245517273`*^9}, {3.8211881986212263`*^9, 3.821188199163307*^9}, {
   3.821188823196363*^9, 3.821188823794189*^9}, {3.8211890245707417`*^9, 
   3.821189025059708*^9}, {3.821200360312541*^9, 3.821200360898416*^9}, {
   3.821252310038846*^9, 3.821252310586355*^9}, {3.82125324163515*^9, 
   3.8212532421440783`*^9}, {3.821253372638462*^9, 3.821253373264234*^9}, {
   3.821254634962702*^9, 3.821254635465993*^9}, {3.8212665302659903`*^9, 
   3.821266530701689*^9}, {3.821269757940619*^9, 3.821269758385137*^9}, {
   3.82126999290799*^9, 3.82126999340336*^9}, {3.821270510943091*^9, 
   3.821270511362616*^9}, {3.821270716036574*^9, 3.821270716465823*^9}, {
   3.821857067972818*^9, 3.821857068588994*^9}, {3.821857240144565*^9, 
   3.82185724076777*^9}, {3.821857308367276*^9, 3.8218573089588003`*^9}, {
   3.8218583304546757`*^9, 3.821858331086363*^9}, {3.821858534883319*^9, 
   3.82185853558987*^9}, {3.822466932274735*^9, 3.8224669328553457`*^9}, {
   3.822467552000757*^9, 3.822467552568399*^9}, {3.822467751007707*^9, 
   3.822467751622408*^9}, {3.822573432645184*^9, 3.822573433210372*^9}, {
   3.8225735911009207`*^9, 3.822573591775455*^9}, {3.8225737625735188`*^9, 
   3.8225737631255913`*^9}, {3.8226459398300323`*^9, 
   3.8226459405624523`*^9}, {3.8226460911572943`*^9, 3.822646091730842*^9}, {
   3.8226470647428493`*^9, 3.822647065289651*^9}, {3.8226498918052683`*^9, 
   3.8226498923725443`*^9}, {3.822650021336521*^9, 3.8226500219104147`*^9}, {
   3.822666072119204*^9, 3.822666072665133*^9}, {3.822680887876027*^9, 
   3.8226808884063377`*^9}, {3.8227497177779007`*^9, 3.822749718388955*^9}, {
   3.822753601504898*^9, 3.822753603697702*^9}, {3.822850661236842*^9, 
   3.822850661837858*^9}, {3.822851349836226*^9, 3.822851350406176*^9}, {
   3.822917514659238*^9, 3.822917515277445*^9}, {3.8230693087306433`*^9, 
   3.823069309351078*^9}, {3.823069937427669*^9, 3.8230699380120497`*^9}, {
   3.8230941527675343`*^9, 3.823094153331086*^9}, {3.823097648210432*^9, 
   3.823097648837817*^9}, {3.823097785161274*^9, 3.823097785755184*^9}, {
   3.82325448254525*^9, 3.82325448308298*^9}, {3.82325526280291*^9, 
   3.82325526333504*^9}, {3.823266390925638*^9, 3.823266391496557*^9}, {
   3.8232779464926853`*^9, 3.823277947053817*^9}, {3.823278051059163*^9, 
   3.8232780516391363`*^9}, {3.824029639655892*^9, 3.8240296402899647`*^9}, {
   3.824030013058543*^9, 3.824030013712633*^9}, {3.824030058962261*^9, 
   3.824030059590209*^9}, {3.824030103117957*^9, 3.8240301548113413`*^9}, {
   3.8240585183747463`*^9, 3.824058519146846*^9}, {3.824111756597373*^9, 
   3.8241117574512873`*^9}, {3.8345697956881943`*^9, 3.834569798070191*^9}, {
   3.834570587807617*^9, 3.8345705899722033`*^9}, {3.834571451984952*^9, 
   3.834571454626636*^9}, {3.8345719945864477`*^9, 3.8345719961195517`*^9}, {
   3.8345738350479794`*^9, 3.834573837134242*^9}},
 CellLabel->
  "During evaluation of \
In[416]:=",ExpressionUUID->"0943a9c2-971a-4354-b225-a9f8f2020031"]
}, Open  ]]
}, Open  ]],

Cell["\<\
We specify the context  BrauerAlgebra to avoid overriding the Disclaimer of \
the other packages. However we need to turn off the message General:shdw \
temporarily:\
\>", "Text",
 CellChangeTimes->{{3.8113973103664427`*^9, 3.8113973112389297`*^9}, 
   3.821109775834511*^9, 3.830678282355728*^9, 3.8316269263292522`*^9, {
   3.87595531932222*^9, 3.875955321830927*^9}, 
   3.8769704376518497`*^9},ExpressionUUID->"67046a70-27e6-49a8-ad21-\
21b49a8207c1"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`xForm`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875954959468993*^9, 3.875954975315156*^9}, 
   3.876970437927692*^9, 
   3.878025375875648*^9},ExpressionUUID->"177331d4-6fd1-4f6d-8164-\
3105a567912d"],

Cell["\<\
If xBrauer is not being called from other package then write this GPL short \
disclaimer:\
\>", "Text",
 CellChangeTimes->{{3.811397324966076*^9, 3.8113973278925533`*^9}, 
   3.821109778417309*^9, {3.875955011112821*^9, 3.875955013535408*^9}, 
   3.876970438202024*^9, {3.883308239443507*^9, 
   3.883308244988854*^9}},ExpressionUUID->"56320610-cc8f-4c7c-aaec-\
95a070b5441c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
   "xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`xBrauer`\>\""}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Print", "[", 
     "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811397341380974*^9, 3.811397342097034*^9}, 
   3.821109780015609*^9, 3.8306782823690977`*^9, 3.8316269263531313`*^9, {
   3.875954996365855*^9, 3.875955008973857*^9}, {3.883308274499503*^9, 
   3.883308275328466*^9}, {3.883308544659865*^9, 3.883308555452392*^9}, 
   3.883309155463438*^9},ExpressionUUID->"bcc65c83-37ed-4942-b90f-\
4ba73edbe076"],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8113973802906237`*^9, 3.8113976734526377`*^9, {3.811397746040906*^9, 
   3.8113977610462027`*^9}, {3.811399023801959*^9, 3.811399024070632*^9}, {
   3.811399141970356*^9, 3.811399142263818*^9}, {3.811399177626767*^9, 
   3.811399177914583*^9}, {3.8113992521371098`*^9, 3.811399252448769*^9}, {
   3.8113994502599087`*^9, 3.8113994504730053`*^9}, {3.8114064820855713`*^9, 
   3.81140648240973*^9}, {3.8114068575468407`*^9, 3.8114068578710537`*^9}, {
   3.811406907427164*^9, 3.811406936412608*^9}, {3.811407460550961*^9, 
   3.81140746095481*^9}, {3.811408147623847*^9, 3.811408147972376*^9}, {
   3.811408191329802*^9, 3.811408191674942*^9}, 3.811408780183262*^9, {
   3.811408815519721*^9, 3.8114088158719883`*^9}, {3.811408862524087*^9, 
   3.811408862841855*^9}, {3.81140899770251*^9, 3.811408998004592*^9}, {
   3.811409062245348*^9, 3.811409062606256*^9}, 3.811409269782422*^9, {
   3.811409304421692*^9, 3.8114093047551403`*^9}, {3.811409612580348*^9, 
   3.8114096129047003`*^9}, {3.8114097924110537`*^9, 
   3.8114097926726313`*^9}, {3.811411451708661*^9, 3.811411451983836*^9}, {
   3.81141186385175*^9, 3.811411864173416*^9}, {3.811411919794717*^9, 
   3.8114119200832977`*^9}, {3.811412615870905*^9, 3.811412616146137*^9}, {
   3.811412715300667*^9, 3.811412715603054*^9}, {3.811413263724257*^9, 
   3.811413264002874*^9}, {3.811413332202839*^9, 3.811413332548571*^9}, {
   3.811413629662818*^9, 3.8114136299656277`*^9}, {3.811413774215596*^9, 
   3.811413774515668*^9}, {3.811413894499695*^9, 3.81141389477352*^9}, 
   3.811414328695777*^9, 3.8114144094521637`*^9, {3.8114146494781027`*^9, 
   3.811414649825714*^9}, {3.8114150420265102`*^9, 3.811415042351219*^9}, {
   3.811415881442857*^9, 3.811415881867776*^9}, {3.811416424210205*^9, 
   3.811416424576687*^9}, {3.811416514510274*^9, 3.8114165148116093`*^9}, {
   3.811416943423992*^9, 3.8114169437273483`*^9}, {3.811417009260152*^9, 
   3.811417009572474*^9}, {3.811419100837137*^9, 3.811419101199787*^9}, {
   3.8114192213717413`*^9, 3.811419222279934*^9}, {3.811419394538576*^9, 
   3.81141939495638*^9}, {3.811419614399149*^9, 3.8114196147368937`*^9}, {
   3.811419721154871*^9, 3.811419721491787*^9}, {3.81142027840374*^9, 
   3.811420278784595*^9}, {3.811420496591317*^9, 3.811420496959734*^9}, {
   3.8114207654693737`*^9, 3.8114207658578777`*^9}, {3.811420875629318*^9, 
   3.811420875994026*^9}, {3.81142099519291*^9, 3.811420995699128*^9}, {
   3.811423399156495*^9, 3.811423399531011*^9}, {3.811423432150598*^9, 
   3.8114234325058537`*^9}, {3.81142390173834*^9, 3.811423902185981*^9}, {
   3.811424940935017*^9, 3.811424941381892*^9}, {3.811425128659313*^9, 
   3.811425129050366*^9}, {3.811425230988387*^9, 3.8114252314351263`*^9}, {
   3.8114253616948347`*^9, 3.8114253621250143`*^9}, {3.811425407326231*^9, 
   3.811425407755106*^9}, {3.8114256486575527`*^9, 3.811425649043414*^9}, {
   3.811425739809609*^9, 3.811425740184533*^9}, {3.811425802081039*^9, 
   3.8114258024570913`*^9}, {3.811426021660324*^9, 3.811426022032298*^9}, {
   3.811426573863682*^9, 3.811426574308659*^9}, {3.811427720850284*^9, 
   3.811427721213203*^9}, {3.8114311780441723`*^9, 3.811431178460887*^9}, {
   3.811431460209279*^9, 3.8114314606367903`*^9}, {3.811431997503669*^9, 
   3.811431997934544*^9}, {3.8114326319473467`*^9, 3.811432632450865*^9}, {
   3.8114347909207067`*^9, 3.8114347914949827`*^9}, {3.811435083628364*^9, 
   3.811435084090391*^9}, {3.811435687052915*^9, 3.811435687637125*^9}, {
   3.811435778956438*^9, 3.811435779466835*^9}, {3.811435829177342*^9, 
   3.8114358296537848`*^9}, {3.811436514828232*^9, 3.811436515328103*^9}, 
   3.811437052954747*^9, 3.811437273633234*^9, {3.811437345281423*^9, 
   3.811437347403377*^9}, {3.811442056650063*^9, 3.811442057294572*^9}, {
   3.811484937266859*^9, 3.8114849384076033`*^9}, {3.811508865639657*^9, 
   3.811508866135507*^9}, {3.8115090106395082`*^9, 3.811509011187421*^9}, {
   3.811509165869811*^9, 3.811509166408177*^9}, {3.811509220473774*^9, 
   3.811509221026752*^9}, {3.811509324576804*^9, 3.811509325122257*^9}, {
   3.8115107690304728`*^9, 3.811510769582539*^9}, {3.811510887373138*^9, 
   3.811510887922225*^9}, {3.811510958723938*^9, 3.811510959255562*^9}, {
   3.811511149420478*^9, 3.8115111499598722`*^9}, {3.811511674258432*^9, 
   3.8115116747827063`*^9}, {3.8115118383538227`*^9, 3.811511838896578*^9}, {
   3.8115119320266047`*^9, 3.8115119325858107`*^9}, {3.811517913728382*^9, 
   3.811517914227708*^9}, {3.811518119704513*^9, 3.811518120360278*^9}, {
   3.8115182793137293`*^9, 3.811518279784086*^9}, {3.811518454383552*^9, 
   3.811518454878085*^9}, {3.8115185240270452`*^9, 3.811518524565852*^9}, {
   3.811518588488676*^9, 3.811518589102003*^9}, {3.811518779955468*^9, 
   3.811518780516642*^9}, {3.8115188250157547`*^9, 3.8115188255058603`*^9}, {
   3.811519075367033*^9, 3.8115190758563147`*^9}, {3.811519195908333*^9, 
   3.811519196388638*^9}, 3.811519273740089*^9, {3.811520940982108*^9, 
   3.8115209414978437`*^9}, {3.811522193189136*^9, 3.81152219378788*^9}, {
   3.811522269378261*^9, 3.8115222698860493`*^9}, {3.811522391160087*^9, 
   3.811522392239249*^9}, {3.8115224350585823`*^9, 3.811522435583156*^9}, {
   3.81152253769947*^9, 3.811522538235537*^9}, {3.8115225939776154`*^9, 
   3.811522594516518*^9}, {3.811523888797782*^9, 3.8115239150236464`*^9}, {
   3.811523975497347*^9, 3.811523976089611*^9}, {3.811524081291355*^9, 
   3.811524081893303*^9}, {3.811524218680627*^9, 3.811524219231621*^9}, {
   3.811524257466516*^9, 3.811524258076159*^9}, {3.81152433587852*^9, 
   3.811524336484267*^9}, {3.811524611503619*^9, 3.811524612109056*^9}, {
   3.811524642516279*^9, 3.8115246430945263`*^9}, {3.811525683687345*^9, 
   3.811525684248208*^9}, {3.811525890182604*^9, 3.811525890842289*^9}, {
   3.811526233031727*^9, 3.8115262337371817`*^9}, {3.8115266308987617`*^9, 
   3.81152663148457*^9}, {3.811526768804142*^9, 3.811526769369442*^9}, {
   3.811527006899583*^9, 3.811527007536625*^9}, {3.811527237376033*^9, 
   3.8115272380535*^9}, {3.8115274345316067`*^9, 3.8115274350683737`*^9}, {
   3.81152781551688*^9, 3.811527816086246*^9}, {3.8115288046466913`*^9, 
   3.811528805160081*^9}, {3.811571685466545*^9, 3.8115716860390778`*^9}, {
   3.811591049315804*^9, 3.8115910498493557`*^9}, {3.811591683090623*^9, 
   3.811591683758226*^9}, {3.811591907471204*^9, 3.811591908067287*^9}, {
   3.811592147899363*^9, 3.8115921485068913`*^9}, {3.811592261365673*^9, 
   3.811592261957225*^9}, {3.811593653288876*^9, 3.811593653946721*^9}, {
   3.8115939557422113`*^9, 3.811593956930251*^9}, {3.811594051575634*^9, 
   3.81159405221677*^9}, {3.811674041800869*^9, 3.811674042815732*^9}, {
   3.8116807930836763`*^9, 3.811680794711833*^9}, {3.811680857072268*^9, 
   3.811680859459391*^9}, {3.811697553532362*^9, 3.811697554407165*^9}, {
   3.811697914052889*^9, 3.811697914827787*^9}, {3.811754743109427*^9, 
   3.8117547438157263`*^9}, {3.812098227577607*^9, 3.812098228305429*^9}, {
   3.812098469733382*^9, 3.8120984704302387`*^9}, {3.812099091213662*^9, 
   3.812099091986021*^9}, {3.812099205129303*^9, 3.8120992057922277`*^9}, {
   3.812099496475237*^9, 3.812099497130563*^9}, {3.812099704859066*^9, 
   3.812099705558215*^9}, 3.812099841408181*^9, {3.812100835020603*^9, 
   3.812100835687059*^9}, {3.812100998067474*^9, 3.812100998733938*^9}, 
   3.8121011992866383`*^9, {3.812105781463171*^9, 3.812105801306386*^9}, {
   3.812106211047121*^9, 3.812106212141972*^9}, {3.8121065170695047`*^9, 
   3.8121065179087887`*^9}, {3.812106627103561*^9, 3.812106628000842*^9}, {
   3.812107358092169*^9, 3.8121073589093513`*^9}, {3.8121080618614197`*^9, 
   3.812108062855665*^9}, {3.812108505985733*^9, 3.812108506804513*^9}, {
   3.812108751703669*^9, 3.812108752612322*^9}, {3.812110466622686*^9, 
   3.812110468453113*^9}, {3.812110605270805*^9, 3.812110622265121*^9}, {
   3.812128612292386*^9, 3.81212861312497*^9}, {3.812142012219798*^9, 
   3.8121420139900513`*^9}, {3.812143618805477*^9, 3.812143619778263*^9}, {
   3.812169986337661*^9, 3.8121699881559896`*^9}, {3.8121703184857893`*^9, 
   3.8121703217312183`*^9}, {3.81217061746986*^9, 3.81217061973427*^9}, {
   3.812170654433563*^9, 3.812170656867264*^9}, {3.812174967851449*^9, 
   3.812174968568019*^9}, {3.812191394729611*^9, 3.8121913977371387`*^9}, {
   3.812191821125429*^9, 3.8121918219423037`*^9}, {3.8121921804097443`*^9, 
   3.812192182454062*^9}, {3.812193507463298*^9, 3.812193508315385*^9}, {
   3.812193977784052*^9, 3.8121939785931473`*^9}, {3.812194328885569*^9, 
   3.812194329730835*^9}, {3.812195358250052*^9, 3.812195359016342*^9}, {
   3.812195410217907*^9, 3.812195410989829*^9}, {3.8121956286003647`*^9, 
   3.812195629377491*^9}, {3.812195747477275*^9, 3.812195748249597*^9}, {
   3.812195805751445*^9, 3.812195806508616*^9}, {3.812196240570176*^9, 
   3.812196241410039*^9}, {3.812198084251144*^9, 3.812198085075962*^9}, {
   3.81219869783005*^9, 3.812198698543871*^9}, {3.812261283337949*^9, 
   3.812261284405692*^9}, {3.8122618475094748`*^9, 3.812261848377331*^9}, {
   3.8122621905877533`*^9, 3.812262191282048*^9}, {3.812262516243683*^9, 
   3.8122625170976877`*^9}, {3.812262733073691*^9, 3.812262734886526*^9}, {
   3.8122637803791447`*^9, 3.8122637812382307`*^9}, {3.812264234089952*^9, 
   3.812264234869557*^9}, {3.812264328543414*^9, 3.812264329295945*^9}, {
   3.812264753757785*^9, 3.81226475464259*^9}, {3.812269428793655*^9, 
   3.812269429507955*^9}, {3.81226978268439*^9, 3.812269783666622*^9}, {
   3.812269955577755*^9, 3.812269956341358*^9}, {3.812270079743615*^9, 
   3.812270080791341*^9}, 3.812270515270434*^9, {3.812272261063469*^9, 
   3.812272262466003*^9}, {3.8122726214809437`*^9, 3.8122726224103403`*^9}, {
   3.81227278537289*^9, 3.812272786156681*^9}, {3.812273117451397*^9, 
   3.812273118242179*^9}, {3.812274979203044*^9, 3.812274980521318*^9}, {
   3.812286822110997*^9, 3.812286822908338*^9}, {3.812286942212511*^9, 
   3.812286942998294*^9}, {3.812290771428976*^9, 3.812290772233432*^9}, {
   3.812291582285556*^9, 3.8122915831338873`*^9}, {3.812292614039257*^9, 
   3.812292614905266*^9}, {3.812292666581946*^9, 3.8122926674138613`*^9}, {
   3.812292862250758*^9, 3.812292863080263*^9}, {3.812299251418438*^9, 
   3.81229925231997*^9}, {3.8123028630998087`*^9, 3.812302865332361*^9}, {
   3.8123449636973877`*^9, 3.8123449645408154`*^9}, {3.812345106033963*^9, 
   3.812345107108781*^9}, {3.812345426422411*^9, 3.8123454274852467`*^9}, {
   3.812346016970993*^9, 3.8123460178830214`*^9}, {3.812349663510928*^9, 
   3.812349665711575*^9}, {3.812349995063875*^9, 3.812349996262456*^9}, {
   3.8123502241315937`*^9, 3.812350225424469*^9}, {3.8123589538867683`*^9, 
   3.812358955394759*^9}, {3.8123594856364594`*^9, 3.812359487467517*^9}, {
   3.812360961209023*^9, 3.8123609624246387`*^9}, {3.8123624528013678`*^9, 
   3.812362453744343*^9}, {3.812364453555729*^9, 3.8123644543734007`*^9}, {
   3.8123652579814873`*^9, 3.812365259059943*^9}, {3.812371337788686*^9, 
   3.812371338651149*^9}, {3.812372110723586*^9, 3.8123721118956003`*^9}, {
   3.812372515381415*^9, 3.8123725163032312`*^9}, {3.8123752142927322`*^9, 
   3.812375215147558*^9}, {3.812375342891227*^9, 3.812375343713933*^9}, {
   3.81237573921259*^9, 3.812375740248674*^9}, {3.8123760608587723`*^9, 
   3.812376061979309*^9}, {3.812376327741643*^9, 3.812376328667281*^9}, {
   3.812436376576166*^9, 3.812436378996464*^9}, {3.812443451350501*^9, 
   3.8124434522697487`*^9}, {3.812444248752713*^9, 3.812444249657262*^9}, {
   3.8124480385670567`*^9, 3.81244804005893*^9}, {3.812448315348158*^9, 
   3.812448316278166*^9}, {3.8124486363806553`*^9, 3.812448637314302*^9}, {
   3.812451864496469*^9, 3.812451865475038*^9}, {3.8124588117331533`*^9, 
   3.812458812797105*^9}, {3.812459066225114*^9, 3.812459067220283*^9}, {
   3.812459582169145*^9, 3.8124595842453547`*^9}, {3.8124597208460407`*^9, 
   3.812459721871467*^9}, {3.8124598455172853`*^9, 3.812459846573578*^9}, {
   3.812459947286893*^9, 3.8124599482722282`*^9}, {3.8124600758286533`*^9, 
   3.8124600768497477`*^9}, {3.812461336712901*^9, 3.812461337628523*^9}, {
   3.812461624229032*^9, 3.812461625242828*^9}, {3.812463233546029*^9, 
   3.812463235320459*^9}, {3.812463727416401*^9, 3.812463728564589*^9}, {
   3.812464009042137*^9, 3.81246401108284*^9}, {3.812464247188417*^9, 
   3.812464248460038*^9}, {3.812465524283595*^9, 3.8124655253546133`*^9}, {
   3.8124658587849216`*^9, 3.8124658599130774`*^9}, {3.812466123812809*^9, 
   3.8124661249642687`*^9}, {3.812525072044011*^9, 3.81252507316539*^9}, {
   3.81253019811374*^9, 3.8125301994610357`*^9}, {3.8125331882405653`*^9, 
   3.8125331892267313`*^9}, {3.812538966406719*^9, 3.81253896838384*^9}, {
   3.812539129691362*^9, 3.812539130706175*^9}, {3.8125391688988237`*^9, 
   3.8125391699446697`*^9}, {3.8125392612434797`*^9, 
   3.8125392622954693`*^9}, {3.8125395185035152`*^9, 3.812539519460105*^9}, {
   3.8125399242437696`*^9, 3.812539925202984*^9}, {3.812539973845964*^9, 
   3.8125399748154497`*^9}, {3.8125400248380537`*^9, 
   3.8125400257915983`*^9}, {3.8125402632964983`*^9, 3.812540264273982*^9}, {
   3.812540594844927*^9, 3.812540596687243*^9}, {3.81254093976686*^9, 
   3.812540940688039*^9}, {3.812541372056015*^9, 3.812541372987965*^9}, {
   3.812541798603395*^9, 3.812541799704288*^9}, {3.812543515404167*^9, 
   3.812543516619006*^9}, {3.8125536808772583`*^9, 3.8125536819587107`*^9}, {
   3.812553930658045*^9, 3.812553931611247*^9}, {3.812558028378029*^9, 
   3.812558029402235*^9}, {3.81256123934756*^9, 3.812561240271943*^9}, {
   3.812561429165761*^9, 3.812561430243425*^9}, {3.812561643101445*^9, 
   3.812561644245139*^9}, {3.81256251180339*^9, 3.812562512940298*^9}, {
   3.812706976742638*^9, 3.81270698006069*^9}, {3.812707159921159*^9, 
   3.81270716425331*^9}, {3.812708183168961*^9, 3.812708186578923*^9}, {
   3.8127085228522243`*^9, 3.81270852572313*^9}, {3.8127095474242764`*^9, 
   3.812709550801238*^9}, {3.812782687208746*^9, 3.812782690661079*^9}, {
   3.813410993429811*^9, 3.813410994619989*^9}, {3.813412566638084*^9, 
   3.813412567469276*^9}, {3.813412757981185*^9, 3.813412758812312*^9}, {
   3.813822979201565*^9, 3.813822980366238*^9}, {3.813823275775917*^9, 
   3.8138232933014297`*^9}, {3.813823596869398*^9, 3.813823597846591*^9}, {
   3.813823704090406*^9, 3.813823706466982*^9}, {3.814079605355771*^9, 
   3.814079606291238*^9}, {3.814080164158558*^9, 3.814080165159501*^9}, {
   3.814080415033224*^9, 3.814080416046218*^9}, {3.8140804748269787`*^9, 
   3.8140804762236423`*^9}, {3.814081043825976*^9, 3.814081044852871*^9}, {
   3.8140811688061934`*^9, 3.81408116977115*^9}, {3.814081325477313*^9, 
   3.814081326502281*^9}, {3.814084458707924*^9, 3.8140844595894938`*^9}, {
   3.8140860458720016`*^9, 3.814086046812492*^9}, {3.814086582255456*^9, 
   3.8140865831924477`*^9}, {3.814086872878231*^9, 3.814086873825376*^9}, {
   3.814087221982272*^9, 3.814087222939592*^9}, {3.8140876818806*^9, 
   3.81408768283669*^9}, {3.814087873863297*^9, 3.8140878775973186`*^9}, {
   3.8140882984572763`*^9, 3.814088299407691*^9}, {3.81408839982708*^9, 
   3.814088400821886*^9}, {3.814088593978549*^9, 3.814088594894013*^9}, {
   3.814088722928947*^9, 3.814088723880187*^9}, {3.814166916118203*^9, 
   3.814166916988194*^9}, {3.8141686625411577`*^9, 3.8141686634513683`*^9}, {
   3.8141737835146923`*^9, 3.814173784567883*^9}, {3.8141739281142178`*^9, 
   3.8141739290441923`*^9}, {3.814174614983766*^9, 3.8141746159473257`*^9}, {
   3.8141752705616417`*^9, 3.814175271647747*^9}, {3.81418124981034*^9, 
   3.814181251105749*^9}, {3.81418160859612*^9, 3.81418161891236*^9}, {
   3.8141818216729918`*^9, 3.814181822721246*^9}, {3.8141820534558573`*^9, 
   3.814182054369754*^9}, {3.814182435682065*^9, 3.814182436610848*^9}, {
   3.81418344764447*^9, 3.81418344877721*^9}, {3.814183795828785*^9, 
   3.81418379680939*^9}, {3.814184040088887*^9, 3.814184041068706*^9}, {
   3.8141841687774897`*^9, 3.814184169852124*^9}, {3.814184404551031*^9, 
   3.814184405496892*^9}, {3.814185176553061*^9, 3.8141851776656322`*^9}, {
   3.814185213971696*^9, 3.814185214919244*^9}, {3.814185466204196*^9, 
   3.814185467288252*^9}, {3.814185598637068*^9, 3.814185599603318*^9}, {
   3.814186493178679*^9, 3.814186494105227*^9}, 3.814186560315096*^9, {
   3.8141866145850077`*^9, 3.814186615705711*^9}, {3.814188573010582*^9, 
   3.81418857401225*^9}, {3.814188933307125*^9, 3.814188934303658*^9}, {
   3.814189016360112*^9, 3.8141890173307962`*^9}, {3.814189118932815*^9, 
   3.81418911989226*^9}, {3.8141894099287558`*^9, 3.814189410867936*^9}, {
   3.814190323383646*^9, 3.814190324625601*^9}, {3.81419048661971*^9, 
   3.814190487644133*^9}, {3.814190823544403*^9, 3.814190824564125*^9}, {
   3.814190883044833*^9, 3.814190884057446*^9}, {3.814191035702544*^9, 
   3.814191036655699*^9}, {3.8141911156590233`*^9, 3.814191116796707*^9}, {
   3.81419132128609*^9, 3.814191322360777*^9}, {3.81419252928751*^9, 
   3.8141925302835417`*^9}, {3.814192588379887*^9, 3.8141925894337273`*^9}, {
   3.814192737373588*^9, 3.8141927384990892`*^9}, {3.8141932357243433`*^9, 
   3.814193236755394*^9}, {3.8141934109350147`*^9, 3.814193411977283*^9}, {
   3.814193569876601*^9, 3.8141935724533577`*^9}, {3.8141937038257923`*^9, 
   3.814193704995761*^9}, {3.8141939057239656`*^9, 3.81419390698195*^9}, {
   3.814194236759089*^9, 3.8141942379641533`*^9}, {3.814194780277388*^9, 
   3.8141947814081993`*^9}, {3.8141948737203074`*^9, 3.81419487486744*^9}, {
   3.814195052988405*^9, 3.814195054111655*^9}, {3.814195166360744*^9, 
   3.814195167535801*^9}, {3.814196116588313*^9, 3.8141961177771397`*^9}, {
   3.814201463970605*^9, 3.814201466027458*^9}, {3.8142025158897057`*^9, 
   3.8142025171942253`*^9}, {3.814202659382618*^9, 3.814202660602046*^9}, {
   3.814202791422069*^9, 3.814202792716124*^9}, {3.814203340093377*^9, 
   3.814203341369438*^9}, {3.8142036445580273`*^9, 3.81420364578401*^9}, {
   3.8142038560914583`*^9, 3.814203857373263*^9}, {3.814204023375718*^9, 
   3.814204025755754*^9}, {3.814204323145289*^9, 3.814204324475705*^9}, {
   3.814204712141409*^9, 3.814204713550848*^9}, {3.814205305169942*^9, 
   3.8142053064951487`*^9}, {3.8142058758356113`*^9, 
   3.8142058779413013`*^9}, {3.8142060291694117`*^9, 3.814206030493689*^9}, {
   3.814206308409768*^9, 3.814206310342691*^9}, {3.814206410581112*^9, 
   3.814206412457739*^9}, {3.814208573643669*^9, 3.8142085910267143`*^9}, {
   3.814208775244734*^9, 3.8142087766337767`*^9}, {3.814208818673071*^9, 
   3.814208820758588*^9}, {3.814209225147086*^9, 3.814209226465652*^9}, {
   3.814342965965994*^9, 3.814342987262206*^9}, {3.8143433905749073`*^9, 
   3.814343392475647*^9}, {3.8143434529419127`*^9, 3.814343455196095*^9}, {
   3.81434361428505*^9, 3.8143436161675873`*^9}, {3.814360790007983*^9, 
   3.814360791078247*^9}, {3.8143611431818*^9, 3.814361144283863*^9}, {
   3.8147727147003736`*^9, 3.814772716033654*^9}, {3.8148189688711567`*^9, 
   3.81481897010198*^9}, {3.814893319010171*^9, 3.814893320797936*^9}, {
   3.815561808787459*^9, 3.815561811183814*^9}, {3.815674114718121*^9, 
   3.815674117081216*^9}, {3.81567448486812*^9, 3.8156744870288763`*^9}, {
   3.815674585271542*^9, 3.815674587946443*^9}, {3.8156754482739964`*^9, 
   3.815675451088686*^9}, {3.815675725433083*^9, 3.815675727696681*^9}, {
   3.815677561818184*^9, 3.815677564253664*^9}, {3.815678897451022*^9, 
   3.81567889890127*^9}, {3.815737251069659*^9, 3.815737252615571*^9}, {
   3.815739443078339*^9, 3.815739444308363*^9}, {3.815739671834543*^9, 
   3.8157396731102743`*^9}, {3.815739953758909*^9, 3.815739955086625*^9}, {
   3.815740566040386*^9, 3.8157405674254*^9}, {3.815740842168351*^9, 
   3.8157408434309673`*^9}, {3.8157561659665318`*^9, 3.815756167265707*^9}, {
   3.815756374887006*^9, 3.815756377073597*^9}, {3.815756515911628*^9, 
   3.8157565171351957`*^9}, {3.815756737735828*^9, 3.815756738926825*^9}, {
   3.815756912683874*^9, 3.815756913911806*^9}, {3.815757469064389*^9, 
   3.815757470269689*^9}, {3.815757630011417*^9, 3.815757631247512*^9}, {
   3.815757744588275*^9, 3.815757745825652*^9}, {3.8157579268196487`*^9, 
   3.8157579280766287`*^9}, {3.815758503627808*^9, 3.815758505651224*^9}, {
   3.815759951069396*^9, 3.8157599525816097`*^9}, {3.815807674249057*^9, 
   3.8158076766870537`*^9}, {3.815847828095662*^9, 3.815847829548852*^9}, {
   3.8162725215340357`*^9, 3.8162725234597673`*^9}, {3.816273435435997*^9, 
   3.81627345340125*^9}, {3.816274028516528*^9, 3.816274043579708*^9}, {
   3.8163670906607227`*^9, 3.816367091850955*^9}, {3.816367468619735*^9, 
   3.816367495477517*^9}, {3.816367701699369*^9, 3.8163677031959267`*^9}, {
   3.816432367079183*^9, 3.8164323838896112`*^9}, {3.8164328915901613`*^9, 
   3.816432893005227*^9}, {3.8164343962205753`*^9, 3.816434397633473*^9}, {
   3.816435121718891*^9, 3.816435123624653*^9}, {3.816435249036715*^9, 
   3.816435250418762*^9}, {3.816437183920314*^9, 3.816437185380541*^9}, {
   3.816438117940875*^9, 3.816438119272591*^9}, {3.8164383735169973`*^9, 
   3.816438374968711*^9}, {3.816443562000051*^9, 3.816443563214179*^9}, {
   3.816449988097139*^9, 3.816449989535575*^9}, {3.816450042970334*^9, 
   3.816450045654436*^9}, {3.816450257431624*^9, 3.816450258792823*^9}, {
   3.816520227317438*^9, 3.816520228645235*^9}, {3.816520277389402*^9, 
   3.816520278638133*^9}, {3.821112249707835*^9, 3.821112250080995*^9}, 
   3.821112582543251*^9, {3.821112640247504*^9, 3.8211126405930433`*^9}, {
   3.821113451996977*^9, 3.82111345236275*^9}, {3.821113560549181*^9, 
   3.8211135608787193`*^9}, {3.821113675266879*^9, 3.821113675608714*^9}, {
   3.8211153570217247`*^9, 3.821115357338541*^9}, {3.8211154397035837`*^9, 
   3.821115440069088*^9}, {3.8211155710274563`*^9, 3.821115571371029*^9}, {
   3.821115608859544*^9, 3.8211156092005463`*^9}, {3.82111564475885*^9, 
   3.821115645098463*^9}, 3.8211156991675*^9, {3.821116527316394*^9, 
   3.8211165277569647`*^9}, {3.821180795292364*^9, 3.821180797409871*^9}, {
   3.821181370355523*^9, 3.8211813708822002`*^9}, {3.821181551403751*^9, 
   3.821181551962614*^9}, {3.8211816500452538`*^9, 3.8211816506089163`*^9}, {
   3.8211817676550827`*^9, 3.821181768108694*^9}, {3.821181851984249*^9, 
   3.821181852433671*^9}, {3.821182197093019*^9, 3.821182197665711*^9}, {
   3.82118223545969*^9, 3.821182236030851*^9}, {3.821182291193102*^9, 
   3.821182291769951*^9}, {3.821182448525566*^9, 3.821182449024164*^9}, {
   3.821182547061552*^9, 3.821182547605485*^9}, {3.8211828049957237`*^9, 
   3.821182826757317*^9}, {3.821182892189208*^9, 3.8211828926964893`*^9}, {
   3.821183845862315*^9, 3.821183847395369*^9}, {3.821183933826502*^9, 
   3.8211839343740396`*^9}, {3.8211854061521387`*^9, 3.821185407532626*^9}, {
   3.8211858964256496`*^9, 3.8211858970134993`*^9}, {3.821185999131826*^9, 
   3.821185999630179*^9}, {3.821186523969942*^9, 3.821186524615992*^9}, {
   3.821188198681879*^9, 3.821188199210864*^9}, {3.821188823258931*^9, 
   3.821188823849145*^9}, {3.821189024620713*^9, 3.8211890251032963`*^9}, {
   3.821200360365093*^9, 3.821200360944065*^9}, {3.821252310086668*^9, 
   3.821252310631537*^9}, {3.8212532416689*^9, 3.821253242183234*^9}, {
   3.82125337267426*^9, 3.821253373302656*^9}, {3.821254634997961*^9, 
   3.8212546355020638`*^9}, {3.8212665302934923`*^9, 3.821266530732121*^9}, {
   3.8212697579714823`*^9, 3.821269758414228*^9}, {3.8212699929442377`*^9, 
   3.8212699934482803`*^9}, {3.8212705109738293`*^9, 3.82127051139065*^9}, {
   3.82127071606476*^9, 3.821270716493355*^9}, {3.821857068005432*^9, 
   3.821857068627817*^9}, {3.8218572401832647`*^9, 3.821857240805461*^9}, {
   3.8218573084039717`*^9, 3.8218573089967012`*^9}, {3.821858330501115*^9, 
   3.821858331131778*^9}, {3.821858534935874*^9, 3.8218585356474953`*^9}, {
   3.822466932317127*^9, 3.822466932895274*^9}, {3.8224675520427856`*^9, 
   3.82246755260954*^9}, {3.8224677510568933`*^9, 3.822467751668244*^9}, {
   3.8225734326852207`*^9, 3.822573433248865*^9}, {3.8225735911563883`*^9, 
   3.8225735918282967`*^9}, {3.8225737626166077`*^9, 3.822573763168593*^9}, {
   3.8226459398928633`*^9, 3.822645940595428*^9}, {3.822646091195016*^9, 
   3.8226460917664623`*^9}, {3.822647064773197*^9, 3.822647065318544*^9}, {
   3.822649891837719*^9, 3.8226498924026003`*^9}, {3.822650021367386*^9, 
   3.8226500219418907`*^9}, {3.8226660721475353`*^9, 3.822666072706554*^9}, {
   3.8226808879034033`*^9, 3.822680888438241*^9}, {3.822749717807164*^9, 
   3.8227497184215517`*^9}, {3.822753601589867*^9, 3.822753603794758*^9}, {
   3.8228506612670918`*^9, 3.8228506618657637`*^9}, {3.822851349866352*^9, 
   3.822851350435252*^9}, {3.822917514690033*^9, 3.822917515307673*^9}, {
   3.823069308765279*^9, 3.823069309383881*^9}, {3.823069937456761*^9, 
   3.823069938039647*^9}, {3.82309415279389*^9, 3.823094153360887*^9}, {
   3.8230976482411137`*^9, 3.823097648869668*^9}, {3.823097785189457*^9, 
   3.8230977857830667`*^9}, {3.82325448256987*^9, 3.8232544831089687`*^9}, {
   3.823255262829487*^9, 3.823255263361701*^9}, {3.823266390953486*^9, 
   3.823266391523204*^9}, {3.823277946518187*^9, 3.8232779470809927`*^9}, {
   3.823278051089568*^9, 3.823278051665766*^9}, {3.824029639688756*^9, 
   3.8240296403278646`*^9}, {3.824030013091926*^9, 3.8240300137443542`*^9}, {
   3.8240300589947653`*^9, 3.8240300596216497`*^9}, {3.8240301031511602`*^9, 
   3.824030154846074*^9}, {3.824058518430229*^9, 3.824058519179844*^9}, {
   3.824111756648747*^9, 3.824111757509842*^9}, {3.834569795722715*^9, 
   3.834569798108127*^9}, {3.834570587842065*^9, 3.834570590018589*^9}, {
   3.834571452023732*^9, 3.8345714546669397`*^9}, {3.834571994634906*^9, 
   3.834571996167038*^9}, {3.834573835091826*^9, 3.834573837171041*^9}},
 CellLabel->
  "During evaluation of \
In[422]:=",ExpressionUUID->"49ffc0d3-106d-48c2-ac50-68f54fa32ec0"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print",
 CellChangeTimes->{
  3.8113973802906237`*^9, 3.8113976734526377`*^9, {3.811397746040906*^9, 
   3.8113977610462027`*^9}, {3.811399023801959*^9, 3.811399024070632*^9}, {
   3.811399141970356*^9, 3.811399142263818*^9}, {3.811399177626767*^9, 
   3.811399177914583*^9}, {3.8113992521371098`*^9, 3.811399252448769*^9}, {
   3.8113994502599087`*^9, 3.8113994504730053`*^9}, {3.8114064820855713`*^9, 
   3.81140648240973*^9}, {3.8114068575468407`*^9, 3.8114068578710537`*^9}, {
   3.811406907427164*^9, 3.811406936412608*^9}, {3.811407460550961*^9, 
   3.81140746095481*^9}, {3.811408147623847*^9, 3.811408147972376*^9}, {
   3.811408191329802*^9, 3.811408191674942*^9}, 3.811408780183262*^9, {
   3.811408815519721*^9, 3.8114088158719883`*^9}, {3.811408862524087*^9, 
   3.811408862841855*^9}, {3.81140899770251*^9, 3.811408998004592*^9}, {
   3.811409062245348*^9, 3.811409062606256*^9}, 3.811409269782422*^9, {
   3.811409304421692*^9, 3.8114093047551403`*^9}, {3.811409612580348*^9, 
   3.8114096129047003`*^9}, {3.8114097924110537`*^9, 
   3.8114097926726313`*^9}, {3.811411451708661*^9, 3.811411451983836*^9}, {
   3.81141186385175*^9, 3.811411864173416*^9}, {3.811411919794717*^9, 
   3.8114119200832977`*^9}, {3.811412615870905*^9, 3.811412616146137*^9}, {
   3.811412715300667*^9, 3.811412715603054*^9}, {3.811413263724257*^9, 
   3.811413264002874*^9}, {3.811413332202839*^9, 3.811413332548571*^9}, {
   3.811413629662818*^9, 3.8114136299656277`*^9}, {3.811413774215596*^9, 
   3.811413774515668*^9}, {3.811413894499695*^9, 3.81141389477352*^9}, 
   3.811414328695777*^9, 3.8114144094521637`*^9, {3.8114146494781027`*^9, 
   3.811414649825714*^9}, {3.8114150420265102`*^9, 3.811415042351219*^9}, {
   3.811415881442857*^9, 3.811415881867776*^9}, {3.811416424210205*^9, 
   3.811416424576687*^9}, {3.811416514510274*^9, 3.8114165148116093`*^9}, {
   3.811416943423992*^9, 3.8114169437273483`*^9}, {3.811417009260152*^9, 
   3.811417009572474*^9}, {3.811419100837137*^9, 3.811419101199787*^9}, {
   3.8114192213717413`*^9, 3.811419222279934*^9}, {3.811419394538576*^9, 
   3.81141939495638*^9}, {3.811419614399149*^9, 3.8114196147368937`*^9}, {
   3.811419721154871*^9, 3.811419721491787*^9}, {3.81142027840374*^9, 
   3.811420278784595*^9}, {3.811420496591317*^9, 3.811420496959734*^9}, {
   3.8114207654693737`*^9, 3.8114207658578777`*^9}, {3.811420875629318*^9, 
   3.811420875994026*^9}, {3.81142099519291*^9, 3.811420995699128*^9}, {
   3.811423399156495*^9, 3.811423399531011*^9}, {3.811423432150598*^9, 
   3.8114234325058537`*^9}, {3.81142390173834*^9, 3.811423902185981*^9}, {
   3.811424940935017*^9, 3.811424941381892*^9}, {3.811425128659313*^9, 
   3.811425129050366*^9}, {3.811425230988387*^9, 3.8114252314351263`*^9}, {
   3.8114253616948347`*^9, 3.8114253621250143`*^9}, {3.811425407326231*^9, 
   3.811425407755106*^9}, {3.8114256486575527`*^9, 3.811425649043414*^9}, {
   3.811425739809609*^9, 3.811425740184533*^9}, {3.811425802081039*^9, 
   3.8114258024570913`*^9}, {3.811426021660324*^9, 3.811426022032298*^9}, {
   3.811426573863682*^9, 3.811426574308659*^9}, {3.811427720850284*^9, 
   3.811427721213203*^9}, {3.8114311780441723`*^9, 3.811431178460887*^9}, {
   3.811431460209279*^9, 3.8114314606367903`*^9}, {3.811431997503669*^9, 
   3.811431997934544*^9}, {3.8114326319473467`*^9, 3.811432632450865*^9}, {
   3.8114347909207067`*^9, 3.8114347914949827`*^9}, {3.811435083628364*^9, 
   3.811435084090391*^9}, {3.811435687052915*^9, 3.811435687637125*^9}, {
   3.811435778956438*^9, 3.811435779466835*^9}, {3.811435829177342*^9, 
   3.8114358296537848`*^9}, {3.811436514828232*^9, 3.811436515328103*^9}, 
   3.811437052954747*^9, 3.811437273633234*^9, {3.811437345281423*^9, 
   3.811437347403377*^9}, {3.811442056650063*^9, 3.811442057294572*^9}, {
   3.811484937266859*^9, 3.8114849384076033`*^9}, {3.811508865639657*^9, 
   3.811508866135507*^9}, {3.8115090106395082`*^9, 3.811509011187421*^9}, {
   3.811509165869811*^9, 3.811509166408177*^9}, {3.811509220473774*^9, 
   3.811509221026752*^9}, {3.811509324576804*^9, 3.811509325122257*^9}, {
   3.8115107690304728`*^9, 3.811510769582539*^9}, {3.811510887373138*^9, 
   3.811510887922225*^9}, {3.811510958723938*^9, 3.811510959255562*^9}, {
   3.811511149420478*^9, 3.8115111499598722`*^9}, {3.811511674258432*^9, 
   3.8115116747827063`*^9}, {3.8115118383538227`*^9, 3.811511838896578*^9}, {
   3.8115119320266047`*^9, 3.8115119325858107`*^9}, {3.811517913728382*^9, 
   3.811517914227708*^9}, {3.811518119704513*^9, 3.811518120360278*^9}, {
   3.8115182793137293`*^9, 3.811518279784086*^9}, {3.811518454383552*^9, 
   3.811518454878085*^9}, {3.8115185240270452`*^9, 3.811518524565852*^9}, {
   3.811518588488676*^9, 3.811518589102003*^9}, {3.811518779955468*^9, 
   3.811518780516642*^9}, {3.8115188250157547`*^9, 3.8115188255058603`*^9}, {
   3.811519075367033*^9, 3.8115190758563147`*^9}, {3.811519195908333*^9, 
   3.811519196388638*^9}, 3.811519273740089*^9, {3.811520940982108*^9, 
   3.8115209414978437`*^9}, {3.811522193189136*^9, 3.81152219378788*^9}, {
   3.811522269378261*^9, 3.8115222698860493`*^9}, {3.811522391160087*^9, 
   3.811522392239249*^9}, {3.8115224350585823`*^9, 3.811522435583156*^9}, {
   3.81152253769947*^9, 3.811522538235537*^9}, {3.8115225939776154`*^9, 
   3.811522594516518*^9}, {3.811523888797782*^9, 3.8115239150236464`*^9}, {
   3.811523975497347*^9, 3.811523976089611*^9}, {3.811524081291355*^9, 
   3.811524081893303*^9}, {3.811524218680627*^9, 3.811524219231621*^9}, {
   3.811524257466516*^9, 3.811524258076159*^9}, {3.81152433587852*^9, 
   3.811524336484267*^9}, {3.811524611503619*^9, 3.811524612109056*^9}, {
   3.811524642516279*^9, 3.8115246430945263`*^9}, {3.811525683687345*^9, 
   3.811525684248208*^9}, {3.811525890182604*^9, 3.811525890842289*^9}, {
   3.811526233031727*^9, 3.8115262337371817`*^9}, {3.8115266308987617`*^9, 
   3.81152663148457*^9}, {3.811526768804142*^9, 3.811526769369442*^9}, {
   3.811527006899583*^9, 3.811527007536625*^9}, {3.811527237376033*^9, 
   3.8115272380535*^9}, {3.8115274345316067`*^9, 3.8115274350683737`*^9}, {
   3.81152781551688*^9, 3.811527816086246*^9}, {3.8115288046466913`*^9, 
   3.811528805160081*^9}, {3.811571685466545*^9, 3.8115716860390778`*^9}, {
   3.811591049315804*^9, 3.8115910498493557`*^9}, {3.811591683090623*^9, 
   3.811591683758226*^9}, {3.811591907471204*^9, 3.811591908067287*^9}, {
   3.811592147899363*^9, 3.8115921485068913`*^9}, {3.811592261365673*^9, 
   3.811592261957225*^9}, {3.811593653288876*^9, 3.811593653946721*^9}, {
   3.8115939557422113`*^9, 3.811593956930251*^9}, {3.811594051575634*^9, 
   3.81159405221677*^9}, {3.811674041800869*^9, 3.811674042815732*^9}, {
   3.8116807930836763`*^9, 3.811680794711833*^9}, {3.811680857072268*^9, 
   3.811680859459391*^9}, {3.811697553532362*^9, 3.811697554407165*^9}, {
   3.811697914052889*^9, 3.811697914827787*^9}, {3.811754743109427*^9, 
   3.8117547438157263`*^9}, {3.812098227577607*^9, 3.812098228305429*^9}, {
   3.812098469733382*^9, 3.8120984704302387`*^9}, {3.812099091213662*^9, 
   3.812099091986021*^9}, {3.812099205129303*^9, 3.8120992057922277`*^9}, {
   3.812099496475237*^9, 3.812099497130563*^9}, {3.812099704859066*^9, 
   3.812099705558215*^9}, 3.812099841408181*^9, {3.812100835020603*^9, 
   3.812100835687059*^9}, {3.812100998067474*^9, 3.812100998733938*^9}, 
   3.8121011992866383`*^9, {3.812105781463171*^9, 3.812105801306386*^9}, {
   3.812106211047121*^9, 3.812106212141972*^9}, {3.8121065170695047`*^9, 
   3.8121065179087887`*^9}, {3.812106627103561*^9, 3.812106628000842*^9}, {
   3.812107358092169*^9, 3.8121073589093513`*^9}, {3.8121080618614197`*^9, 
   3.812108062855665*^9}, {3.812108505985733*^9, 3.812108506804513*^9}, {
   3.812108751703669*^9, 3.812108752612322*^9}, {3.812110466622686*^9, 
   3.812110468453113*^9}, {3.812110605270805*^9, 3.812110622265121*^9}, {
   3.812128612292386*^9, 3.81212861312497*^9}, {3.812142012219798*^9, 
   3.8121420139900513`*^9}, {3.812143618805477*^9, 3.812143619778263*^9}, {
   3.812169986337661*^9, 3.8121699881559896`*^9}, {3.8121703184857893`*^9, 
   3.8121703217312183`*^9}, {3.81217061746986*^9, 3.81217061973427*^9}, {
   3.812170654433563*^9, 3.812170656867264*^9}, {3.812174967851449*^9, 
   3.812174968568019*^9}, {3.812191394729611*^9, 3.8121913977371387`*^9}, {
   3.812191821125429*^9, 3.8121918219423037`*^9}, {3.8121921804097443`*^9, 
   3.812192182454062*^9}, {3.812193507463298*^9, 3.812193508315385*^9}, {
   3.812193977784052*^9, 3.8121939785931473`*^9}, {3.812194328885569*^9, 
   3.812194329730835*^9}, {3.812195358250052*^9, 3.812195359016342*^9}, {
   3.812195410217907*^9, 3.812195410989829*^9}, {3.8121956286003647`*^9, 
   3.812195629377491*^9}, {3.812195747477275*^9, 3.812195748249597*^9}, {
   3.812195805751445*^9, 3.812195806508616*^9}, {3.812196240570176*^9, 
   3.812196241410039*^9}, {3.812198084251144*^9, 3.812198085075962*^9}, {
   3.81219869783005*^9, 3.812198698543871*^9}, {3.812261283337949*^9, 
   3.812261284405692*^9}, {3.8122618475094748`*^9, 3.812261848377331*^9}, {
   3.8122621905877533`*^9, 3.812262191282048*^9}, {3.812262516243683*^9, 
   3.8122625170976877`*^9}, {3.812262733073691*^9, 3.812262734886526*^9}, {
   3.8122637803791447`*^9, 3.8122637812382307`*^9}, {3.812264234089952*^9, 
   3.812264234869557*^9}, {3.812264328543414*^9, 3.812264329295945*^9}, {
   3.812264753757785*^9, 3.81226475464259*^9}, {3.812269428793655*^9, 
   3.812269429507955*^9}, {3.81226978268439*^9, 3.812269783666622*^9}, {
   3.812269955577755*^9, 3.812269956341358*^9}, {3.812270079743615*^9, 
   3.812270080791341*^9}, 3.812270515270434*^9, {3.812272261063469*^9, 
   3.812272262466003*^9}, {3.8122726214809437`*^9, 3.8122726224103403`*^9}, {
   3.81227278537289*^9, 3.812272786156681*^9}, {3.812273117451397*^9, 
   3.812273118242179*^9}, {3.812274979203044*^9, 3.812274980521318*^9}, {
   3.812286822110997*^9, 3.812286822908338*^9}, {3.812286942212511*^9, 
   3.812286942998294*^9}, {3.812290771428976*^9, 3.812290772233432*^9}, {
   3.812291582285556*^9, 3.8122915831338873`*^9}, {3.812292614039257*^9, 
   3.812292614905266*^9}, {3.812292666581946*^9, 3.8122926674138613`*^9}, {
   3.812292862250758*^9, 3.812292863080263*^9}, {3.812299251418438*^9, 
   3.81229925231997*^9}, {3.8123028630998087`*^9, 3.812302865332361*^9}, {
   3.8123449636973877`*^9, 3.8123449645408154`*^9}, {3.812345106033963*^9, 
   3.812345107108781*^9}, {3.812345426422411*^9, 3.8123454274852467`*^9}, {
   3.812346016970993*^9, 3.8123460178830214`*^9}, {3.812349663510928*^9, 
   3.812349665711575*^9}, {3.812349995063875*^9, 3.812349996262456*^9}, {
   3.8123502241315937`*^9, 3.812350225424469*^9}, {3.8123589538867683`*^9, 
   3.812358955394759*^9}, {3.8123594856364594`*^9, 3.812359487467517*^9}, {
   3.812360961209023*^9, 3.8123609624246387`*^9}, {3.8123624528013678`*^9, 
   3.812362453744343*^9}, {3.812364453555729*^9, 3.8123644543734007`*^9}, {
   3.8123652579814873`*^9, 3.812365259059943*^9}, {3.812371337788686*^9, 
   3.812371338651149*^9}, {3.812372110723586*^9, 3.8123721118956003`*^9}, {
   3.812372515381415*^9, 3.8123725163032312`*^9}, {3.8123752142927322`*^9, 
   3.812375215147558*^9}, {3.812375342891227*^9, 3.812375343713933*^9}, {
   3.81237573921259*^9, 3.812375740248674*^9}, {3.8123760608587723`*^9, 
   3.812376061979309*^9}, {3.812376327741643*^9, 3.812376328667281*^9}, {
   3.812436376576166*^9, 3.812436378996464*^9}, {3.812443451350501*^9, 
   3.8124434522697487`*^9}, {3.812444248752713*^9, 3.812444249657262*^9}, {
   3.8124480385670567`*^9, 3.81244804005893*^9}, {3.812448315348158*^9, 
   3.812448316278166*^9}, {3.8124486363806553`*^9, 3.812448637314302*^9}, {
   3.812451864496469*^9, 3.812451865475038*^9}, {3.8124588117331533`*^9, 
   3.812458812797105*^9}, {3.812459066225114*^9, 3.812459067220283*^9}, {
   3.812459582169145*^9, 3.8124595842453547`*^9}, {3.8124597208460407`*^9, 
   3.812459721871467*^9}, {3.8124598455172853`*^9, 3.812459846573578*^9}, {
   3.812459947286893*^9, 3.8124599482722282`*^9}, {3.8124600758286533`*^9, 
   3.8124600768497477`*^9}, {3.812461336712901*^9, 3.812461337628523*^9}, {
   3.812461624229032*^9, 3.812461625242828*^9}, {3.812463233546029*^9, 
   3.812463235320459*^9}, {3.812463727416401*^9, 3.812463728564589*^9}, {
   3.812464009042137*^9, 3.81246401108284*^9}, {3.812464247188417*^9, 
   3.812464248460038*^9}, {3.812465524283595*^9, 3.8124655253546133`*^9}, {
   3.8124658587849216`*^9, 3.8124658599130774`*^9}, {3.812466123812809*^9, 
   3.8124661249642687`*^9}, {3.812525072044011*^9, 3.81252507316539*^9}, {
   3.81253019811374*^9, 3.8125301994610357`*^9}, {3.8125331882405653`*^9, 
   3.8125331892267313`*^9}, {3.812538966406719*^9, 3.81253896838384*^9}, {
   3.812539129691362*^9, 3.812539130706175*^9}, {3.8125391688988237`*^9, 
   3.8125391699446697`*^9}, {3.8125392612434797`*^9, 
   3.8125392622954693`*^9}, {3.8125395185035152`*^9, 3.812539519460105*^9}, {
   3.8125399242437696`*^9, 3.812539925202984*^9}, {3.812539973845964*^9, 
   3.8125399748154497`*^9}, {3.8125400248380537`*^9, 
   3.8125400257915983`*^9}, {3.8125402632964983`*^9, 3.812540264273982*^9}, {
   3.812540594844927*^9, 3.812540596687243*^9}, {3.81254093976686*^9, 
   3.812540940688039*^9}, {3.812541372056015*^9, 3.812541372987965*^9}, {
   3.812541798603395*^9, 3.812541799704288*^9}, {3.812543515404167*^9, 
   3.812543516619006*^9}, {3.8125536808772583`*^9, 3.8125536819587107`*^9}, {
   3.812553930658045*^9, 3.812553931611247*^9}, {3.812558028378029*^9, 
   3.812558029402235*^9}, {3.81256123934756*^9, 3.812561240271943*^9}, {
   3.812561429165761*^9, 3.812561430243425*^9}, {3.812561643101445*^9, 
   3.812561644245139*^9}, {3.81256251180339*^9, 3.812562512940298*^9}, {
   3.812706976742638*^9, 3.81270698006069*^9}, {3.812707159921159*^9, 
   3.81270716425331*^9}, {3.812708183168961*^9, 3.812708186578923*^9}, {
   3.8127085228522243`*^9, 3.81270852572313*^9}, {3.8127095474242764`*^9, 
   3.812709550801238*^9}, {3.812782687208746*^9, 3.812782690661079*^9}, {
   3.813410993429811*^9, 3.813410994619989*^9}, {3.813412566638084*^9, 
   3.813412567469276*^9}, {3.813412757981185*^9, 3.813412758812312*^9}, {
   3.813822979201565*^9, 3.813822980366238*^9}, {3.813823275775917*^9, 
   3.8138232933014297`*^9}, {3.813823596869398*^9, 3.813823597846591*^9}, {
   3.813823704090406*^9, 3.813823706466982*^9}, {3.814079605355771*^9, 
   3.814079606291238*^9}, {3.814080164158558*^9, 3.814080165159501*^9}, {
   3.814080415033224*^9, 3.814080416046218*^9}, {3.8140804748269787`*^9, 
   3.8140804762236423`*^9}, {3.814081043825976*^9, 3.814081044852871*^9}, {
   3.8140811688061934`*^9, 3.81408116977115*^9}, {3.814081325477313*^9, 
   3.814081326502281*^9}, {3.814084458707924*^9, 3.8140844595894938`*^9}, {
   3.8140860458720016`*^9, 3.814086046812492*^9}, {3.814086582255456*^9, 
   3.8140865831924477`*^9}, {3.814086872878231*^9, 3.814086873825376*^9}, {
   3.814087221982272*^9, 3.814087222939592*^9}, {3.8140876818806*^9, 
   3.81408768283669*^9}, {3.814087873863297*^9, 3.8140878775973186`*^9}, {
   3.8140882984572763`*^9, 3.814088299407691*^9}, {3.81408839982708*^9, 
   3.814088400821886*^9}, {3.814088593978549*^9, 3.814088594894013*^9}, {
   3.814088722928947*^9, 3.814088723880187*^9}, {3.814166916118203*^9, 
   3.814166916988194*^9}, {3.8141686625411577`*^9, 3.8141686634513683`*^9}, {
   3.8141737835146923`*^9, 3.814173784567883*^9}, {3.8141739281142178`*^9, 
   3.8141739290441923`*^9}, {3.814174614983766*^9, 3.8141746159473257`*^9}, {
   3.8141752705616417`*^9, 3.814175271647747*^9}, {3.81418124981034*^9, 
   3.814181251105749*^9}, {3.81418160859612*^9, 3.81418161891236*^9}, {
   3.8141818216729918`*^9, 3.814181822721246*^9}, {3.8141820534558573`*^9, 
   3.814182054369754*^9}, {3.814182435682065*^9, 3.814182436610848*^9}, {
   3.81418344764447*^9, 3.81418344877721*^9}, {3.814183795828785*^9, 
   3.81418379680939*^9}, {3.814184040088887*^9, 3.814184041068706*^9}, {
   3.8141841687774897`*^9, 3.814184169852124*^9}, {3.814184404551031*^9, 
   3.814184405496892*^9}, {3.814185176553061*^9, 3.8141851776656322`*^9}, {
   3.814185213971696*^9, 3.814185214919244*^9}, {3.814185466204196*^9, 
   3.814185467288252*^9}, {3.814185598637068*^9, 3.814185599603318*^9}, {
   3.814186493178679*^9, 3.814186494105227*^9}, 3.814186560315096*^9, {
   3.8141866145850077`*^9, 3.814186615705711*^9}, {3.814188573010582*^9, 
   3.81418857401225*^9}, {3.814188933307125*^9, 3.814188934303658*^9}, {
   3.814189016360112*^9, 3.8141890173307962`*^9}, {3.814189118932815*^9, 
   3.81418911989226*^9}, {3.8141894099287558`*^9, 3.814189410867936*^9}, {
   3.814190323383646*^9, 3.814190324625601*^9}, {3.81419048661971*^9, 
   3.814190487644133*^9}, {3.814190823544403*^9, 3.814190824564125*^9}, {
   3.814190883044833*^9, 3.814190884057446*^9}, {3.814191035702544*^9, 
   3.814191036655699*^9}, {3.8141911156590233`*^9, 3.814191116796707*^9}, {
   3.81419132128609*^9, 3.814191322360777*^9}, {3.81419252928751*^9, 
   3.8141925302835417`*^9}, {3.814192588379887*^9, 3.8141925894337273`*^9}, {
   3.814192737373588*^9, 3.8141927384990892`*^9}, {3.8141932357243433`*^9, 
   3.814193236755394*^9}, {3.8141934109350147`*^9, 3.814193411977283*^9}, {
   3.814193569876601*^9, 3.8141935724533577`*^9}, {3.8141937038257923`*^9, 
   3.814193704995761*^9}, {3.8141939057239656`*^9, 3.81419390698195*^9}, {
   3.814194236759089*^9, 3.8141942379641533`*^9}, {3.814194780277388*^9, 
   3.8141947814081993`*^9}, {3.8141948737203074`*^9, 3.81419487486744*^9}, {
   3.814195052988405*^9, 3.814195054111655*^9}, {3.814195166360744*^9, 
   3.814195167535801*^9}, {3.814196116588313*^9, 3.8141961177771397`*^9}, {
   3.814201463970605*^9, 3.814201466027458*^9}, {3.8142025158897057`*^9, 
   3.8142025171942253`*^9}, {3.814202659382618*^9, 3.814202660602046*^9}, {
   3.814202791422069*^9, 3.814202792716124*^9}, {3.814203340093377*^9, 
   3.814203341369438*^9}, {3.8142036445580273`*^9, 3.81420364578401*^9}, {
   3.8142038560914583`*^9, 3.814203857373263*^9}, {3.814204023375718*^9, 
   3.814204025755754*^9}, {3.814204323145289*^9, 3.814204324475705*^9}, {
   3.814204712141409*^9, 3.814204713550848*^9}, {3.814205305169942*^9, 
   3.8142053064951487`*^9}, {3.8142058758356113`*^9, 
   3.8142058779413013`*^9}, {3.8142060291694117`*^9, 3.814206030493689*^9}, {
   3.814206308409768*^9, 3.814206310342691*^9}, {3.814206410581112*^9, 
   3.814206412457739*^9}, {3.814208573643669*^9, 3.8142085910267143`*^9}, {
   3.814208775244734*^9, 3.8142087766337767`*^9}, {3.814208818673071*^9, 
   3.814208820758588*^9}, {3.814209225147086*^9, 3.814209226465652*^9}, {
   3.814342965965994*^9, 3.814342987262206*^9}, {3.8143433905749073`*^9, 
   3.814343392475647*^9}, {3.8143434529419127`*^9, 3.814343455196095*^9}, {
   3.81434361428505*^9, 3.8143436161675873`*^9}, {3.814360790007983*^9, 
   3.814360791078247*^9}, {3.8143611431818*^9, 3.814361144283863*^9}, {
   3.8147727147003736`*^9, 3.814772716033654*^9}, {3.8148189688711567`*^9, 
   3.81481897010198*^9}, {3.814893319010171*^9, 3.814893320797936*^9}, {
   3.815561808787459*^9, 3.815561811183814*^9}, {3.815674114718121*^9, 
   3.815674117081216*^9}, {3.81567448486812*^9, 3.8156744870288763`*^9}, {
   3.815674585271542*^9, 3.815674587946443*^9}, {3.8156754482739964`*^9, 
   3.815675451088686*^9}, {3.815675725433083*^9, 3.815675727696681*^9}, {
   3.815677561818184*^9, 3.815677564253664*^9}, {3.815678897451022*^9, 
   3.81567889890127*^9}, {3.815737251069659*^9, 3.815737252615571*^9}, {
   3.815739443078339*^9, 3.815739444308363*^9}, {3.815739671834543*^9, 
   3.8157396731102743`*^9}, {3.815739953758909*^9, 3.815739955086625*^9}, {
   3.815740566040386*^9, 3.8157405674254*^9}, {3.815740842168351*^9, 
   3.8157408434309673`*^9}, {3.8157561659665318`*^9, 3.815756167265707*^9}, {
   3.815756374887006*^9, 3.815756377073597*^9}, {3.815756515911628*^9, 
   3.8157565171351957`*^9}, {3.815756737735828*^9, 3.815756738926825*^9}, {
   3.815756912683874*^9, 3.815756913911806*^9}, {3.815757469064389*^9, 
   3.815757470269689*^9}, {3.815757630011417*^9, 3.815757631247512*^9}, {
   3.815757744588275*^9, 3.815757745825652*^9}, {3.8157579268196487`*^9, 
   3.8157579280766287`*^9}, {3.815758503627808*^9, 3.815758505651224*^9}, {
   3.815759951069396*^9, 3.8157599525816097`*^9}, {3.815807674249057*^9, 
   3.8158076766870537`*^9}, {3.815847828095662*^9, 3.815847829548852*^9}, {
   3.8162725215340357`*^9, 3.8162725234597673`*^9}, {3.816273435435997*^9, 
   3.81627345340125*^9}, {3.816274028516528*^9, 3.816274043579708*^9}, {
   3.8163670906607227`*^9, 3.816367091850955*^9}, {3.816367468619735*^9, 
   3.816367495477517*^9}, {3.816367701699369*^9, 3.8163677031959267`*^9}, {
   3.816432367079183*^9, 3.8164323838896112`*^9}, {3.8164328915901613`*^9, 
   3.816432893005227*^9}, {3.8164343962205753`*^9, 3.816434397633473*^9}, {
   3.816435121718891*^9, 3.816435123624653*^9}, {3.816435249036715*^9, 
   3.816435250418762*^9}, {3.816437183920314*^9, 3.816437185380541*^9}, {
   3.816438117940875*^9, 3.816438119272591*^9}, {3.8164383735169973`*^9, 
   3.816438374968711*^9}, {3.816443562000051*^9, 3.816443563214179*^9}, {
   3.816449988097139*^9, 3.816449989535575*^9}, {3.816450042970334*^9, 
   3.816450045654436*^9}, {3.816450257431624*^9, 3.816450258792823*^9}, {
   3.816520227317438*^9, 3.816520228645235*^9}, {3.816520277389402*^9, 
   3.816520278638133*^9}, {3.821112249707835*^9, 3.821112250080995*^9}, 
   3.821112582543251*^9, {3.821112640247504*^9, 3.8211126405930433`*^9}, {
   3.821113451996977*^9, 3.82111345236275*^9}, {3.821113560549181*^9, 
   3.8211135608787193`*^9}, {3.821113675266879*^9, 3.821113675608714*^9}, {
   3.8211153570217247`*^9, 3.821115357338541*^9}, {3.8211154397035837`*^9, 
   3.821115440069088*^9}, {3.8211155710274563`*^9, 3.821115571371029*^9}, {
   3.821115608859544*^9, 3.8211156092005463`*^9}, {3.82111564475885*^9, 
   3.821115645098463*^9}, 3.8211156991675*^9, {3.821116527316394*^9, 
   3.8211165277569647`*^9}, {3.821180795292364*^9, 3.821180797409871*^9}, {
   3.821181370355523*^9, 3.8211813708822002`*^9}, {3.821181551403751*^9, 
   3.821181551962614*^9}, {3.8211816500452538`*^9, 3.8211816506089163`*^9}, {
   3.8211817676550827`*^9, 3.821181768108694*^9}, {3.821181851984249*^9, 
   3.821181852433671*^9}, {3.821182197093019*^9, 3.821182197665711*^9}, {
   3.82118223545969*^9, 3.821182236030851*^9}, {3.821182291193102*^9, 
   3.821182291769951*^9}, {3.821182448525566*^9, 3.821182449024164*^9}, {
   3.821182547061552*^9, 3.821182547605485*^9}, {3.8211828049957237`*^9, 
   3.821182826757317*^9}, {3.821182892189208*^9, 3.8211828926964893`*^9}, {
   3.821183845862315*^9, 3.821183847395369*^9}, {3.821183933826502*^9, 
   3.8211839343740396`*^9}, {3.8211854061521387`*^9, 3.821185407532626*^9}, {
   3.8211858964256496`*^9, 3.8211858970134993`*^9}, {3.821185999131826*^9, 
   3.821185999630179*^9}, {3.821186523969942*^9, 3.821186524615992*^9}, {
   3.821188198681879*^9, 3.821188199210864*^9}, {3.821188823258931*^9, 
   3.821188823849145*^9}, {3.821189024620713*^9, 3.8211890251032963`*^9}, {
   3.821200360365093*^9, 3.821200360944065*^9}, {3.821252310086668*^9, 
   3.821252310631537*^9}, {3.8212532416689*^9, 3.821253242183234*^9}, {
   3.82125337267426*^9, 3.821253373302656*^9}, {3.821254634997961*^9, 
   3.8212546355020638`*^9}, {3.8212665302934923`*^9, 3.821266530732121*^9}, {
   3.8212697579714823`*^9, 3.821269758414228*^9}, {3.8212699929442377`*^9, 
   3.8212699934482803`*^9}, {3.8212705109738293`*^9, 3.82127051139065*^9}, {
   3.82127071606476*^9, 3.821270716493355*^9}, {3.821857068005432*^9, 
   3.821857068627817*^9}, {3.8218572401832647`*^9, 3.821857240805461*^9}, {
   3.8218573084039717`*^9, 3.8218573089967012`*^9}, {3.821858330501115*^9, 
   3.821858331131778*^9}, {3.821858534935874*^9, 3.8218585356474953`*^9}, {
   3.822466932317127*^9, 3.822466932895274*^9}, {3.8224675520427856`*^9, 
   3.82246755260954*^9}, {3.8224677510568933`*^9, 3.822467751668244*^9}, {
   3.8225734326852207`*^9, 3.822573433248865*^9}, {3.8225735911563883`*^9, 
   3.8225735918282967`*^9}, {3.8225737626166077`*^9, 3.822573763168593*^9}, {
   3.8226459398928633`*^9, 3.822645940595428*^9}, {3.822646091195016*^9, 
   3.8226460917664623`*^9}, {3.822647064773197*^9, 3.822647065318544*^9}, {
   3.822649891837719*^9, 3.8226498924026003`*^9}, {3.822650021367386*^9, 
   3.8226500219418907`*^9}, {3.8226660721475353`*^9, 3.822666072706554*^9}, {
   3.8226808879034033`*^9, 3.822680888438241*^9}, {3.822749717807164*^9, 
   3.8227497184215517`*^9}, {3.822753601589867*^9, 3.822753603794758*^9}, {
   3.8228506612670918`*^9, 3.8228506618657637`*^9}, {3.822851349866352*^9, 
   3.822851350435252*^9}, {3.822917514690033*^9, 3.822917515307673*^9}, {
   3.823069308765279*^9, 3.823069309383881*^9}, {3.823069937456761*^9, 
   3.823069938039647*^9}, {3.82309415279389*^9, 3.823094153360887*^9}, {
   3.8230976482411137`*^9, 3.823097648869668*^9}, {3.823097785189457*^9, 
   3.8230977857830667`*^9}, {3.82325448256987*^9, 3.8232544831089687`*^9}, {
   3.823255262829487*^9, 3.823255263361701*^9}, {3.823266390953486*^9, 
   3.823266391523204*^9}, {3.823277946518187*^9, 3.8232779470809927`*^9}, {
   3.823278051089568*^9, 3.823278051665766*^9}, {3.824029639688756*^9, 
   3.8240296403278646`*^9}, {3.824030013091926*^9, 3.8240300137443542`*^9}, {
   3.8240300589947653`*^9, 3.8240300596216497`*^9}, {3.8240301031511602`*^9, 
   3.824030154846074*^9}, {3.824058518430229*^9, 3.824058519179844*^9}, {
   3.824111756648747*^9, 3.824111757509842*^9}, {3.834569795722715*^9, 
   3.834569798108127*^9}, {3.834570587842065*^9, 3.834570590018589*^9}, {
   3.834571452023732*^9, 3.8345714546669397`*^9}, {3.834571994634906*^9, 
   3.834571996167038*^9}, {3.834573835091826*^9, 3.834573837172719*^9}},
 CellLabel->
  "During evaluation of \
In[422]:=",ExpressionUUID->"9fb39ea6-f48f-4f56-b6c9-e31146e4b22f"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print",
 CellChangeTimes->{
  3.8113973802906237`*^9, 3.8113976734526377`*^9, {3.811397746040906*^9, 
   3.8113977610462027`*^9}, {3.811399023801959*^9, 3.811399024070632*^9}, {
   3.811399141970356*^9, 3.811399142263818*^9}, {3.811399177626767*^9, 
   3.811399177914583*^9}, {3.8113992521371098`*^9, 3.811399252448769*^9}, {
   3.8113994502599087`*^9, 3.8113994504730053`*^9}, {3.8114064820855713`*^9, 
   3.81140648240973*^9}, {3.8114068575468407`*^9, 3.8114068578710537`*^9}, {
   3.811406907427164*^9, 3.811406936412608*^9}, {3.811407460550961*^9, 
   3.81140746095481*^9}, {3.811408147623847*^9, 3.811408147972376*^9}, {
   3.811408191329802*^9, 3.811408191674942*^9}, 3.811408780183262*^9, {
   3.811408815519721*^9, 3.8114088158719883`*^9}, {3.811408862524087*^9, 
   3.811408862841855*^9}, {3.81140899770251*^9, 3.811408998004592*^9}, {
   3.811409062245348*^9, 3.811409062606256*^9}, 3.811409269782422*^9, {
   3.811409304421692*^9, 3.8114093047551403`*^9}, {3.811409612580348*^9, 
   3.8114096129047003`*^9}, {3.8114097924110537`*^9, 
   3.8114097926726313`*^9}, {3.811411451708661*^9, 3.811411451983836*^9}, {
   3.81141186385175*^9, 3.811411864173416*^9}, {3.811411919794717*^9, 
   3.8114119200832977`*^9}, {3.811412615870905*^9, 3.811412616146137*^9}, {
   3.811412715300667*^9, 3.811412715603054*^9}, {3.811413263724257*^9, 
   3.811413264002874*^9}, {3.811413332202839*^9, 3.811413332548571*^9}, {
   3.811413629662818*^9, 3.8114136299656277`*^9}, {3.811413774215596*^9, 
   3.811413774515668*^9}, {3.811413894499695*^9, 3.81141389477352*^9}, 
   3.811414328695777*^9, 3.8114144094521637`*^9, {3.8114146494781027`*^9, 
   3.811414649825714*^9}, {3.8114150420265102`*^9, 3.811415042351219*^9}, {
   3.811415881442857*^9, 3.811415881867776*^9}, {3.811416424210205*^9, 
   3.811416424576687*^9}, {3.811416514510274*^9, 3.8114165148116093`*^9}, {
   3.811416943423992*^9, 3.8114169437273483`*^9}, {3.811417009260152*^9, 
   3.811417009572474*^9}, {3.811419100837137*^9, 3.811419101199787*^9}, {
   3.8114192213717413`*^9, 3.811419222279934*^9}, {3.811419394538576*^9, 
   3.81141939495638*^9}, {3.811419614399149*^9, 3.8114196147368937`*^9}, {
   3.811419721154871*^9, 3.811419721491787*^9}, {3.81142027840374*^9, 
   3.811420278784595*^9}, {3.811420496591317*^9, 3.811420496959734*^9}, {
   3.8114207654693737`*^9, 3.8114207658578777`*^9}, {3.811420875629318*^9, 
   3.811420875994026*^9}, {3.81142099519291*^9, 3.811420995699128*^9}, {
   3.811423399156495*^9, 3.811423399531011*^9}, {3.811423432150598*^9, 
   3.8114234325058537`*^9}, {3.81142390173834*^9, 3.811423902185981*^9}, {
   3.811424940935017*^9, 3.811424941381892*^9}, {3.811425128659313*^9, 
   3.811425129050366*^9}, {3.811425230988387*^9, 3.8114252314351263`*^9}, {
   3.8114253616948347`*^9, 3.8114253621250143`*^9}, {3.811425407326231*^9, 
   3.811425407755106*^9}, {3.8114256486575527`*^9, 3.811425649043414*^9}, {
   3.811425739809609*^9, 3.811425740184533*^9}, {3.811425802081039*^9, 
   3.8114258024570913`*^9}, {3.811426021660324*^9, 3.811426022032298*^9}, {
   3.811426573863682*^9, 3.811426574308659*^9}, {3.811427720850284*^9, 
   3.811427721213203*^9}, {3.8114311780441723`*^9, 3.811431178460887*^9}, {
   3.811431460209279*^9, 3.8114314606367903`*^9}, {3.811431997503669*^9, 
   3.811431997934544*^9}, {3.8114326319473467`*^9, 3.811432632450865*^9}, {
   3.8114347909207067`*^9, 3.8114347914949827`*^9}, {3.811435083628364*^9, 
   3.811435084090391*^9}, {3.811435687052915*^9, 3.811435687637125*^9}, {
   3.811435778956438*^9, 3.811435779466835*^9}, {3.811435829177342*^9, 
   3.8114358296537848`*^9}, {3.811436514828232*^9, 3.811436515328103*^9}, 
   3.811437052954747*^9, 3.811437273633234*^9, {3.811437345281423*^9, 
   3.811437347403377*^9}, {3.811442056650063*^9, 3.811442057294572*^9}, {
   3.811484937266859*^9, 3.8114849384076033`*^9}, {3.811508865639657*^9, 
   3.811508866135507*^9}, {3.8115090106395082`*^9, 3.811509011187421*^9}, {
   3.811509165869811*^9, 3.811509166408177*^9}, {3.811509220473774*^9, 
   3.811509221026752*^9}, {3.811509324576804*^9, 3.811509325122257*^9}, {
   3.8115107690304728`*^9, 3.811510769582539*^9}, {3.811510887373138*^9, 
   3.811510887922225*^9}, {3.811510958723938*^9, 3.811510959255562*^9}, {
   3.811511149420478*^9, 3.8115111499598722`*^9}, {3.811511674258432*^9, 
   3.8115116747827063`*^9}, {3.8115118383538227`*^9, 3.811511838896578*^9}, {
   3.8115119320266047`*^9, 3.8115119325858107`*^9}, {3.811517913728382*^9, 
   3.811517914227708*^9}, {3.811518119704513*^9, 3.811518120360278*^9}, {
   3.8115182793137293`*^9, 3.811518279784086*^9}, {3.811518454383552*^9, 
   3.811518454878085*^9}, {3.8115185240270452`*^9, 3.811518524565852*^9}, {
   3.811518588488676*^9, 3.811518589102003*^9}, {3.811518779955468*^9, 
   3.811518780516642*^9}, {3.8115188250157547`*^9, 3.8115188255058603`*^9}, {
   3.811519075367033*^9, 3.8115190758563147`*^9}, {3.811519195908333*^9, 
   3.811519196388638*^9}, 3.811519273740089*^9, {3.811520940982108*^9, 
   3.8115209414978437`*^9}, {3.811522193189136*^9, 3.81152219378788*^9}, {
   3.811522269378261*^9, 3.8115222698860493`*^9}, {3.811522391160087*^9, 
   3.811522392239249*^9}, {3.8115224350585823`*^9, 3.811522435583156*^9}, {
   3.81152253769947*^9, 3.811522538235537*^9}, {3.8115225939776154`*^9, 
   3.811522594516518*^9}, {3.811523888797782*^9, 3.8115239150236464`*^9}, {
   3.811523975497347*^9, 3.811523976089611*^9}, {3.811524081291355*^9, 
   3.811524081893303*^9}, {3.811524218680627*^9, 3.811524219231621*^9}, {
   3.811524257466516*^9, 3.811524258076159*^9}, {3.81152433587852*^9, 
   3.811524336484267*^9}, {3.811524611503619*^9, 3.811524612109056*^9}, {
   3.811524642516279*^9, 3.8115246430945263`*^9}, {3.811525683687345*^9, 
   3.811525684248208*^9}, {3.811525890182604*^9, 3.811525890842289*^9}, {
   3.811526233031727*^9, 3.8115262337371817`*^9}, {3.8115266308987617`*^9, 
   3.81152663148457*^9}, {3.811526768804142*^9, 3.811526769369442*^9}, {
   3.811527006899583*^9, 3.811527007536625*^9}, {3.811527237376033*^9, 
   3.8115272380535*^9}, {3.8115274345316067`*^9, 3.8115274350683737`*^9}, {
   3.81152781551688*^9, 3.811527816086246*^9}, {3.8115288046466913`*^9, 
   3.811528805160081*^9}, {3.811571685466545*^9, 3.8115716860390778`*^9}, {
   3.811591049315804*^9, 3.8115910498493557`*^9}, {3.811591683090623*^9, 
   3.811591683758226*^9}, {3.811591907471204*^9, 3.811591908067287*^9}, {
   3.811592147899363*^9, 3.8115921485068913`*^9}, {3.811592261365673*^9, 
   3.811592261957225*^9}, {3.811593653288876*^9, 3.811593653946721*^9}, {
   3.8115939557422113`*^9, 3.811593956930251*^9}, {3.811594051575634*^9, 
   3.81159405221677*^9}, {3.811674041800869*^9, 3.811674042815732*^9}, {
   3.8116807930836763`*^9, 3.811680794711833*^9}, {3.811680857072268*^9, 
   3.811680859459391*^9}, {3.811697553532362*^9, 3.811697554407165*^9}, {
   3.811697914052889*^9, 3.811697914827787*^9}, {3.811754743109427*^9, 
   3.8117547438157263`*^9}, {3.812098227577607*^9, 3.812098228305429*^9}, {
   3.812098469733382*^9, 3.8120984704302387`*^9}, {3.812099091213662*^9, 
   3.812099091986021*^9}, {3.812099205129303*^9, 3.8120992057922277`*^9}, {
   3.812099496475237*^9, 3.812099497130563*^9}, {3.812099704859066*^9, 
   3.812099705558215*^9}, 3.812099841408181*^9, {3.812100835020603*^9, 
   3.812100835687059*^9}, {3.812100998067474*^9, 3.812100998733938*^9}, 
   3.8121011992866383`*^9, {3.812105781463171*^9, 3.812105801306386*^9}, {
   3.812106211047121*^9, 3.812106212141972*^9}, {3.8121065170695047`*^9, 
   3.8121065179087887`*^9}, {3.812106627103561*^9, 3.812106628000842*^9}, {
   3.812107358092169*^9, 3.8121073589093513`*^9}, {3.8121080618614197`*^9, 
   3.812108062855665*^9}, {3.812108505985733*^9, 3.812108506804513*^9}, {
   3.812108751703669*^9, 3.812108752612322*^9}, {3.812110466622686*^9, 
   3.812110468453113*^9}, {3.812110605270805*^9, 3.812110622265121*^9}, {
   3.812128612292386*^9, 3.81212861312497*^9}, {3.812142012219798*^9, 
   3.8121420139900513`*^9}, {3.812143618805477*^9, 3.812143619778263*^9}, {
   3.812169986337661*^9, 3.8121699881559896`*^9}, {3.8121703184857893`*^9, 
   3.8121703217312183`*^9}, {3.81217061746986*^9, 3.81217061973427*^9}, {
   3.812170654433563*^9, 3.812170656867264*^9}, {3.812174967851449*^9, 
   3.812174968568019*^9}, {3.812191394729611*^9, 3.8121913977371387`*^9}, {
   3.812191821125429*^9, 3.8121918219423037`*^9}, {3.8121921804097443`*^9, 
   3.812192182454062*^9}, {3.812193507463298*^9, 3.812193508315385*^9}, {
   3.812193977784052*^9, 3.8121939785931473`*^9}, {3.812194328885569*^9, 
   3.812194329730835*^9}, {3.812195358250052*^9, 3.812195359016342*^9}, {
   3.812195410217907*^9, 3.812195410989829*^9}, {3.8121956286003647`*^9, 
   3.812195629377491*^9}, {3.812195747477275*^9, 3.812195748249597*^9}, {
   3.812195805751445*^9, 3.812195806508616*^9}, {3.812196240570176*^9, 
   3.812196241410039*^9}, {3.812198084251144*^9, 3.812198085075962*^9}, {
   3.81219869783005*^9, 3.812198698543871*^9}, {3.812261283337949*^9, 
   3.812261284405692*^9}, {3.8122618475094748`*^9, 3.812261848377331*^9}, {
   3.8122621905877533`*^9, 3.812262191282048*^9}, {3.812262516243683*^9, 
   3.8122625170976877`*^9}, {3.812262733073691*^9, 3.812262734886526*^9}, {
   3.8122637803791447`*^9, 3.8122637812382307`*^9}, {3.812264234089952*^9, 
   3.812264234869557*^9}, {3.812264328543414*^9, 3.812264329295945*^9}, {
   3.812264753757785*^9, 3.81226475464259*^9}, {3.812269428793655*^9, 
   3.812269429507955*^9}, {3.81226978268439*^9, 3.812269783666622*^9}, {
   3.812269955577755*^9, 3.812269956341358*^9}, {3.812270079743615*^9, 
   3.812270080791341*^9}, 3.812270515270434*^9, {3.812272261063469*^9, 
   3.812272262466003*^9}, {3.8122726214809437`*^9, 3.8122726224103403`*^9}, {
   3.81227278537289*^9, 3.812272786156681*^9}, {3.812273117451397*^9, 
   3.812273118242179*^9}, {3.812274979203044*^9, 3.812274980521318*^9}, {
   3.812286822110997*^9, 3.812286822908338*^9}, {3.812286942212511*^9, 
   3.812286942998294*^9}, {3.812290771428976*^9, 3.812290772233432*^9}, {
   3.812291582285556*^9, 3.8122915831338873`*^9}, {3.812292614039257*^9, 
   3.812292614905266*^9}, {3.812292666581946*^9, 3.8122926674138613`*^9}, {
   3.812292862250758*^9, 3.812292863080263*^9}, {3.812299251418438*^9, 
   3.81229925231997*^9}, {3.8123028630998087`*^9, 3.812302865332361*^9}, {
   3.8123449636973877`*^9, 3.8123449645408154`*^9}, {3.812345106033963*^9, 
   3.812345107108781*^9}, {3.812345426422411*^9, 3.8123454274852467`*^9}, {
   3.812346016970993*^9, 3.8123460178830214`*^9}, {3.812349663510928*^9, 
   3.812349665711575*^9}, {3.812349995063875*^9, 3.812349996262456*^9}, {
   3.8123502241315937`*^9, 3.812350225424469*^9}, {3.8123589538867683`*^9, 
   3.812358955394759*^9}, {3.8123594856364594`*^9, 3.812359487467517*^9}, {
   3.812360961209023*^9, 3.8123609624246387`*^9}, {3.8123624528013678`*^9, 
   3.812362453744343*^9}, {3.812364453555729*^9, 3.8123644543734007`*^9}, {
   3.8123652579814873`*^9, 3.812365259059943*^9}, {3.812371337788686*^9, 
   3.812371338651149*^9}, {3.812372110723586*^9, 3.8123721118956003`*^9}, {
   3.812372515381415*^9, 3.8123725163032312`*^9}, {3.8123752142927322`*^9, 
   3.812375215147558*^9}, {3.812375342891227*^9, 3.812375343713933*^9}, {
   3.81237573921259*^9, 3.812375740248674*^9}, {3.8123760608587723`*^9, 
   3.812376061979309*^9}, {3.812376327741643*^9, 3.812376328667281*^9}, {
   3.812436376576166*^9, 3.812436378996464*^9}, {3.812443451350501*^9, 
   3.8124434522697487`*^9}, {3.812444248752713*^9, 3.812444249657262*^9}, {
   3.8124480385670567`*^9, 3.81244804005893*^9}, {3.812448315348158*^9, 
   3.812448316278166*^9}, {3.8124486363806553`*^9, 3.812448637314302*^9}, {
   3.812451864496469*^9, 3.812451865475038*^9}, {3.8124588117331533`*^9, 
   3.812458812797105*^9}, {3.812459066225114*^9, 3.812459067220283*^9}, {
   3.812459582169145*^9, 3.8124595842453547`*^9}, {3.8124597208460407`*^9, 
   3.812459721871467*^9}, {3.8124598455172853`*^9, 3.812459846573578*^9}, {
   3.812459947286893*^9, 3.8124599482722282`*^9}, {3.8124600758286533`*^9, 
   3.8124600768497477`*^9}, {3.812461336712901*^9, 3.812461337628523*^9}, {
   3.812461624229032*^9, 3.812461625242828*^9}, {3.812463233546029*^9, 
   3.812463235320459*^9}, {3.812463727416401*^9, 3.812463728564589*^9}, {
   3.812464009042137*^9, 3.81246401108284*^9}, {3.812464247188417*^9, 
   3.812464248460038*^9}, {3.812465524283595*^9, 3.8124655253546133`*^9}, {
   3.8124658587849216`*^9, 3.8124658599130774`*^9}, {3.812466123812809*^9, 
   3.8124661249642687`*^9}, {3.812525072044011*^9, 3.81252507316539*^9}, {
   3.81253019811374*^9, 3.8125301994610357`*^9}, {3.8125331882405653`*^9, 
   3.8125331892267313`*^9}, {3.812538966406719*^9, 3.81253896838384*^9}, {
   3.812539129691362*^9, 3.812539130706175*^9}, {3.8125391688988237`*^9, 
   3.8125391699446697`*^9}, {3.8125392612434797`*^9, 
   3.8125392622954693`*^9}, {3.8125395185035152`*^9, 3.812539519460105*^9}, {
   3.8125399242437696`*^9, 3.812539925202984*^9}, {3.812539973845964*^9, 
   3.8125399748154497`*^9}, {3.8125400248380537`*^9, 
   3.8125400257915983`*^9}, {3.8125402632964983`*^9, 3.812540264273982*^9}, {
   3.812540594844927*^9, 3.812540596687243*^9}, {3.81254093976686*^9, 
   3.812540940688039*^9}, {3.812541372056015*^9, 3.812541372987965*^9}, {
   3.812541798603395*^9, 3.812541799704288*^9}, {3.812543515404167*^9, 
   3.812543516619006*^9}, {3.8125536808772583`*^9, 3.8125536819587107`*^9}, {
   3.812553930658045*^9, 3.812553931611247*^9}, {3.812558028378029*^9, 
   3.812558029402235*^9}, {3.81256123934756*^9, 3.812561240271943*^9}, {
   3.812561429165761*^9, 3.812561430243425*^9}, {3.812561643101445*^9, 
   3.812561644245139*^9}, {3.81256251180339*^9, 3.812562512940298*^9}, {
   3.812706976742638*^9, 3.81270698006069*^9}, {3.812707159921159*^9, 
   3.81270716425331*^9}, {3.812708183168961*^9, 3.812708186578923*^9}, {
   3.8127085228522243`*^9, 3.81270852572313*^9}, {3.8127095474242764`*^9, 
   3.812709550801238*^9}, {3.812782687208746*^9, 3.812782690661079*^9}, {
   3.813410993429811*^9, 3.813410994619989*^9}, {3.813412566638084*^9, 
   3.813412567469276*^9}, {3.813412757981185*^9, 3.813412758812312*^9}, {
   3.813822979201565*^9, 3.813822980366238*^9}, {3.813823275775917*^9, 
   3.8138232933014297`*^9}, {3.813823596869398*^9, 3.813823597846591*^9}, {
   3.813823704090406*^9, 3.813823706466982*^9}, {3.814079605355771*^9, 
   3.814079606291238*^9}, {3.814080164158558*^9, 3.814080165159501*^9}, {
   3.814080415033224*^9, 3.814080416046218*^9}, {3.8140804748269787`*^9, 
   3.8140804762236423`*^9}, {3.814081043825976*^9, 3.814081044852871*^9}, {
   3.8140811688061934`*^9, 3.81408116977115*^9}, {3.814081325477313*^9, 
   3.814081326502281*^9}, {3.814084458707924*^9, 3.8140844595894938`*^9}, {
   3.8140860458720016`*^9, 3.814086046812492*^9}, {3.814086582255456*^9, 
   3.8140865831924477`*^9}, {3.814086872878231*^9, 3.814086873825376*^9}, {
   3.814087221982272*^9, 3.814087222939592*^9}, {3.8140876818806*^9, 
   3.81408768283669*^9}, {3.814087873863297*^9, 3.8140878775973186`*^9}, {
   3.8140882984572763`*^9, 3.814088299407691*^9}, {3.81408839982708*^9, 
   3.814088400821886*^9}, {3.814088593978549*^9, 3.814088594894013*^9}, {
   3.814088722928947*^9, 3.814088723880187*^9}, {3.814166916118203*^9, 
   3.814166916988194*^9}, {3.8141686625411577`*^9, 3.8141686634513683`*^9}, {
   3.8141737835146923`*^9, 3.814173784567883*^9}, {3.8141739281142178`*^9, 
   3.8141739290441923`*^9}, {3.814174614983766*^9, 3.8141746159473257`*^9}, {
   3.8141752705616417`*^9, 3.814175271647747*^9}, {3.81418124981034*^9, 
   3.814181251105749*^9}, {3.81418160859612*^9, 3.81418161891236*^9}, {
   3.8141818216729918`*^9, 3.814181822721246*^9}, {3.8141820534558573`*^9, 
   3.814182054369754*^9}, {3.814182435682065*^9, 3.814182436610848*^9}, {
   3.81418344764447*^9, 3.81418344877721*^9}, {3.814183795828785*^9, 
   3.81418379680939*^9}, {3.814184040088887*^9, 3.814184041068706*^9}, {
   3.8141841687774897`*^9, 3.814184169852124*^9}, {3.814184404551031*^9, 
   3.814184405496892*^9}, {3.814185176553061*^9, 3.8141851776656322`*^9}, {
   3.814185213971696*^9, 3.814185214919244*^9}, {3.814185466204196*^9, 
   3.814185467288252*^9}, {3.814185598637068*^9, 3.814185599603318*^9}, {
   3.814186493178679*^9, 3.814186494105227*^9}, 3.814186560315096*^9, {
   3.8141866145850077`*^9, 3.814186615705711*^9}, {3.814188573010582*^9, 
   3.81418857401225*^9}, {3.814188933307125*^9, 3.814188934303658*^9}, {
   3.814189016360112*^9, 3.8141890173307962`*^9}, {3.814189118932815*^9, 
   3.81418911989226*^9}, {3.8141894099287558`*^9, 3.814189410867936*^9}, {
   3.814190323383646*^9, 3.814190324625601*^9}, {3.81419048661971*^9, 
   3.814190487644133*^9}, {3.814190823544403*^9, 3.814190824564125*^9}, {
   3.814190883044833*^9, 3.814190884057446*^9}, {3.814191035702544*^9, 
   3.814191036655699*^9}, {3.8141911156590233`*^9, 3.814191116796707*^9}, {
   3.81419132128609*^9, 3.814191322360777*^9}, {3.81419252928751*^9, 
   3.8141925302835417`*^9}, {3.814192588379887*^9, 3.8141925894337273`*^9}, {
   3.814192737373588*^9, 3.8141927384990892`*^9}, {3.8141932357243433`*^9, 
   3.814193236755394*^9}, {3.8141934109350147`*^9, 3.814193411977283*^9}, {
   3.814193569876601*^9, 3.8141935724533577`*^9}, {3.8141937038257923`*^9, 
   3.814193704995761*^9}, {3.8141939057239656`*^9, 3.81419390698195*^9}, {
   3.814194236759089*^9, 3.8141942379641533`*^9}, {3.814194780277388*^9, 
   3.8141947814081993`*^9}, {3.8141948737203074`*^9, 3.81419487486744*^9}, {
   3.814195052988405*^9, 3.814195054111655*^9}, {3.814195166360744*^9, 
   3.814195167535801*^9}, {3.814196116588313*^9, 3.8141961177771397`*^9}, {
   3.814201463970605*^9, 3.814201466027458*^9}, {3.8142025158897057`*^9, 
   3.8142025171942253`*^9}, {3.814202659382618*^9, 3.814202660602046*^9}, {
   3.814202791422069*^9, 3.814202792716124*^9}, {3.814203340093377*^9, 
   3.814203341369438*^9}, {3.8142036445580273`*^9, 3.81420364578401*^9}, {
   3.8142038560914583`*^9, 3.814203857373263*^9}, {3.814204023375718*^9, 
   3.814204025755754*^9}, {3.814204323145289*^9, 3.814204324475705*^9}, {
   3.814204712141409*^9, 3.814204713550848*^9}, {3.814205305169942*^9, 
   3.8142053064951487`*^9}, {3.8142058758356113`*^9, 
   3.8142058779413013`*^9}, {3.8142060291694117`*^9, 3.814206030493689*^9}, {
   3.814206308409768*^9, 3.814206310342691*^9}, {3.814206410581112*^9, 
   3.814206412457739*^9}, {3.814208573643669*^9, 3.8142085910267143`*^9}, {
   3.814208775244734*^9, 3.8142087766337767`*^9}, {3.814208818673071*^9, 
   3.814208820758588*^9}, {3.814209225147086*^9, 3.814209226465652*^9}, {
   3.814342965965994*^9, 3.814342987262206*^9}, {3.8143433905749073`*^9, 
   3.814343392475647*^9}, {3.8143434529419127`*^9, 3.814343455196095*^9}, {
   3.81434361428505*^9, 3.8143436161675873`*^9}, {3.814360790007983*^9, 
   3.814360791078247*^9}, {3.8143611431818*^9, 3.814361144283863*^9}, {
   3.8147727147003736`*^9, 3.814772716033654*^9}, {3.8148189688711567`*^9, 
   3.81481897010198*^9}, {3.814893319010171*^9, 3.814893320797936*^9}, {
   3.815561808787459*^9, 3.815561811183814*^9}, {3.815674114718121*^9, 
   3.815674117081216*^9}, {3.81567448486812*^9, 3.8156744870288763`*^9}, {
   3.815674585271542*^9, 3.815674587946443*^9}, {3.8156754482739964`*^9, 
   3.815675451088686*^9}, {3.815675725433083*^9, 3.815675727696681*^9}, {
   3.815677561818184*^9, 3.815677564253664*^9}, {3.815678897451022*^9, 
   3.81567889890127*^9}, {3.815737251069659*^9, 3.815737252615571*^9}, {
   3.815739443078339*^9, 3.815739444308363*^9}, {3.815739671834543*^9, 
   3.8157396731102743`*^9}, {3.815739953758909*^9, 3.815739955086625*^9}, {
   3.815740566040386*^9, 3.8157405674254*^9}, {3.815740842168351*^9, 
   3.8157408434309673`*^9}, {3.8157561659665318`*^9, 3.815756167265707*^9}, {
   3.815756374887006*^9, 3.815756377073597*^9}, {3.815756515911628*^9, 
   3.8157565171351957`*^9}, {3.815756737735828*^9, 3.815756738926825*^9}, {
   3.815756912683874*^9, 3.815756913911806*^9}, {3.815757469064389*^9, 
   3.815757470269689*^9}, {3.815757630011417*^9, 3.815757631247512*^9}, {
   3.815757744588275*^9, 3.815757745825652*^9}, {3.8157579268196487`*^9, 
   3.8157579280766287`*^9}, {3.815758503627808*^9, 3.815758505651224*^9}, {
   3.815759951069396*^9, 3.8157599525816097`*^9}, {3.815807674249057*^9, 
   3.8158076766870537`*^9}, {3.815847828095662*^9, 3.815847829548852*^9}, {
   3.8162725215340357`*^9, 3.8162725234597673`*^9}, {3.816273435435997*^9, 
   3.81627345340125*^9}, {3.816274028516528*^9, 3.816274043579708*^9}, {
   3.8163670906607227`*^9, 3.816367091850955*^9}, {3.816367468619735*^9, 
   3.816367495477517*^9}, {3.816367701699369*^9, 3.8163677031959267`*^9}, {
   3.816432367079183*^9, 3.8164323838896112`*^9}, {3.8164328915901613`*^9, 
   3.816432893005227*^9}, {3.8164343962205753`*^9, 3.816434397633473*^9}, {
   3.816435121718891*^9, 3.816435123624653*^9}, {3.816435249036715*^9, 
   3.816435250418762*^9}, {3.816437183920314*^9, 3.816437185380541*^9}, {
   3.816438117940875*^9, 3.816438119272591*^9}, {3.8164383735169973`*^9, 
   3.816438374968711*^9}, {3.816443562000051*^9, 3.816443563214179*^9}, {
   3.816449988097139*^9, 3.816449989535575*^9}, {3.816450042970334*^9, 
   3.816450045654436*^9}, {3.816450257431624*^9, 3.816450258792823*^9}, {
   3.816520227317438*^9, 3.816520228645235*^9}, {3.816520277389402*^9, 
   3.816520278638133*^9}, {3.821112249707835*^9, 3.821112250080995*^9}, 
   3.821112582543251*^9, {3.821112640247504*^9, 3.8211126405930433`*^9}, {
   3.821113451996977*^9, 3.82111345236275*^9}, {3.821113560549181*^9, 
   3.8211135608787193`*^9}, {3.821113675266879*^9, 3.821113675608714*^9}, {
   3.8211153570217247`*^9, 3.821115357338541*^9}, {3.8211154397035837`*^9, 
   3.821115440069088*^9}, {3.8211155710274563`*^9, 3.821115571371029*^9}, {
   3.821115608859544*^9, 3.8211156092005463`*^9}, {3.82111564475885*^9, 
   3.821115645098463*^9}, 3.8211156991675*^9, {3.821116527316394*^9, 
   3.8211165277569647`*^9}, {3.821180795292364*^9, 3.821180797409871*^9}, {
   3.821181370355523*^9, 3.8211813708822002`*^9}, {3.821181551403751*^9, 
   3.821181551962614*^9}, {3.8211816500452538`*^9, 3.8211816506089163`*^9}, {
   3.8211817676550827`*^9, 3.821181768108694*^9}, {3.821181851984249*^9, 
   3.821181852433671*^9}, {3.821182197093019*^9, 3.821182197665711*^9}, {
   3.82118223545969*^9, 3.821182236030851*^9}, {3.821182291193102*^9, 
   3.821182291769951*^9}, {3.821182448525566*^9, 3.821182449024164*^9}, {
   3.821182547061552*^9, 3.821182547605485*^9}, {3.8211828049957237`*^9, 
   3.821182826757317*^9}, {3.821182892189208*^9, 3.8211828926964893`*^9}, {
   3.821183845862315*^9, 3.821183847395369*^9}, {3.821183933826502*^9, 
   3.8211839343740396`*^9}, {3.8211854061521387`*^9, 3.821185407532626*^9}, {
   3.8211858964256496`*^9, 3.8211858970134993`*^9}, {3.821185999131826*^9, 
   3.821185999630179*^9}, {3.821186523969942*^9, 3.821186524615992*^9}, {
   3.821188198681879*^9, 3.821188199210864*^9}, {3.821188823258931*^9, 
   3.821188823849145*^9}, {3.821189024620713*^9, 3.8211890251032963`*^9}, {
   3.821200360365093*^9, 3.821200360944065*^9}, {3.821252310086668*^9, 
   3.821252310631537*^9}, {3.8212532416689*^9, 3.821253242183234*^9}, {
   3.82125337267426*^9, 3.821253373302656*^9}, {3.821254634997961*^9, 
   3.8212546355020638`*^9}, {3.8212665302934923`*^9, 3.821266530732121*^9}, {
   3.8212697579714823`*^9, 3.821269758414228*^9}, {3.8212699929442377`*^9, 
   3.8212699934482803`*^9}, {3.8212705109738293`*^9, 3.82127051139065*^9}, {
   3.82127071606476*^9, 3.821270716493355*^9}, {3.821857068005432*^9, 
   3.821857068627817*^9}, {3.8218572401832647`*^9, 3.821857240805461*^9}, {
   3.8218573084039717`*^9, 3.8218573089967012`*^9}, {3.821858330501115*^9, 
   3.821858331131778*^9}, {3.821858534935874*^9, 3.8218585356474953`*^9}, {
   3.822466932317127*^9, 3.822466932895274*^9}, {3.8224675520427856`*^9, 
   3.82246755260954*^9}, {3.8224677510568933`*^9, 3.822467751668244*^9}, {
   3.8225734326852207`*^9, 3.822573433248865*^9}, {3.8225735911563883`*^9, 
   3.8225735918282967`*^9}, {3.8225737626166077`*^9, 3.822573763168593*^9}, {
   3.8226459398928633`*^9, 3.822645940595428*^9}, {3.822646091195016*^9, 
   3.8226460917664623`*^9}, {3.822647064773197*^9, 3.822647065318544*^9}, {
   3.822649891837719*^9, 3.8226498924026003`*^9}, {3.822650021367386*^9, 
   3.8226500219418907`*^9}, {3.8226660721475353`*^9, 3.822666072706554*^9}, {
   3.8226808879034033`*^9, 3.822680888438241*^9}, {3.822749717807164*^9, 
   3.8227497184215517`*^9}, {3.822753601589867*^9, 3.822753603794758*^9}, {
   3.8228506612670918`*^9, 3.8228506618657637`*^9}, {3.822851349866352*^9, 
   3.822851350435252*^9}, {3.822917514690033*^9, 3.822917515307673*^9}, {
   3.823069308765279*^9, 3.823069309383881*^9}, {3.823069937456761*^9, 
   3.823069938039647*^9}, {3.82309415279389*^9, 3.823094153360887*^9}, {
   3.8230976482411137`*^9, 3.823097648869668*^9}, {3.823097785189457*^9, 
   3.8230977857830667`*^9}, {3.82325448256987*^9, 3.8232544831089687`*^9}, {
   3.823255262829487*^9, 3.823255263361701*^9}, {3.823266390953486*^9, 
   3.823266391523204*^9}, {3.823277946518187*^9, 3.8232779470809927`*^9}, {
   3.823278051089568*^9, 3.823278051665766*^9}, {3.824029639688756*^9, 
   3.8240296403278646`*^9}, {3.824030013091926*^9, 3.8240300137443542`*^9}, {
   3.8240300589947653`*^9, 3.8240300596216497`*^9}, {3.8240301031511602`*^9, 
   3.824030154846074*^9}, {3.824058518430229*^9, 3.824058519179844*^9}, {
   3.824111756648747*^9, 3.824111757509842*^9}, {3.834569795722715*^9, 
   3.834569798108127*^9}, {3.834570587842065*^9, 3.834570590018589*^9}, {
   3.834571452023732*^9, 3.8345714546669397`*^9}, {3.834571994634906*^9, 
   3.834571996167038*^9}, {3.834573835091826*^9, 3.83457383717579*^9}},
 CellLabel->
  "During evaluation of \
In[422]:=",ExpressionUUID->"54d1ba97-b67a-4de9-a8da-055cf447df98"]
}, Open  ]]
}, Open  ]],

Cell["\<\
Note that symbols in the Global` context cannot be accessed while building \
the package:\
\>", "Text",
 CellChangeTimes->{
  3.811398838880125*^9},ExpressionUUID->"7ed0d2f5-fecf-4f8e-a113-\
8c27c1a30642"],

Cell["Established connection to external executable?", "Text",ExpressionUUID->"dd185764-c883-434c-9958-91e444ac75c0"]
}, Open  ]],

Cell["1.4. Non-standard setup", "Subsubsection",ExpressionUUID->"79488d97-b3e3-4592-80ca-988dc5c7d2e0"],

Cell[CellGroupData[{

Cell["\<\
1.5. Bibliography : A very convenient function for citations from the IntU \
package by Z. Puchala and J. Miszczak\
\>", "Subsubsection",
 CellChangeTimes->{{3.8773519086652412`*^9, 3.8773519284789124`*^9}, 
   3.8773523172024803`*^9},ExpressionUUID->"5ea2d342-01ea-4df4-b0a5-\
293a645dbecd"],

Cell[BoxData[""], "Code",
 CellChangeTimes->{{3.877349810213256*^9, 3.877349912536764*^9}, {
   3.87735003753301*^9, 3.877350082938305*^9}, {3.87735011844862*^9, 
   3.877350139395041*^9}, {3.877350300625148*^9, 3.87735032323037*^9}, {
   3.877350623750205*^9, 3.87735062787372*^9}, {3.8773506733415413`*^9, 
   3.8773506866573143`*^9}, {3.877350739378405*^9, 3.87735074885284*^9}, {
   3.8773510166150417`*^9, 3.8773511268305597`*^9}, {3.877351207029434*^9, 
   3.8773512455227203`*^9}, {3.877351316623003*^9, 3.877351318375655*^9}, {
   3.877351523296645*^9, 3.877351573890324*^9}, {3.877351818115733*^9, 
   3.877351833408434*^9}, {3.8773518634456663`*^9, 3.877351863897801*^9}, {
   3.877351934785186*^9, 3.877351935960299*^9}, 3.877352223941283*^9, {
   3.877356647596435*^9, 3.877356718536227*^9}, {3.8773573258523607`*^9, 
   3.8773573573375587`*^9}, 3.877357492274888*^9, {3.877357597749861*^9, 
   3.8773575979556932`*^9}, {3.877357646080537*^9, 3.87735767114824*^9}, {
   3.877357712576947*^9, 3.877357720473795*^9}, {3.8773579391487713`*^9, 
   3.877357988007656*^9}, {3.877358102702404*^9, 3.877358106595278*^9}, {
   3.877358699551383*^9, 3.877358754368919*^9}, {3.8774119682959347`*^9, 
   3.8774119939688187`*^9}, {3.877413507025004*^9, 3.8774135072449903`*^9}, {
   3.877413970879674*^9, 3.8774140337238817`*^9}, 3.877414065558351*^9, {
   3.877429350594672*^9, 3.8774293904045153`*^9}, {3.877429503932673*^9, 
   3.87742952198742*^9}, {3.877430097561414*^9, 3.8774301226431313`*^9}, {
   3.877433284769821*^9, 3.877433335527855*^9}, {3.877433387548871*^9, 
   3.877433427569605*^9}, {3.877436241732689*^9, 3.8774362420086603`*^9}, {
   3.877436279169744*^9, 3.87743632487202*^9}, {3.877502194707547*^9, 
   3.8775021951316566`*^9}, {3.877505304385603*^9, 3.8775053084847813`*^9}, {
   3.8775064266582212`*^9, 3.877506426875557*^9}, {3.87750646759167*^9, 
   3.877506471538979*^9}, {3.877506515552003*^9, 3.877506530405611*^9}, {
   3.8775067356699*^9, 3.877506737226935*^9}, {3.877513497477474*^9, 
   3.877513552386869*^9}, {3.877516923158649*^9, 3.877516938192651*^9}, {
   3.877517317631542*^9, 3.87751731834205*^9}, {3.8775174338603687`*^9, 
   3.8775174862064466`*^9}, {3.878011522527388*^9, 3.878011532018794*^9}, 
   3.878027032920639*^9, 
   3.88330792433952*^9},ExpressionUUID->"0aa686c6-463d-4687-9c82-\
209c58cf8505"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.6. Usage messages", "Subsubsection",
 CellChangeTimes->{
  3.883307927631575*^9},ExpressionUUID->"d3ebe61c-50f8-4d32-92fb-\
e20e7a505c69"],

Cell["\<\
Here we declare the usage messages. This also creates the variables in the \
public scope.\
\>", "Text",ExpressionUUID->"f5485f81-c10c-4678-b0d8-2ce643e91523"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"**", " ", "VERSIONS"}], " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$Version", "::", "usage"}], "=", 
    "\"\<$Version is a global variable giving the version of the package \
xBrauer in use.\>\""}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8113993458121357`*^9, 3.81139936073293*^9}, {
   3.811399472949978*^9, 3.81139947712604*^9}, {3.8115287916650476`*^9, 
   3.811528792959569*^9}, {3.821109785494095*^9, 3.8211097892695913`*^9}, {
   3.8759550302372704`*^9, 3.87595503395761*^9}, 3.875955701521832*^9, 
   3.87697043845203*^9, {3.8833080946529093`*^9, 
   3.883308099336151*^9}},ExpressionUUID->"dbb93d31-e9de-47de-8b4d-\
989845c68a3c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", "Reserverd", " ", "words", " ", "in", " ", "xBrauer"}], 
  " ", "**)"}]], "Input",
 CellChangeTimes->{{3.812528947037035*^9, 3.812528993297617*^9}, {
   3.8125292655496807`*^9, 3.8125292956676493`*^9}, {3.816436163695923*^9, 
   3.8164361705900173`*^9}, 3.82110979217665*^9},
 CellLabel->
  "In[433]:=",ExpressionUUID->"f7cee69a-2630-46af-9f6b-ae9e5d0502ed"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
    "**"}], "*****)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", 
     "Symplectic"}], " ", 
    RowBox[{
    "Manifold", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**"}]}], "******************)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
    "**"}], "*****)"}], "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SymplecticFormQ", "::", "usage"}], "=", 
     "\"\<SymplecticFormQ[expr] gives True if expr has been registered as a \
symplectic form, and False otherwise\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymplecticFormsOfVBundle", "::", "usage"}], "=", 
     "\"\<SymplecticFormsOfVBundle[vbundle] gives the list of symplectic \
forms that have been defined on the vector bundle vbundle.\>\""}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"VBundleOfSymplecticForm", "::", "usage"}], "=", 
     "\"\<VBundleOfSymplecticForm[symplecticform] gives the vector bundle \
where symplecticform lives.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"$SymplecticForms", "::", "usage"}], "=", 
     "\"\<$SymplecticForms is a global variable storing the list of all \
currently defined symplectic forms.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"DefSymplecticForm", "::", "usage"}], "=", 
     "\"\<DefSymplecticForm[\[Omega][-i1,-i2]] defines the symplectic 2-form \
\[Omega][-i1,-i2] on the manifold with tangent bundle associated with the \
indices -i1 and -i2.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ContractSymplecticForm", "::", "usage"}], "=", 
     "\"\<ContractSymplecticForm[expr,symplecticform] contracts all instances \
of symplecticform (and Inv[symplecticform]) in expr.\n\
ContractSymplecticForm[expr] contracts all instances of the symplectic \
associated to expr in expr.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SeparateSymplecticForm", "::", "usage"}], "=", 
     "\"\<To do.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SymplecticFormOfTensor", "::", "usage"}], "=", 
     "\"\<SymplecticFormOfTensor[tens] returns the symplectic form associated \
to the tensor tens. \nThis symplectic form is used to raised and lowered the \
indices of tens.\nFor a tensor to be associated with a symplectic form \
\[Omega] one should set the option Master-> \[Omega] .\>\""}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**"}]}], "****************)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", 
      "Realisation"}], " ", "of", " ", "the", " ", "Brauer", " ", "alegebra", 
     " ", "as", " ", "operators", " ", "on", " ", "tensors", " ", "and", " ", 
     "action", " ", "on", " ", 
     RowBox[{"tensors", " ", "**", "**", "**", "**", "**", "**", "**", "**"}],
      "*", 
     RowBox[{"**", 
      RowBox[{"*", "**"}]}]}], "*********)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
     "***********)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BrauerToTensor", "::", "usage"}], "=", 
     "\"\<BrauerToTensor[d,metric,inds] transforms a BrauerList d into a \
product of metrics metric where the vertices numbers of d are mapped to the \
indices inds.\nBrauerToTensor[d,metric] is equivalent to \
BrauerToTensor[d,metric,inds] where inds are the first indices of \
IndicesOfVBundle[VBundleOfMetric[metric]]. The Vertex in the upper part of d \
are converted to UpIndex \nand vertex in the lower part are converted to \
DownIndex.\nBrauerToTensor[d] is equivalent to  \
BrauerToTensor[d,First[$Metrics]].\>\""}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**"}]}], "****************)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", " ",
      "Action", " ", "of", " ", "the", " ", "Brauer", " ", "algebra", " ", 
     "on", " ", 
     RowBox[{
     "tensors", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**"}], "*", "*", 
     RowBox[{"**", "**", "**", "**", "**"}]}], "*****)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**"}]}], "****************)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TracePermuteIndices", "::", "usage"}], "=", 
     "\"\<TracePermuteIndices[expr,indices,diagram/bracelet,g] traces and \
permutes the indices of expr given by the list indices (Head List) according\n\
to the element of the Brauer algebra diagram (Head BrauerList) or to the \
conjugacy class bracelet (Head Bracelets) using metric (or symplectic form) \
g. \nIn general diagram/bracelet can be a linear combination of such \
elements.\nNote that the action of a diagram on tensor[indices] with \
TracePermuteIndices correspond to the action of the diagram on indices \
placing diagram above indices. \nThe input g is optionnal. The default value \
is the first metric (or symplectic form) defined in the vector bundle \
associated to the indices.\nIf both a metric and a symplectic form has been \
defined on the vector bundle the priority is given to the metric.\nWhen the \
input is a bracelet (conjugacy class in the Brauer algebra) which size is \
equal to the number of Free indices of expr the result is independent of \
indices which become optionnal.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassTensor", "::", "usage"}], "=", 
     "\"\<ClassTensor[tenslist,bracelet][inds] represents a tensor expression \
where the product of tensors in tenslist is dressed with a conjugacy class \
sum of the Brauer algebra\n with (Head Bracelets).\nMore precisely the result \
of ExpandClassTensor[ClassTensor[tensorlist,bracelet][inds]] is the same as \
TracePermuteIndices[exp,bracelet] where exp is the product of tenslist \n\
dressed with the indices inds.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandClassTensor", "::", "usage"}], "=", 
     "\"\<ExpandClassTensor[ClassTensor[tensorlist,bracelet][inds],g], expand \
a ClassTensor object as a sum of tensors using metric g.\nThe metric input g \
is optional.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ToClassTensor", "::", "usage"}], "=", 
     "\"\<ToClassTensor[tensor,bracelets] dresses tensor with bracelets to \
form a ClassTensor object.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassAction", "::", "usage"}], "=", 
     "\"\<ClassAction[bracelets1,ClassTensor[{tens},bracelets2][inds]] \
multplies bracelets1 with bracelets2 using the ConjugacyClassProduct function \
of the\npackage BrauerAlgebra and returns the associted linear combination of \
ClassTensor.\nThe function can be applied to any linear combination of \
ClassTensor objects.\>\""}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", "**", " ", "Irreducible"}], " ", 
     "decomposition", " ", "of", " ", "a", " ", "tensor", " ", "under", " ", 
     "the", " ", "action", " ", "of", " ", "GL", 
     RowBox[{
      RowBox[{"(", "N", ")"}], " ", "**", "**", "**", "**"}]}], 
    "************************)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*****)"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"CentralYoungProjectorTensor", "::", "usage"}], "=", 
      "\"\<CentralYoungProjectorTensor[\[Mu],g,inds] returns the central \
Young projector.\>\""}], ";"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"CentralYoungProject", "::", "usage"}], "=", "\"\<To do.\>\""}],
      ";"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"YoungSymmetrize", "::", "usage"}], "=", 
      "\"\<YoungSymmetrize[exp,tab,indices] projects exp to the irreducible \
representation space parametrized by the standard tableau tab.\>\""}], ";"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SemiNormalYoungProject", "::", "usage"}], "=", 
     "\"\<SemiNormalYoungProject[exp,tableau,indices] projects exp to the \
irreducible representation space parametrized by the standard tableau \
tab.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GeneralLinearGroup", "::", "usage"}], "=", 
     "\"\<In SymmetricFunctions GeneralLinearGroup is a parameter for \
DimOfIrrep and for BranchingRule.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GLIrreducibleProject", "::", "usage"}], "=", 
     "\"\<GLIrreducibleProject[exp,tableau,indices] projects exp to the \
irreducible space parametrized by tableau.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GLIsotypicProject", "::", "usage"}], "=", 
     "\"\<GLIsotypicProject[exp,\[Mu]] projects exp to the isotypic component \
with respect to the action of GL, parametrized by the partition \[Mu]. \nIn \
other words GLIsotypicProject[exp,\[Mu]] projects exp to the direct sum of \
equivalent irreducible GL-module parametrized by the partition \[Mu].\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GLCentralIrreducibleProject", "::", "usage"}], "=", 
     "\"\<GLCentralIrreducibleProject[exp,\[Mu]] projects exp to the isotypic \
component with respect to the action of GL, parametrized by the partition \
\[Mu]. \nIn other words GLCentralIrreducibleProject[exp,\[Mu]] projects exp \
to the direct sum of equivalent irreducible GL-module parametrized by the \
partition \[Mu].\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GLIrrepsOfTensor", "::", "usage"}], "=", 
     "\"\<GLIrrepsOfTensor[tensor] returns a list of partitions corresponding \
to the irreducible representations of GL (with multiplicities) associated \
with tensor.\n(** Remark on the limitations of this function **)\nThis \
function analyses the symmetry of tensor, but exchange symmetries of n-tuple \
of indices are not taken into account yet. Therefore when a tensor has some \
exchange \nsymmetries (like the metric Riemann tensor) some irreps in the \
list GLIrrepsOfTensor[tensor] may still not be present in tensor. Also, more \
complicated symmetries like Bianchi type \nidenties are not taken into \
account.\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**"}], "*", " ", "Trace", " ", 
     "decomposition", " ", "of", " ", "a", " ", 
     RowBox[{
     "tensor", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
      "**"}]}], "*******************)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*****)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "::", "usage"}], "=", 
     "\"\<(************ The function **************)\n\
TracelessProjectorTensor[n,f,{dim},g,inds] returns the f-traceless projector \
for tensors of order n, dimension of tangent space dim,  using metric g and \
indices inds.\nTracelessProjectorTensor[n,f,g,inds] returns the f-traceless \
projector for tensors of order n using metric g and indices inds with \
dim=DimOfManifold@@DependenciesOfTensor[g].\n\
TracelessProjectorTensor[n,g,inds] returns the traceless projector for \
tensors of order n using metric g and indices inds.\n\
TracelessProjectorTensor[n,f,g], TracelessProjectorTensor[n,g], \
TracelessProjectorTensor[n,\[Mu],g] returns the corresponding traceless \
projectors using the first indices of IndicesOfVBundle[VBundleOfMetric[g]].\n\
TracelessProjectorTensor[n,f], TracelessProjectorTensor[n], \
TracelessProjectorTensor[n,\[Mu]] returns the corresponding traceless \
projectors using the metric First[$Metrics].\n(************* Options \
******************)\nThe function TracelessProjectorTensor has two options : \
Output and SymplecticGroup. Output can take the value Tensor or SymH. The \
Default value is Tensor. SymplecticGroup is a boolean option.\nthe default \
value is False. If SymplecticGroup is set to True TracelessProjectorTensor \
returns the traceless projector for tensors defined on a symplectic manifold. \
The antisymmetric symplectic 2-form \nhas to be defined accordingly for the \
function to work properly. (See the examples in the documentation).\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"GLTracelessProjector", "::", "usage"}], "=", 
    "\"\<GLTracelessProjector[n,\[Mu],g,inds] returns the traceless projector \
for GL(N)-irreducible tensors associated to the integer partition \[Mu], \
using metric g and indices inds.\>\""}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceProjectorTensor", "::", "usage"}], "=", 
     "\"\<TraceProjectorTensor[n,g,inds_List] returns the fmax-trace \
projector for tensors of order n using metric g and indices inds.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProject", "::", "usage"}], "=", 
     "\"\<TracelessProject[exp,f,g] projects exp onto the space of \
f-traceless tensors using metric (or symplectic form) g. \nA f-traceless \
tensors is a tensors such that any f contractions of pairs of indices yield \
zero. TracelessProject[exp,g] projects exp \nonto the space to totally \
traceless tensors. The metric input g is optional.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProject", "::", "usage"}], "=", 
     "\"\<GLTracelessProject[exp,f,\[Mu]] projects exp onto the space of \
f-traceless tensors.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceProject", "::", "usage"}], "=", 
     "\"\<TraceProject[exp] projects exp onto the space of fmax-trace \
tensors. In particular, if exp is a tensor of even order TraceProject[exp] \
projects to the \nspace of scalar invariants.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Dressed", "::", "usage"}], "=", 
     "\"\<In the package BrauerAlgebra Dressed is an option for \
SnTracelessProjector. In the package xBrauer Dressed is an option for \
GLTracelessProjector and GLTracelessProject.\nIt can take the value None or \
CentralYoungProjector. In all cases the default value is None.\>\""}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*****)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", "**", " ", "Irreducible"}], " ", 
     "decomposition", " ", "of", " ", "a", " ", "tensor", " ", "under", " ", 
     "the", " ", "action", " ", "of", " ", "the", " ", "orthogonal", " ", 
     RowBox[{"group", " ", "**"}]}], "***************)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*****)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OIrrepsOfTensor", "::", "usage"}], "=", 
     "\"\<OIrrepsOfTensor[tensor] returns a list of partitions corresponding \
to the irreducible representations of the orthogonal group (with \
multiplicities) \nassociated with tensor.\n(** Remark on the limitations of \
this function **)\nThe list of irreps is obtained by the branching rules from \
GL(N) to O(N) for N large enough. So OIrrepsOfTensor[tensor] has the same \
limitation as GLIrrepsOfTensor[tensor].\nAlso the N-dependant restrictions on \
irreps (when N is small compare to the order of the tensor) are not \
implemented yet.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OIsotypicProject", "::", "usage"}], "=", 
     "\"\<OIsotypicProject[exp,\[Lambda],metric] projects exp to the isotypic \
component parametrized by the partition \[Lambda], with respect to the action \
of O(d). \nIn other words, OIsotypicProject[exp,\[Lambda],metric] projects \
exp on the direct sum of equivalent irreducible tensor representation spaces \
parametrized by a partition \[Lambda], with respect to the\northogonal group. \
Note that metric is optional.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OCentralIrreducibleProject", "::", "usage"}], "=", 
     "\"\<OCentralIrreducibleProject[exp,\[Lambda],metric] projects exp to \
the isotypic component parametrized by the partition \[Lambda], with respect \
to the action of O(d). \nIn other words, OCentralIrreducibleProject[exp,\
\[Lambda],metric] projects exp on the direct sum of equivalent irreducible \
tensor representation spaces parametrized by a partition \[Lambda], with \
respect to the\northogonal group. Note that metric is optional.\>\""}], ";"}],
    "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OIrreducibleProject", "::", "usage"}], "=", 
     "\"\<OIrreducibleProject[exp,path,indices,metric] projects exp to the \
irreducible space parametrized by the Bratteli path of the Brauer\nalgebra \
path. Note that path is a list of integer partitions which has to start by \
the partition {1}. The input metric is optional.\>\""}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
    "*****)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", " ", "Modification"}], " ", "and", " ", "other", " ", 
     "extension", " ", "of", " ", 
     RowBox[{"xTensor", "  ", "**", "**", "**", "**", "**"}]}], 
    "**************************)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**"}], "*", 
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
    "*****)"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Master", "::", "usage"}], "=", 
     "\"\<Master is an option for DefType commands specifying the master \
symbol of the defined symbol. By default, no master is associated.\nIn \
xBrauer Master is an important option for DefTensor. Use Master -> met, or \
Master -> Null. Its default value is Null.\n\
DefTensor[tens[inds],...,Master->g] defines a tensor tens with indices inds \
which can be raised, lowered or contracted with metric (or symplectic form) g \
only. \nDefTensor[tens[inds],M,...,Master->Null] defines a tensor tens with \
indices inds which can be raised, lowered or contracted with the first metric \
(or symplectic form) of the vector bundle associated with the indices inds.\>\
\""}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricOfTensor", "::", "usage"}], "=", 
     "\"\<MetricOfTensor[tens] returns the metric associated to the tensor \
tens. This metric is used to raised and lowered the indices of tens.  \nFor a \
tensor to be associated with a metric g one should set the option Master->g \
(or Master->covdg) at definition time of tensor.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"InducedMetricQ", "::", "usage"}], "=", 
     "\"\<InducedMetricQ[met] returns true if met is the induced metric of \
another metric.\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LeviCivitaQ", "::", "usage"}], "=", 
     "\"\<LeviCivitaQ[covd,g] returns True if covd is the Levi-Civita \
connection associated with g. LeviCivitaQ[covd] returns True if covd is \nthe \
Levi-Civita connection associated with the metric MasterOf[covd] if \
any.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"SafeCanonical", "::", "usage"}], "=", 
     "\"\<SafeCanonical[e] is ToCanonical with the option UseMetricOnVBundle \
-> None\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ConformalTransform", "::", "usage"}], "=", 
     "\"\<ConformalTransform[exp,g,gc] apply the conformal rules from metric \
g to metric gc to exp.\>\""}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TraceFreeQ", "::", "usage"}], "=", 
      "\"\<TraceFreeQ[tensor[inds],met] returns True if the contraction with \
the metric met of any pair of the indices of tensor is zero.\>\""}], ";"}], 
    "*)"}], "\n", "\n"}]}]], "Code",
 CellChangeTimes->{{3.811411244224895*^9, 3.811411266346787*^9}, {
   3.812528973924108*^9, 3.8125289988737593`*^9}, {3.812529038520733*^9, 
   3.812529214581428*^9}, {3.812529256408149*^9, 3.8125292579046783`*^9}, {
   3.81252950480727*^9, 3.812529518163322*^9}, {3.812529877894863*^9, 
   3.812529881331768*^9}, {3.8140806483933783`*^9, 3.814080649910758*^9}, {
   3.8155621158232603`*^9, 3.815562451212317*^9}, {3.8155624821939573`*^9, 
   3.815562578522374*^9}, {3.815562683134302*^9, 3.815562684608164*^9}, {
   3.8155639002480173`*^9, 3.815563999783863*^9}, {3.815664172178513*^9, 
   3.815664187878731*^9}, {3.815664218761105*^9, 3.8156642235225277`*^9}, {
   3.8164245503999662`*^9, 3.8164245586417923`*^9}, {3.81642530280486*^9, 
   3.816425374712946*^9}, {3.8164256879258432`*^9, 3.81642572970548*^9}, {
   3.816425965696835*^9, 3.816426162217507*^9}, {3.816434878030706*^9, 
   3.816434884200262*^9}, 3.816436146107232*^9, {3.8211108765772457`*^9, 
   3.8211109386303377`*^9}, {3.821112359793398*^9, 3.821112371877262*^9}, {
   3.8211124456901712`*^9, 3.8211125737844954`*^9}, {3.821113100429636*^9, 
   3.8211131051093473`*^9}, {3.82111386879729*^9, 3.8211140016274033`*^9}, {
   3.821114856791597*^9, 3.82111489080753*^9}, 3.821115283074871*^9, {
   3.8211814679197073`*^9, 3.821181540385079*^9}, {3.82119395222438*^9, 
   3.8211940396443653`*^9}, {3.82125090599095*^9, 3.8212510632701883`*^9}, {
   3.821855014621529*^9, 3.821855080502225*^9}, {3.821855136803135*^9, 
   3.821855354428439*^9}, {3.821855462008532*^9, 3.8218554989813957`*^9}, {
   3.821857211112255*^9, 3.8218572181629763`*^9}, {3.822573520872538*^9, 
   3.8225735778013277`*^9}, {3.822645341529439*^9, 3.822645441746378*^9}, {
   3.82264596990958*^9, 3.822646078739484*^9}, {3.8232541437680187`*^9, 
   3.823254145967823*^9}, {3.824029610137808*^9, 3.824029622013196*^9}, {
   3.8240296590916023`*^9, 3.824029680992037*^9}, {3.82629575944044*^9, 
   3.826295839220539*^9}, {3.8262968983426723`*^9, 3.8262969013443413`*^9}, {
   3.826305376625477*^9, 3.826305382307782*^9}, {3.8264786479971943`*^9, 
   3.8264787393783693`*^9}, {3.826479320732115*^9, 3.826479331161055*^9}, {
   3.8270533433289003`*^9, 3.827053673356875*^9}, {3.82705389552318*^9, 
   3.82705406779126*^9}, {3.827054249746459*^9, 3.827054328893794*^9}, {
   3.8270543899324503`*^9, 3.8270544623524437`*^9}, {3.827055992271249*^9, 
   3.8270559941056757`*^9}, {3.8270570349575367`*^9, 
   3.8270570367000217`*^9}, {3.827057254865944*^9, 3.827057305844983*^9}, {
   3.8270573678597307`*^9, 3.827057373865809*^9}, {3.8272370892289753`*^9, 
   3.8272371033070507`*^9}, {3.827301939190646*^9, 3.8273020051269693`*^9}, {
   3.827302082871295*^9, 3.8273021220589046`*^9}, {3.827307183699461*^9, 
   3.82730732979537*^9}, {3.82731048700469*^9, 3.827310593611936*^9}, {
   3.827310804382908*^9, 3.82731080878821*^9}, {3.82731119688442*^9, 
   3.8273111986685038`*^9}, {3.827311254728228*^9, 3.827311258777446*^9}, {
   3.827312288254552*^9, 3.827312355289612*^9}, 3.827312421437127*^9, {
   3.827482979660385*^9, 3.827483031854321*^9}, {3.827483283098349*^9, 
   3.827483332508833*^9}, {3.827484360776576*^9, 3.8274844578813457`*^9}, {
   3.827492883479907*^9, 3.827492915314837*^9}, {3.82749306618006*^9, 
   3.8274931047383623`*^9}, {3.827493195148827*^9, 3.8274931989164467`*^9}, {
   3.827567640737681*^9, 3.827567660046955*^9}, {3.82766111070874*^9, 
   3.8276611110717278`*^9}, {3.827672137252687*^9, 3.827672231699806*^9}, {
   3.827672523546824*^9, 3.827672553886588*^9}, {3.8276729841650257`*^9, 
   3.827673040668017*^9}, {3.8276731985443363`*^9, 3.827673280409834*^9}, {
   3.827747908305852*^9, 3.827748127794348*^9}, {3.827748163603119*^9, 
   3.827748255732387*^9}, {3.828011794209468*^9, 3.828011899318369*^9}, {
   3.828021998511148*^9, 3.828022054082737*^9}, {3.828279437389921*^9, 
   3.828279459914598*^9}, {3.8284430238287354`*^9, 3.828443079733171*^9}, {
   3.828444309152709*^9, 3.828444434411891*^9}, {3.828446166015243*^9, 
   3.82844638898311*^9}, {3.828446469985219*^9, 3.828446472588172*^9}, {
   3.82844665682122*^9, 3.828446737836398*^9}, {3.8285176931246862`*^9, 
   3.828517998212682*^9}, {3.8285180325177727`*^9, 3.828518166579113*^9}, {
   3.828518267025038*^9, 3.828518318430255*^9}, {3.828534774154706*^9, 
   3.8285348734506607`*^9}, {3.828535031288807*^9, 3.8285352525314302`*^9}, {
   3.82853533256911*^9, 3.828535499547468*^9}, 3.82853553758008*^9, {
   3.828539315703635*^9, 3.828539353195898*^9}, {3.828539393169013*^9, 
   3.828539395896984*^9}, {3.82868753733736*^9, 3.828687718784278*^9}, {
   3.828690001967074*^9, 3.828690031148232*^9}, {3.828699113636595*^9, 
   3.8286991487251463`*^9}, {3.828699184203994*^9, 3.828699397824873*^9}, {
   3.828727299335107*^9, 3.8287273390094147`*^9}, {3.8293216475831423`*^9, 
   3.829321667635013*^9}, {3.8293217137109833`*^9, 3.829321724858279*^9}, {
   3.829321966156744*^9, 3.829322129578095*^9}, {3.8293231914698353`*^9, 
   3.829323225779307*^9}, {3.8293233070322723`*^9, 3.829323364258157*^9}, {
   3.829323428891356*^9, 3.829323433444359*^9}, {3.829324534550047*^9, 
   3.829324585807378*^9}, {3.8293246183376093`*^9, 3.829324623125184*^9}, {
   3.829417439151823*^9, 3.8294174790409727`*^9}, {3.829417562045663*^9, 
   3.829417564336382*^9}, {3.829417596210644*^9, 3.829417596931716*^9}, {
   3.829417639219747*^9, 3.829417681862756*^9}, {3.829476611170576*^9, 
   3.8294766430654497`*^9}, {3.829476687959743*^9, 3.82947676325716*^9}, {
   3.829476913677412*^9, 3.829476915383059*^9}, {3.829667664154153*^9, 
   3.829667664950595*^9}, {3.829900867646595*^9, 3.829900947318256*^9}, {
   3.829901669011961*^9, 3.829901747690537*^9}, {3.829901779250526*^9, 
   3.829901898051265*^9}, {3.829901946147202*^9, 3.829901947070744*^9}, {
   3.829901995686966*^9, 3.829902107076066*^9}, {3.829902149085918*^9, 
   3.829902164493452*^9}, {3.8299042535724783`*^9, 3.829904280626808*^9}, {
   3.830284414551293*^9, 3.830284430683817*^9}, {3.830678392353409*^9, 
   3.830678450740385*^9}, {3.830681383295561*^9, 3.8306814539582367`*^9}, {
   3.830681485130486*^9, 3.830681573441435*^9}, {3.830684992352597*^9, 
   3.8306850476558237`*^9}, {3.830689733372819*^9, 3.830689733712216*^9}, {
   3.830699951704905*^9, 3.83069995477061*^9}, {3.830787846196084*^9, 
   3.830788153076254*^9}, {3.830847799933593*^9, 3.830847804662764*^9}, {
   3.830920550402528*^9, 3.830920559565022*^9}, 3.831288658537923*^9, {
   3.8315302057767973`*^9, 3.8315302491295977`*^9}, {3.831716352212891*^9, 
   3.8317164146267767`*^9}, {3.8341509429343967`*^9, 3.834150964229342*^9}, {
   3.834569305488308*^9, 3.834569307026869*^9}, {3.834569374298976*^9, 
   3.834569383190668*^9}, {3.834569435140564*^9, 3.834569486289748*^9}, {
   3.8345696554430647`*^9, 3.834569763886229*^9}, {3.834570824586988*^9, 
   3.8345708313839417`*^9}, {3.834573315723926*^9, 3.834573427009411*^9}, {
   3.840007819312489*^9, 3.840008161765839*^9}, {3.841724998677058*^9, 
   3.8417250713182287`*^9}, {3.841725117147813*^9, 3.841725154771467*^9}, {
   3.8417253305726633`*^9, 3.84172536625348*^9}, {3.841725777850936*^9, 
   3.8417258132832623`*^9}, {3.841726423310059*^9, 3.841726469042021*^9}, {
   3.841726510070221*^9, 3.841726600361006*^9}, {3.84172667483274*^9, 
   3.84172675178955*^9}, {3.841726798052896*^9, 3.841726948781137*^9}, {
   3.841735273949594*^9, 3.8417352770498457`*^9}, {3.843628109837846*^9, 
   3.843628114912682*^9}, {3.845438466428401*^9, 3.845438466522257*^9}, {
   3.845438733284033*^9, 3.845438756467767*^9}, {3.8454387969322233`*^9, 
   3.8454387974182377`*^9}, {3.8454388415833*^9, 3.84543886060933*^9}, {
   3.8454390574664297`*^9, 3.8454390591703777`*^9}, {3.8454400469693327`*^9, 
   3.845440063930444*^9}, {3.845443024353269*^9, 3.845443025272773*^9}, {
   3.84544371187682*^9, 3.845443863068033*^9}, {3.8454440078653307`*^9, 
   3.845444008362864*^9}, {3.845445015979599*^9, 3.845445018262165*^9}, 
   3.845445188085641*^9, {3.8454452374611187`*^9, 3.845445253197028*^9}, {
   3.845446320791112*^9, 3.845446329735577*^9}, {3.845457547850172*^9, 
   3.845457593703052*^9}, {3.845457689907324*^9, 3.845457735708709*^9}, {
   3.845457887455783*^9, 3.845457906351131*^9}, {3.845630936962825*^9, 
   3.845630944759131*^9}, {3.847169938579874*^9, 3.8471699390212917`*^9}, 
   3.847170367154869*^9, {3.847170493081656*^9, 3.8471704937137413`*^9}, {
   3.847170549434326*^9, 3.847170556409396*^9}, {3.847170591916073*^9, 
   3.8471706180408993`*^9}, {3.8471706780647583`*^9, 3.847170714088203*^9}, {
   3.8471722212092867`*^9, 3.8471722221459837`*^9}, {3.847172291722681*^9, 
   3.8471722952374372`*^9}, {3.847172357153022*^9, 3.847172358234919*^9}, {
   3.8471725288944693`*^9, 3.847172531671982*^9}, {3.847179968785729*^9, 
   3.847180060958317*^9}, {3.858427966353304*^9, 3.858428009164667*^9}, {
   3.860574774836067*^9, 3.86057480738197*^9}, {3.8613525490844727`*^9, 
   3.861352563503435*^9}, {3.8624779863043547`*^9, 3.8624780605833883`*^9}, 
   3.862478356251728*^9, {3.8624815826796513`*^9, 3.86248174594516*^9}, {
   3.862481838958993*^9, 3.862481933933536*^9}, {3.8624820403524857`*^9, 
   3.862482060446459*^9}, {3.862482600817482*^9, 3.862482696061874*^9}, {
   3.862482733995282*^9, 3.862482734611825*^9}, {3.8631733538216753`*^9, 
   3.8631733604357567`*^9}, {3.86377058884544*^9, 3.863770640965152*^9}, {
   3.86377068460714*^9, 3.863770697270515*^9}, {3.8641551694435797`*^9, 
   3.864155175386354*^9}, {3.865494889051962*^9, 3.865494889654557*^9}, {
   3.865502183891518*^9, 3.8655022063218803`*^9}, {3.865504397938644*^9, 
   3.8655044106464*^9}, {3.865504609127924*^9, 3.865504649206737*^9}, {
   3.8698930280995483`*^9, 3.869893034219276*^9}, {3.870161469000964*^9, 
   3.870161608553975*^9}, {3.870163500962102*^9, 3.870163535536193*^9}, {
   3.870163597604835*^9, 3.870163632240617*^9}, {3.8701636685512037`*^9, 
   3.8701639011712914`*^9}, {3.8701641246475363`*^9, 3.870164137315094*^9}, {
   3.870164420200603*^9, 3.870164428118981*^9}, {3.870169912968622*^9, 
   3.870169959041114*^9}, {3.870496691229519*^9, 3.870496691993648*^9}, {
   3.871123896456452*^9, 3.8711239237314997`*^9}, 3.871141103030211*^9, {
   3.871188163924357*^9, 3.871188199369327*^9}, {3.875176648842082*^9, 
   3.875176649582856*^9}, {3.875176706166402*^9, 3.875176808179784*^9}, {
   3.8751768498708057`*^9, 3.875176859803281*^9}, {3.8751915820042048`*^9, 
   3.875191582492125*^9}, {3.875640242147271*^9, 3.875640257586532*^9}, {
   3.87564028970404*^9, 3.875640300295224*^9}, {3.875651932849773*^9, 
   3.875651965789104*^9}, {3.875652055698556*^9, 3.8756520603937683`*^9}, 
   3.875693661060836*^9, 3.875693796373714*^9, {3.875696724914652*^9, 
   3.8756967423305073`*^9}, {3.875696776556755*^9, 3.875696792318841*^9}, {
   3.875955052129469*^9, 3.8759550706644583`*^9}, {3.8759552097843933`*^9, 
   3.8759552527070913`*^9}, {3.875961706854377*^9, 3.8759617076760683`*^9}, {
   3.875961797957058*^9, 3.8759617985801287`*^9}, {3.8759620895294943`*^9, 
   3.875962097509843*^9}, {3.875982722627022*^9, 3.875982823309987*^9}, {
   3.875982893022667*^9, 3.875982967047729*^9}, {3.87603007273517*^9, 
   3.876030126443412*^9}, {3.876030908716281*^9, 3.876030953356904*^9}, {
   3.876046085770835*^9, 3.8760460876917963`*^9}, {3.8760500317018623`*^9, 
   3.8760500379585667`*^9}, {3.8760505709040327`*^9, 3.876050871163048*^9}, {
   3.876052007594534*^9, 3.876052018028493*^9}, 3.876061548580521*^9, {
   3.876062217237268*^9, 3.876062240187861*^9}, {3.876062526273286*^9, 
   3.8760626491102047`*^9}, {3.876062927804946*^9, 3.876062932393516*^9}, {
   3.87606398170638*^9, 3.876064006018413*^9}, {3.87606441531623*^9, 
   3.87606444192408*^9}, {3.876064497791977*^9, 3.8760645090609922`*^9}, {
   3.876075649781852*^9, 3.876075827351859*^9}, 3.876082237336735*^9, {
   3.8761142977516127`*^9, 3.876114415161015*^9}, {3.8761144840183563`*^9, 
   3.876114518775378*^9}, 3.8761145657405567`*^9, {3.876114625034531*^9, 
   3.876114684428916*^9}, {3.876114745080111*^9, 3.876114751583272*^9}, {
   3.876114871856633*^9, 3.8761149866599627`*^9}, {3.87611501677956*^9, 
   3.876115380293954*^9}, {3.876115471406968*^9, 3.8761155334461317`*^9}, {
   3.876115594519751*^9, 3.8761156160137367`*^9}, 3.876115719368359*^9, {
   3.876115828963965*^9, 3.876115837401539*^9}, {3.876115867936479*^9, 
   3.8761159797104893`*^9}, {3.8761167781222897`*^9, 
   3.8761168702349358`*^9}, {3.876116923639022*^9, 3.8761169291027184`*^9}, {
   3.876117028818578*^9, 3.876117034440559*^9}, 3.8761415263605824`*^9, {
   3.876145374059803*^9, 3.876145394185424*^9}, {3.876192125157351*^9, 
   3.8761921256346684`*^9}, {3.87619703030311*^9, 3.8761970305358562`*^9}, {
   3.8761976058436127`*^9, 3.876197677378006*^9}, {3.876209593044775*^9, 
   3.876209692728339*^9}, {3.8762097335718527`*^9, 3.876209867178505*^9}, {
   3.876212451816526*^9, 3.876212463339068*^9}, {3.876220981077896*^9, 
   3.876221342245998*^9}, {3.8762213883445673`*^9, 3.8762214171008863`*^9}, {
   3.876230232955029*^9, 3.876230359947064*^9}, {3.8762303917529*^9, 
   3.876230432115942*^9}, 3.876230629646285*^9, {3.876233639429851*^9, 
   3.876233649344632*^9}, {3.876233849191791*^9, 3.876233896594355*^9}, {
   3.876234225394631*^9, 3.876234254897257*^9}, 3.8762342863961687`*^9, {
   3.876234326099524*^9, 3.876234326964622*^9}, {3.876234373744974*^9, 
   3.8762345183726177`*^9}, {3.876234561675364*^9, 3.876234583518422*^9}, {
   3.876234661476375*^9, 3.876234675583201*^9}, {3.876234765702145*^9, 
   3.876234778736347*^9}, 3.8762348155055304`*^9, {3.876234856496085*^9, 
   3.876234883311511*^9}, {3.876235035084552*^9, 3.8762350369933767`*^9}, {
   3.8762370709280643`*^9, 3.876237097096529*^9}, {3.876237154159916*^9, 
   3.87623716334798*^9}, {3.876240164720433*^9, 3.876240175905292*^9}, 
   3.87627768172264*^9, {3.876278767724168*^9, 3.8762788047180557`*^9}, {
   3.876278866603508*^9, 3.876278912661162*^9}, {3.8762789683510303`*^9, 
   3.8762790440698977`*^9}, {3.876279112804224*^9, 3.8762791859940643`*^9}, {
   3.876279262332926*^9, 3.876279315909631*^9}, {3.8762793760243464`*^9, 
   3.876279432437402*^9}, {3.876280983763987*^9, 3.8762810541105537`*^9}, {
   3.8762852346057568`*^9, 3.876285252302355*^9}, {3.876285798638084*^9, 
   3.876285824258713*^9}, {3.8762867967844677`*^9, 3.876286965664716*^9}, {
   3.8762919123214893`*^9, 3.876291912721959*^9}, {3.876305727290313*^9, 
   3.876305777128763*^9}, {3.8763060465370817`*^9, 3.876306118697031*^9}, {
   3.876306287749102*^9, 3.8763062903095818`*^9}, {3.876370231582992*^9, 
   3.876370249655189*^9}, {3.876391028593741*^9, 3.876391030908478*^9}, {
   3.876398423151504*^9, 3.876398423615451*^9}, {3.876398457269335*^9, 
   3.87639849216661*^9}, {3.876452831360682*^9, 3.876453223782218*^9}, {
   3.876453336233864*^9, 3.876453369454276*^9}, {3.8764534261287317`*^9, 
   3.876453503398313*^9}, {3.8764551872177067`*^9, 3.8764552384122458`*^9}, 
   3.876455273338826*^9, {3.876456716876021*^9, 3.8764567171767817`*^9}, {
   3.8764573200957203`*^9, 3.876457320428011*^9}, 3.876457863732098*^9, {
   3.8764728944141483`*^9, 3.8764729643269787`*^9}, {3.876473509258287*^9, 
   3.876473719571166*^9}, {3.8764739206344833`*^9, 3.87647394869357*^9}, {
   3.8764913467840223`*^9, 3.876491396571724*^9}, {3.876491632138689*^9, 
   3.876491763989356*^9}, 3.876572186816011*^9, {3.876573441939241*^9, 
   3.876573481544832*^9}, {3.876573512591654*^9, 3.8765736441481457`*^9}, {
   3.876573712784713*^9, 3.8765737481913023`*^9}, {3.8765738165462627`*^9, 
   3.87657391665991*^9}, {3.876575209630519*^9, 3.876575227279908*^9}, {
   3.876575355392228*^9, 3.876575374945805*^9}, {3.876577126712376*^9, 
   3.876577145271962*^9}, {3.87657722312316*^9, 3.8765773042312517`*^9}, {
   3.876578106761519*^9, 3.876578170380199*^9}, {3.876578775729*^9, 
   3.876578792886747*^9}, {3.87657888552459*^9, 3.876578916624164*^9}, {
   3.876578969925972*^9, 3.876578991698224*^9}, {3.8765790348802557`*^9, 
   3.876579035346435*^9}, {3.876579075545869*^9, 3.8765791650602217`*^9}, {
   3.876579200154003*^9, 3.876579203694503*^9}, {3.876625206696636*^9, 
   3.8766252072224703`*^9}, {3.8766252390808897`*^9, 3.876625371421362*^9}, {
   3.876625454431012*^9, 3.876625473586396*^9}, {3.8766336665766153`*^9, 
   3.87663367423271*^9}, {3.8766337535915003`*^9, 3.8766337869437637`*^9}, {
   3.876633829442913*^9, 3.876633867728134*^9}, {3.876650280275532*^9, 
   3.8766503713350067`*^9}, {3.876650551779235*^9, 3.876650668161284*^9}, {
   3.876652722553722*^9, 3.876652739067492*^9}, {3.8766532517621107`*^9, 
   3.876653299095148*^9}, {3.876653396415245*^9, 3.8766535438846703`*^9}, {
   3.8766536029705*^9, 3.876653663124176*^9}, {3.87665371621148*^9, 
   3.876654055777399*^9}, {3.8766540862281017`*^9, 3.87665408722023*^9}, {
   3.8766541195069437`*^9, 3.8766541383479958`*^9}, {3.8766542182227783`*^9, 
   3.876654228824675*^9}, 3.876654261868919*^9, {3.876757918774817*^9, 
   3.876757981740179*^9}, {3.876765033128049*^9, 3.876765045667406*^9}, {
   3.876765178376718*^9, 3.876765181790695*^9}, {3.876765235864964*^9, 
   3.8767652366835337`*^9}, 3.87676528387004*^9, {3.876765406208496*^9, 
   3.876765432258397*^9}, {3.876765485985849*^9, 3.876765662062119*^9}, {
   3.876765822995884*^9, 3.876765887592182*^9}, {3.876765925569606*^9, 
   3.876766009721116*^9}, {3.876766150594862*^9, 3.8767661512424173`*^9}, {
   3.876805091588835*^9, 3.87680517031903*^9}, {3.8768053056256323`*^9, 
   3.876805310779166*^9}, {3.876809192401647*^9, 3.8768091973885193`*^9}, 
   3.876812938556353*^9, 3.876812979728342*^9, {3.87681308863413*^9, 
   3.876813125934342*^9}, {3.876813186762261*^9, 3.876813194749061*^9}, {
   3.876814574478737*^9, 3.876814649935265*^9}, {3.876815252858301*^9, 
   3.87681530293605*^9}, {3.8768156983146133`*^9, 3.876815805769356*^9}, {
   3.876819538444783*^9, 3.876819634555949*^9}, {3.87682594931747*^9, 
   3.8768259567609377`*^9}, {3.876826783595166*^9, 3.876826845932375*^9}, {
   3.876826878965973*^9, 3.876827073864744*^9}, {3.876827117894887*^9, 
   3.876827176645014*^9}, {3.876827216664*^9, 3.876827233847362*^9}, {
   3.876827292634905*^9, 3.8768272955788097`*^9}, {3.876827339119184*^9, 
   3.8768273399890833`*^9}, {3.876827384506569*^9, 3.8768273853191442`*^9}, 
   3.876889496835438*^9, {3.87688984707283*^9, 3.876889917709877*^9}, {
   3.876890431703063*^9, 3.876890438202236*^9}, {3.876890469525507*^9, 
   3.876890534404216*^9}, {3.876890577486073*^9, 3.8768906147964983`*^9}, {
   3.8768908381965017`*^9, 3.8768908730245*^9}, {3.8768909683745003`*^9, 
   3.8768909814700003`*^9}, {3.876891024143877*^9, 3.876891027216271*^9}, {
   3.876891070690405*^9, 3.876891082387628*^9}, {3.876891181757725*^9, 
   3.876891263206581*^9}, {3.876891295624364*^9, 3.8768913122422447`*^9}, {
   3.8768913685453053`*^9, 3.876891411066059*^9}, {3.8768914704649363`*^9, 
   3.8768914850311203`*^9}, {3.876891520984963*^9, 3.876891539631019*^9}, {
   3.876891962360181*^9, 3.876891969184168*^9}, 3.876893698636169*^9, {
   3.876893753281392*^9, 3.876893984178555*^9}, {3.876894066352522*^9, 
   3.876894090819062*^9}, {3.876894162205758*^9, 3.8768941840720778`*^9}, {
   3.876897762931706*^9, 3.876897766842617*^9}, 3.876897935412957*^9, {
   3.876897967425572*^9, 3.876898066305583*^9}, {3.8768985166433477`*^9, 
   3.87689851864835*^9}, {3.876900905296595*^9, 3.876900951261828*^9}, {
   3.8769040256045856`*^9, 3.876904064844697*^9}, {3.876911936619485*^9, 
   3.876911950870316*^9}, {3.876912044617909*^9, 3.876912137652049*^9}, {
   3.876914201226261*^9, 3.876914219813373*^9}, {3.876938539982373*^9, 
   3.8769386043207083`*^9}, {3.8769386385108433`*^9, 3.876938749285101*^9}, {
   3.8769387897765703`*^9, 3.8769388207022943`*^9}, {3.876971657235045*^9, 
   3.8769716577826147`*^9}, {3.876972255498786*^9, 3.876972356035947*^9}, {
   3.87697238831356*^9, 3.876972515953518*^9}, {3.876972919342248*^9, 
   3.876972979191659*^9}, {3.876973009232418*^9, 3.876973071572118*^9}, {
   3.876973340398116*^9, 3.8769733406547623`*^9}, {3.876973421054213*^9, 
   3.876973553471341*^9}, {3.876974306383548*^9, 3.876974726974883*^9}, {
   3.8769747712868977`*^9, 3.876974834674513*^9}, {3.876974903863315*^9, 
   3.876974912586088*^9}, 3.8769749470216217`*^9, {3.876975032870296*^9, 
   3.876975069772113*^9}, {3.8769751070786037`*^9, 3.876975109279436*^9}, {
   3.876978053197967*^9, 3.876978172046236*^9}, {3.876978359811606*^9, 
   3.876978362835609*^9}, {3.876978475477642*^9, 3.8769784756686*^9}, {
   3.876978740441423*^9, 3.876978762320602*^9}, {3.876985497534616*^9, 
   3.876985506292821*^9}, {3.87698808944153*^9, 3.876988166374967*^9}, {
   3.877002289134425*^9, 3.8770023000280333`*^9}, {3.877009560601307*^9, 
   3.877009566122282*^9}, 3.877009614810987*^9, {3.8770123269705343`*^9, 
   3.8770123359839687`*^9}, {3.8770123721866703`*^9, 3.87701247945096*^9}, {
   3.877012551356361*^9, 3.877012569904557*^9}, {3.877104226266551*^9, 
   3.8771042378522873`*^9}, {3.8771045808295307`*^9, 3.87710462819*^9}, {
   3.87710474986383*^9, 3.877104770331626*^9}, {3.8771453516152277`*^9, 
   3.87714535427037*^9}, {3.8771491641906013`*^9, 3.877149189573285*^9}, {
   3.877149220594054*^9, 3.877149315511653*^9}, {3.877149348813822*^9, 
   3.877149384079667*^9}, {3.877149416042303*^9, 3.877149429635242*^9}, {
   3.877149460484326*^9, 3.877149471672756*^9}, {3.8771495034200697`*^9, 
   3.877149594516492*^9}, {3.877149625735921*^9, 3.8771496484511414`*^9}, {
   3.877155019213348*^9, 3.877155031204616*^9}, 3.877347881186941*^9, {
   3.877347981400631*^9, 3.877347998784649*^9}, {3.8773480780420227`*^9, 
   3.87734810177948*^9}, {3.877348287452757*^9, 3.877348288300272*^9}, 
   3.877348449936655*^9, {3.877348498846859*^9, 3.877348516750929*^9}, {
   3.877348583026141*^9, 3.8773485836583147`*^9}, 3.8773486313164873`*^9, {
   3.8773493538513403`*^9, 3.877349672902766*^9}, {3.877349702940254*^9, 
   3.877349714539884*^9}, {3.877349937214542*^9, 3.877349953619233*^9}, {
   3.877350384224134*^9, 3.877350424944562*^9}, {3.877350494891551*^9, 
   3.877350495553035*^9}, {3.877350569690654*^9, 3.877350594371188*^9}, {
   3.877350833563334*^9, 3.877350834167502*^9}, {3.8773509070344343`*^9, 
   3.8773510072215557`*^9}, {3.8773513797101517`*^9, 
   3.8773513967121077`*^9}, {3.877351604191799*^9, 3.8773516782068233`*^9}, 
   3.8773517470810747`*^9, {3.87735328990396*^9, 3.877353326840288*^9}, {
   3.87735336921094*^9, 3.8773534394795237`*^9}, {3.877356434091578*^9, 
   3.877356475461088*^9}, {3.877356544657305*^9, 3.8773565665510817`*^9}, {
   3.8773567491238937`*^9, 3.877356806775309*^9}, {3.8773572616259003`*^9, 
   3.877357316122946*^9}, {3.877357403847754*^9, 3.877357425698462*^9}, {
   3.877357761423931*^9, 3.877357814198955*^9}, {3.8773578471918592`*^9, 
   3.87735785139049*^9}, {3.877358130241765*^9, 3.877358145070486*^9}, {
   3.877358175605372*^9, 3.87735819540621*^9}, {3.877358469557582*^9, 
   3.8773584840723658`*^9}, {3.877358538481188*^9, 3.877358557926703*^9}, {
   3.8773586347561207`*^9, 3.877358683536549*^9}, {3.87735879662799*^9, 
   3.877358894389103*^9}, 3.8773590879272327`*^9, {3.8773591309182377`*^9, 
   3.877359152820615*^9}, {3.8773591862881937`*^9, 3.87735922458302*^9}, {
   3.877359255236195*^9, 3.877359325750098*^9}, {3.877369351964155*^9, 
   3.8773693652805767`*^9}, {3.877370275605439*^9, 3.877370308435441*^9}, {
   3.877370942426165*^9, 3.8773709433794117`*^9}, {3.877404427121305*^9, 
   3.877404457826659*^9}, {3.8774120559018497`*^9, 3.877412127865141*^9}, {
   3.877412179721527*^9, 3.8774122785439672`*^9}, {3.8774126481098557`*^9, 
   3.877412652475213*^9}, {3.8774126870088654`*^9, 3.8774127263625317`*^9}, {
   3.8774127907525587`*^9, 3.8774128572087193`*^9}, {3.87741292111157*^9, 
   3.877412934915598*^9}, {3.877413010441869*^9, 3.87741303804392*^9}, {
   3.8774130737615767`*^9, 3.877413147278943*^9}, {3.877413194309812*^9, 
   3.877413254649992*^9}, {3.877413492037871*^9, 3.877413494980344*^9}, {
   3.877414166388402*^9, 3.877414216036685*^9}, {3.8774302861548347`*^9, 
   3.877430388993805*^9}, {3.877430497190556*^9, 3.877430501105578*^9}, {
   3.8774305823495398`*^9, 3.877430589062482*^9}, {3.877430650010879*^9, 
   3.877430654668282*^9}, {3.877431922203566*^9, 3.87743195892107*^9}, {
   3.877432027654202*^9, 3.877432163705217*^9}, {3.8774322191015167`*^9, 
   3.8774322544314947`*^9}, {3.877433267666532*^9, 3.877433275946739*^9}, {
   3.877433464476544*^9, 3.877433623731659*^9}, {3.877436207622488*^9, 
   3.877436231385622*^9}, {3.8775023225451097`*^9, 3.877502322703144*^9}, {
   3.877502388501236*^9, 3.877502401367467*^9}, {3.8775052872305393`*^9, 
   3.8775053246048*^9}, {3.8775059945766706`*^9, 3.877505997370681*^9}, {
   3.87750627447894*^9, 3.877506417544281*^9}, {3.877513408482082*^9, 
   3.877513420884503*^9}, {3.877513569155036*^9, 3.877513570406555*^9}, {
   3.877513847367754*^9, 3.877513896092575*^9}, {3.8775150034939404`*^9, 
   3.877515019775455*^9}, {3.877515742480442*^9, 3.877515770182438*^9}, {
   3.8775158116489*^9, 3.877515871400208*^9}, {3.877516086488708*^9, 
   3.877516110872196*^9}, {3.877516961828835*^9, 3.877517287534726*^9}, {
   3.8775175699285173`*^9, 3.8775176018130836`*^9}, {3.877519779020323*^9, 
   3.8775198794338093`*^9}, {3.877519909917067*^9, 3.8775202190145903`*^9}, {
   3.87752027691637*^9, 3.877520277405946*^9}, {3.877520321734837*^9, 
   3.87752032402995*^9}, {3.877520733279049*^9, 3.877520798345861*^9}, {
   3.877520859959898*^9, 3.8775208630223093`*^9}, {3.877521468090435*^9, 
   3.877521506136079*^9}, {3.877522000217848*^9, 3.877522153352586*^9}, {
   3.877522343774868*^9, 3.877522353982403*^9}, {3.877609291724678*^9, 
   3.877609297706128*^9}, {3.8779547535816793`*^9, 3.8779547703497553`*^9}, {
   3.878027409012142*^9, 3.878027508827866*^9}, {3.878027546483067*^9, 
   3.8780276115087767`*^9}, {3.878027810445198*^9, 3.878027819842717*^9}, {
   3.878027940747611*^9, 3.878027941393805*^9}, {3.878046251412717*^9, 
   3.878046318553265*^9}, {3.878120902067626*^9, 3.878120914596504*^9}, {
   3.8781210430579453`*^9, 3.878121046274742*^9}, {3.8800110135344763`*^9, 
   3.8800110163208513`*^9}, {3.8816684046233377`*^9, 3.88166888857093*^9}, {
   3.8816689650427713`*^9, 3.88166902729256*^9}, {3.881669074484292*^9, 
   3.8816691320167847`*^9}, {3.881669189171618*^9, 3.881669721368739*^9}, {
   3.881669767206263*^9, 3.881669868249365*^9}, {3.881669964483384*^9, 
   3.881669994293364*^9}, 3.881670237829432*^9, {3.881816665678585*^9, 
   3.881816779228107*^9}, 3.881817519522831*^9, {3.8818283904877*^9, 
   3.8818284103659687`*^9}, {3.882021321077766*^9, 3.8820213867712383`*^9}, {
   3.882079560754345*^9, 3.882079610554694*^9}, 3.882079656849064*^9, {
   3.882161717569933*^9, 3.882161732653545*^9}, {3.8821638701090803`*^9, 
   3.882163933418785*^9}, {3.882267507302514*^9, 3.882267520488789*^9}, {
   3.8823379153209543`*^9, 3.882337925398593*^9}, {3.882337994019744*^9, 
   3.882337999920683*^9}, 3.882339181360443*^9, {3.882339334804597*^9, 
   3.882339335070675*^9}, {3.882339440658927*^9, 3.8823394408479967`*^9}, {
   3.8824433881766987`*^9, 3.882443393067457*^9}, {3.882443428751567*^9, 
   3.882443443541823*^9}, {3.882445716205703*^9, 3.882445721279109*^9}, {
   3.8825272842417173`*^9, 3.882527301416676*^9}, {3.882530826711516*^9, 
   3.882530980785824*^9}, {3.882611229328286*^9, 3.8826112297220583`*^9}, {
   3.88295025021073*^9, 3.8829502763669367`*^9}, {3.8829589682759113`*^9, 
   3.882958980616696*^9}, {3.882964047998486*^9, 3.8829640502216873`*^9}, {
   3.8829640878624496`*^9, 3.8829641672685003`*^9}, {3.883045948428528*^9, 
   3.883045987047948*^9}, {3.883121143590794*^9, 3.8831215130308247`*^9}, {
   3.883121557798338*^9, 3.8831216644402657`*^9}, {3.883123885817843*^9, 
   3.8831240126590967`*^9}, {3.8831240895020657`*^9, 3.883124132422103*^9}, {
   3.883124635124077*^9, 3.8831247224193363`*^9}, {3.8831248013533773`*^9, 
   3.883124887033004*^9}, {3.8831253562679234`*^9, 3.883125399704475*^9}, {
   3.883125449637156*^9, 3.883125518544332*^9}, {3.883128675793556*^9, 
   3.883128690391284*^9}, {3.883128782048052*^9, 3.8831288344270267`*^9}, {
   3.8832356335289803`*^9, 3.8832356337351723`*^9}, {3.883236049316412*^9, 
   3.883236176461706*^9}, {3.883236548870388*^9, 3.883236561298107*^9}, {
   3.883236646086197*^9, 3.883236695310117*^9}, {3.883236734578933*^9, 
   3.883236736432912*^9}, {3.8832373099367456`*^9, 3.8832373103933277`*^9}, 
   3.883237389578747*^9, {3.883293408072361*^9, 3.883293411728203*^9}, {
   3.883293488654978*^9, 3.8832934926974993`*^9}, {3.883293653351301*^9, 
   3.883293722328865*^9}, {3.883294158667371*^9, 3.883294163677627*^9}, {
   3.883295129892123*^9, 3.883295154601593*^9}, {3.883295536974176*^9, 
   3.8832955467819767`*^9}, {3.883301803280032*^9, 3.8833018200815*^9}, {
   3.883301906279047*^9, 3.8833019064850388`*^9}, 3.883301966318872*^9, 
   3.883302188710124*^9, {3.883307113104905*^9, 3.883307118172925*^9}, {
   3.883307816276424*^9, 3.88330781628096*^9}, {3.883307935636324*^9, 
   3.883307936101362*^9}, {3.8833080691881037`*^9, 3.883308077705594*^9}, {
   3.883320895186098*^9, 3.883320920848672*^9}, {3.883469751895069*^9, 
   3.883469752984324*^9}, {3.883469924126952*^9, 3.883469933876112*^9}, {
   3.883470226321312*^9, 3.8834702760126038`*^9}, {3.886591265220179*^9, 
   3.886591265719788*^9}, {3.886593252093519*^9, 3.886593270754496*^9}, {
   3.8865933024151287`*^9, 3.886593315075448*^9}, {3.886594220999199*^9, 
   3.886594255381873*^9}, 3.886594307123435*^9, {3.8865943809765167`*^9, 
   3.886594394067045*^9}, 3.888569628079659*^9, {3.888649906278222*^9, 
   3.888649926432293*^9}, 3.888650450222237*^9, {3.888651155730649*^9, 
   3.888651180928493*^9}, {3.888651234284615*^9, 3.8886512444709473`*^9}, {
   3.888656472283608*^9, 3.8886564789124527`*^9}, {3.888656509630146*^9, 
   3.888656591690971*^9}, {3.891338565087434*^9, 3.891338600618376*^9}, {
   3.891341191120982*^9, 3.8913413311676188`*^9}, {3.891341750377735*^9, 
   3.8913417512552643`*^9}, {3.891506874935788*^9, 3.89150688736646*^9}, {
   3.8915069522720423`*^9, 3.891506998613319*^9}, {3.891511273570448*^9, 
   3.891511397223227*^9}, {3.8915121589441557`*^9, 3.891512260754414*^9}, {
   3.8915123488793287`*^9, 3.891512446495887*^9}, {3.891512485568685*^9, 
   3.8915125093080397`*^9}, {3.891512592689375*^9, 3.8915127562822742`*^9}, {
   3.89151282448641*^9, 3.891512878930524*^9}, {3.891513131600153*^9, 
   3.8915131792158327`*^9}, {3.891513390932269*^9, 3.891513454981103*^9}, {
   3.891583890885981*^9, 3.8915839936554737`*^9}, {3.891584059235806*^9, 
   3.891584098688919*^9}, {3.8915841573922377`*^9, 3.891584170275406*^9}, {
   3.891586683240528*^9, 3.891586984371932*^9}, {3.891587220133523*^9, 
   3.89158733244289*^9}, {3.8915873641299257`*^9, 3.891587492375492*^9}, {
   3.891598555735413*^9, 3.8915987917929564`*^9}, {3.891603807949359*^9, 
   3.891603879447187*^9}, {3.891658210999748*^9, 3.891658277103788*^9}, {
   3.8916584686622963`*^9, 3.891658570857504*^9}, {3.891658632716441*^9, 
   3.89165865901373*^9}, {3.891658906240376*^9, 3.891658907029106*^9}, {
   3.8916610095815563`*^9, 3.891661009995762*^9}, 3.891661242133546*^9, {
   3.8920251629882183`*^9, 3.892025699659649*^9}, {3.892025780233801*^9, 
   3.8920258440751877`*^9}, {3.892031488577652*^9, 3.892031518949679*^9}, {
   3.892031581881378*^9, 3.892031696901099*^9}, {3.892031746853136*^9, 
   3.892031780704464*^9}, {3.892031840438848*^9, 3.892031841181656*^9}, {
   3.892098649247909*^9, 3.892098683662792*^9}, {3.892100439983161*^9, 
   3.89210049406463*^9}, {3.892100550724989*^9, 3.892100581493425*^9}, {
   3.893231777890436*^9, 3.893231788091729*^9}, 3.893391716777914*^9, 
   3.893405485888818*^9, {3.89349612280089*^9, 3.893496123374084*^9}, {
   3.893512222950563*^9, 3.89351222435737*^9}, 3.893514561318058*^9, {
   3.908783506013587*^9, 3.9087836730116043`*^9}, {3.9087837893800993`*^9, 
   3.908783792591692*^9}, {3.908783910655581*^9, 3.9087839726033173`*^9}, {
   3.90878400288516*^9, 3.9087840156334877`*^9}, {3.908784050893033*^9, 
   3.9087841400314302`*^9}, {3.908878871689415*^9, 3.9088788720614777`*^9}, {
   3.9090385863281927`*^9, 
   3.909038653866373*^9}},ExpressionUUID->"cd7bc4de-5cf3-43c2-883e-\
d368e48ba56d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.6. Begin private", "Subsubsection",ExpressionUUID->"2a52b782-39b3-473f-bcd1-7f16b3e843ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[498]:=",ExpressionUUID->"27c8d571-8850-4ed4-b09b-9aed01378bd0"],

Cell[BoxData["\<\"xAct`xBrauer`Private`\"\>"], "Output",
 CellChangeTimes->{{3.834569795779855*^9, 3.834569798360499*^9}, {
  3.834570587900591*^9, 3.8345705903467607`*^9}, {3.8345714520862417`*^9, 
  3.834571454939509*^9}, {3.834571994708253*^9, 3.834571996992008*^9}, {
  3.834573835181713*^9, 3.834573837506715*^9}},
 CellLabel->
  "Out[498]=",ExpressionUUID->"4d0b5ced-e5bd-455a-852d-e495f179839e"]
}, Open  ]],

Cell["The reserved words in version 0.2.0 :", "Text",
 CellChangeTimes->{
  3.862384847869766*^9},ExpressionUUID->"74cc563e-6060-4c8e-9ae9-\
8c48b5ad236e"],

Cell[BoxData[
 RowBox[{"Names", "[", "\"\<xBrauer`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8113975686592493`*^9, 3.811397569974093*^9}, {
   3.827673080370017*^9, 3.827673102684333*^9}, 3.8276731554800797`*^9, 
   3.830678282445074*^9, 3.831626926404344*^9, 3.8759552608421383`*^9, 
   3.875955405517642*^9, 3.875955556802784*^9, 3.876970438758993*^9, 
   3.8833078162829647`*^9, 3.883307963274851*^9, 3.8833080070556307`*^9, 
   3.88330915548109*^9},ExpressionUUID->"567ee559-6583-4c3d-881e-\
1bae3d98d237"],

Cell[CellGroupData[{

Cell[BoxData["$Context"], "Input",
 CellLabel->
  "In[504]:=",ExpressionUUID->"ac08f0cd-558b-4603-bd7d-471ca9756600"],

Cell[BoxData["\<\"xAct`xBrauer`Private`\"\>"], "Output",
 CellChangeTimes->{3.834569798512024*^9, 3.834570590517365*^9, 
  3.834571455122954*^9, 3.834571997240583*^9, 3.834573837708877*^9},
 CellLabel->
  "Out[504]=",ExpressionUUID->"56dfd421-745f-44e2-a7fa-88855b6b5594"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.7. Options management : ", "Subsubsection",
 CellChangeTimes->{{3.876126718420456*^9, 
  3.8761267279229517`*^9}},ExpressionUUID->"69c4fc57-885e-4862-8b73-\
6365eded4ae8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", "**"}], "*", " ", "This", " ", "function", " ", "is", " ", 
     "borrowed", " ", "to", " ", "xCore", " ", 
     RowBox[{"Package", " ", ":", " ", 
      RowBox[{
       StyleBox[
        RowBox[{"Jos\[EAcute]", " ", 
         RowBox[{"M", ".", " ", "Mart\[IAcute]n"}]}],
        FontSize->12], 
       StyleBox["-",
        FontSize->12], 
       RowBox[{
        StyleBox["Garc\[IAcute]a",
         FontSize->12], 
        StyleBox["\n",
         FontSize->18], 
        RowBox[{
         RowBox[{"jose", "@", "xact"}], ".", "es"}], "\n", 
        RowBox[{"(", "c", ")"}], " ", "2007"}], "-", "2020"}]}]}], ",", 
    RowBox[{"under", " ", "GPL"}]}], " ", "****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CheckOptions", "[", "]"}], ":=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CheckOptions", "[", "opts__", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionQ", "[", 
         RowBox[{"{", "opts", "}"}], "]"}], "&&", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"ArrayDepth", "[", 
           RowBox[{"{", "opts", "}"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Throw", "[", 
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CheckOptions", "::", "invalid"}], ",", "opts", ",", 
          "\"\<option or list of options\>\""}], "]"}], "]"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"Protect", "[", "CheckOptions", "]"}], ";"}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.876126733237195*^9, 3.8761268048058453`*^9}, {
  3.8780257625276814`*^9, 
  3.878025765249695*^9}},ExpressionUUID->"d9292542-253c-4bbe-b926-\
4efdd5b15903"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["1. Symplectic manifold ",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.8825310417450027`*^9, 3.882531046659555*^9}, 
   3.883308028457999*^9},ExpressionUUID->"49ad5304-c6ae-45fe-963b-\
12af745782ae"],

Cell[CellGroupData[{

Cell["1.1. Definition of the Symplectic form ", "Subsection",
 CellChangeTimes->{{3.8823430481638927`*^9, 3.882343055753886*^9}, {
  3.882531071677947*^9, 3.8825310925552073`*^9}, {3.891510885699407*^9, 
  3.891510885994008*^9}},ExpressionUUID->"fcaaf38c-7f0a-4ec4-baa8-\
f43491c6c1b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Inv", "[", 
   RowBox[{"symplecticform_", "?", "SymplecticFormQ"}], "]"}], ":=", 
  RowBox[{"GiveSymbol", "[", 
   RowBox[{"Inv", ",", "symplecticform"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$SymplecticForms", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticFormsOfVBundle", "[", 
    RowBox[{"-", "vbundle_"}], "]"}], ":=", 
   RowBox[{"SymplecticFormsOfVBundle", "[", "vbundle", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymplecticFormQ", "[", "_", "]"}], ":=", "False"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882343012199188*^9, 3.882343029492008*^9}, {
   3.882343130800949*^9, 3.882343143091638*^9}, {3.8824456678426447`*^9, 
   3.882445668271332*^9}, {3.882445825084648*^9, 3.8824458314122477`*^9}, {
   3.882445887599715*^9, 3.882445888792252*^9}, {3.882446768596236*^9, 
   3.88244677108972*^9}, 3.882446976237714*^9, {3.8824495753906593`*^9, 
   3.8824495916391487`*^9}, 3.882531098838182*^9, 3.882532833430654*^9, {
   3.882730805660754*^9, 
   3.88273082797718*^9}},ExpressionUUID->"939668d6-9260-4dcc-85fc-\
6061f8f50a9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xTension", "[", 
    RowBox[{
    "\"\<xBrauer`xTensor`\>\"", ",", "DefVBundle", ",", "\"\<End\>\""}], 
    "]"}], ":=", "xBrauerxTensorDefVBundle"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xBrauerxTensorDefVBundle", "[", 
    RowBox[{
    "vbundle_", ",", "manifold_", ",", "dimF_", ",", "indices_", ",", 
     "options___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SymplecticFormsOfVBundle", "[", "vbundle", "]"}], "^=", 
    RowBox[{"{", "}"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882531105218143*^9, 
  3.882531105367161*^9}},ExpressionUUID->"5f18c2ea-6fcc-4be2-a115-\
64ff6f2e6e67"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DefSymplecticForm", "::", "dimension"}], "=", 
   "\"\<A symplectic form can not be defined on `1` because its dimension is \
not even.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "DefSymplecticForm", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"PrintAs", "\[Rule]", "Identity"}], ",", 
    RowBox[{"ConformalTo", "\[Rule]", "Null"}], ",", 
    RowBox[{"OtherDependencies", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"WeightedWithBasis", "\[Rule]", "Null"}], ",", 
    RowBox[{"Master", "\[Rule]", "Null"}], ",", 
    RowBox[{"ProtectNewSymbol", "->", "$ProtectNewSymbols"}], ",", 
    RowBox[{"DefInfo", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefSymplecticForm", "[", 
   RowBox[{
    RowBox[{"symplecticform_", "[", 
     RowBox[{
      RowBox[{"-", "ind1_"}], ",", 
      RowBox[{"-", "ind2_"}]}], "]"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Catch", "[", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vbundle", "=", 
       RowBox[{"VBundleOfIndex", "[", "ind1", "]"}]}], "}"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "confto", ",", "odeps", ",", "wwb", ",", "pns", ",", "info", ",", 
         "dim", ",", "integerdimQ", ",", "firstQ", ",", "invertQ"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "confto", ",", "odeps", ",", "wwb", ",", "pns", ",", "info"}], 
          "}"}], "=", 
         RowBox[{"OptionValue", "[", 
          RowBox[{
           RowBox[{"{", "DefSymplecticForm", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "ConformalTo", ",", "OtherDependencies", ",", "WeightedWithBasis",
              ",", "ProtectNewSymbol", ",", "DefInfo"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"dim", "=", 
         RowBox[{"DimOfVBundle", "[", "vbundle", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"integerdimQ", "=", 
         RowBox[{"IntegerQ", "[", "dim", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"firstQ", "=", 
         RowBox[{
          RowBox[{"SymplecticFormsOfVBundle", "[", "vbundle", "]"}], "===", 
          RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"manifold", "=", 
             RowBox[{"BaseOfVBundle", "[", "vbundle", "]"}]}], ",", 
            RowBox[{"deps", "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"BaseOfVBundle", "[", "vbundle", "]"}], "}"}], 
              "\[Union]", "odeps"}]}], ",", 
            RowBox[{"vbQ", "=", 
             RowBox[{
             "xAct`xTensor`Private`VBundleIndexQ", "[", "vbundle", "]"}]}], 
            ",", 
            RowBox[{"vbpmQ", "=", 
             RowBox[{
             "xAct`xTensor`Private`VBundleIndexPMQ", "[", "vbundle", "]"}]}], 
            ",", 
            RowBox[{"invsymplecticform", "=", 
             RowBox[{"GiveSymbol", "[", 
              RowBox[{"Inv", ",", "symplecticform"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IntegerQ", "[", "dim", "]"}], "&&", 
              RowBox[{"OddQ", "[", "dim", "]"}]}], ",", 
             RowBox[{"Throw", "@", 
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"DefSymplecticForm", "::", "dimension"}], ",", 
                "manifold"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Off", "[", 
            StyleBox[
             RowBox[{"OptionValue", "::", "nodef"}], "MessageName"], "]"}], 
           ";", 
           RowBox[{"DefTensor", "[", 
            RowBox[{
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "ind1"}], ",", 
               RowBox[{"-", "ind2"}]}], "]"}], ",", "deps", ",", 
             RowBox[{"Antisymmetric", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
             RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
             RowBox[{"DefInfo", "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"info", "===", "False"}], ",", "False", ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<symplectic form\>\"", ",", "\"\<\>\""}], 
                 "}"}]}], "]"}]}], ",", "options"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"MakexTensions", "[", 
            RowBox[{"DefSymplecticForm", ",", "\"\<Beginning\>\"", ",", 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "ind1"}], ",", 
               RowBox[{"-", "ind2"}]}], "]"}], ",", "options"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendToUnevaluated", "[", 
            RowBox[{"$SymplecticForms", ",", "symplecticform"}], "]"}], ";", 
           RowBox[{
            RowBox[{"SymplecticFormQ", "[", "symplecticform", "]"}], "^=", 
            "True"}], ";", 
           RowBox[{
            RowBox[{"VBundleOfSymplecticForm", "[", "symplecticform", "]"}], "^=",
             "vbundle"}], ";", 
           RowBox[{"xUpAppendTo", "[", 
            RowBox[{
             RowBox[{"SymplecticFormsOfVBundle", "[", "vbundle", "]"}], ",", 
             "symplecticform"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"InducedFrom", "[", "symplecticform", "]"}], "^=", 
            "Null"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"**", "**", " ", "Definition"}], " ", "of", " ", 
             "inverse", " ", "metric"}], " ", "******)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"DefTensor", "[", 
            RowBox[{
             RowBox[{"invsymplecticform", "[", 
              RowBox[{"ind1", ",", "ind2"}], "]"}], ",", "deps", ",", 
             RowBox[{"Antisymmetric", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
             RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
             RowBox[{"Master", "\[Rule]", "symplecticform"}], ",", 
             RowBox[{"DefInfo", "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"info", "===", "False"}], ",", "False", ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<inverse symplectic form\>\"", ",", "\"\<\>\""}],
                  "}"}]}], "]"}]}], ",", 
             RowBox[{"PrintAs", "\[RuleDelayed]", 
              RowBox[{"GiveOutputString", "[", 
               RowBox[{"Inv", ",", "symplecticform"}], "]"}]}], ",", 
             "options"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"**", "**", "**", "**", " ", "Convention"}], " ", "for", 
             " ", "inverse", " ", "symplectic", " ", "form", " ", "and", " ", 
             "tensor", " ", "contraction"}], " ", "***)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{
             RowBox[{"invsymplecticform", "[", 
              RowBox[{"i1_Symbol", ",", "i2_Symbol"}], "]"}], 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "i1_Symbol"}], ",", 
               RowBox[{"-", "i3_Symbol"}]}], "]"}]}], ":=", 
            RowBox[{"-", 
             RowBox[{"delta", "[", 
              RowBox[{
               RowBox[{"-", "i3"}], ",", "i2"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{
             RowBox[{"invsymplecticform", "[", 
              RowBox[{"i2_Symbol", ",", "i1_Symbol"}], "]"}], 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "i1_Symbol"}], ",", 
               RowBox[{"-", "i3_Symbol"}]}], "]"}]}], ":=", 
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", "i3"}], ",", "i2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{
             RowBox[{"invsymplecticform", "[", 
              RowBox[{"i2_Symbol", ",", "i1_Symbol"}], "]"}], 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "i3_Symbol"}], ",", 
               RowBox[{"-", "i1_Symbol"}]}], "]"}]}], ":=", 
            RowBox[{"-", 
             RowBox[{"delta", "[", 
              RowBox[{
               RowBox[{"-", "i3"}], ",", "i2"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{
             RowBox[{"invsymplecticform", "[", 
              RowBox[{"i1_Symbol", ",", "i2_Symbol"}], "]"}], 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "i3_Symbol"}], ",", 
               RowBox[{"-", "i1_Symbol"}]}], "]"}]}], ":=", 
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", "i3"}], ",", "i2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Unprotect", "[", "delta", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"delta", "/:", 
            RowBox[{"delta", "[", 
             RowBox[{"i1_Symbol", ",", "i2_Symbol"}], "]"}], ":=", 
            RowBox[{"invsymplecticform", "[", 
             RowBox[{"i1", ",", "i2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"delta", "/:", 
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", "i1_Symbol"}], ",", 
              RowBox[{"-", "i2_Symbol"}]}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "i1"}], ",", 
               RowBox[{"-", "i2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"delta", "/:", 
            RowBox[{"delta", "[", 
             RowBox[{"i1_Symbol", ",", 
              RowBox[{"-", "i1_Symbol"}]}], "]"}], ":=", 
            RowBox[{"-", "dim"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"delta", "/:", 
            RowBox[{"delta", "[", 
             RowBox[{"i1_Symbol", ",", 
              RowBox[{"-", "i2_Symbol"}]}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"delta", "[", 
              RowBox[{
               RowBox[{"-", "i2"}], ",", "i1"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Protect", "[", "delta", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{"symplecticform", "[", 
             RowBox[{"i1_Symbol", ",", "i2_Symbol"}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"invsymplecticform", "[", 
              RowBox[{"i1", ",", " ", "i2"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invsymplecticform", "/:", 
            RowBox[{"invsymplecticform", "[", 
             RowBox[{
              RowBox[{"-", "i1_Symbol"}], ",", 
              RowBox[{"-", "i2_Symbol"}]}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "i1"}], ",", 
               RowBox[{"-", "i2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{"symplecticform", "[", 
             RowBox[{"i1_Symbol", ",", 
              RowBox[{"-", "i2_Symbol"}]}], "]"}], ":=", 
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", "i2"}], ",", "i1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"symplecticform", "/:", 
            RowBox[{"symplecticform", "[", 
             RowBox[{
              RowBox[{"-", "i1_Symbol"}], ",", "i2_Symbol"}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"delta", "[", 
              RowBox[{
               RowBox[{"-", "i1"}], ",", "i2"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invsymplecticform", "/:", 
            RowBox[{"invsymplecticform", "[", 
             RowBox[{"i1_Symbol", ",", 
              RowBox[{"-", "i2_Symbol"}]}], "]"}], ":=", 
            RowBox[{"-", 
             RowBox[{"delta", "[", 
              RowBox[{
               RowBox[{"-", "i2"}], ",", "i1"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invsymplecticform", "/:", 
            RowBox[{"invsymplecticform", "[", 
             RowBox[{
              RowBox[{"-", "i1_Symbol"}], ",", "i2_Symbol"}], "]"}], ":=", 
            RowBox[{"delta", "[", 
             RowBox[{
              RowBox[{"-", "i1"}], ",", "i2"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"**", 
             RowBox[{"*", " ", "Conformal", " ", "symplectic", " ", 
              RowBox[{"forms", " ", ":", " ", 
               RowBox[{"To", " ", "do"}]}]}]}], " ", "****)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"confto", "=!=", "Null"}], ",", 
               RowBox[{"SetConformalTo", "[", 
                RowBox[{
                 RowBox[{"symplecticform", "[", 
                  RowBox[{
                   RowBox[{"-", "ind1"}], ",", 
                   RowBox[{"-", "ind2"}]}], "]"}], ",", "confto"}], "]"}]}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"MakexTensions", "[", 
            RowBox[{"DefSymplecticForm", ",", "\"\<End\>\"", ",", 
             RowBox[{"symplecticform", "[", 
              RowBox[{
               RowBox[{"-", "ind1"}], ",", 
               RowBox[{"-", "ind2"}]}], "]"}], ",", "options"}], "]"}], ";", 
           RowBox[{"On", "[", 
            StyleBox[
             RowBox[{"OptionValue", "::", "nodef"}], "MessageName"], "]"}], 
           ";", 
           RowBox[{"If", "[", 
            RowBox[{"pns", ",", 
             RowBox[{"Protect", "[", "symplecticform", "]"}]}], "]"}], 
           ";"}]}], "]"}]}]}], "]"}]}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882522699450354*^9, 3.882522767953212*^9}, {
   3.882522836420066*^9, 3.882522878772101*^9}, 3.8825229588498383`*^9, {
   3.882522993003956*^9, 3.8825230169462757`*^9}, {3.8825230766032267`*^9, 
   3.8825232414398603`*^9}, 3.882523364280939*^9, {3.882523397347843*^9, 
   3.882523424217318*^9}, {3.882523498534967*^9, 3.882523675263164*^9}, {
   3.882523734414958*^9, 3.882523797301827*^9}, {3.882523943254362*^9, 
   3.882523983541901*^9}, {3.88252401970263*^9, 3.882524094905519*^9}, {
   3.882524126709235*^9, 3.88252417267829*^9}, {3.8825242612924633`*^9, 
   3.882524293386372*^9}, {3.882524327086537*^9, 3.8825244053926477`*^9}, {
   3.882524436067025*^9, 3.882524442781742*^9}, {3.882525956614147*^9, 
   3.8825261063699207`*^9}, {3.8825263278216057`*^9, 3.882526364272769*^9}, {
   3.8825295346468267`*^9, 3.882529591893355*^9}, {3.8825296688187723`*^9, 
   3.8825297447363234`*^9}, {3.882529786411129*^9, 3.8825298547017717`*^9}, {
   3.882529943122694*^9, 3.882530016966175*^9}, {3.882530083930522*^9, 
   3.882530384887508*^9}, {3.882530448457851*^9, 3.882530484556069*^9}, {
   3.8825306218464823`*^9, 3.882530626074737*^9}, 3.8825311175441637`*^9, 
   3.8825332939767838`*^9, {3.892032031276165*^9, 3.892032059219879*^9}, {
   3.8920321009867477`*^9, 
   3.89203225890232*^9}},ExpressionUUID->"71cad961-0c0a-41a6-a17b-\
fd58a305046f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", "**", " ", "Private"}], " ", "function", " ", 
   "BilinearFormsOfVBundle"}], " ", "*****)"}]], "Input",
 CellChangeTimes->{{3.882782988942745*^9, 3.8827830344963703`*^9}, {
  3.882783254867179*^9, 3.882783259699497*^9}, {3.882784976445002*^9, 
  3.882784977302956*^9}},ExpressionUUID->"034e5f8a-8b44-4064-a9a5-\
c62d82fe4813"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BilinearFormsOfVBundle", "[", "vbundle_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"MetricsOfVBundle", "[", "vbundle", "]"}], ",", 
    RowBox[{"SymplecticFormsOfVBundle", "[", "vbundle", "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882783015101182*^9, 3.882783075007337*^9}, {
  3.882783347723606*^9, 3.88278337788407*^9}, {3.88278494362645*^9, 
  3.882784945930723*^9}},ExpressionUUID->"4c3de466-488e-4fa4-ad77-\
ee00155e7f14"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", " ", "Symplectic"}], " ", "form", " ", "associated", " ", 
   "with", " ", "a", " ", "tensor"}], " ", "****)"}]], "Input",
 CellChangeTimes->{{3.882730837376577*^9, 
  3.882730846340816*^9}},ExpressionUUID->"6dce5872-5ef8-4377-bf9e-\
7358de761e7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticFormOfTensor", "[", 
    RowBox[{"met_", "?", "SymplecticFormQ"}], "]"}], ":=", "met"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticFormOfTensor", "[", "delta", "]"}], ":=", "Null"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticFormOfTensor", "[", 
    RowBox[{"tensor_", "?", "xTensorQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MasterOf", "[", "tensor", "]"}], "===", "Null"}], ",", "Null", 
     ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SymplecticFormQ", "[", 
        RowBox[{"MasterOf", "[", "tensor", "]"}], "]"}], ",", 
       RowBox[{"MasterOf", "[", "tensor", "]"}], ",", "Null"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticFormOfTensor", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds__", "]"}], "]"}], ":=", 
   
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"symplecticform", "=", 
       RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"symplecticform", "===", "Null"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"symplecticforms", "=", 
           RowBox[{"SymplecticFormsOfVBundle", "[", 
            RowBox[{"VBundleOfIndex", "[", 
             RowBox[{
              RowBox[{"{", "inds", "}"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"symplecticforms", "===", 
            RowBox[{"{", "}"}]}], ",", "Null", ",", 
           RowBox[{"symplecticforms", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
       "symplecticform"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SymplecticFormOfTensor", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "]"}], "]"}], ":=", "All"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841218310144376*^9, 3.841218314054572*^9}, {
   3.8412186005920067`*^9, 3.841218604897525*^9}, {3.841218641408883*^9, 
   3.841218644728931*^9}, {3.841218741075693*^9, 3.841218899169948*^9}, {
   3.841218962769034*^9, 3.841218997184019*^9}, {3.841219037449135*^9, 
   3.841219042615219*^9}, 3.84121938578612*^9, {3.841219492340589*^9, 
   3.841219504656919*^9}, 3.8412195450377293`*^9, {3.841219686873102*^9, 
   3.841219732053059*^9}, {3.841219780470356*^9, 3.841219782922393*^9}, {
   3.841219850249539*^9, 3.841219854597796*^9}, {3.8412199223956213`*^9, 
   3.841219979458324*^9}, {3.841220049754116*^9, 3.841220099499708*^9}, {
   3.841220151007297*^9, 3.8412201734921207`*^9}, 3.8412230409342747`*^9, {
   3.84329436738523*^9, 3.843294374454771*^9}, {3.843294512366366*^9, 
   3.84329451839563*^9}, {3.8437282096243963`*^9, 3.843728246723928*^9}, 
   3.843728617345364*^9, {3.843834378083775*^9, 3.843834404135304*^9}, {
   3.843834523012226*^9, 3.8438345248586493`*^9}, {3.843834590881794*^9, 
   3.843834619531825*^9}, {3.8438346577992153`*^9, 3.843834658444972*^9}, {
   3.843893711045781*^9, 3.843893717672785*^9}, 3.8438937673942757`*^9, {
   3.84389380150327*^9, 3.843893869229273*^9}, {3.843893907744432*^9, 
   3.843893982158142*^9}, 3.843900630903598*^9, {3.8439010153931932`*^9, 
   3.843901016049268*^9}, {3.8439077779257727`*^9, 3.843907778616169*^9}, {
   3.847964659341981*^9, 3.8479647077986403`*^9}, {3.882441092256486*^9, 
   3.88244118759262*^9}, {3.882614512021326*^9, 3.882614565519268*^9}, {
   3.882620129048897*^9, 3.8826201296619253`*^9}, 3.882779992869033*^9, {
   3.882780064081249*^9, 3.8827802376074142`*^9}, {3.882780309224453*^9, 
   3.882780310625203*^9}, {3.8827803848214808`*^9, 3.882780431262691*^9}, {
   3.88278051721486*^9, 3.882780520104533*^9}, 3.882780559736521*^9, 
   3.882780626994357*^9, 
   3.8827807022974873`*^9},ExpressionUUID->"1d1c0187-2210-481e-a8eb-\
ce2b0af45ff3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", "**"}], "*", "Metric", " ", "associated", " ", "to", " ", 
   "a", " ", "tensor"}], " ", "*******)"}]], "Input",
 CellChangeTimes->{{3.882779600888194*^9, 
  3.882779608646686*^9}},ExpressionUUID->"a9869aea-6d88-4767-85b9-\
fff09516c9d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "MasterOf", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetNumberOfArguments", "[", 
  RowBox[{"MasterOf", ",", "1", ",", "2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MasterOf", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"num_", "?", "IntegerQ"}]}], "]"}], ":=", 
   RowBox[{"Nest", "[", 
    RowBox[{"MasterOf", ",", "tensor", ",", "num"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "MasterOf", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841216801705154*^9, 3.8412168865060167`*^9}, {
  3.841216919344204*^9, 3.841216942592596*^9}, {3.8412170498845367`*^9, 
  3.841217050533803*^9}, {3.841217094562562*^9, 3.841217095808972*^9}, {
  3.841217219754689*^9, 
  3.841217246417746*^9}},ExpressionUUID->"cc6d0207-e86f-4b22-86e4-\
a719057b80d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MetricOfTensor", "[", 
    RowBox[{"met_", "?", "MetricQ"}], "]"}], ":=", "met"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricOfTensor", "[", "delta", "]"}], ":=", "Null"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricOfTensor", "[", 
    RowBox[{"tensor_", "?", "xTensorQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MasterOf", "[", "tensor", "]"}], "===", "Null"}], ",", "Null", 
     ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MetricQ", "[", 
        RowBox[{"MasterOf", "[", "tensor", "]"}], "]"}], ",", 
       RowBox[{"MasterOf", "[", "tensor", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"CovDQ", "[", 
           RowBox[{"MasterOf", "[", "tensor", "]"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"MasterOf", "[", 
            RowBox[{"tensor", ",", "2"}], "]"}], "===", "Null"}]}], ",", 
         RowBox[{"$Metrics", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CovDQ", "[", 
             RowBox[{"MasterOf", "[", "tensor", "]"}], "]"}], "&&", 
            RowBox[{"MetricQ", "[", 
             RowBox[{"MasterOf", "[", 
              RowBox[{"tensor", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"MasterOf", "[", 
            RowBox[{"tensor", ",", "2"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricOfTensor", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds__", "]"}], "]"}], ":=", 
   
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"metric", "=", 
       RowBox[{"MetricOfTensor", "[", "tensor", "]"}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"metric", "===", "Null"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mets", "=", 
           RowBox[{"MetricsOfVBundle", "[", 
            RowBox[{"VBundleOfIndex", "[", 
             RowBox[{
              RowBox[{"{", "inds", "}"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"mets", "===", 
            RowBox[{"{", "}"}]}], ",", "Null", ",", 
           RowBox[{"mets", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", "metric"}],
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MetricOfTensor", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "]"}], "]"}], ":=", "All"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841218310144376*^9, 3.841218314054572*^9}, {
   3.8412186005920067`*^9, 3.841218604897525*^9}, {3.841218641408883*^9, 
   3.841218644728931*^9}, {3.841218741075693*^9, 3.841218899169948*^9}, {
   3.841218962769034*^9, 3.841218997184019*^9}, {3.841219037449135*^9, 
   3.841219042615219*^9}, 3.84121938578612*^9, {3.841219492340589*^9, 
   3.841219504656919*^9}, 3.8412195450377293`*^9, {3.841219686873102*^9, 
   3.841219732053059*^9}, {3.841219780470356*^9, 3.841219782922393*^9}, {
   3.841219850249539*^9, 3.841219854597796*^9}, {3.8412199223956213`*^9, 
   3.841219979458324*^9}, {3.841220049754116*^9, 3.841220099499708*^9}, {
   3.841220151007297*^9, 3.8412201734921207`*^9}, 3.8412230409342747`*^9, {
   3.84329436738523*^9, 3.843294374454771*^9}, {3.843294512366366*^9, 
   3.84329451839563*^9}, {3.8437282096243963`*^9, 3.843728246723928*^9}, 
   3.843728617345364*^9, {3.843834378083775*^9, 3.843834404135304*^9}, {
   3.843834523012226*^9, 3.8438345248586493`*^9}, {3.843834590881794*^9, 
   3.843834619531825*^9}, {3.8438346577992153`*^9, 3.843834658444972*^9}, {
   3.843893711045781*^9, 3.843893717672785*^9}, 3.8438937673942757`*^9, {
   3.84389380150327*^9, 3.843893869229273*^9}, {3.843893907744432*^9, 
   3.843893982158142*^9}, 3.843900630903598*^9, {3.8439010153931932`*^9, 
   3.843901016049268*^9}, {3.8439077779257727`*^9, 3.843907778616169*^9}, {
   3.847964659341981*^9, 3.8479647077986403`*^9}, {3.8827797449891243`*^9, 
   3.882779807715591*^9}, {3.882779838624652*^9, 3.8827798788512983`*^9}, {
   3.882779911502297*^9, 3.882779932967819*^9}, {3.8827800319276533`*^9, 
   3.8827800340042686`*^9}, {3.882780118812209*^9, 3.882780119296921*^9}, {
   3.882780251633603*^9, 3.882780381395583*^9}, {3.8827805071384*^9, 
   3.8827805116913157`*^9}, 3.882780562006175*^9, 3.882780624518135*^9, {
   3.8827806944482594`*^9, 
   3.882780696621101*^9}},ExpressionUUID->"7c3da358-1be3-44cc-846c-\
3c8d7a3cbdb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"metricOfcovdtens", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"covd_", "?", "CovDQ"}], "[", "inds1__", "]"}], "[", 
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds2___", "]"}], "]"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MasterOf", "[", "covd", "]"}], "===", 
       RowBox[{"MetricOfTensor", "[", "tensor", "]"}]}], "||", 
      RowBox[{"inds2", "===", "Null"}]}], ",", 
     RowBox[{"MasterOf", "[", "covd", "]"}], ",", 
     RowBox[{"$Metrics", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"metricOf", "[", "exp_", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"metlist", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"MetricOfTensor", "/@", 
              RowBox[{"FindAllOfType", "[", 
               RowBox[{"exp", ",", "Tensor"}], "]"}]}], ",", 
             RowBox[{"metricOfcovdtens", "/@", 
              RowBox[{"FindAllOfType", "[", 
               RowBox[{"exp", ",", "CovD"}], "]"}]}]}], "]"}], ",", "Null"}], 
          "]"}], ",", "All"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", "metlist", "]"}], "]"}], "===", "1"}], "&&", 
        RowBox[{"metlist", "=!=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"metlist", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"$Metrics", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.84383071860226*^9, 3.843831037943309*^9}, {
   3.84383116329664*^9, 3.843831170674662*^9}, {3.843831265163188*^9, 
   3.8438313007385817`*^9}, {3.8438322150936947`*^9, 
   3.8438322169309187`*^9}, {3.843832332237465*^9, 3.843832333285913*^9}, {
   3.8438323687280283`*^9, 3.843832379499051*^9}, {3.843832413671279*^9, 
   3.843832429720051*^9}, {3.8438325476852303`*^9, 3.843832547811789*^9}, {
   3.843832611410364*^9, 3.84383265081606*^9}, {3.843833226783409*^9, 
   3.8438332374659977`*^9}, {3.8438333060152473`*^9, 3.84383331307458*^9}, {
   3.843836610969317*^9, 3.8438366111248713`*^9}, {3.843836659271764*^9, 
   3.843836659430051*^9}, {3.843901398024633*^9, 3.843901440717415*^9}, {
   3.8439014816878633`*^9, 3.843901503339054*^9}, {3.843901539667631*^9, 
   3.843901541985344*^9}, {3.843901596253092*^9, 3.8439016857558737`*^9}, {
   3.843901744721242*^9, 3.843901761068759*^9}, {3.84390179129249*^9, 
   3.843901816642035*^9}, {3.84390206664334*^9, 3.8439020794892473`*^9}, {
   3.843902114873777*^9, 3.843902145037558*^9}, {3.847964014011404*^9, 
   3.847964071351555*^9}, {3.84796418979877*^9, 3.847964190114026*^9}, {
   3.847964232640761*^9, 3.847964233192862*^9}, 3.847964340029909*^9, {
   3.847964418705917*^9, 3.8479644239053373`*^9}, {3.847964757190565*^9, 
   3.847964769878743*^9}},ExpressionUUID->"596e285b-cd48-42ae-8677-\
461822214944"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", " ", "Private"}], " ", "function", " ", 
   "BilinearFormOfTensor"}], " ", "***)"}]], "Input",
 CellChangeTimes->{{3.882730849687698*^9, 
  3.8827308726045523`*^9}},ExpressionUUID->"aa29cdb4-6db0-4eb3-b31f-\
88fbfbf05fce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BilinearFormOfTensor", "[", 
    RowBox[{
     RowBox[{"met_", "?", "SymplecticFormQ"}], "||", 
     RowBox[{"met_", "?", "MetricQ"}]}], "]"}], ":=", "met"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearFormOfTensor", "[", "delta", "]"}], ":=", "Null"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BilinearFormOfTensor", "[", 
   RowBox[{"tensor_", "?", "xTensorQ"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], ",", 
          RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}]}], "}"}], 
        ",", "Null"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"list", "===", 
       RowBox[{"{", "}"}]}], ",", "Null", ",", 
      RowBox[{"First", "[", "list", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BilinearFormOfTensor", "[", 
   RowBox[{
    RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds__", "]"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MetricOfTensor", "[", 
           RowBox[{"tensor", "[", "inds", "]"}], "]"}], ",", 
          RowBox[{"SymplecticFormOfTensor", "[", 
           RowBox[{"tensor", "[", "inds", "]"}], "]"}]}], "}"}], ",", 
        "Null"}], "]"}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"list", "===", 
       RowBox[{"{", "}"}]}], ",", "Null", ",", 
      RowBox[{"First", "[", "list", "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BilinearFormOfTensor", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "]"}], "]"}], ":=", "All"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BilinearFormsOfExpression", "[", "exp_", "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"BilinearFormOfTensor", "/@", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Head", "/@", 
      RowBox[{"FindAllOfType", "[", 
       RowBox[{"exp", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882730896201935*^9, 3.8827310344926*^9}, {
   3.8827773876477757`*^9, 3.882777388309123*^9}, {3.882779222382614*^9, 
   3.882779233112135*^9}, 3.882782131454668*^9, {3.8829501322492027`*^9, 
   3.882950132883868*^9}},ExpressionUUID->"bcd46581-21cf-4ed0-98ee-\
fd50e0e1a1ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.2. ContractSymplecticForm", "Subsection",
 CellChangeTimes->{{3.8825311438963213`*^9, 3.882531149585081*^9}, 
   3.8915108884294167`*^9},ExpressionUUID->"088099d7-e504-41c9-bb96-\
2475a14fef8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ContractSymplecticForm", "[", 
    RowBox[{"expr_", ",", "symplecticforms_List"}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", "expr", ",", 
     "symplecticforms"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ContractSymplecticForm", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"symplecticform_Symbol", "?", "SymplecticFormQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ContractSymplecticForm0", "[", 
     RowBox[{"{", "symplecticform", "}"}], "]"}], "[", "expr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ContractSymplecticForm", "[", 
    RowBox[{"expr_", ",", "symplecticform_Symbol", ",", "options___"}], "]"}],
    ":=", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"ContractSymplecticForm", "::", "unknown"}], ",", 
      "\"\<symplecticform\>\"", ",", "symplecticform"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ContractSymplecticForm", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"ContractSymplecticForm", "[", 
    RowBox[{"expr", ",", "$SymplecticForms", ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"ContractSymplecticForm", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882438603754018*^9, 3.8824387071132507`*^9}, {
   3.882438754623432*^9, 3.88243882814583*^9}, {3.88243886611075*^9, 
   3.8824388749511833`*^9}, {3.882440694283443*^9, 3.882440699825086*^9}, {
   3.8824409574225616`*^9, 3.882440984803062*^9}, 3.882441349658455*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"9d497600-a645-4254-a66f-78c9334440fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", " ", "Expand"}], " ", 
    RowBox[{"Product", " ", "**"}]}], "******)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm0", "[", "case__", "]"}], "[", 
      "expr_Times", "]"}], ":=", 
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "case", "]"}], "[", 
      RowBox[{"xAct`xTensor`Private`MathInputExpand", "[", "expr", "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm0", "[", "case__", "]"}], "[", "expr_", 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "case", "]"}], "[", "expr", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", " ", "Automatic"}], " ", "threading"}], " ", 
    "********)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "case__", "]"}], "[", 
      "expr_Plus", "]"}], ":=", 
     RowBox[{
      RowBox[{"ContractSymplecticForm0", "[", "case", "]"}], "/@", "expr"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "case__", "]"}], "[", 
      "expr_SeriesData", "]"}], ":=", 
     RowBox[{"xAct`xTensor`Private`SeriesDataMap", "[", 
      RowBox[{
       RowBox[{"ContractSymplecticForm0", "[", "case", "]"}], ",", "expr"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "case__", "]"}], "[", 
      "list_List", "]"}], ":=", 
     RowBox[{
      RowBox[{"ContractSymplecticForm0", "[", "case", "]"}], "/@", "list"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "case__", "]"}], "[", 
      "eq_Equal", "]"}], ":=", 
     RowBox[{
      RowBox[{"ContractSymplecticForm0", "[", "case", "]"}], "/@", "eq"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8824389032308807`*^9, 3.8824389833193693`*^9}, {
  3.882441032558514*^9, 3.8824410366490192`*^9}, {3.882441226220895*^9, 
  3.882441227581156*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"ef499a9a-935b-4a09-9bd0-2dfd3f018442"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", " ", "rules"}], " ", "for", " ", "contraction", 
    " ", "of", " ", "the", " ", "symplectic", " ", "form"}], " ", "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"CM", ":", 
       RowBox[{"ContractSymplecticForm1", "[", 
        RowBox[{"{", "symplecticform_", "}"}], "]"}]}], ")"}], "[", 
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
       RowBox[{"i1___", ",", "c_", ",", "i2___"}], "]"}], 
      RowBox[{"symplecticform_", "[", 
       RowBox[{
        RowBox[{"-", "b_"}], ",", 
        RowBox[{"-", "c_"}]}], "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CM", "[", 
      RowBox[{"rest", " ", 
       RowBox[{"tensor", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"-", "b"}], ",", "i2"}], "]"}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
        "symplecticform"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
          "Null"}], "&&", 
         RowBox[{"symplecticform", "===", 
          RowBox[{"$SymplecticForms", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"CM", ":", 
       RowBox[{"ContractSymplecticForm1", "[", 
        RowBox[{"{", "symplecticform_", "}"}], "]"}]}], ")"}], "[", 
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
       RowBox[{"i1___", ",", "c_", ",", "i2___"}], "]"}], 
      RowBox[{"symplecticform_", "[", 
       RowBox[{
        RowBox[{"-", "c_"}], ",", 
        RowBox[{"-", "b_"}]}], "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CM", "[", 
      RowBox[{
       RowBox[{"-", "rest"}], " ", 
       RowBox[{"tensor", "[", 
        RowBox[{"i1", ",", 
         RowBox[{"-", "b"}], ",", "i2"}], "]"}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
        "symplecticform"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
          "Null"}], "&&", 
         RowBox[{"symplecticform", "===", 
          RowBox[{"$SymplecticForms", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", " ", "rules"}], " ", "for", " ", "contraction",
      " ", "of", " ", "the", " ", "inverse", " ", "of", " ", "the", " ", 
     "symplectic", " ", "form"}], " ", "*****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"CM", ":", 
       RowBox[{"ContractSymplecticForm1", "[", 
        RowBox[{"{", "symplecticform_", "}"}], "]"}]}], ")"}], "[", 
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
       RowBox[{"i1___", ",", 
        RowBox[{"-", "c_"}], ",", "i2___"}], "]"}], 
      RowBox[{"invsymplecticform_", "[", 
       RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CM", "[", 
      RowBox[{"rest", " ", 
       RowBox[{"tensor", "[", 
        RowBox[{"i1", ",", "b", ",", "i2"}], "]"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"invsymplecticform", "===", 
       RowBox[{"Inv", "[", "symplecticform", "]"}]}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
         "symplecticform"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
           "Null"}], "&&", 
          RowBox[{"symplecticform", "===", 
           RowBox[{"$SymplecticForms", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"CM", ":", 
       RowBox[{"ContractSymplecticForm1", "[", 
        RowBox[{"{", "symplecticform_", "}"}], "]"}]}], ")"}], "[", 
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
       RowBox[{"i1___", ",", 
        RowBox[{"-", "c_"}], ",", "i2___"}], "]"}], 
      RowBox[{"invsymplecticform_", "[", 
       RowBox[{"c_", ",", "b_"}], "]"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"CM", "[", 
      RowBox[{
       RowBox[{"-", "rest"}], " ", 
       RowBox[{"tensor", "[", 
        RowBox[{"i1", ",", "b", ",", "i2"}], "]"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"invsymplecticform", "===", 
       RowBox[{"Inv", "[", "symplecticform", "]"}]}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
         "symplecticform"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
           "Null"}], "&&", 
          RowBox[{"symplecticform", "===", 
           RowBox[{"$SymplecticForms", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Default", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ContractSymplecticForm1", "[", "__", "]"}], "[", "expr_", 
      "]"}], ":=", "expr"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882439505099338*^9, 3.882439540430975*^9}, {
  3.882439574892436*^9, 3.882439601004987*^9}, {3.882440025945127*^9, 
  3.8824401108122873`*^9}, {3.882440180843782*^9, 3.882440216766302*^9}, {
  3.882440305119742*^9, 3.882440311242548*^9}, {3.882440357344208*^9, 
  3.882440489817151*^9}, {3.882440644558648*^9, 3.882440656415989*^9}, {
  3.882441507585438*^9, 3.882441508620337*^9}, {3.882441577210801*^9, 
  3.882441584903534*^9}, {3.882441775176915*^9, 3.882441787612863*^9}, {
  3.8824420333430357`*^9, 3.8824420395068693`*^9}, {3.882519858139412*^9, 
  3.882519880557398*^9}, {3.8825204602795877`*^9, 3.882520470034234*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"c89f20d8-b9e0-4699-915e-5e94db1529b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.3. SeparateSymplecticForm", "Subsection",
 CellChangeTimes->{{3.882531190660201*^9, 3.882531196973084*^9}, 
   3.89151088892889*^9},ExpressionUUID->"5d4d4a41-c2d2-4c48-99b0-\
dbab5b609ba2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"firstsymplecticformofvbundle", "[", 
   RowBox[{"vbundle_", ",", "list_List", ",", "_"}], "]"}], ":=", 
  RowBox[{"First", "[", "list", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FirstSymplecticFormOfVBundle", "[", 
   RowBox[{"vbundle_", ",", 
    RowBox[{"mess_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"firstsymplecticformofvbundle", "[", 
   RowBox[{"vbundle", ",", 
    RowBox[{"SymplecticFormsOfVBundle", "[", "vbundle", "]"}], ",", "mess"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882445105499032*^9, 3.882445123779035*^9}, {
   3.882445183080974*^9, 3.882445213732304*^9}, {3.882445310741522*^9, 
   3.882445311318067*^9}, 3.882450643517014*^9, {3.8824513042764463`*^9, 
   3.882451308415854*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"f00c6784-892e-44ef-9c37-f271f3f25ea1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Locate", " ", "individual", " ", "tensors"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "args1___", "]"}], "[", 
      RowBox[{"expr_Plus", ",", "args2___"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SeparateSymplecticForm", "[", "args1", "]"}], "[", 
        RowBox[{"#", ",", "args2"}], "]"}], "&"}], "/@", "expr"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "args1___", "]"}], "[", 
      RowBox[{"expr_SeriesData", ",", "args2___"}], "]"}], ":=", 
     RowBox[{"xAct`xTensor`Private`SeriesDataMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SeparateSymplecticForm", "[", "args1", "]"}], "[", 
         RowBox[{"#", ",", "args2"}], "]"}], "&"}], ",", "expr"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "args1___", "]"}], "[", 
      RowBox[{"expr_Times", ",", "args2___"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SeparateSymplecticForm", "[", "args1", "]"}], "[", 
        RowBox[{"#", ",", "args2"}], "]"}], "&"}], "/@", "expr"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88244438242865*^9, 3.882444424792233*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"6de3953d-9e19-491f-95e1-7e7cabe92e01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Shortcuts", " ", "to", " ", "2", " ", "arguments", " ", "in", " ", "the", 
    " ", "first", " ", "pair", " ", "of", " ", "brackets"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "]"}], "[", "args__", "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"Automatic", ",", "AIndex"}], "]"}], "[", "args", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "metric_", "]"}], "[", "args__", 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric", ",", "AIndex"}], "]"}], "[", "args", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Second", " ", "argument", " ", "of", " ", "the", " ", "second", " ", 
     "pair", " ", "of", " ", "brackets"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "All"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric", ",", "basis"}], "]"}], "[", 
      RowBox[{"expr", ",", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "]"}], "[", "expr", "]"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"vb_", "?", "VBundleQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric", ",", "basis"}], "]"}], "[", 
      RowBox[{
       RowBox[{"IndicesOf", "[", "vb", "]"}], "[", "expr", "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"basis2_Symbol", "?", "BasisQ"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric", ",", "basis"}], "]"}], "[", 
      RowBox[{"expr", ",", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "basis2", "]"}], "[", "expr", "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "f_IndicesOf"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric", ",", "basis"}], "]"}], "[", 
      RowBox[{"expr", ",", 
       RowBox[{"f", "[", "expr", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Default", " ", "action", " ", "of", " ", "the", " ", "second", " ", 
     RowBox[{"argument", ":", " ", 
      RowBox[{
      "Indices", " ", "not", " ", "in", " ", "their", " ", "original", " ", 
       "character"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", "expr_", "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric", ",", "basis"}], "]"}], "[", 
      RowBox[{"expr", ",", "Automatic"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "Automatic"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensors", "=", 
         RowBox[{"FindAllOfType", "[", 
          RowBox[{"expr", ",", "Tensor"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"SeparateSymplecticForm", "[", 
         RowBox[{"metric", ",", "basis"}], "]"}], "[", 
        RowBox[{"expr", ",", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Apply", "[", 
           RowBox[{"IndexList", ",", 
            RowBox[{"xAct`xTensor`Private`movedindices", "/@", "tensors"}]}], 
           "]"}]}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Expand", " ", "list", " ", "of", " ", "indices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "list_IndexList"}], "]"}], ":=", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{"SeparateSymplecticForm", "[", 
        RowBox[{"metric", ",", "basis"}], "]"}], ",", "expr", ",", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"list", ",", 
          RowBox[{"_LI", "|", 
           RowBox[{"-", "_LI"}]}]}], "]"}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882444461120064*^9, 3.8824444762747793`*^9}, {
  3.8824445575143013`*^9, 3.882444697571643*^9}, {3.8824448339006977`*^9, 
  3.8824448549476557`*^9}, {3.88245084322554*^9, 3.882450845855577*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"025ca358-4c33-40bc-b790-8629f76f6f85"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeparateSymplecticForm", "[", 
     RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"index_", "?", "GIndexQ"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SeparateSymplecticForm1", "[", 
     RowBox[{"basis", ",", "metric", ",", 
      RowBox[{"FirstSymplecticFormOfVBundle", "[", 
       RowBox[{"VBundleOfIndex", "[", "index", "]"}], "]"}]}], "]"}], "[", 
    RowBox[{"expr", ",", "index"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882444978680873*^9, 3.882444980911153*^9}, 
   3.882449896220936*^9},
 CellLabel->
  "In[106]:=",ExpressionUUID->"00cd6ca2-212e-4794-aac8-ff6c39a23f95"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeparateSymplecticForm1", "[", 
     RowBox[{"basis_", ",", "Automatic", ",", "metric1_"}], "]"}], "[", 
    RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SeparateSymplecticForm2", "[", 
     RowBox[{"basis", ",", "metric1"}], "]"}], "[", 
    RowBox[{"expr", ",", "index"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SeparateSymplecticForm1", "[", 
     RowBox[{"basis_", ",", "metric1_", ",", "metric1_"}], "]"}], "[", 
    RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"SeparateSymplecticForm2", "[", 
      RowBox[{"basis", ",", "metric1"}], "]"}], "[", 
     RowBox[{"expr", ",", "index"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"VBundleOfSymplecticForm", "[", "metric1", "]"}], "===", 
     RowBox[{"VBundleOfIndex", "[", "index", "]"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882444916487842*^9, 3.882444916957531*^9}, {
  3.882449950258543*^9, 3.8824499566690073`*^9}, {3.882451363712709*^9, 
  3.882451365019538*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c258b124-4de4-41c8-8ea8-d2b6155b08e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "SeparateMetric", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm2", "[", 
       RowBox[{"AIndex", ",", "metric_"}], "]"}], "[", 
      RowBox[{
       RowBox[{"metric_", "[", 
        RowBox[{"i1_", ",", "i2_"}], "]"}], ",", "index_"}], "]"}], ":=", 
     RowBox[{"metric", "[", 
      RowBox[{"i1", ",", "i2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "SeparateMetric"}], " ", "driver", " ", "with", " ", 
     "option"}], " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm2", "[", 
       RowBox[{"basis_", ",", "symplecticform_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"expr", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
         RowBox[{"i1___", ",", "index", ",", "i2___"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dummy", "=", 
            RowBox[{"DummyAs", "[", 
             RowBox[{"index", ",", "basis"}], "]"}]}], "}"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===", 
               "symplecticform"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"SymplecticFormOfTensor", "[", "tensor", "]"}], "===",
                  "Null"}], "&&", 
                RowBox[{"symplecticform", "===", 
                 RowBox[{"$SymplecticForms", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}], ")"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"UpIndexQ", "[", "index", "]"}], ",", 
               RowBox[{
                RowBox[{"Inv", "[", "symplecticform", "]"}], "[", 
                RowBox[{"index", ",", "dummy"}], "]"}], ",", 
               RowBox[{"symplecticform", "[", 
                RowBox[{"index", ",", "dummy"}], "]"}]}], "]"}], 
             RowBox[{"tensor", "[", 
              RowBox[{"i1", ",", 
               RowBox[{"ChangeIndex", "[", "dummy", "]"}], ",", "i2"}], 
              "]"}]}], ",", 
            RowBox[{"tensor", "[", 
             RowBox[{"i1", ",", "index", ",", "i2"}], "]"}]}], "]"}]}], 
         "]"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "]"}], "[", "exp_", "]"}], ":=", 
     
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SeparateSymplecticForm", "[", "#2", "]"}], "[", "#1", "]"}],
         "&"}], ",", "exp", ",", "$SymplecticForms"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeparateSymplecticForm", "[", 
      RowBox[{"exp_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"SymplecticFormQ", "[", "#", "]"}]}], "&"}], ")"}]}], "]"}],
      ":=", 
     RowBox[{
      RowBox[{"SeparateSymplecticForm", "[", "]"}], "[", "exp", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882444960737368*^9, 3.882444961350062*^9}, {
   3.882450178722536*^9, 3.8824502488991833`*^9}, {3.8824503079774113`*^9, 
   3.882450404945799*^9}, {3.882450478022462*^9, 3.882450481956398*^9}, {
   3.882450534654332*^9, 3.882450547869958*^9}, {3.8824505977001762`*^9, 
   3.882450615030711*^9}, {3.882450802395279*^9, 3.882450813620606*^9}, {
   3.882451037360631*^9, 3.88245106636277*^9}, 3.882451495473412*^9, {
   3.8824517222013073`*^9, 3.88245172379177*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"341f5df0-fe73-4910-9214-7028119b5300"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.4. TraceFreeQ function", "Subsection",
 CellChangeTimes->{{3.88261575642109*^9, 3.882615761679088*^9}, 
   3.891510889872201*^9},ExpressionUUID->"2d5b0b88-abf9-4c30-b815-\
671f1f9a974c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**"}], "*", " ", "This", " ", "is", " ", "now",
     " ", "private"}], " ", "***********)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TraceFreeQ", "[", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], ",", "inds___List", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mettraces", ",", "traces", ",", "tfQ"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mettraces", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"metric", "@@", "#"}], "&"}], ",", 
           RowBox[{"ChangeIndex", "/@", 
            RowBox[{"Subsets", "[", 
             RowBox[{"inds", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"traces", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ContractMetric", "[", 
             RowBox[{
              RowBox[{"ToCanonical", "[", 
               RowBox[{
                RowBox[{"tensor", "@@", "inds"}], "*", "#"}], "]"}], ",", 
              "metric"}], "]"}], "&"}], ",", "mettraces"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AllTrue", "[", 
           RowBox[{"traces", ",", 
            RowBox[{
             RowBox[{"#", "===", "0"}], "&"}]}], "]"}], ",", 
          RowBox[{"tfQ", "=", "True"}], ",", 
          RowBox[{"tfQ", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
        "tfQ"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceFreeQ", "[", 
      RowBox[{"tensor_", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}]}], "]"}], ":=", 
     RowBox[{"TraceFreeQ", "[", 
      RowBox[{
       RowBox[{"Head", "@", "tensor"}], ",", 
       RowBox[{"List", "@@", "tensor"}], ",", "metric"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceFreeQ", "[", "tensor_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MasterOf", "[", 
         RowBox[{"Head", "@", "tensor"}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TraceFreeQ", "[", 
        RowBox[{
         RowBox[{"Head", "@", "tensor"}], ",", 
         RowBox[{"List", "@@", "tensor"}], ",", 
         RowBox[{"MetricOfTensor", "[", 
          RowBox[{"Head", "@", "tensor"}], "]"}]}], "]"}], ",", 
       RowBox[{"TraceFreeQ", "[", 
        RowBox[{
         RowBox[{"Head", "@", "tensor"}], ",", 
         RowBox[{"List", "@@", "tensor"}], ",", 
         RowBox[{"$Metrics", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829636879183366*^9, 3.829636932352683*^9}, {
   3.8296376086713953`*^9, 3.8296376099945602`*^9}, {3.829637645451597*^9, 
   3.8296376618381357`*^9}, 3.829637710596187*^9, {3.829637997520033*^9, 
   3.829638078030119*^9}, {3.829638129686797*^9, 3.829638343260476*^9}, {
   3.8296383889966917`*^9, 3.8296384578152514`*^9}, {3.829638490526638*^9, 
   3.829638492447846*^9}, {3.829638562168497*^9, 3.8296386442353477`*^9}, {
   3.8432014107454233`*^9, 3.843201653228121*^9}, {3.843201687993466*^9, 
   3.843201803060625*^9}, {3.8432018854680223`*^9, 3.84320193376123*^9}, {
   3.8432019665031347`*^9, 3.843201971962269*^9}, {3.8432020292382803`*^9, 
   3.843202042601657*^9}, {3.843202872208766*^9, 3.8432028756752377`*^9}, {
   3.8432031463721857`*^9, 3.8432031741811934`*^9}, {3.8432034466597033`*^9, 
   3.843203461009893*^9}, {3.843623236083282*^9, 3.843623255165563*^9}, {
   3.843623331398691*^9, 3.843623332642703*^9}, {3.843623372301919*^9, 
   3.843623376834683*^9}, {3.84362363139692*^9, 3.843623631674781*^9}, {
   3.843623786434548*^9, 3.843623788030386*^9}, {3.84561823176991*^9, 
   3.845618233915799*^9}, {3.882339965934025*^9, 3.882339970420944*^9}, {
   3.88235713646257*^9, 3.882357145400777*^9}, {3.8932318144335823`*^9, 
   3.893231826002469*^9}},ExpressionUUID->"a149fdb0-a1c7-4396-a2ed-\
2ea72a2adc38"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["2. Translating BrauerList and Bracelets to the \
tensorial formalism. ",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.821186788933041*^9, 3.8211868179248257`*^9}, {
   3.821193823124754*^9, 3.821193833828657*^9}, 3.82185346675784*^9, 
   3.8274836732619123`*^9, 3.828517441121497*^9, {3.8286982551984158`*^9, 
   3.828698269161572*^9}, {3.841724873525094*^9, 3.841724873772903*^9}, 
   3.843653487768938*^9, {3.860569015101532*^9, 3.860569015477421*^9}, 
   3.875173088924387*^9, 3.8780263656113377`*^9, {3.878026656654272*^9, 
   3.878026679379736*^9}, 3.8781199756042967`*^9, {3.881664827087228*^9, 
   3.88166484641411*^9}, {3.881672347060403*^9, 3.881672365114479*^9}, {
   3.8819957482456207`*^9, 3.881995757674025*^9}, 3.883294113708768*^9, 
   3.8832950016036777`*^9, 3.883295514694409*^9, 
   3.883308033363027*^9},ExpressionUUID->"b7827784-d2fe-4f2f-8e00-\
31e7c37543bc"],

Cell[CellGroupData[{

Cell["2.1. BrauerToTensor", "Subsection",
 CellChangeTimes->{{3.88001243895821*^9, 3.880012448652452*^9}, 
   3.8819957804759483`*^9, {3.8915108746275263`*^9, 
   3.8915108749297743`*^9}},ExpressionUUID->"f92c4c0e-ba31-4cb8-8641-\
5463b3690997"],

Cell["\<\
 Brauer Diagram and Brauer List to metric formalism : we use the convention \
the following convention : vertex up are converted to UpIndices and vertex \
down to DownIndices :
The realization of the Brauer Algebra on Symplectic Manifold is control via \
the option :  Antisymmetric-> False/True. \
\>", "Text",
 CellChangeTimes->{{3.821200644111011*^9, 3.8212007176782513`*^9}, {
  3.821248907037908*^9, 3.821248922529953*^9}, {3.880012467287464*^9, 
  3.8800125447947073`*^9}, {3.8800162892678337`*^9, 
  3.880016291169095*^9}},ExpressionUUID->"44a391ce-9361-4762-a2b3-\
1530637bb274"],

Cell[CellGroupData[{

Cell["a.1. Symmetric Metric : Riemannian case ", "Subsubsection",
 CellChangeTimes->{{3.8800165349828033`*^9, 3.880016555685203*^9}, 
   3.880016858742943*^9},ExpressionUUID->"fb3c3b5e-8ed9-4add-a099-\
9f8082ffdedb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrauerToTensorRiemann", "[", 
     RowBox[{
      RowBox[{"x", ":", 
       RowBox[{"BrauerList", "[", "list_", "]"}]}], ",", "metric_", ",", 
      "inds_List"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"invmetric", "=", 
         RowBox[{"Inv", "[", "metric", "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "list", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "inds", "]"}], "=!=", 
          RowBox[{"2", "*", "n"}]}], ",", 
         RowBox[{"Throw", "[", 
          RowBox[{
          "Print", "[", 
           "\"\<The number of indices is not compatible the Brauer diagrams\>\
\"", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Times", "@@", 
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"UpIndexQ", "[", "#1", "]"}], "&&", 
              RowBox[{"DownIndexQ", "[", "#2", "]"}]}], ",", 
             RowBox[{"delta", "[", 
              RowBox[{"#2", ",", "#1"}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"UpIndexQ", "[", "#1", "]"}], "&&", 
                RowBox[{"UpIndexQ", "[", "#2", "]"}]}], ",", 
               RowBox[{"invmetric", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], ",", 
               RowBox[{"metric", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}]}], "]"}]}], "]"}], "&"}], 
          ",", 
          RowBox[{"list", "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Range", "[", "n", "]"}], ",", 
                RowBox[{"DownInteger", "[", 
                 RowBox[{"Range", "[", "n", "]"}], "]"}]}], "]"}], ",", 
              "inds"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorRiemann", "[", 
    RowBox[{"x_BrauerList", ",", "metric_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Flatten", "@", 
            RowBox[{"IndicesOfVBundle", "[", 
             RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], ")"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"2", "*", 
             RowBox[{"Length", "@@", "x"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"Length", "@@", "x"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"BrauerToTensorRiemann", "[", 
      RowBox[{"x", ",", "metric", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"DownIndex", "/@", 
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorRiemann", "[", 
    RowBox[{"x_BrauerList", ",", "inds_List"}], "]"}], ":=", 
   RowBox[{"BrauerToTensorRiemann", "[", 
    RowBox[{"x", ",", 
     RowBox[{"$Metrics", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "inds"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrauerToTensorRiemann", "[", "x_BrauerList", "]"}], ":=", 
    RowBox[{"BrauerToTensorRiemann", "[", 
     RowBox[{"x", ",", 
      RowBox[{"$Metrics", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorRiemann", "[", 
    RowBox[{
    "cycle_System`Cycles", ",", "n_Integer", ",", "metric_", ",", 
     "inds_List"}], "]"}], ":=", 
   RowBox[{"BrauerToTensorRiemann", "[", 
    RowBox[{
     RowBox[{"PermToBrauer", "[", 
      RowBox[{"cycle", ",", "n"}], "]"}], ",", "metric", ",", "inds"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensorRiemann", "[", 
   RowBox[{"cycle_System`Cycles", ",", "metric_", ",", "inds_List"}], "]"}], ":=", 
  RowBox[{"BrauerToTensorRiemann", "[", 
   RowBox[{"cycle", ",", 
    RowBox[{
     RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], ",", "metric", ",", 
    "inds"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88001666246065*^9, 3.8800166737311172`*^9}, {
   3.880023760017003*^9, 3.880023820917241*^9}, {3.8800238637758636`*^9, 
   3.880023864759554*^9}, {3.880024003891868*^9, 3.880024018139298*^9}, {
   3.88002414782519*^9, 3.880024174078207*^9}, {3.880025716667468*^9, 
   3.880025750646977*^9}, {3.880025923970951*^9, 3.880025967965802*^9}, {
   3.880540143955213*^9, 3.880540150083735*^9}, {3.882339880405094*^9, 
   3.882339905577642*^9}, {3.8823401491682987`*^9, 3.882340175710464*^9}, {
   3.882355302199669*^9, 3.882355305038334*^9}, {3.882377228029499*^9, 
   3.882377246459424*^9}, {3.882412653240034*^9, 3.882412682163968*^9}, 
   3.8824127421926107`*^9, {3.883033960699933*^9, 3.883033985458445*^9}, {
   3.886588944188257*^9, 3.886588962326293*^9}, {3.8865890041732273`*^9, 
   3.886589115207773*^9}, {3.886589228021172*^9, 3.886589230307971*^9}, {
   3.886589881346301*^9, 3.886589927235429*^9}, {3.891831602071082*^9, 
   3.8918316024313602`*^9}, {3.891831743827712*^9, 
   3.8918317440061293`*^9}},ExpressionUUID->"fd98ef5b-e064-4bdd-9173-\
6bddf05dd0b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["a.2. SymplecticForm : Symplectic case  ", "Subsubsection",
 CellChangeTimes->{{3.880016503451365*^9, 3.880016521984332*^9}, 
   3.8800168569166307`*^9, {3.882531257862294*^9, 
   3.882531261179409*^9}},ExpressionUUID->"ed4acca4-7535-4c55-ad85-\
23a9ce6f97d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorSymplectic0", "[", 
    RowBox[{
     RowBox[{"x", ":", 
      RowBox[{"BrauerList", "[", "list_", "]"}]}], ",", "symplecticform_", 
     ",", "inds_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "rule", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"invsymplecticform", "=", 
          RowBox[{"Inv", "[", "symplecticform", "]"}]}], ",", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "list", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "inds", "]"}], "=!=", 
           RowBox[{"2", "*", "n"}]}], ",", 
          RowBox[{"Throw", "[", 
           RowBox[{
           "Print", "[", 
            "\"\<The number of indices is not compatible the Brauer \
diagrams\>\"", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Times", "@@", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"xAct`BrauerAlgebra`Private`ArcUpQ", "[", "#2", "]"}], 
              ",", 
              RowBox[{
               RowBox[{"Inv", "[", "symplecticform", "]"}], "@@", "#1"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xAct`BrauerAlgebra`Private`LineQ", "[", "#2", "]"}], 
                ",", 
                RowBox[{"delta", "@@", 
                 RowBox[{"Reverse", "[", "#1", "]"}]}], ",", 
                RowBox[{"symplecticform", "@@", "#1"}]}], "]"}]}], "]"}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"list", "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{"Rule", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", "n", "]"}], ",", 
                   RowBox[{"DownInteger", "[", 
                    RowBox[{"Range", "[", "n", "]"}], "]"}]}], "]"}], ",", 
                 "inds"}], "]"}], "]"}]}], ",", "list"}], "}"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorSymplectic", "[", 
    RowBox[{"x_BrauerList", ",", "symplecticform_", ",", "inds_List"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"SignatureBrauer", "[", "x", "]"}], "*", 
    RowBox[{"BrauerToTensorSymplectic0", "[", 
     RowBox[{"x", ",", "symplecticform", ",", "inds"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensorSymplectic", "[", 
   RowBox[{"x_BrauerList", ",", "symplecticform_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"IndicesOfVBundle", "[", 
            RowBox[{"VBundleOfSymplecticForm", "[", "symplecticform", "]"}], 
            "]"}]}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", 
           RowBox[{"2", "*", 
            RowBox[{"Length", "@@", "x"}]}]}], "]"}], "]"}], ",", 
        RowBox[{"Length", "@@", "x"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"BrauerToTensorSymplectic", "[", 
     RowBox[{"x", ",", "symplecticform", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"list", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"DownIndex", "/@", 
         RowBox[{"list", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorSymplectic", "[", 
    RowBox[{"x_BrauerList", ",", "inds_List"}], "]"}], ":=", 
   RowBox[{"BrauerToTensorSymplectic", "[", 
    RowBox[{"x", ",", 
     RowBox[{"$SymplecticForms", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "inds"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrauerToTensorSymplectic", "[", "x_BrauerList", "]"}], ":=", 
    RowBox[{"BrauerToTensorSymplectic", "[", 
     RowBox[{"x", ",", 
      RowBox[{"$SymplecticForms", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"**", "**", " ", "Cycles"}], " ", 
   "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrauerToTensorSymplectic", "[", 
     RowBox[{
     "cycle_System`Cycles", ",", "n_Integer", ",", "symplecticform_", ",", 
      "inds_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"SignatureBrauer", "[", "cycle", "]"}], "*", 
     RowBox[{"BrauerToTensorSymplectic0", "[", 
      RowBox[{
       RowBox[{"PermToBrauer", "[", 
        RowBox[{"cycle", ",", "n"}], "]"}], ",", "symplecticform", ",", 
       "inds"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorSymplectic", "[", 
    RowBox[{"cycle_System`Cycles", ",", "symplecticform_", ",", "inds_List"}],
     "]"}], ":=", 
   RowBox[{"BrauerToTensorSymplectic", "[", 
    RowBox[{"cycle", ",", 
     RowBox[{
      RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], ",", "symplecticform",
      ",", "inds"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8800167065205307`*^9, 3.880016708194865*^9}, {
   3.880020283027981*^9, 3.88002030955781*^9}, 3.880021346076038*^9, {
   3.880023358580419*^9, 3.880023453200738*^9}, {3.880023493398737*^9, 
   3.880023538863254*^9}, {3.8800236961382427`*^9, 3.8800237105282173`*^9}, {
   3.88002374613538*^9, 3.880023746325932*^9}, {3.8800239290684633`*^9, 
   3.880023955428796*^9}, {3.880024044649576*^9, 3.880024129445958*^9}, {
   3.8800257875773478`*^9, 3.880025816586606*^9}, {3.880025874957226*^9, 
   3.880025908541046*^9}, {3.88002597364395*^9, 3.880026016525505*^9}, {
   3.8800260518533497`*^9, 3.880026061070743*^9}, {3.880540181174996*^9, 
   3.8805402026850567`*^9}, {3.882339840357346*^9, 3.882339853755445*^9}, {
   3.8823400507063723`*^9, 3.882340053318508*^9}, {3.882340088285967*^9, 
   3.882340097517467*^9}, {3.88234020062407*^9, 3.882340205750022*^9}, {
   3.882342917096469*^9, 3.882342936722258*^9}, {3.88236308962632*^9, 
   3.882363125518936*^9}, {3.8823639764109087`*^9, 3.882363977997875*^9}, {
   3.8823771770973988`*^9, 3.8823771859438543`*^9}, {3.8823772178946047`*^9, 
   3.882377221598639*^9}, {3.882377259786687*^9, 3.882377299491777*^9}, {
   3.882413024452298*^9, 3.8824130872726088`*^9}, 3.882413117398899*^9, 
   3.88241333082821*^9, {3.882413899938677*^9, 3.88241390377054*^9}, {
   3.882413995599153*^9, 3.882414000323392*^9}, {3.882414943801346*^9, 
   3.882414988185478*^9}, {3.882415067572751*^9, 3.882415111083527*^9}, {
   3.882417030304387*^9, 3.882417066731221*^9}, 3.8824182624560757`*^9, {
   3.882421416045686*^9, 3.882421438335041*^9}, {3.883033995584532*^9, 
   3.883034010593254*^9}, {3.88331062356291*^9, 3.883310635445732*^9}, 
   3.8833107636296663`*^9, {3.88658919239084*^9, 3.88658921013103*^9}, {
   3.886589261086317*^9, 3.886589357585226*^9}, {3.886589945505258*^9, 
   3.8865899889876842`*^9}, {3.886590642110239*^9, 3.8865906710506353`*^9}, {
   3.891831619401544*^9, 3.891831619545537*^9}, 3.891831753202427*^9, {
   3.892032536362856*^9, 3.8920325378136797`*^9}, {3.892299410552124*^9, 
   3.892299412672346*^9}},ExpressionUUID->"d7bbb923-24a6-4f86-817c-\
a7a155c94282"]
}, Open  ]],

Cell[CellGroupData[{

Cell["a.3. BrauerToTensor", "Subsubsection",
 CellChangeTimes->{{3.880016568519487*^9, 3.8800165780956984`*^9}, {
  3.886590003109254*^9, 
  3.886590006644449*^9}},ExpressionUUID->"a68cc1dd-14a0-40fb-b980-\
88fa34aa931f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "BrauerToTensor", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Output", "->", "Tensor"}], ",", 
    RowBox[{"SymplecticGroup", "->", "False"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensor", "[", 
    RowBox[{
     RowBox[{"BrauerList", "[", "list_", "]"}], ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "indiceslist", ",", "metriclist", ",", "rule", ",", "symplecticQ1", ",", 
       RowBox[{"symplecticQ2", "=", 
        RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "symplecticQ1", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "BrauerToTensor", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "SymplecticGroup", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"symplecticQ1", "||", "symplecticQ2"}], ",", 
        RowBox[{"BrauerToTensorSymplectic", "[", 
         RowBox[{
          RowBox[{"BrauerList", "[", "list", "]"}], ",", "metric", ",", 
          "inds"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BrauerToTensorRiemann", "[", 
         RowBox[{
          RowBox[{"BrauerList", "[", "list", "]"}], ",", "metric", ",", 
          "inds"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrauerToTensor", "[", 
     RowBox[{"cycle_System`Cycles", ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"symplecticQ", "=", 
        RowBox[{
         RowBox[{"SymplecticGroup", "/.", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
         RowBox[{"Options", "[", "BrauerToTensor", "]"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{"symplecticQ", ",", 
        RowBox[{"BrauerToTensorSymplectic", "[", 
         RowBox[{"cycle", ",", "metric", ",", "inds"}], "]"}], ",", 
        RowBox[{"BrauerToTensorRiemann", "[", 
         RowBox[{"cycle", ",", "metric", ",", "inds"}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensor", "[", 
    RowBox[{"x_BrauerList", ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"symplecticQ1", "=", 
        RowBox[{
         RowBox[{"SymplecticGroup", "/.", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
         RowBox[{"Options", "[", "BrauerToTensor", "]"}]}]}], ",", 
       RowBox[{"symplecticQ2", "=", 
        RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"symplecticQ1", "||", "symplecticQ2"}], ",", 
       RowBox[{"BrauerToTensorSymplectic", "[", 
        RowBox[{"x", ",", "metric"}], "]"}], ",", 
       RowBox[{"BrauerToTensorRiemann", "[", 
        RowBox[{"x", ",", "metric"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensor", "[", 
    RowBox[{"x_BrauerList", ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"symplecticQ1", "=", 
       RowBox[{
        RowBox[{"SymplecticGroup", "/.", 
         RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
        RowBox[{"Options", "[", "BrauerToTensor", "]"}]}]}], "}"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{"symplecticQ1", ",", 
       RowBox[{"BrauerToTensorSymplectic", "[", 
        RowBox[{"x", ",", "inds"}], "]"}], ",", 
       RowBox[{"BrauerToTensorRiemann", "[", 
        RowBox[{"x", ",", "inds"}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BrauerToTensor", "[", 
     RowBox[{"x_BrauerList", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"symplecticQ1", "=", 
        RowBox[{
         RowBox[{"SymplecticGroup", "/.", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
         RowBox[{"Options", "[", "BrauerToTensor", "]"}]}]}], "}"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{"symplecticQ1", ",", 
        RowBox[{"BrauerToTensorSymplectic", "[", "x", "]"}], ",", 
        RowBox[{"BrauerToTensorRiemann", "[", "x", "]"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*", 
    RowBox[{"**", "**"}]}], "***)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}], "*", " ", 
    "Bracelets", " ", "to", " ", 
    RowBox[{
    "tensors", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "*****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], "*", 
    RowBox[{"**", "**", "**"}]}], "***)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", " ", "SymH"}], " ", 
    "notation", " ", "of", " ", "SymManipulator", " ", "Package"}], " ", 
   "************)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "SymH"}], " ", "notation"}], " ", 
   "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensorSymRiemann", "[", 
   RowBox[{"x_Bracelets", ",", 
    RowBox[{"metric_", "?", "MetricQ"}], ",", "inds_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rep", "=", 
       RowBox[{"BrauerToTensor", "[", 
        RowBox[{
         RowBox[{"ToRepresentativeDiagram", "[", "x", "]"}], ",", "metric", 
         ",", "inds"}], "]"}]}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "@@", "x"}], "]"}]}]}], ",", "sym", ",", 
      "ruleindices", ",", 
      RowBox[{"list1", "=", 
       RowBox[{"Normal", "@", 
        RowBox[{"PositionIndex", "[", 
         RowBox[{"UpIndex", "/@", "inds"}], "]"}]}]}], ",", "symGroup", ",", 
      "supportstring", ",", "heads"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{
          RowBox[{"IndicesOf", "[", "AIndex", "]"}], "@", "rep"}]}], ",", 
        RowBox[{"numofdiagram", "=", 
         RowBox[{
         "xAct`BrauerAlgebra`Private`SizeOfConjugacyClass", "[", "x", 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"heads", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"UpIndexQ", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                RowBox[{"DownIndexQ", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DownIndexQ", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                RowBox[{"UpIndexQ", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}]}], ",", 
             "delta", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"UpIndexQ", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
                 RowBox[{"UpIndexQ", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], ",", 
               RowBox[{"Inv", "[", "metric", "]"}], ",", "metric"}], "]"}]}], 
            "]"}], "&"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"List", "@@", "indices"}], ",", "2"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ruleindices", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "->", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "&"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Normal", "@", 
             RowBox[{"PositionIndex", "[", 
              RowBox[{"UpIndex", "/@", 
               RowBox[{"List", "@@", "indices"}]}], "]"}]}], ")"}], "/.", 
           "list1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sym", "=", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"List", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"n", "/", "2"}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", 
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"n", "/", "2"}], "+", "1"}], ",", "n"}], "]"}], ",", 
              
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "/.", 
         "ruleindices"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"symGroup", "=", " ", 
        RowBox[{"StrongGenSet", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"GenSet", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"Cycles", "@@@", "sym"}], ")"}]}], "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"supportstring", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", 
              RowBox[{"Range", "[", "n", "]"}]}], ",", "\"\<(\>\""}], "]"}], 
           ",", "\"\<)\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numofdiagram", "*", 
        RowBox[{
         RowBox[{"SymH", "[", 
          RowBox[{"heads", ",", " ", "symGroup", ",", "supportstring"}], 
          "]"}], "[", 
         RowBox[{"Sequence", "@@", "indices"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorSymRiemann", "[", 
    RowBox[{"x_Bracelets", ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Flatten", "@", 
            RowBox[{"IndicesOfVBundle", "[", 
             RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], ")"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{";;", 
            RowBox[{"2", "*", 
             RowBox[{"Length", "[", 
              RowBox[{"Flatten", "@@", "x"}], "]"}]}]}], "]"}], "]"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Flatten", "@@", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"BrauerToTensorSymRiemann", "[", 
      RowBox[{"x", ",", "metric", ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"list", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"DownIndex", "/@", 
          RowBox[{"list", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensorSymRiemann", "[", "x_Bracelets", "]"}], ":=", 
  RowBox[{"BrauerToTensorSymRiemann", "[", 
   RowBox[{"x", ",", 
    RowBox[{"$Metrics", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensorSymRiemann", "[", 
    RowBox[{"x_Bracelets", ",", "inds_List"}], "]"}], ":=", 
   RowBox[{"BrauerToTensorSymRiemann", "[", 
    RowBox[{"x", ",", 
     RowBox[{"$Metrics", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "inds"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensor", "[", 
   RowBox[{
    RowBox[{"x_Bracelets", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"SymmetricGroupQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"metric_", "?", "MetricQ"}], "|", 
     RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"output", ",", "symplecticQ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", "symplecticQ"}], "}"}], "=", 
      RowBox[{"OptionValue", "[", 
       RowBox[{
        RowBox[{"{", "BrauerToTensor", "}"}], ",", 
        RowBox[{"{", "options", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Output", ",", "SymplecticGroup"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"output", "===", "SymH"}], "&&", 
        RowBox[{"!", "symplecticQ"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"BrauerToTensorSymRiemann", "[", 
        RowBox[{"x", ",", "metric", ",", "inds"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BrauerToTensor", "[", 
        RowBox[{
         RowBox[{"ConjugacyClassSum", "[", "x", "]"}], ",", "metric", ",", 
         "inds", ",", 
         RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensor", "[", 
   RowBox[{
    RowBox[{"btab_Bracelets", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SymmetricGroupQ", "[", "#", "]"}]}], "&"}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"metric_", "?", "MetricQ"}], "|", 
     RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"output", ",", "symplecticQ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", "symplecticQ"}], "}"}], "=", 
      RowBox[{"OptionValue", "[", 
       RowBox[{
        RowBox[{"{", "BrauerToTensor", "}"}], ",", 
        RowBox[{"{", "options", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Output", ",", "SymplecticGroup"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"output", "===", "SymH"}], "&&", 
        RowBox[{"!", "symplecticQ"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"BrauerToTensorSymRiemann", "[", 
        RowBox[{"btab", ",", "metric", ",", "inds"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BrauerToTensor", "[", 
        RowBox[{
         RowBox[{"ConjugacyClassSum", "[", "btab", "]"}], ",", "metric", ",", 
         "inds", ",", 
         RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
      "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensor", "[", 
   RowBox[{"btab_Bracelets", ",", 
    RowBox[{
     RowBox[{"metric_", "?", "MetricQ"}], "|", 
     RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "@", 
             RowBox[{"IndicesOfVBundle", "[", 
              RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], ")"}],
            "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"2", "*", 
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "@@", "btab"}], "]"}]}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "@@", "btab"}], "]"}]}], "]"}], ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "@", 
             RowBox[{"IndicesOfVBundle", "[", 
              RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
              "]"}]}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", 
             RowBox[{"2", "*", 
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "@@", "btab"}], "]"}]}]}], "]"}], "]"}], 
          ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "@@", "btab"}], "]"}]}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"BrauerToTensor", "[", 
     RowBox[{"btab", ",", "metric", ",", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"list", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"DownIndex", "/@", 
         RowBox[{"list", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensor", "[", 
   RowBox[{"x_Bracelets", ",", "inds_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"symplecticQ1", "=", 
      RowBox[{
       RowBox[{"SymplecticGroup", "/.", 
        RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
       RowBox[{"Options", "[", "BrauerToTensor", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"symplecticQ1", ",", 
      RowBox[{"BrauerToTensor", "[", 
       RowBox[{"x", ",", 
        RowBox[{"$SymplecticForms", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"BrauerToTensor", "[", 
       RowBox[{"x", ",", 
        RowBox[{"$Metrics", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensor", "[", 
   RowBox[{"x_Bracelets", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"symplecticQ1", "=", 
      RowBox[{
       RowBox[{"SymplecticGroup", "/.", 
        RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
       RowBox[{"Options", "[", "BrauerToTensor", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"symplecticQ1", ",", 
      RowBox[{"BrauerToTensor", "[", 
       RowBox[{"x", ",", 
        RowBox[{"$SymplecticForms", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BrauerToTensor", "[", 
       RowBox[{"x", ",", 
        RowBox[{"$Metrics", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.820167009902501*^9, 3.820167030866308*^9}, {
   3.82016722991485*^9, 3.8201674468206577`*^9}, {3.820208724934414*^9, 
   3.820208944434145*^9}, {3.820209165829932*^9, 3.820209241182399*^9}, {
   3.820209273779542*^9, 3.820209362912389*^9}, {3.8202094269407253`*^9, 
   3.82020950119909*^9}, {3.820209541204694*^9, 3.820209564307205*^9}, {
   3.820209851849942*^9, 3.820210258783065*^9}, {3.820210332395364*^9, 
   3.820210441736354*^9}, {3.820210482010084*^9, 3.8202104919681253`*^9}, {
   3.8202122936351833`*^9, 3.820212315894525*^9}, {3.8202136718592577`*^9, 
   3.820213766864408*^9}, {3.820213830343891*^9, 3.820213848307498*^9}, {
   3.820214029649301*^9, 3.820214039237432*^9}, {3.820214224718843*^9, 
   3.8202142248765497`*^9}, {3.820214317393858*^9, 3.8202143688634357`*^9}, 
   3.820214414348055*^9, {3.820214984538957*^9, 3.820214994779739*^9}, {
   3.821189319071088*^9, 3.821189330407496*^9}, {3.821189499688525*^9, 
   3.821189506528246*^9}, {3.8211895487462807`*^9, 3.821189549419873*^9}, {
   3.8211895972528267`*^9, 3.8211897064961042`*^9}, {3.8211897794722347`*^9, 
   3.8211899240191717`*^9}, {3.8211900829809113`*^9, 3.821190236392157*^9}, {
   3.821190360954938*^9, 3.821190440134894*^9}, {3.821190484930472*^9, 
   3.821190724563129*^9}, {3.821190764971315*^9, 3.821190809929331*^9}, {
   3.821190845687797*^9, 3.821190900450213*^9}, {3.8211909576248913`*^9, 
   3.821190988877378*^9}, {3.821191079070734*^9, 3.821191100418088*^9}, {
   3.821191135627451*^9, 3.8211912236311293`*^9}, {3.82119141387718*^9, 
   3.8211915042158537`*^9}, {3.82119229819483*^9, 3.821192333622672*^9}, {
   3.8211923647110558`*^9, 3.8211923652423964`*^9}, {3.821192444216259*^9, 
   3.821192485214911*^9}, {3.82119278364995*^9, 3.821192786834388*^9}, {
   3.821193667128251*^9, 3.82119368088002*^9}, 3.821193736443931*^9, {
   3.821200594865883*^9, 3.8212006175494757`*^9}, {3.821248951999982*^9, 
   3.821249024317548*^9}, {3.821249081255932*^9, 3.8212490817561617`*^9}, {
   3.821249261493891*^9, 3.821249411251541*^9}, {3.821249548220265*^9, 
   3.821249573454411*^9}, {3.821249612455377*^9, 3.821249693702983*^9}, {
   3.821249749998205*^9, 3.8212497990296087`*^9}, {3.821249829679495*^9, 
   3.821250278292066*^9}, {3.821250311900687*^9, 3.821250449787835*^9}, {
   3.821250494951111*^9, 3.8212505380796537`*^9}, {3.82125060752045*^9, 
   3.8212506138437777`*^9}, {3.821250675764563*^9, 3.821250763249832*^9}, {
   3.821250795076612*^9, 3.8212508241128817`*^9}, {3.8212529760635757`*^9, 
   3.821252980841264*^9}, {3.82125311659219*^9, 3.821253196607745*^9}, {
   3.8212533596607943`*^9, 3.821253362902254*^9}, {3.821266478356155*^9, 
   3.821266484525325*^9}, 3.824029543626142*^9, {3.827236925849764*^9, 
   3.827236926508708*^9}, {3.827413300663806*^9, 3.827413343296426*^9}, {
   3.8296409344151993`*^9, 3.829640957919866*^9}, {3.8296409942042723`*^9, 
   3.829641032975955*^9}, {3.829641173737885*^9, 3.829641173949767*^9}, {
   3.829642485097712*^9, 3.829642485525428*^9}, {3.829826804671279*^9, 
   3.829826829934808*^9}, {3.829827675176395*^9, 3.829827675714362*^9}, 
   3.829827878337789*^9, {3.8320914858215303`*^9, 3.8320914948468027`*^9}, {
   3.8320915677375107`*^9, 3.832091570054364*^9}, 3.8320917880229473`*^9, {
   3.840616424007174*^9, 3.840616426267235*^9}, {3.840616486371484*^9, 
   3.84061650825272*^9}, {3.840616582898486*^9, 3.840616692973432*^9}, {
   3.840616732205021*^9, 3.840616741937169*^9}, {3.8406168735982656`*^9, 
   3.840616875169035*^9}, {3.8406169981175833`*^9, 3.8406170043678913`*^9}, {
   3.8406193526185293`*^9, 3.8406193647440147`*^9}, 3.840620300013674*^9, 
   3.840620541132023*^9, {3.8623860809717503`*^9, 3.862386158555953*^9}, {
   3.862386250260418*^9, 3.8623862507558317`*^9}, {3.862387573142651*^9, 
   3.862387595672646*^9}, {3.862387867095682*^9, 3.8623878672832813`*^9}, {
   3.862387941171842*^9, 3.86238794139473*^9}, {3.8623881113575687`*^9, 
   3.862388126003586*^9}, {3.862389410672701*^9, 3.8623894158537903`*^9}, 
   3.875176643958685*^9, 3.8780328357774982`*^9, {3.878033703760038*^9, 
   3.8780338169961767`*^9}, {3.8780338546175756`*^9, 3.878033864482111*^9}, {
   3.878033901429657*^9, 3.878033938296464*^9}, {3.8780361924714317`*^9, 
   3.8780364790365057`*^9}, {3.878036552259901*^9, 3.87803655662763*^9}, {
   3.8780365990335617`*^9, 3.878036617708009*^9}, {3.878036660724478*^9, 
   3.8780366881450863`*^9}, {3.878040950053752*^9, 3.8780409516244392`*^9}, {
   3.878040988370755*^9, 3.8780412322602367`*^9}, 3.8780412663399467`*^9, 
   3.878041981775401*^9, {3.8780420477356873`*^9, 3.878042138109268*^9}, {
   3.878042171812011*^9, 3.87804219143633*^9}, {3.878042256003686*^9, 
   3.878042283983488*^9}, {3.878042331128421*^9, 3.878042332657036*^9}, {
   3.878042543386471*^9, 3.8780426078519573`*^9}, {3.878046149978985*^9, 
   3.8780461504930143`*^9}, {3.8780463832303133`*^9, 3.878046384601503*^9}, {
   3.8780468916421633`*^9, 3.8780469085452137`*^9}, {3.878047010947617*^9, 
   3.878047051540119*^9}, {3.878057857350913*^9, 3.878057868035037*^9}, {
   3.880012264650106*^9, 3.880012265396699*^9}, {3.880016269500949*^9, 
   3.880016278670392*^9}, {3.88002033286318*^9, 3.880020344293766*^9}, {
   3.880020394114336*^9, 3.8800203943192587`*^9}, {3.880026598917465*^9, 
   3.880026638629126*^9}, {3.880026676332748*^9, 3.880026677817295*^9}, {
   3.880026895357442*^9, 3.8800269225038347`*^9}, {3.8800286719160967`*^9, 
   3.8800286810787907`*^9}, {3.880029072012103*^9, 3.880029073987039*^9}, {
   3.880029425531905*^9, 3.880029471638749*^9}, {3.880029825870158*^9, 
   3.8800298305245657`*^9}, {3.8800916364250183`*^9, 3.880091637006819*^9}, {
   3.880091749335721*^9, 3.880091773049138*^9}, {3.8800918168380823`*^9, 
   3.880092104266019*^9}, 3.880538186309752*^9, {3.880538248112748*^9, 
   3.880538316076936*^9}, {3.8805384200308037`*^9, 3.8805384440553083`*^9}, {
   3.881677002464027*^9, 3.881677063949396*^9}, {3.881741541500371*^9, 
   3.8817415622626534`*^9}, {3.88174227359692*^9, 3.881742350309326*^9}, {
   3.8817424501680326`*^9, 3.8817424660885563`*^9}, {3.881742528882859*^9, 
   3.881742578643697*^9}, {3.8817428089394407`*^9, 3.881742812303857*^9}, 
   3.881743049856283*^9, 3.881743207497066*^9, {3.881751172804275*^9, 
   3.8817512180093718`*^9}, {3.8823399211429253`*^9, 
   3.8823399474459543`*^9}, {3.882355517249935*^9, 3.882355570633524*^9}, {
   3.8824374760080357`*^9, 3.882437480855487*^9}, 3.882437616615038*^9, {
   3.882609494003085*^9, 3.8826096293647623`*^9}, {3.8826096645669813`*^9, 
   3.882609678638546*^9}, {3.883034020875066*^9, 3.883034037610291*^9}, {
   3.883294120036178*^9, 3.883294129979342*^9}, {3.883295001614334*^9, 
   3.883295001665126*^9}, {3.8832955147050543`*^9, 3.8832955147551517`*^9}, {
   3.8833104520340967`*^9, 3.883310478111092*^9}, {3.886589380465899*^9, 
   3.886589381526033*^9}, {3.886589647568172*^9, 3.886589667514368*^9}, {
   3.886589710409359*^9, 3.886589711810297*^9}, {3.88658976169133*^9, 
   3.8865898126629963`*^9}, {3.886590057524626*^9, 3.886590061667852*^9}, {
   3.886590100262356*^9, 3.886590100798259*^9}, {3.886590203125092*^9, 
   3.886590218632017*^9}, {3.886590278160646*^9, 3.886590323374805*^9}, {
   3.886590700544223*^9, 3.886590708849889*^9}, {3.88659097698705*^9, 
   3.886591000747814*^9}, {3.886591118384705*^9, 3.886591118557086*^9}, {
   3.8865913965422697`*^9, 3.8865914041019373`*^9}, {3.891831209155273*^9, 
   3.8918312104817543`*^9}, {3.892035492288069*^9, 3.8920354934176073`*^9}, {
   3.8920355265430393`*^9, 3.8920357877052813`*^9}, 
   3.8922994134859953`*^9},ExpressionUUID->"fb5167de-deb8-46b1-ae9b-\
51d7ee47fa80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensor", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"exp", "/.", 
    RowBox[{
     RowBox[{"x_BrauerList", "|", "x_System`Cycles", "|", "x_Bracelets"}], ":>", 
     RowBox[{"BrauerToTensor", "[", 
      RowBox[{"x", ",", "metric", ",", "inds", ",", "options"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "No"}], " ", "metric", " ", "in", " ", "the", 
    " ", "argument"}], " ", "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensor", "[", 
    RowBox[{"exp_", ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"exp", "/.", 
    RowBox[{
     RowBox[{"x_BrauerList", "|", "x_System`Cycles", "|", "x_Bracelets"}], ":>", 
     RowBox[{"BrauerToTensor", "[", 
      RowBox[{"x", ",", "inds", ",", "options"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "No"}], " ", "indices", " ", "in", " ", "the", 
    " ", "argument"}], " ", "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BrauerToTensor", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"exp", "/.", 
    RowBox[{
     RowBox[{"x_BrauerList", "|", "x_System`Cycles", "|", "x_Bracelets"}], ":>", 
     RowBox[{"BrauerToTensor", "[", 
      RowBox[{"x", ",", "metric", ",", "options"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "No"}], " ", "metric", " ", "and", " ", "no", 
    " ", "indices", " ", "in", " ", "the", " ", "argument"}], " ", 
   "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BrauerToTensor", "[", 
   RowBox[{"exp_", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"exp", "/.", 
   RowBox[{
    RowBox[{"x_BrauerList", "|", "x_System`Cycles", "|", "x_Bracelets"}], ":>", 
    RowBox[{"BrauerToTensor", "[", 
     RowBox[{"x", ",", "options"}], "]"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.829641260992977*^9, 3.829641281823249*^9}, {
   3.829642491024186*^9, 3.82964249641055*^9}, {3.829642981085721*^9, 
   3.829642990161091*^9}, {3.829643167085065*^9, 3.829643192691873*^9}, {
   3.829643253748211*^9, 3.8296433082906303`*^9}, {3.8298279165486393`*^9, 
   3.8298279425867777`*^9}, {3.829827979898769*^9, 3.829828075771302*^9}, {
   3.829828212006597*^9, 3.829828239411909*^9}, {3.829828283812559*^9, 
   3.829828322460746*^9}, {3.847173038646871*^9, 3.847173045701194*^9}, 
   3.862387793885769*^9, {3.862387924162897*^9, 3.862387928477325*^9}, {
   3.86238795933041*^9, 3.8623880679118633`*^9}, {3.8623881201918364`*^9, 
   3.862388174259368*^9}, 3.862388295031981*^9, {3.862389264035419*^9, 
   3.862389279874589*^9}, {3.862389937959149*^9, 3.8623899829116993`*^9}, 
   3.8623910209603786`*^9, {3.8623911977781153`*^9, 3.862391289151802*^9}, {
   3.862391732411249*^9, 3.8623917732240953`*^9}, {3.862484946881908*^9, 
   3.8624849711851063`*^9}, {3.862564741308565*^9, 3.8625649266453857`*^9}, {
   3.878032889242412*^9, 3.8780329061097403`*^9}, {3.8780423615241747`*^9, 
   3.878042424525401*^9}, {3.880545360510333*^9, 3.88054536173328*^9}, {
   3.882339948709546*^9, 3.882339951113063*^9}, {3.883294130996175*^9, 
   3.883294133406184*^9}, {3.883295001669997*^9, 3.8832950016834517`*^9}, {
   3.883295514760355*^9, 3.883295514773176*^9}, {3.886589401099969*^9, 
   3.886589611089409*^9}, {3.886589719013928*^9, 3.8865897301215363`*^9}, {
   3.8865900774566727`*^9, 
   3.8865901279945*^9}},ExpressionUUID->"c981cf31-95b0-44a1-8f42-\
45459265ac3b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2.2. Traceless and trace projectors for tensors : trace decomposition \
\>", "Subsection",
 CellChangeTimes->{{3.878027778646459*^9, 3.878027795683836*^9}, 
   3.880538513745232*^9, {3.88199580765333*^9, 3.8819958127851257`*^9}, {
   3.8819959793905697`*^9, 3.881995982471183*^9}, {3.882782707113209*^9, 
   3.882782709586426*^9}, {3.886593591627508*^9, 3.8865936112365913`*^9}, 
   3.891510878672947*^9},ExpressionUUID->"58884a20-c9d6-49d9-8240-\
a52ad1d5e3d3"],

Cell[CellGroupData[{

Cell["a. f-traceless projectors", "Subsubsection",
 CellChangeTimes->{{3.8816649561012707`*^9, 3.8816649648302727`*^9}, {
   3.8819958273667583`*^9, 3.881995834792182*^9}, 
   3.881995987867118*^9},ExpressionUUID->"410485d2-4563-4e1a-8451-\
53a7b97e0858"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntegerListQ", "[", "list_", "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"IntegerQ", "/@", "list"}], ")"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.881668172207086*^9, 
  3.8816681873956423`*^9}},ExpressionUUID->"1405324e-8e91-4977-a1d6-\
8913f950d7ec"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", "**"}], "*", " ", "Tensorial", " ", "version", " ", "of", 
   " ", "the", " ", "Traceless", " ", "projectors"}], " ", 
  "******)"}]], "Input",
 CellChangeTimes->{{3.87517253682239*^9, 3.875172554561678*^9}, 
   3.8781213277525167`*^9},ExpressionUUID->"06d1c276-dd6e-4ea2-bcbc-\
8d5ffd0ab79f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
    "*", " ", "Traceless", " ", "projector", " ", "of", " ", 
    RowBox[{
     SuperscriptBox["V", 
      RowBox[{"\[TensorProduct]", "n"}]], " ", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "TracelessProjectorTensor", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Output", "\[Rule]", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"TracelessProjectorTensor", "[", 
     RowBox[{"n_", ",", "f_Integer", ",", 
      RowBox[{"{", 
       RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", 
        RowBox[{"symplecticQ", "=", 
         RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "output", "}"}], "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{
          RowBox[{"{", "TracelessProjectorTensor", "}"}], ",", 
          RowBox[{"{", "options", "}"}], ",", 
          RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symplecticQ", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "dim", "]"}], "===", "Integer"}], "||", 
            RowBox[{
             RowBox[{"Head", "[", "dim", "]"}], "===", "Plus"}]}], ",", 
           RowBox[{"BrauerToTensor", "[", 
            RowBox[{
             RowBox[{"TracelessProjector", "[", 
              RowBox[{"n", ",", "f", ",", 
               RowBox[{"{", 
                RowBox[{"-", "dim"}], "}"}], ",", 
               RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}], 
             ",", "metric", ",", "inds", ",", 
             RowBox[{"Output", "->", "output"}], ",", 
             RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}], ",", 
           RowBox[{"BrauerToTensor", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TracelessProjector", "[", 
               RowBox[{"n", ",", "f", ",", 
                RowBox[{"{", "dim", "}"}], ",", 
                RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}], "/.", 
              RowBox[{"dim", "->", 
               RowBox[{"-", "dim"}]}]}], ",", "metric", ",", "inds", ",", 
             RowBox[{"Output", "->", "output"}], ",", 
             RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"BrauerToTensor", "[", 
          RowBox[{
           RowBox[{"TracelessProjector", "[", 
            RowBox[{"n", ",", "f", ",", 
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"SchurWeylDual", "->", "OrthogonalGroup"}]}], "]"}], ",",
            "metric", ",", "inds", ",", 
           RowBox[{"Output", "->", "output"}], ",", 
           RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", " ", "No"}], " ",
      "indices", " ", "in", " ", "the", " ", 
     RowBox[{
     "input", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
     RowBox[{"**", "**", "**", "**", "**", "**", "**"}], "*"}], "*******)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", "f_Integer", ",", 
       RowBox[{"{", 
        RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}], 
           ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
                 "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"TracelessProjectorTensor", "[", 
        RowBox[{"n", ",", "f", ",", 
         RowBox[{"{", "dim", "}"}], ",", "metric", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"inds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"DownIndex", "/@", 
            RowBox[{"inds", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "No"}], " ", "metric", " ", "in", " ", "the", " ", 
     "input"}], " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProjectorTensor", "[", 
     RowBox[{"n_", ",", "f_Integer", ",", 
      RowBox[{"{", 
       RowBox[{"dim_Integer", "|", 
        RowBox[{"dim_Symbol", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MetricQ", "[", "#", "]"}]}], "&&", 
            RowBox[{"!", 
             RowBox[{"SymplecticFormQ", "[", "#", "]"}]}]}], "&"}], ")"}]}], 
        "|", "dim_Plus"}], "}"}], ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TracelessProjectorTensor", "[", 
     RowBox[{"n", ",", "f", ",", "dim", ",", 
      RowBox[{
       RowBox[{"BilinearFormsOfVBundle", "[", 
        RowBox[{"VBundleOfIndex", "[", 
         RowBox[{"inds", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", "f_Integer", ",", 
       RowBox[{"{", 
        RowBox[{"dim_Integer", "|", 
         RowBox[{"dim_Symbol", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MetricQ", "[", "#", "]"}]}], "&&", 
             RowBox[{"!", 
              RowBox[{"SymplecticFormQ", "[", "#", "]"}]}]}], "&"}], ")"}]}], 
         "|", "dim_Plus"}], "}"}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "f", ",", 
       RowBox[{"{", "dim", "}"}], ",", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "When", " ", "there", 
     " ", "is", " ", "no", " ", "dimension", " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", ":", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "default", " ", "value", " ", "is", " ", "DimOfManifold", 
        " ", "is", " ", 
        RowBox[{"metric", "/", "symplectic"}], " ", "form", " ", "is", " ", 
        "not", " ", "induced", " ", "else", " ", "DimOfManifold"}], "-", 
       RowBox[{"1", " ", 
        RowBox[{"(", 
         RowBox[{"should", " ", "be", " ", "generalized"}], ")"}]}]}]}]}], 
    " ", "*******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProjectorTensor", "[", 
     RowBox[{"n_", ",", "f_Integer", ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", 
         RowBox[{"DimOfManifold", "@@", 
          RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], ",", 
        RowBox[{"indQ", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"InducedFrom", "[", "metric", "]"}], "===", "Null"}], ",",
            "False", ",", "True"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"indQ", ",", 
        RowBox[{"TracelessProjectorTensor", "[", 
         RowBox[{"n", ",", "f", ",", 
          RowBox[{"{", 
           RowBox[{"dim", "-", "1"}], "}"}], ",", "metric", ",", "inds", ",", 
          "options"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TracelessProjectorTensor", "[", 
         RowBox[{"n", ",", "f", ",", 
          RowBox[{"{", "dim", "}"}], ",", "metric", ",", "inds", ",", 
          "options"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", "f_Integer", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}], 
           ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
                 "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"TracelessProjectorTensor", "[", 
        RowBox[{"n", ",", "f", ",", "metric", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"inds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"DownIndex", "/@", 
            RowBox[{"inds", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "No"}], " ", "metric", " ", "in", " ", "the", " ", 
     "input"}], " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", "f_Integer", ",", "inds_List", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "f", ",", 
       RowBox[{
        RowBox[{"BilinearFormsOfVBundle", "[", 
         RowBox[{"VBundleOfIndex", "[", 
          RowBox[{"inds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProjectorTensor", "[", 
     RowBox[{"n_", ",", "f_Integer", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TracelessProjectorTensor", "[", 
     RowBox[{"n", ",", "f", ",", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"**", "**", "**", "**", " ", "If"}], " ", "the", " ", "number", 
      " ", "of", " ", "traces", " ", "f", " ", "is", " ", "not", " ", "in", 
      " ", "the", " ", "input", " ", "this", " ", "correspond", " ", "to", 
      " ", "f"}], "=", "1"}], " ", "*******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"{", 
        RowBox[{"dim_Symbol", "|", "dim_Plus"}], "}"}], ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
       
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "1", ",", 
       RowBox[{"{", "dim", "}"}], ",", "metric", ",", "inds", ",", 
       "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
       
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "1", ",", "metric", ",", "inds", ",", "options"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", "inds_List", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "1", ",", "inds", ",", "options"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "1", ",", "metric", ",", "options"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProjectorTensor", "[", 
      RowBox[{"n", ",", "1", ",", "options"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841136734702982*^9, 3.8411367917442083`*^9}, {
   3.841136925465089*^9, 3.841136928204872*^9}, {3.8417352820089417`*^9, 
   3.8417352830947742`*^9}, {3.8424117092793207`*^9, 3.84241175210713*^9}, {
   3.8424117955696287`*^9, 3.8424117988346453`*^9}, {3.842412024286902*^9, 
   3.842412106672282*^9}, {3.842412298818615*^9, 3.84241233802113*^9}, {
   3.842412418839366*^9, 3.842412586476872*^9}, {3.8424128819235163`*^9, 
   3.84241288689994*^9}, {3.842413027775477*^9, 3.842413033561097*^9}, {
   3.842413270164441*^9, 3.8424133151298428`*^9}, 3.860829431540927*^9, {
   3.8624789456030407`*^9, 3.862478959754888*^9}, {3.862479087071927*^9, 
   3.862479261318369*^9}, {3.862479320572441*^9, 3.862479542210907*^9}, {
   3.862479930508933*^9, 3.862479934683481*^9}, {3.862480047690448*^9, 
   3.8624800522222652`*^9}, {3.862480500151943*^9, 3.8624805044222183`*^9}, {
   3.862480536026889*^9, 3.862480538561595*^9}, {3.862481157336499*^9, 
   3.8624811575437307`*^9}, {3.862481538711109*^9, 3.862481550642782*^9}, {
   3.862563416526217*^9, 3.862563416708021*^9}, 3.862564338410142*^9, 
   3.862564411776513*^9, {3.862566309551553*^9, 3.862566321386239*^9}, {
   3.862566385577729*^9, 3.86256640421449*^9}, {3.870159250613233*^9, 
   3.8701592520308104`*^9}, {3.8701595809298353`*^9, 3.870159653796947*^9}, {
   3.8701597102321463`*^9, 3.8701597104225607`*^9}, {3.8701597447103786`*^9, 
   3.870159756058288*^9}, {3.870159915922399*^9, 3.870159941967684*^9}, {
   3.870164462262415*^9, 3.8701644624136343`*^9}, {3.878028007155552*^9, 
   3.878028047376539*^9}, {3.878028089706442*^9, 3.8780281097645206`*^9}, {
   3.8781201320711813`*^9, 3.87812014101523*^9}, {3.8781202075053463`*^9, 
   3.87812022102875*^9}, {3.878120255358286*^9, 3.8781203070206127`*^9}, {
   3.8781203438113327`*^9, 3.878120355135377*^9}, {3.878120411328507*^9, 
   3.878120761318426*^9}, {3.878120796724895*^9, 3.8781208436233187`*^9}, {
   3.87812114483276*^9, 3.878121209656519*^9}, {3.8781212419815493`*^9, 
   3.878121276607974*^9}, {3.878121315289298*^9, 3.8781213219327183`*^9}, {
   3.878122613631765*^9, 3.87812261757705*^9}, {3.878122678526814*^9, 
   3.878122697055046*^9}, {3.8781227623826227`*^9, 3.878122773746065*^9}, {
   3.8781228308429728`*^9, 3.878122859499254*^9}, {3.878122920641567*^9, 
   3.878122937693639*^9}, {3.8781229749155283`*^9, 3.878122999057391*^9}, {
   3.8781230498944483`*^9, 3.87812319239275*^9}, {3.8781232418364887`*^9, 
   3.8781232576095*^9}, {3.878123306720481*^9, 3.8781233083113937`*^9}, {
   3.8781233423119087`*^9, 3.878123383234004*^9}, {3.878123447111218*^9, 
   3.878123494757078*^9}, {3.878123658965168*^9, 3.878123676309784*^9}, {
   3.878124101264923*^9, 3.878124125008931*^9}, {3.8816651479057503`*^9, 
   3.8816651679058647`*^9}, {3.881665201437998*^9, 3.881665221370769*^9}, {
   3.881665257942781*^9, 3.881665334500145*^9}, {3.881665380240498*^9, 
   3.881665475405034*^9}, {3.881665581819278*^9, 3.881665659229237*^9}, {
   3.881665690005947*^9, 3.881665715027142*^9}, {3.881665762672695*^9, 
   3.88166576339077*^9}, {3.88166796878551*^9, 3.881668086555346*^9}, {
   3.881668224007811*^9, 3.881668225929756*^9}, {3.8816733595138597`*^9, 
   3.8816733679553547`*^9}, {3.881673398681512*^9, 3.88167341517474*^9}, {
   3.881673603627561*^9, 3.881673624191078*^9}, {3.881673727662922*^9, 
   3.8816737334293327`*^9}, {3.881673799280072*^9, 3.8816738001774063`*^9}, 
   3.881674182086725*^9, {3.881732546102655*^9, 3.8817325613098087`*^9}, {
   3.881732774894277*^9, 3.881732904485903*^9}, {3.881733140234326*^9, 
   3.881733143067079*^9}, {3.881733190176857*^9, 3.881733276381795*^9}, {
   3.881739559489629*^9, 3.881739585095832*^9}, {3.881739749633915*^9, 
   3.8817397506714277`*^9}, {3.881755595217987*^9, 3.881755600063369*^9}, {
   3.8817559850526037`*^9, 3.8817559916348667`*^9}, {3.8817563684742126`*^9, 
   3.881756398496807*^9}, {3.881757459781001*^9, 3.88175748269683*^9}, {
   3.882339953010803*^9, 3.88233996539264*^9}, {3.882355889829329*^9, 
   3.8823560080287*^9}, {3.8823560434817123`*^9, 3.8823560586558657`*^9}, {
   3.882356112385579*^9, 3.882356142733124*^9}, {3.882356257071382*^9, 
   3.88235628770275*^9}, {3.882356361299871*^9, 3.882356433658469*^9}, {
   3.882356465762958*^9, 3.88235658885131*^9}, {3.8823567808765917`*^9, 
   3.882356801763595*^9}, {3.8823571013715353`*^9, 3.882357124014517*^9}, 
   3.882357456601491*^9, {3.882357496848587*^9, 3.882357527436603*^9}, {
   3.882357563731996*^9, 3.882357734142736*^9}, {3.882358030092657*^9, 
   3.8823580760696*^9}, {3.882358114629931*^9, 3.882358141405705*^9}, {
   3.8823582739941177`*^9, 3.882358309652335*^9}, {3.882358350402728*^9, 
   3.882358359514242*^9}, {3.882358435159522*^9, 3.8823584989230843`*^9}, {
   3.8826154148519287`*^9, 3.882615534517276*^9}, {3.88261556806639*^9, 
   3.882615676214488*^9}, 3.882617842617635*^9, {3.882618106773718*^9, 
   3.882618150916624*^9}, {3.882618197295237*^9, 3.882618301005199*^9}, {
   3.882618355989512*^9, 3.882618388677267*^9}, {3.882731104605626*^9, 
   3.882731151030675*^9}, {3.882783092134046*^9, 3.882783197595612*^9}, {
   3.882783407649192*^9, 3.882783493814884*^9}, {3.882783558425858*^9, 
   3.882783558676258*^9}, {3.882783593597501*^9, 3.8827839203213243`*^9}, {
   3.88278397055723*^9, 3.882784045315763*^9}, {3.882784963732649*^9, 
   3.882784966476288*^9}, {3.886589381720747*^9, 3.886589385452495*^9}, {
   3.886592657137768*^9, 3.886592802167754*^9}, {3.8865928513303623`*^9, 
   3.886592926504261*^9}, {3.886593480179359*^9, 3.886593484145913*^9}, {
   3.886593936762813*^9, 3.886593938267004*^9}, {3.886593989870364*^9, 
   3.886594095995367*^9}},ExpressionUUID->"e5ac87c0-6ad9-444b-8276-\
be9d3eae9af0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["b. Projection to traceless irreducible GL-module ", "Subsubsection",
 CellChangeTimes->{{3.886593895664076*^9, 
  3.886593926505348*^9}},ExpressionUUID->"963f7bdf-755c-4547-b0c0-\
9e9c93131843"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}],
      "*", " ", "Traceless", " ", "projector", " ", "of", " ", "simple", " ", 
     "GL"}], "-", 
    RowBox[{"modules", " ", 
     RowBox[{
      SuperscriptBox["V", "\[Mu]"], " ", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**"}]}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "GLTracelessProjector", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GLTracelessProjector", "[", 
     RowBox[{"n_", ",", "\[Mu]_List", " ", ",", 
      RowBox[{"{", 
       RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", "dressed", ",", 
        RowBox[{"symplecticQ", "=", 
         RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "output", "}"}], "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{
          RowBox[{"{", "GLTracelessProjector", "}"}], ",", 
          RowBox[{"{", "options", "}"}], ",", 
          RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symplecticQ", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "dim", "]"}], "===", "Integer"}], "||", 
            RowBox[{
             RowBox[{"Head", "[", "dim", "]"}], "===", "Plus"}]}], ",", 
           RowBox[{"BrauerToTensor", "[", 
            RowBox[{
             RowBox[{"SnTracelessProjector", "[", 
              RowBox[{"n", ",", 
               RowBox[{"TransposePartition", "[", "\[Mu]", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "dim"}], "}"}], ",", 
               RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}], ",", 
               RowBox[{"Dressed", "->", "CentralYoung"}]}], "]"}], ",", 
             "metric", ",", "inds", ",", 
             RowBox[{"Output", "->", "output"}], ",", 
             RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}], ",", 
           RowBox[{"BrauerToTensor", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SnTracelessProjector", "[", 
               RowBox[{"n", ",", 
                RowBox[{"TransposePartition", "[", "\[Mu]", "]"}], ",", 
                RowBox[{"{", "dim", "}"}], ",", 
                RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}], ",", 
                RowBox[{"Dressed", "->", "CentralYoung"}]}], "]"}], "/.", 
              RowBox[{"dim", "->", 
               RowBox[{"-", "dim"}]}]}], ",", "metric", ",", "inds", ",", 
             RowBox[{"Output", "->", "output"}], ",", 
             RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"BrauerToTensor", "[", 
          RowBox[{
           RowBox[{"SnTracelessProjector", "[", 
            RowBox[{"n", ",", "\[Mu]", ",", 
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"SchurWeylDual", "->", "OrthogonalGroup"}], ",", 
             RowBox[{"Dressed", "->", "CentralYoung"}]}], "]"}], ",", 
           "metric", ",", "inds", ",", 
           RowBox[{"Output", "->", "output"}], ",", 
           RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**"}], "*", " ", "No", " ", "indices", " ", "in", " ", 
     "the", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n_", ",", "\[Mu]_List", " ", ",", 
       RowBox[{"{", 
        RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
       ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}], 
           ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
                 "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"GLTracelessProjector", "[", 
        RowBox[{"n", ",", "\[Mu]", ",", 
         RowBox[{"{", "dim", "}"}], ",", "metric", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"inds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"DownIndex", "/@", 
            RowBox[{"inds", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "metric", 
     " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", "**", "**", "**"}]}], "******)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n_", ",", "\[Mu]_List", " ", ",", 
       RowBox[{"{", 
        RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
       ",", "inds_List", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n", ",", "\[Mu]", ",", 
       RowBox[{"{", "dim", "}"}], ",", 
       RowBox[{
        RowBox[{"BilinearFormsOfVBundle", "[", 
         RowBox[{"VBundleOfIndex", "[", 
          RowBox[{"inds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n_", ",", "\[Mu]_List", " ", ",", 
       RowBox[{"{", 
        RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
       ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n", ",", "\[Mu]", ",", 
       RowBox[{"{", "dim", "}"}], ",", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
    "***)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "When", " ", "there", 
     " ", "is", " ", "no", " ", "dimension", " ", 
     RowBox[{"input", " ", ":", " ", 
      RowBox[{
       RowBox[{
       "the", " ", "default", " ", "value", " ", "is", " ", "DimOfManifold", 
        " ", "if", " ", 
        RowBox[{"metric", "/", "symplectic"}], " ", "form", " ", "is", " ", 
        "not", " ", "induced", " ", "else", " ", "DimOfManifold"}], "-", 
       RowBox[{"1", " ", 
        RowBox[{"(", 
         RowBox[{"should", " ", "be", " ", "generalized"}], ")"}]}]}]}]}], 
    " ", "*******)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
    "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GLTracelessProjector", "[", 
     RowBox[{"n_", ",", "\[Mu]_List", " ", ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dim", "=", 
         RowBox[{"DimOfManifold", "@@", 
          RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], ",", 
        RowBox[{"symplecticQ", "=", 
         RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"symplecticQ", ",", 
        RowBox[{"GLTracelessProjector", "[", 
         RowBox[{"n", ",", "\[Mu]", ",", 
          RowBox[{"{", "dim", "}"}], ",", "metric", ",", "inds", ",", 
          "options"}], "]"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"indQ", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"InducedFrom", "[", "metric", "]"}], "===", "Null"}], 
              ",", "False", ",", "True"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"indQ", ",", "\[IndentingNewLine]", 
            RowBox[{"GLTracelessProjector", "[", 
             RowBox[{"n", ",", "\[Mu]", ",", 
              RowBox[{"{", 
               RowBox[{"dim", "-", "1"}], "}"}], ",", "metric", ",", "inds", 
              ",", "options"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"GLTracelessProjector", "[", 
             RowBox[{"n", ",", "\[Mu]", ",", 
              RowBox[{"{", "dim", "}"}], ",", "metric", ",", "inds", ",", 
              "options"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n_", ",", "\[Mu]_List", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"inds", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], 
               ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}], 
           ",", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Flatten", "@", 
                RowBox[{"IndicesOfVBundle", "[", 
                 RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
                 "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", 
                RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"GLTracelessProjector", "[", 
        RowBox[{"n", ",", "\[Mu]", ",", "metric", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"inds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"DownIndex", "/@", 
            RowBox[{"inds", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"**", 
     RowBox[{
     "*", " ", "No", " ", "dim", " ", "and", " ", "no", " ", "metric", " ", 
      "in", " ", "the", " ", "input"}]}], " ", "***)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n_", ",", "\[Mu]_List", ",", "inds_List", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n", ",", "\[Mu]", ",", 
       RowBox[{
        RowBox[{"BilinearFormsOfVBundle", "[", 
         RowBox[{"VBundleOfIndex", "[", 
          RowBox[{"inds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n_", ",", 
       RowBox[{"\[Mu]_List", "?", "IntegerListQ"}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"GLTracelessProjector", "[", 
      RowBox[{"n", ",", "\[Mu]", ",", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8865941183556356`*^9, 3.88659413291481*^9}, {
  3.8865941668337927`*^9, 3.8865942023750477`*^9}, {3.886594454904168*^9, 
  3.886594458987821*^9}, {3.8865946304332523`*^9, 3.8865946532886963`*^9}, {
  3.886594711591868*^9, 3.886594750021452*^9}, {3.8865950458312597`*^9, 
  3.886595055188263*^9}, {3.886595092971754*^9, 3.886595101578144*^9}, {
  3.88659514899279*^9, 
  3.8865951521006813`*^9}},ExpressionUUID->"3663e5ee-1cfa-454a-bc94-\
9182ae4c6e5d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["c. Maximal trace projector", "Subsubsection",
 CellChangeTimes->{{3.881995845700921*^9, 3.881995855421423*^9}, {
   3.886593524383129*^9, 3.886593528712129*^9}, 
   3.886593585510395*^9},ExpressionUUID->"24dcd086-a3f5-42b7-a5ea-\
b6d76b89cda3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", "**"}], "*", " ", "Tensorial", " ", "version", " ", "of", 
   " ", "the", " ", "Trace", " ", "projectors"}], " ", "******)"}]], "Input",
 CellChangeTimes->{
  3.8781213367273417`*^9},ExpressionUUID->"576c34a8-abff-4272-b758-\
1b2b19475c3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "TraceProjectorTensor", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Output", "\[Rule]", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"{", 
      RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"output", ",", 
       RowBox[{"symplecticQ", "=", 
        RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "output", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "TraceProjectorTensor", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{"symplecticQ", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "dim", "]"}], "===", "Integer"}], "||", 
           RowBox[{
            RowBox[{"Head", "[", "dim", "]"}], "===", "Plus"}]}], ",", 
          RowBox[{"BrauerToTensor", "[", 
           RowBox[{
            RowBox[{"TraceProjector", "[", 
             RowBox[{"n", ",", 
              RowBox[{"{", 
               RowBox[{"-", "dim"}], "}"}], ",", 
              RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}], 
            ",", "metric", ",", "inds", ",", 
            RowBox[{"Output", "->", "output"}], ",", 
            RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}], ",", 
          RowBox[{"BrauerToTensor", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TraceProjector", "[", 
              RowBox[{"n", ",", 
               RowBox[{"{", "dim", "}"}], ",", 
               RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}], "/.", 
             RowBox[{"dim", "->", 
              RowBox[{"-", "dim"}]}]}], ",", "metric", ",", "inds", ",", 
            RowBox[{"Output", "->", "output"}], ",", 
            RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"BrauerToTensor", "[", 
         RowBox[{
          RowBox[{"TraceProjector", "[", 
           RowBox[{"n", ",", 
            RowBox[{"{", "dim", "}"}], ",", 
            RowBox[{"SchurWeylDual", "->", "OrthogonalGroup"}]}], "]"}], ",", 
          "metric", ",", "inds", ",", 
          RowBox[{"Output", "->", "output"}], ",", 
          RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", " ", "No"}], " ", "indices", " ", "in", " ", 
    "the", " ", 
    RowBox[{
    "input", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**"}], "*"}], "*******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceProjectorTensor", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"{", 
       RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], 
      ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"inds", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"IndicesOfVBundle", "[", 
                RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], 
              ")"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}], 
          ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"IndicesOfVBundle", "[", 
                RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
                "]"}]}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"TraceProjectorTensor", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", "dim", "}"}], ",", "metric", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"inds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"DownIndex", "/@", 
           RowBox[{"inds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", " ", "No"}], " ", "metric", 
    " ", "in", " ", "the", " ", 
    RowBox[{"input", " ", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**"}], "*"}], 
   "*******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"{", 
      RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", "dim", "}"}], ",", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"{", 
      RowBox[{"dim_Integer", "|", "dim_Symbol", "|", "dim_Plus"}], "}"}], ",",
      "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n", ",", 
     RowBox[{"{", "dim", "}"}], ",", 
     RowBox[{
      RowBox[{"BilinearFormsOfVBundle", "[", 
       RowBox[{"VBundleOfIndex", "[", 
        RowBox[{"inds", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**"}], "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "When", " ", "there", 
    " ", "is", " ", "no", " ", "dimension", " ", 
    RowBox[{"input", " ", ":", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "default", " ", "value", " ", "is", " ", "DimOfManifold", 
       " ", "if", " ", 
       RowBox[{"metric", "/", "symplectic"}], " ", "form", " ", "is", " ", 
       "not", " ", "induced", " ", "else", " ", "DimOfManifold"}], "-", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"should", " ", "be", " ", "generalized"}], ")"}]}]}]}]}], " ",
    "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n_", ",", 
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "|", 
      RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{"DimOfManifold", "@@", 
         RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], ",", 
       "symplecticQ1", ",", 
       RowBox[{"symplecticQ2", "=", 
        RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"symplecticQ2", ",", 
       RowBox[{"TraceProjectorTensor", "[", 
        RowBox[{"n", ",", 
         RowBox[{"{", "dim", "}"}], ",", "metric", ",", "inds", ",", 
         "options"}], "]"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"indQ", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"InducedFrom", "[", "metric", "]"}], "===", "Null"}], 
             ",", "False", ",", "True"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"indQ", ",", 
           RowBox[{"TraceProjectorTensor", "[", 
            RowBox[{"n", ",", 
             RowBox[{"{", 
              RowBox[{"dim", "-", "1"}], "}"}], ",", "metric", ",", "inds", 
             ",", "options"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"TraceProjectorTensor", "[", 
            RowBox[{"n", ",", 
             RowBox[{"{", "dim", "}"}], ",", "metric", ",", "inds", ",", 
             "options"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", " ", "No"}], " ", "indices", " ", 
    "in", " ", "the", " ", 
    RowBox[{
    "input", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TraceProjectorTensor", "[", 
     RowBox[{"n_", ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"inds", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MetricQ", "[", "metric", "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"IndicesOfVBundle", "[", 
                RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], 
              ")"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}], 
          ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "@", 
               RowBox[{"IndicesOfVBundle", "[", 
                RowBox[{"VBundleOfSymplecticForm", "[", "metric", "]"}], 
                "]"}]}], ")"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{"2", "*", "n"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"TraceProjectorTensor", "[", 
       RowBox[{"n", ",", "metric", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"inds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"DownIndex", "/@", 
           RowBox[{"inds", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", "options"}], 
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", " ", "No"}], " ", 
    RowBox[{"metric", "/", "symplectic"}], " ", "form", " ", "in", " ", "the",
     " ", 
    RowBox[{
    "input", " ", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TraceProjectorTensor", "[", 
   RowBox[{"n_", ",", "inds_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"TraceProjectorTensor", "[", 
   RowBox[{"n", ",", 
    RowBox[{
     RowBox[{"BilinearFormsOfVBundle", "[", 
      RowBox[{"VBundleOfIndex", "[", 
       RowBox[{"inds", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"TraceProjectorTensor", "[", 
    RowBox[{"n", ",", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.878028051675049*^9, 3.878028052724368*^9}, {
   3.878028277970624*^9, 3.878028284894157*^9}, {3.8817334642830772`*^9, 
   3.88173361853646*^9}, {3.8817396605287733`*^9, 3.881739661755082*^9}, {
   3.881755555308755*^9, 3.8817555723532133`*^9}, {3.882339973090149*^9, 
   3.882339976728147*^9}, {3.8823561505801983`*^9, 3.882356160230238*^9}, {
   3.882356209466241*^9, 3.8823562193708553`*^9}, {3.882357190195853*^9, 
   3.882357386295439*^9}, {3.882357416531672*^9, 3.882357416975615*^9}, {
   3.8823577905838537`*^9, 3.8823578361816263`*^9}, {3.882357885802744*^9, 
   3.882357930377636*^9}, {3.8823579655593557`*^9, 3.882358006032312*^9}, 
   3.88235815562446*^9, {3.882358513538909*^9, 3.882358515661735*^9}, {
   3.882615796470552*^9, 3.882615901210479*^9}, {3.882618576716264*^9, 
   3.882618691203261*^9}, {3.88261874019293*^9, 3.8826187447945843`*^9}, {
   3.882784211838378*^9, 3.8827842391022387`*^9}, {3.8827842872546043`*^9, 
   3.882784585990065*^9}, {3.8827849675664062`*^9, 3.882784970214307*^9}, 
   3.882787763038352*^9, {3.882787826598631*^9, 3.882787826806525*^9}, {
   3.886589384546473*^9, 3.886589384586361*^9}, {3.886592937957863*^9, 
   3.8865931718234262`*^9}},ExpressionUUID->"4ba5fbcf-0b65-4f5c-adb0-\
4765671c8cfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Borrowed", " ", "from", " ", "Francesco", " ", 
    RowBox[{"Torsello", ":", " ", 
     RowBox[{"See", "  ", "arXiv"}], ":", "1904.10464", " ", ":", " ", 
     RowBox[{
     "this", " ", "should", " ", "be", " ", "somewhere", " ", "else"}]}]}], 
   "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SafeCanonical", "[", "e_", "]"}], ":=", 
    RowBox[{"ToCanonical", "[", 
     RowBox[{"e", ",", " ", 
      RowBox[{"UseMetricOnVBundle", " ", "->", " ", "None"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SafeMakeRule", "[", "e_List", "]"}], ":=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{"e", ",", 
      RowBox[{"MetricOn", "\[Rule]", "None"}], ",", 
      RowBox[{"ContractMetrics", "\[Rule]", "False"}]}], "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.811525443457665*^9, 3.811525536564933*^9}, {
   3.8115255883321342`*^9, 3.811525596284936*^9}, 3.815669056306604*^9, 
   3.8297443400542383`*^9, {3.840869800689934*^9, 3.840869800947257*^9}, {
   3.8827845995762033`*^9, 
   3.882784608492772*^9}},ExpressionUUID->"4bb0f5d9-630d-4b88-b689-\
58d6bf979dce"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.3. Projectors from the symmetric group (private)", "Subsection",
 CellChangeTimes->{{3.881996040691845*^9, 3.881996047569345*^9}, 
   3.882088580536415*^9, 3.8915108792615423`*^9, {3.8916586441513577`*^9, 
   3.891658646988188*^9}},ExpressionUUID->"7ae7574a-ec2b-446a-9ee9-\
c02b50ffc371"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"**", 
   RowBox[{"*", " ", "Central", " ", "Young"}]}], " ", "****)"}]], "Input",
 CellChangeTimes->{{3.881817067948367*^9, 
  3.881817073778076*^9}},ExpressionUUID->"d912d7ec-b6ab-45ba-82fd-\
9a7ddbc79c25"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "CentralYoungProjectorTensor", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Output", "\[Rule]", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CentralYoungProjectorTensor", "[", 
    RowBox[{"\[Mu]_List", ",", 
     RowBox[{
      RowBox[{"g_", "?", "MetricQ"}], "|", 
      RowBox[{"g_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"output", ",", 
       RowBox[{"symplecticQ", "=", 
        RowBox[{"SymplecticFormQ", "[", "g", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "output", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "CentralYoungProjectorTensor", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{"symplecticQ", ",", 
        RowBox[{"BrauerToTensor", "[", 
         RowBox[{
          RowBox[{"CentralYoungProjector", "[", 
           RowBox[{"TransposePartition", "[", "\[Mu]", "]"}], "]"}], ",", "g",
           ",", "inds", ",", 
          RowBox[{"Output", "->", "output"}], ",", 
          RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}], ",", 
        RowBox[{"BrauerToTensor", "[", 
         RowBox[{
          RowBox[{"CentralYoungProjector", "[", "\[Mu]", "]"}], ",", "g", ",",
           "inds", ",", 
          RowBox[{"Output", "->", "output"}], ",", 
          RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CentralYoungProjectorTensor", "[", 
     RowBox[{"\[Mu]_List", ",", 
      RowBox[{
       RowBox[{"g_", "?", "MetricQ"}], "|", 
       RowBox[{"g_", "?", "SymplecticFormQ"}]}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", 
        RowBox[{"symplecticQ", "=", 
         RowBox[{"SymplecticFormQ", "[", "g", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "output", "}"}], "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{
          RowBox[{"{", "CentralYoungProjectorTensor", "}"}], ",", 
          RowBox[{"{", "options", "}"}], ",", 
          RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"symplecticQ", ",", 
         RowBox[{"BrauerToTensor", "[", 
          RowBox[{
           RowBox[{"CentralYoungProjector", "[", 
            RowBox[{"TransposePartition", "[", "\[Mu]", "]"}], "]"}], ",", 
           "g", ",", 
           RowBox[{"Output", "->", "output"}], ",", 
           RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}], ",", 
         RowBox[{"BrauerToTensor", "[", 
          RowBox[{
           RowBox[{"CentralYoungProjector", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"Output", "->", "output"}], ",", 
           RowBox[{"SymplecticGroup", "->", "symplecticQ"}]}], "]"}]}], 
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", "no"}], 
    " ", 
    RowBox[{"metric", "/", "symplectic"}], " ", "form", " ", "in", " ", "the",
     " ", 
    RowBox[{"input", " ", "**", "**", "**", 
     RowBox[{"**", "**"}]}], "*", "*", 
    RowBox[{"**", "**", "**"}]}], "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CentralYoungProjectorTensor", "[", 
    RowBox[{"\[Mu]_List", ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"CentralYoungProjectorTensor", "[", 
    RowBox[{"\[Mu]", ",", 
     RowBox[{
      RowBox[{"BilinearFormsOfVBundle", "[", 
       RowBox[{"VBundleOfIndex", "[", 
        RowBox[{"inds", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CentralYoungProjectorTensor", "[", 
   RowBox[{"\[Mu]_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"CentralYoungProjectorTensor", "[", 
   RowBox[{"\[Mu]", ",", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"$Metrics", ",", "$SymplecticForms"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "options"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzU8oQwEAx/G1TUk0MWKxtvInMhNrf2rKWyw5TM3FlP8bRSwp1mopabHW
iuZAklZW40BzevNnkt2M0g7IGlpaeSviEZZ5vx2+fY5f8ZBZb2KzWCwBE7QH
L9p+XijiM23XQpHmqxd6yfcJOG+KTcPhc6UV0iuKJdj4kXLAhMh3EqUoossf
CEKjh+OIMSqqeS7oDo6sQum3cwNO0Xwv1K+vncE59/1pRZIidKZ4GPaRd9ew
YVByA4WhRBJ2WJW/MLs8lYb5y+q8SsZ9u1kCx3pqpDDMkRDw4VCWkZYs1FUx
5rDK5DAS1xLQtzeeUbdomIT+rM0ZyM1Vb0OF07gLn7plBzDWuUPCZxVPGMGP
M1oLnbe2eiiYtTRBS6lcBWXtAxmbQ6IWaLhq1cDjdAHJpymipL8w49ZlNFDM
KOYWHUEX7XkN/lHEo439Bv8Bft/tRw==
  "],ExpressionUUID->"68922893-6795-41da-9b65-be48ff6fd16e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"**", 
   RowBox[{"*", " ", "Young", " ", "Symmetrizer"}]}], " ", "****)"}]], "Input",\

 CellChangeTimes->{{3.8818170792521048`*^9, 
  3.8818170832511063`*^9}},ExpressionUUID->"be3f1c41-cfb8-4a2a-a342-\
f987b4c767bd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", 
    RowBox[{"*", " ", "Young", " ", "semi"}]}], "-", 
   RowBox[{"normal", " ", "units"}]}], " ", "****)"}]], "Input",
 CellChangeTimes->{{3.881996075268166*^9, 
  3.881996085518594*^9}},ExpressionUUID->"0a75ae51-b9a8-45c1-af00-\
7b5a5243cf5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2.4. TensorToBrauer (Private function)", "Subsection",
 CellChangeTimes->{{3.8800124241422787`*^9, 3.880012431173064*^9}, {
   3.881664908765182*^9, 3.8816649348892736`*^9}, 3.8819960125278063`*^9, 
   3.882088581756966*^9, {3.88261120180173*^9, 3.882611213654235*^9}, 
   3.891510879905768*^9},ExpressionUUID->"435d86a7-f38f-4965-b53a-\
fa7d7f137ba7"],

Cell["1. Metric Formalism to Brauer diagrams and Brauer Lists", "Text",
 CellChangeTimes->{{3.821193879580574*^9, 
  3.8211938991621*^9}},ExpressionUUID->"ac8ecceb-2fe6-427a-a45b-8b6068ab53b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorToBrauer", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sortedindofexp", ",", "unsortedindofexp", ",", "orderbrauer", ",", 
      "indlist", ",", "indtonum", ",", "edgelist", ",", "range1", ",", 
      "range2", ",", "arcsup", ",", "arcsdown", ",", "lines", ",", 
      "brauerdiagram"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetIndexSortPriorities", "[", 
      RowBox[{
      "\"\<positional\>\"", ",", "\"\<free\>\"", ",", "\"\<dummy\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sortedindofexp", "=", 
      RowBox[{"IndexSort", "@", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "AIndex", "]"}], "[", "exp", "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"unsortedindofexp", "=", 
      RowBox[{
       RowBox[{"IndicesOf", "[", "AIndex", "]"}], "[", "exp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orderbrauer", "=", 
      RowBox[{
       RowBox[{"Length", "[", "sortedindofexp", "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indlist", "=", 
      RowBox[{"List", "@@", "sortedindofexp"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"indtonum", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "indlist", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Range", "[", 
            RowBox[{"2", "*", "orderbrauer"}], "]"}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgelist", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Sort", ",", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"List", "@@", "unsortedindofexp"}], "/.", "indtonum"}], 
          ",", "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetIndexSortPriorities", "[", 
      RowBox[{
      "\"\<free\>\"", ",", "\"\<lexicographic\>\"", ",", "\"\<up\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"BrauerList", "[", 
      RowBox[{"Sort", "@", "edgelist"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorToBrauer", "[", 
   RowBox[{"a_Plus", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TensorToBrauer", "[", "#", "]"}], "&"}], ",", 
     RowBox[{"List", "@@", "a"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorToBrauer", "[", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"n_", "?", "NumberQ"}], ",", "a_"}], "]"}], "]"}], ":=", 
   RowBox[{"Times", "[", 
    RowBox[{"n", ",", 
     RowBox[{"TensorToBrauer", "[", "a", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorToBrauer", "[", 
    RowBox[{"Times", "[", 
     RowBox[{"a_", ",", "n_Power"}], "]"}], "]"}], ":=", 
   RowBox[{"Times", "[", 
    RowBox[{"n", ",", 
     RowBox[{"TensorToBrauer", "[", "a", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorToBrauer", "[", 
    RowBox[{"Power", "[", 
     RowBox[{"n_", ",", "a_"}], "]"}], "]"}], ":=", 
   RowBox[{"Times", "[", 
    RowBox[{"n", ",", 
     RowBox[{"TensorToBrauer", "[", "a", "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.820167009902501*^9, 3.820167030866308*^9}, {
   3.82016722991485*^9, 3.8201674468206577`*^9}, {3.820208724934414*^9, 
   3.820208944434145*^9}, {3.820209165829932*^9, 3.820209241182399*^9}, {
   3.820209273779542*^9, 3.820209362912389*^9}, {3.8202094269407253`*^9, 
   3.82020950119909*^9}, {3.820209541204694*^9, 3.820209564307205*^9}, {
   3.820209851849942*^9, 3.820210258783065*^9}, {3.820210332395364*^9, 
   3.820210441736354*^9}, {3.820210482010084*^9, 3.8202104919681253`*^9}, {
   3.8202122936351833`*^9, 3.820212315894525*^9}, {3.8202136718592577`*^9, 
   3.820213766864408*^9}, {3.820213830343891*^9, 3.820213848307498*^9}, {
   3.820214029649301*^9, 3.820214039237432*^9}, {3.820214224718843*^9, 
   3.8202142248765497`*^9}, {3.820214317393858*^9, 3.8202143688634357`*^9}, 
   3.820214414348055*^9, {3.820214984538957*^9, 3.820214994779739*^9}, {
   3.821189319071088*^9, 3.821189330407496*^9}, {3.821189499688525*^9, 
   3.821189506528246*^9}, {3.8211895487462807`*^9, 3.821189549419873*^9}, {
   3.8211895972528267`*^9, 3.8211897064961042`*^9}, {3.8211897794722347`*^9, 
   3.8211899240191717`*^9}, {3.8211900829809113`*^9, 3.821190236392157*^9}, {
   3.821190360954938*^9, 3.821190440134894*^9}, {3.821190484930472*^9, 
   3.821190724563129*^9}, {3.821190764971315*^9, 3.821190809929331*^9}, {
   3.821190845687797*^9, 3.821190900450213*^9}, {3.8211909576248913`*^9, 
   3.821190988877378*^9}, {3.821191079070734*^9, 3.821191100418088*^9}, {
   3.821191135627451*^9, 3.8211912236311293`*^9}, {3.82119141387718*^9, 
   3.8211915042158537`*^9}, {3.82119229819483*^9, 3.821192333622672*^9}, {
   3.8211923647110558`*^9, 3.8211923652423964`*^9}, {3.821192444216259*^9, 
   3.821192485214911*^9}, {3.82119278364995*^9, 3.821192786834388*^9}, {
   3.821193667128251*^9, 3.82119368088002*^9}, 3.821193736443931*^9, {
   3.821200594865883*^9, 3.8212006175494757`*^9}, 3.8223933297909327`*^9, {
   3.822467328542753*^9, 3.822467329637879*^9}, {3.824029705830834*^9, 
   3.824029991542781*^9}, {3.824030049303897*^9, 3.824030084749139*^9}, {
   3.824030115082059*^9, 3.824030119375766*^9}, {3.8240584908703527`*^9, 
   3.82405849454998*^9}, {3.827236940733733*^9, 3.827236983275549*^9}, {
   3.827413053268968*^9, 3.827413059381734*^9}, {3.827413091063936*^9, 
   3.827413164437593*^9}, {3.827413266751348*^9, 3.827413289349741*^9}, {
   3.8276613480594463`*^9, 3.8276613849191103`*^9}, 3.8276623767380667`*^9, {
   3.828698983478785*^9, 3.828698987057343*^9}, {3.8436524703889236`*^9, 
   3.8436524739789143`*^9}, {3.843652571360959*^9, 3.84365257290762*^9}, {
   3.843652733897314*^9, 3.843652745824975*^9}, {3.843652823253119*^9, 
   3.843652857021991*^9}, {3.843652995551671*^9, 3.843653018779934*^9}, {
   3.843653578842579*^9, 3.843653580290861*^9}, {3.843653666754722*^9, 
   3.843653691138589*^9}, {3.8436539071216793`*^9, 3.843653908784657*^9}, {
   3.8436542314533052`*^9, 3.843654251474053*^9}, {3.878026797353147*^9, 
   3.878026798526312*^9}, {3.878026840311482*^9, 3.878026897924487*^9}, {
   3.8830340493504333`*^9, 3.8830340723919*^9}, 
   3.886593209107572*^9},ExpressionUUID->"bd9e8250-db24-48bf-b474-\
8b78194d167f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["3. Action of the Brauer algebra on tensors ",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.8819958996460114`*^9, 3.88199591526248*^9}, 
   3.883308037273055*^9},ExpressionUUID->"b7e1e050-41c3-4f3b-ad92-\
a95aa80ccefb"],

Cell[CellGroupData[{

Cell["\<\
3.1. The TracePermuteIndices function ( Generalization of PermuteIndices of \
xPerm)\
\>", "Subsection",
 CellChangeTimes->{{3.881995932245159*^9, 3.8819959587570553`*^9}, {
  3.891510864592408*^9, 
  3.891510864886962*^9}},ExpressionUUID->"61671527-8ff4-4387-9163-\
7c1e3f921110"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"expr_", ",", "indices_List", ",", "0", ",", "metric_"}], "]"}], ":=",
    "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TracePermuteIndices", "[", 
     RowBox[{"0", ",", "rest___", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", "TracePermuteIndices"}], " ", "with",
     " ", "input", " ", "a", " ", "permutation"}], " ", 
   "********)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TracePermuteIndices0", "[", 
   RowBox[{
   "expr_", ",", "indices_List", ",", "cycle_System`Cycles", ",", "metric_"}],
    "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"iperm", "=", 
       RowBox[{"InversePermutation", "[", "cycle", "]"}]}], ",", 
      RowBox[{"support", "=", 
       RowBox[{"PermutationSupport", "[", "cycle", "]"}]}]}], "}"}], ",", 
    RowBox[{"ReplaceIndex", "[", 
     RowBox[{"expr", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{
        "indices", "\[LeftDoubleBracket]", "support", 
         "\[RightDoubleBracket]"}], "->", 
        RowBox[{"indices", "\[LeftDoubleBracket]", 
         RowBox[{"PermutationReplace", "[", 
          RowBox[{"support", ",", "iperm"}], "]"}], 
         "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices0", "[", 
    RowBox[{"expr_", ",", "indices_List", ",", 
     RowBox[{"d_BrauerList", "?", "SymmetricGroupQ"}], ",", "metric_"}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SymplecticFormQ", "[", "metric", "]"}], ",", 
     RowBox[{
      RowBox[{"SignatureBrauer", "[", "d", "]"}], "*", 
      RowBox[{"ReplaceIndex", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"indices", "[", 
             RowBox[{"[", 
              RowBox[{"xAct`BrauerAlgebra`Private`UpInteger", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}], "->", 
            RowBox[{"indices", "[", 
             RowBox[{"[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "&"}], ",", 
          RowBox[{"Sequence", "@@", "d"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"indices", "[", 
            RowBox[{"[", 
             RowBox[{"xAct`BrauerAlgebra`Private`UpInteger", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}], "->", 
           RowBox[{"indices", "[", 
            RowBox[{"[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "&"}], ",", 
         RowBox[{"Sequence", "@@", "d"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**"}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", "TracePermuteIndices"}], " ", "with",
     " ", "input", " ", "a", " ", "Brauerlist", " ", "with", " ", "arcs"}], 
   " ", "********)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**"}], "*****)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", 
     "Convention"}], " ", 
    RowBox[{"Below", " ", ":", " ", 
     RowBox[{
     "diagram", " ", "acting", " ", "on", " ", "tensor", " ", "from", " ", 
      "below"}], " ", ":", " ", 
     RowBox[{"not", " ", "the", " ", "convention", " ", "of", " ", 
      RowBox[{"xPerm", " ", "**", "**", "**", "**", "**", "**"}]}]}]}], 
   "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TracePermuteIndicesReplacementRule", "[", 
      RowBox[{"indices_List", ",", "d_BrauerList"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "@@", "d"}]}], "}"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"UpArcQ", "[", 
              RowBox[{"#", ",", "n"}], "]"}], ",", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"dummy", "=", 
                 RowBox[{"UpIndex", "[", 
                  RowBox[{"DummyAs", "[", 
                   RowBox[{"indices", "[", 
                    RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"indices", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
                  RowBox[{"-", "dummy"}]}], ",", 
                 RowBox[{
                  RowBox[{"indices", "[", 
                   RowBox[{"[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "->", 
                  "dummy"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"xAct`BrauerAlgebra`Private`LineQ", "[", 
                RowBox[{"#", ",", "n"}], "]"}], ",", 
               RowBox[{
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "->", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "n"}], "]"}], 
                 "]"}]}], ",", "Nothing"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"Sequence", "@@", "d"}]}], "]"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"TracePermuteIndicesMetricList", "[", 
      RowBox[{"metric_", ",", "indices_List", ",", "d_BrauerList"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "@@", "d"}]}], "}"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"DownArcQ", "[", 
              RowBox[{"#", ",", "n"}], "]"}], ",", 
             RowBox[{"metric", "@@", 
              RowBox[{"indices", "[", 
               RowBox[{"[", 
                RowBox[{"#", "-", "n"}], "]"}], "]"}]}], ",", "Nothing"}], 
            "]"}], "&"}], ",", 
          RowBox[{"Sequence", "@@", "d"}]}], "]"}], "]"}]}], "]"}]}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", " ", 
     "Convention"}], " ", 
    RowBox[{"Above", " ", ":", " ", 
     RowBox[{
     "diagram", " ", "acting", " ", "on", " ", "tensor", " ", "from", " ", 
      "above"}], " ", ":", " ", 
     RowBox[{"the", " ", "convention", " ", "of", " ", 
      RowBox[{"xPerm", " ", "**", "**", "**", "**", "**", "**"}]}]}]}], 
   "*****)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TracePermuteIndicesReplacementRule", "[", 
     RowBox[{"indices_List", ",", 
      RowBox[{"x", ":", 
       RowBox[{"BrauerList", "[", "d_", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"xAct`BrauerAlgebra`Private`ArcDownQ", "[", "#", "]"}], ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dummy", "=", 
              RowBox[{"UpIndex", "[", 
               RowBox[{"DummyAs", "[", 
                RowBox[{"indices", "[", 
                 RowBox[{"[", 
                  RowBox[{"xAct`BrauerAlgebra`Private`UpInteger", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], 
                "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"indices", "[", 
                RowBox[{"[", 
                 RowBox[{"xAct`BrauerAlgebra`Private`UpInteger", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], "->", 
               
               RowBox[{"-", "dummy"}]}], ",", 
              RowBox[{
               RowBox[{"indices", "[", 
                RowBox[{"[", 
                 RowBox[{"xAct`BrauerAlgebra`Private`UpInteger", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}], "->", 
               "dummy"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"xAct`BrauerAlgebra`Private`LineQ", "[", "#", "]"}], ",", 
            
            RowBox[{
             RowBox[{"indices", "[", 
              RowBox[{"[", 
               RowBox[{"xAct`BrauerAlgebra`Private`UpInteger", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}], "->", 
             RowBox[{"indices", "[", 
              RowBox[{"[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
            "Nothing"}], "]"}]}], "]"}], "&"}], ",", "d"}], "]"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TracePermuteIndicesMetricList", "[", 
     RowBox[{"metric_", ",", "indices_List", ",", 
      RowBox[{"x", ":", 
       RowBox[{"BrauerList", "[", "d_", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"xAct`BrauerAlgebra`Private`ArcUpQ", "[", "#", "]"}], ",", 
          RowBox[{"metric", "@@", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], ",", "Nothing"}], "]"}], "&"}], 
       ",", "d"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TracePermuteIndices0", "[", 
     RowBox[{
     "expr_", ",", "indices_List", ",", "d_BrauerList", ",", "metric_"}], 
     "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SymplecticFormQ", "[", "metric", "]"}], ",", 
      RowBox[{
       RowBox[{"SignatureBrauer", "[", "d", "]"}], "*", 
       RowBox[{"Times", "@@", 
        RowBox[{"TracePermuteIndicesMetricList", "[", 
         RowBox[{"metric", ",", "indices", ",", "d"}], "]"}]}], "*", 
       RowBox[{"ReplaceIndex", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"TracePermuteIndicesReplacementRule", "[", 
          RowBox[{"indices", ",", "d"}], "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"TracePermuteIndicesMetricList", "[", 
         RowBox[{"metric", ",", "indices", ",", "d"}], "]"}]}], "*", 
       RowBox[{"ReplaceIndex", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"TracePermuteIndicesReplacementRule", "[", 
          RowBox[{"indices", ",", "d"}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**"}], "*****)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TracePermuteIndices", "[", 
      RowBox[{"expr_", ",", "indices_List", ",", "x_Plus", ",", "metric_"}], 
      "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TracePermuteIndices", "[", 
         RowBox[{"expr", ",", "indices", ",", "#1", ",", "metric"}], "]"}], 
        "&"}], ")"}], "/@", "x"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TracePermuteIndices", "[", 
       RowBox[{"expr_", ",", "indices_List", ",", 
        RowBox[{"k_", "*", 
         RowBox[{"(", 
          RowBox[{
          "x_System`Cycles", "|", "x_BrauerList", "|", "x_Bracelets", "|", 
           "x_Plus"}], ")"}]}], ",", "metric_"}], "]"}], "/;", 
      RowBox[{"TrueQ", "[", 
       RowBox[{
       "xAct`BrauerAlgebra`Private`ScalarExpressionForConjugacyClassProductQ",
         "[", 
        RowBox[{"k", ",", 
         RowBox[{"DimOfManifold", "@@", 
          RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], "]"}], 
       "]"}]}], ":=", 
     RowBox[{"k", "*", 
      RowBox[{"TracePermuteIndices", "[", 
       RowBox[{"expr", ",", "indices", ",", "x", ",", "metric"}], "]"}]}]}]}],
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "*****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", "TracePermuteIndices"}], " ", "with",
     " ", "input", " ", "a", " ", "Bracelets"}], " ", "********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices0", "[", 
    RowBox[{
    "expr_", ",", "indices_List", ",", "btab_Bracelets", ",", "metric_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TracePermuteIndices0", "[", 
       RowBox[{"expr", ",", "indices", ",", "#", ",", "metric"}], "]"}], 
      "&"}], "/@", 
     RowBox[{"ConjugacyClass", "[", "btab", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", "TracePermuteIndices"}], " ", "on", 
    " ", "Class", " ", "Tensor", " ", "with", " ", "input", " ", "a", " ", 
    "Bracelets"}], " ", "********)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices0", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ClassTensor", "[", "exp___", "]"}], "[", "inds___", "]"}], ",",
      "btab_Bracelets", ",", "metric_"}], "]"}], ":=", 
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ClassTensor", "[", "exp", "]"}], "[", "inds", "]"}], ",", 
     RowBox[{"List", "[", "inds", "]"}], ",", "btab", ",", "metric"}], 
    "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "*****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"**", "**", "**", "**", "**"}], "*", " ", 
      RowBox[{"TracePermuteIndices", " ", ":", " ", 
       RowBox[{"main", " ", "function"}]}]}], " ", "**"}], "**"}], 
   "********)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}]}], 
   "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"expr_", ",", "indices_List", ",", "exp1_", ",", "metric_"}], 
    "]"}], ":=", 
   RowBox[{"exp1", "/.", 
    RowBox[{
     RowBox[{"x_BrauerList", "|", "x_System`Cycles", "|", "x_Bracelets"}], ":>", 
     RowBox[{"TracePermuteIndices0", "[", 
      RowBox[{"expr", ",", "indices", ",", "x", ",", "metric"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "*", " ", "Default", " ", "value", " ", "for", " ", "the",
     " ", "metric", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"symplectic", " ", "form"}], ")"}], " ", "**", "**", "**"}], 
    "*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], "*", 
    RowBox[{"**", "**", "**"}]}], "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TracePermuteIndices", "[", 
     RowBox[{"expr_", ",", "indices_List", ",", "x_"}], "]"}], ":=", 
    RowBox[{"TracePermuteIndices", "[", 
     RowBox[{"expr", ",", "indices", ",", "x", ",", 
      RowBox[{"First", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"MetricsOfVBundle", "[", 
          RowBox[{"VBundleOfIndex", "[", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"SymplecticFormsOfVBundle", "[", 
          RowBox[{"VBundleOfIndex", "[", 
           RowBox[{"indices", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "*", " ", "Default", " ", "value", " ", "for", " ", "the",
     " ", "indices", " ", 
    RowBox[{
     RowBox[{"(", "support", ")"}], " ", "**", "**", "**"}], "*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}], "*", 
    RowBox[{"**", "**", "**"}]}], "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"expr_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"List", "@@", 
      RowBox[{
       RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
     "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"expr_", ",", "x_", ",", 
     RowBox[{
      RowBox[{"g_", "?", "MetricQ"}], "|", 
      RowBox[{"g_", "?", "SymplecticFormQ"}]}]}], "]"}], ":=", 
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"List", "@@", 
      RowBox[{
       RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
     "x", ",", "g"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8819146275039577`*^9, 3.881914747168778*^9}, {
   3.88191486813546*^9, 3.881914871093896*^9}, {3.8819149314243593`*^9, 
   3.8819150380456533`*^9}, {3.8819186079047422`*^9, 3.881918610465678*^9}, {
   3.881918856215012*^9, 3.881918863353107*^9}, {3.8819189107974*^9, 
   3.881918912825898*^9}, {3.881919725679577*^9, 3.881919863359408*^9}, {
   3.881919926766234*^9, 3.881919936428215*^9}, {3.8819200754982243`*^9, 
   3.881920075940789*^9}, {3.8819201585695457`*^9, 3.88192017764231*^9}, {
   3.8819208304209547`*^9, 3.881920836759676*^9}, {3.8819251565718937`*^9, 
   3.8819251578417473`*^9}, 3.881925623483288*^9, {3.881925655789199*^9, 
   3.881925665100607*^9}, {3.88199451938068*^9, 3.8819945196194468`*^9}, {
   3.881994608702242*^9, 3.881994621736965*^9}, {3.881994979344243*^9, 
   3.881994995907702*^9}, {3.881996144546294*^9, 3.881996234670459*^9}, {
   3.882084170946381*^9, 3.8820841749951057`*^9}, {3.8820872437048273`*^9, 
   3.882087263181776*^9}, {3.882162026924406*^9, 3.882162058505003*^9}, {
   3.882377201706917*^9, 3.8823772025930243`*^9}, {3.882608368913856*^9, 
   3.882608372197606*^9}, {3.882608667807741*^9, 3.882608669727046*^9}, {
   3.8826100523530283`*^9, 3.882610070651219*^9}, {3.882610118745514*^9, 
   3.882610185452731*^9}, {3.882621172206644*^9, 3.882621250539192*^9}, 
   3.882694339739151*^9, {3.882695049316835*^9, 3.8826950960285597`*^9}, 
   3.882695189879883*^9, 3.8826956683399363`*^9, {3.883111506809812*^9, 
   3.883111694899579*^9}, 3.883114933083301*^9, {3.883115504296915*^9, 
   3.883115533773308*^9}, 3.883115696981638*^9, {3.8831234669762993`*^9, 
   3.883123692523843*^9}, 3.883123724120851*^9, {3.8831238113212547`*^9, 
   3.8831238632148*^9}, {3.883237041719534*^9, 3.883237158169263*^9}, {
   3.8832371922140417`*^9, 3.883237234910926*^9}, {3.883237530518854*^9, 
   3.883237580689323*^9}, {3.883237628789647*^9, 3.883237660128751*^9}, {
   3.883294135297995*^9, 3.883294145814937*^9}, {3.883295001689587*^9, 
   3.883295001714243*^9}, {3.883295514780068*^9, 3.883295514897621*^9}, {
   3.8833105906333323`*^9, 3.88331061033526*^9}, {3.8833106516426477`*^9, 
   3.8833106564242983`*^9}, {3.8833107457352333`*^9, 3.883310772872005*^9}, {
   3.888563847035899*^9, 3.888563867100236*^9}, {3.8885639814729033`*^9, 
   3.888564013529031*^9}, 3.88856406387917*^9, {3.888564122545701*^9, 
   3.888564126012044*^9}, {3.8885641580758867`*^9, 3.888564207125628*^9}, {
   3.888564243135639*^9, 3.888564254821756*^9}, {3.888564285720503*^9, 
   3.8885642862341146`*^9}, {3.888564332008643*^9, 3.888564362953203*^9}, {
   3.888564493442374*^9, 3.8885645171224117`*^9}, {3.888564571097618*^9, 
   3.8885646056667013`*^9}, {3.888564699190957*^9, 3.888564703405386*^9}, {
   3.888566002300826*^9, 3.888566004466601*^9}, {3.888566064237754*^9, 
   3.8885660898951187`*^9}, {3.8885666658089952`*^9, 
   3.8885666786741867`*^9}, {3.888566787558386*^9, 3.88856692197707*^9}, {
   3.888566957648366*^9, 3.8885669628520107`*^9}, {3.888568346462562*^9, 
   3.888568354540318*^9}, {3.888568406195257*^9, 3.888568434895557*^9}, {
   3.8885685051632957`*^9, 3.88856851464469*^9}, {3.888568565256117*^9, 
   3.88856856743653*^9}, {3.888568637981845*^9, 3.888568686320076*^9}, {
   3.888651777520384*^9, 3.8886518150122137`*^9}, {3.888651939771538*^9, 
   3.8886519609236526`*^9}, {3.8886520215016747`*^9, 3.8886520313878603`*^9}, 
   3.888652100806217*^9, {3.8913418834382477`*^9, 3.8913418837855663`*^9}, {
   3.892027127464633*^9, 3.8920271447920094`*^9}, {3.892027189976041*^9, 
   3.892027192741664*^9}, {3.892027478365469*^9, 3.89202754545584*^9}, {
   3.892027581353314*^9, 3.8920276244956017`*^9}, {3.892027661844314*^9, 
   3.892027677693183*^9}, {3.892027745716855*^9, 3.892027757393869*^9}, {
   3.892029670172092*^9, 3.8920297195227833`*^9}, {3.892029787756654*^9, 
   3.892029792568021*^9}, {3.8920298344916973`*^9, 3.892029846465502*^9}, 
   3.892098031182201*^9, {3.8922994140770407`*^9, 
   3.892299420644895*^9}},ExpressionUUID->"8bbef68a-346f-415b-a91d-\
254c2f6ecc9a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3.2. ClassTensor ", "Subsection",
 CellChangeTimes->{{3.882161669836816*^9, 3.882161673364258*^9}, 
   3.891510869624192*^9},ExpressionUUID->"563eb064-f76b-4fc3-a383-\
5094ce33e813"],

Cell["\<\
The ClassTensor objects are very similar to the SymH objects of the \
SymManipulator package. Instead of being parametrized by a Subgroup of the \
Symmetric group ClassTensor are parametrized by conjugacy Classes in the \
symmetric group and in the Brauer algebra. \
\>", "Text",
 CellChangeTimes->{{3.8832182108297787`*^9, 
  3.8832182802001*^9}},ExpressionUUID->"871421f0-103e-4939-872d-bf23ced194bc"],

Cell[CellGroupData[{

Cell["a. Format and properties", "Subsubsection",
 CellChangeTimes->{{3.882099382950123*^9, 3.882099387801257*^9}, {
  3.8832182969666853`*^9, 
  3.883218329754675*^9}},ExpressionUUID->"2241fb34-9493-4014-b79f-\
df489ec2a03a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xTensorQ", "[", 
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tensorheadslist_", ",", "btab_Bracelets"}], "]"}], "]"}], "^:=",
    "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintAs", "[", 
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tensorheadslist_", ",", "btab_Bracelets"}], "]"}], "]"}], "^:=", 
   RowBox[{"RowBox", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"UnderscriptBox", "[", 
       RowBox[{"\"\<Class\>\"", ",", 
        RowBox[{"StyleBox", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Sequence", "@@", "btab"}], "]"}], ",", "10"}], "]"}]}], 
       "]"}], ",", "\"\<[\>\"", ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{"PrintAs", "/@", "tensorheadslist"}], ")"}]}], ",", 
      "\"\<]\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SlotsOfTensor", "[", 
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tensorheadslist_", ",", "btab_Bracelets"}], "]"}], "]"}], "^:=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{"SlotsOfTensor", "/@", "tensorheadslist"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DependenciesOfTensor", "[", 
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tensorheadslist_", ",", "btab_Bracelets"}], "]"}], "]"}], "^:=", 
   RowBox[{"Union", "@@", 
    RowBox[{"(", 
     RowBox[{"DependenciesOfTensor", "/@", "tensorheadslist"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClassTensor", "/:", 
  RowBox[{"SymmetryGroupOfTensor", "[", 
   RowBox[{"x", ":", 
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tensor_", ",", "btab_Bracelets"}], "]"}]}], "]"}], ":=", 
  RowBox[{"InternalSymmetryClassTensor", "[", "x", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8820964681002007`*^9, 3.8820966042259912`*^9}, {
   3.882096647110903*^9, 3.882096658202574*^9}, {3.882096709273563*^9, 
   3.882096735801173*^9}, {3.882096791664927*^9, 3.882096800886438*^9}, {
   3.882096878118299*^9, 3.882096905595028*^9}, {3.882097064796557*^9, 
   3.882097067446075*^9}, {3.882097154027698*^9, 3.882097162726034*^9}, {
   3.882097259932225*^9, 3.882097282432279*^9}, {3.882097314078404*^9, 
   3.8820973143693867`*^9}, {3.88209736608355*^9, 3.8820973663384132`*^9}, {
   3.882097609065434*^9, 3.882097609261751*^9}, {3.882265239053423*^9, 
   3.88226524052941*^9}, {3.882986903498757*^9, 3.8829869201492357`*^9}, {
   3.883128874973124*^9, 3.883128879372715*^9}, 3.883128917066038*^9, {
   3.8831292174886713`*^9, 3.883129219588175*^9}, {3.883129347612236*^9, 
   3.8831293672242327`*^9}, {3.8831333438245*^9, 3.8831334098408213`*^9}, {
   3.883133650294045*^9, 3.8831336728640337`*^9}, {3.8832181616200457`*^9, 
   3.8832181618354797`*^9}, {3.8832927759930353`*^9, 3.883292791439558*^9}, {
   3.883294146778284*^9, 3.883294149023653*^9}, {3.8832950017167473`*^9, 
   3.883295001724077*^9}, {3.883295514901441*^9, 
   3.883295514909988*^9}},ExpressionUUID->"b128aea3-38b4-43e8-9401-\
c24def49f8d0"],

Cell[BoxData[{
 RowBox[{"ClassTensor", "/:", 
  RowBox[{
   RowBox[{"ClassTensor", "[", 
    RowBox[{"tens_", ",", 
     RowBox[{"k_", "*", "btab_Bracelets"}]}], "]"}], "[", "inds___", "]"}], ":=", 
  RowBox[{"k", "*", 
   RowBox[{
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tens", ",", "btab"}], "]"}], "[", "inds", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClassTensor", "/:", 
  RowBox[{
   RowBox[{"ClassTensor", "[", 
    RowBox[{"tens_", ",", "exp_Plus"}], "]"}], "[", "inds___", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ClassTensor", "[", 
      RowBox[{"tens", ",", "#"}], "]"}], "[", "inds", "]"}], "&"}], "/@", 
   "exp"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClassTensor", "/:", 
  RowBox[{
   RowBox[{"ClassTensor", "[", 
    RowBox[{"tens_", ",", 
     RowBox[{"k_", "*", "exp_Plus"}]}], "]"}], "[", "inds___", "]"}], ":=", 
  RowBox[{"k", "*", 
   RowBox[{
    RowBox[{"ClassTensor", "[", 
     RowBox[{"tens", ",", "exp"}], "]"}], "[", "inds", "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.883294150081057*^9, 3.883295001726501*^9, 
  3.8832955149126596`*^9},ExpressionUUID->"487be4f2-8a90-4183-94a7-\
dee52b612f76"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
b. Internal Symmetry of Class Tensor and the function ExpandClassTensor \
\>", "Subsubsection",
 CellChangeTimes->{{3.8832183354846687`*^9, 
  3.8832183871350203`*^9}},ExpressionUUID->"450ec50c-21cb-429f-b5e1-\
51c7d37d5289"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", "**", " ", "This"}], " ", "is", " ", "the", " ", "same", " ",
    "code", " ", "as", " ", "in", " ", "the", " ", "SymManipulator", " ", 
   "package"}], " ", "*******)"}]], "Input",
 CellChangeTimes->{{3.883218394812439*^9, 
  3.883218417697452*^9}},ExpressionUUID->"a63e206c-9624-4070-b729-\
9473e162de34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InternalExprClassTensor", "[", 
   RowBox[{"ClassTensor", "[", 
    RowBox[{"headlist_", ",", "bracelet_"}], "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"numindices", "=", 
       RowBox[{"Length", "/@", 
        RowBox[{"SlotsOfTensor", "/@", "headlist"}]}]}], ",", "slotlist", ",",
       "partitionedslots", ",", "internalexpr"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"slotlist", "=", 
      RowBox[{"xAct`xTensor`Private`slot", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Plus", "@@", "numindices"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"partitionedslots", "=", 
      RowBox[{"IndexList", "@@@", 
       RowBox[{"Internal`PartitionRagged", "[", 
        RowBox[{"slotlist", ",", "numindices"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"internalexpr", "=", 
      RowBox[{"Inner", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#1", "@@", "#2"}], ")"}], "&"}], ",", "headlist", ",", 
        "partitionedslots", ",", "Times"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883129884845647*^9, 3.883129906420703*^9}, {
   3.883130942172567*^9, 3.883130987523264*^9}, 3.8831310321903143`*^9, 
   3.883131080530263*^9, {3.883131457153371*^9, 3.883131484689468*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"23431c4a-12df-4fee-88aa-ba72c5189870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InternalSymmetryClassTensor", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{"ClassTensor", "[", 
      RowBox[{"headlist_", ",", "bracelet_"}], "]"}], ")"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"internalexpr", "=", 
       RowBox[{"InternalExprClassTensor", "[", "x", "]"}]}], ",", 
      RowBox[{"tempinds", "=", 
       RowBox[{"DummyIn", "/@", 
        RowBox[{"SlotsOfTensor", "[", "x", "]"}]}]}], ",", "rule"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rule", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"List", "@@", "#"}], "&"}], ",", 
            RowBox[{"List", "@@", "internalexpr"}]}], "]"}], "]"}], ",", 
         "tempinds"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SymmetryOf", "[", 
       RowBox[{"internalexpr", "/.", "rule"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[31]:=",ExpressionUUID->"58d2a6b9-cbcf-428d-b913-9b56fa9c069b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpandClassTensor1", "[", 
   RowBox[{
    RowBox[{"x", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ClassTensor", "[", 
        RowBox[{"headlist_", ",", "bracelet_"}], "]"}], "[", "inds___", "]"}],
       ")"}]}], ",", "g_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"indlist", "=", 
       RowBox[{"List", "[", "inds", "]"}]}], ",", 
      RowBox[{"slotlist", "=", 
       RowBox[{"xAct`xTensor`Private`slot", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", 
          RowBox[{"List", "[", "inds", "]"}], "]"}], "]"}]}]}], ",", 
      RowBox[{"internalexpr", "=", 
       RowBox[{"InternalExprClassTensor", "[", 
        RowBox[{"Head", "@", "x"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"TracePermuteIndices", "[", 
     RowBox[{
      RowBox[{"internalexpr", "/.", 
       RowBox[{"Thread", "@", 
        RowBox[{"Rule", "[", 
         RowBox[{"slotlist", ",", "indlist"}], "]"}]}]}], ",", 
      RowBox[{"List", "[", "inds", "]"}], ",", "bracelet", ",", "g"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandClassTensor1", "[", 
   RowBox[{"x", ":", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"headlist_", ",", "bracelet_"}], "]"}], "[", "inds___", "]"}], 
     ")"}]}], "]"}], ":=", 
  RowBox[{"ExpandClassTensor1", "[", 
   RowBox[{"x", ",", 
    RowBox[{"First", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"MetricsOfVBundle", "[", 
        RowBox[{"VBundleOfIndex", "[", 
         RowBox[{
          RowBox[{"List", "[", "inds", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"SymplecticFormsOfVBundle", "[", 
        RowBox[{"VBundleOfIndex", "[", 
         RowBox[{
          RowBox[{"List", "[", "inds", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.883134901656081*^9, 3.8831349766421337`*^9}, {
  3.883218507833178*^9, 
  3.883218508523057*^9}},ExpressionUUID->"00c9776d-b30e-448b-a0e3-\
02188b8c77bb"],

Cell["\<\
TO DO : Develop a \[OpenCurlyDoubleQuote]SmartExpandClassTensor\
\[CloseCurlyDoubleQuote] as in SymManipulator (Schreier Sims Algorithm at the \
level Brauer algebra ? ) (Maybe a lot of work ! but necessary ... )\
\>", "Text",
 CellChangeTimes->{{3.88321851343476*^9, 3.883218606919796*^9}, {
  3.883220011496759*^9, 
  3.8832200467225437`*^9}},ExpressionUUID->"d2ba1be8-3a2a-468f-8abe-\
3f405b59511e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandClassTensor", "[", 
   RowBox[{"expr_", ",", "g___"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"expr", "/.", 
   RowBox[{
    RowBox[{"x", ":", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ClassTensor", "[", "___", "]"}], "[", "inds___", "]"}], 
      ")"}]}], ":>", 
    RowBox[{"ExpandClassTensor1", "[", 
     RowBox[{"x", ",", "g"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.484471790717*^9, 3.484471838552*^9}, 3.4937201398962*^9,
    3.494752741707*^9, 3.515752680206894*^9, {3.5157527152738996`*^9, 
   3.515752716761985*^9}, {3.5260454092890434`*^9, 3.5260454277741003`*^9}, {
   3.5342492362826595`*^9, 3.53424923668826*^9}, {3.5342493832973175`*^9, 
   3.534249429535799*^9}, {3.5342495088463383`*^9, 3.5342495665820394`*^9}, {
   3.5342503602958336`*^9, 3.534250361684236*^9}, {3.5342504998224783`*^9, 
   3.5342505031608844`*^9}, 3.5876525014853573`*^9, 3.5876525427796297`*^9, {
   3.587653756218562*^9, 3.587653757809765*^9}, {3.883219927971715*^9, 
   3.883219931811268*^9}, {3.883219962113347*^9, 3.88321998713757*^9}, {
   3.892024715402811*^9, 
   3.892024736447221*^9}},ExpressionUUID->"5afe4be0-1e64-4cc3-849f-\
d21b17e95e16"]
}, Open  ]],

Cell[CellGroupData[{

Cell["c. ToClassTensor", "Subsubsection",
 CellChangeTimes->{{3.8832183680655737`*^9, 3.8832183688743553`*^9}, {
  3.8832925012717333`*^9, 3.883292504725862*^9}, {3.8832930861623497`*^9, 
  3.88329308812709*^9}},ExpressionUUID->"f60c71de-fa0a-468a-bb94-\
3111d0903ac9"],

Cell["Step 0: Expand input.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5901453856075287`*^9, 3.590145389710336*^9}, {
  3.5901456190619392`*^9, 
  3.5901456257543507`*^9}},ExpressionUUID->"1230983f-e254-47f1-b201-\
5d2fc3e08d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToClassTensor", "[", 
   RowBox[{"expr_", ",", "class_"}], "]"}], ":=", 
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{"xAct`xTensor`Private`MathInputExpand", "@", "expr"}], ",", 
    "class"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.590145415731182*^9, 3.5901454513460445`*^9}, {
   3.5901455140113544`*^9, 3.5901455339169893`*^9}, 3.590145633850765*^9, {
   3.883232071548636*^9, 3.883232080867773*^9}, {3.8832327650396643`*^9, 
   3.883232794843862*^9}, {3.883292038023696*^9, 
   3.883292038212768*^9}},ExpressionUUID->"a765f928-49c8-4898-a0b4-\
d1ae398ccc19"],

Cell["Step 1: Reduce to a product of tensors", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5901453926431413`*^9, 3.5901453951859455`*^9}, {
  3.590145628421955*^9, 3.5901456285623555`*^9}, {3.5901456617748137`*^9, 
  3.5901456630852165`*^9}, {3.590145735859344*^9, 
  3.590145740289752*^9}},ExpressionUUID->"3b49291f-7cdf-4ccd-a0ba-\
ff095877fa08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{"expr_Plus", ",", "other__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ToClassTensor1", "[", 
     RowBox[{"#", ",", "other"}], "]"}], "&"}], "/@", "expr"}]}], "\n", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{"0", ",", "other__"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5901459387689004`*^9, {3.883232041738141*^9, 3.883232044928751*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"7b976736-6dfc-4331-be9d-5794618bd8ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x_", "?", "ConstantQ"}], " ", "y_"}], ",", "other__"}], "]"}], ":=", 
  RowBox[{"x", " ", 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{"y", ",", "other"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Scalar", "[", "x_", "]"}], " ", "y_"}], ",", "other__"}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"Scalar", "[", "x", "]"}], " ", 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{"y", ",", "other"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"F_", "?", "ScalarFunctionQ"}], ")"}], "[", 
      RowBox[{"Scalar", "[", "x_", "]"}], "]"}], "y_"}], ",", "other__"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"Scalar", "[", "x", "]"}], "]"}], " ", 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{"y", ",", "other"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"F_", "?", "ScalarFunctionQ"}], ")"}], "[", 
      RowBox[{
       RowBox[{"x_", "?", "xTensorQ"}], "[", "]"}], "]"}], "y_"}], ",", 
    "other__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{"x", "[", "]"}], "]"}], " ", 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{"y", ",", "other"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"x_", "?", "ScalarQ"}], " ", "y_"}], ",", "other__"}], "]"}], ":=", 
  RowBox[{"x", " ", 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{"y", ",", "other"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"x___", ",", 
      RowBox[{
       RowBox[{"y_", "?", "xTensorQ"}], "[", "]"}], ",", "z___"}], "]"}], ",",
     "other__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"y", "[", "]"}], 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"x", ",", "z"}], "]"}], ",", "other"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"x___", ",", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"y_", "?", "xTensorQ"}], "[", "]"}], ",", "n_"}], "]"}], ",",
       "z___"}], "]"}], ",", "other__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"y", "[", "]"}], ",", "n"}], "]"}], 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"x", ",", "z"}], "]"}], ",", "other"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"x___", ",", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"Scalar", "[", "y_", "]"}], ",", "n_"}], "]"}], ",", "z___"}],
      "]"}], ",", "other__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Power", "[", 
    RowBox[{
     RowBox[{"Scalar", "[", "y", "]"}], ",", "n"}], "]"}], 
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"x", ",", "z"}], "]"}], ",", "other"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToClassTensor1", "[", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{"x___", ",", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"y_", "?", "ScalarQ"}], " ", ",", "n_"}], "]"}], ",", 
       "z___"}], "]"}], ",", "other__"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Power", "[", 
     RowBox[{"y", ",", "n"}], "]"}], 
    RowBox[{"ToClassTensor1", "[", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"x", ",", "z"}], "]"}], ",", "other"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{"expr", ":", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"_", "?", "xTensorQ"}], "[", "__", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"_", "?", "xTensorQ"}], "[", "__", "]"}], "..."}]}], "]"}]}],
     ",", "other__"}], "]"}], ":=", 
  RowBox[{"ToClassTensor2", "[", 
   RowBox[{"expr", ",", "other"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToClassTensor1", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"T_", "?", "xTensorQ"}], "[", "tensorinds__", "]"}], ",", 
    "other__"}], "]"}], ":=", 
  RowBox[{"ToClassTensor2", "[", 
   RowBox[{
    RowBox[{"T", "[", "tensorinds", "]"}], ",", "other"}], "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.4806759047243*^9, 3.4806759433810997`*^9}, {
   3.4806760007267*^9, 3.4806760008827*^9}, {3.4806762501707*^9, 
   3.4806762543827*^9}, {3.4807491477678003`*^9, 3.4807491528378*^9}, {
   3.5069296016964006`*^9, 3.5069296260480003`*^9}, {3.5303392049899635`*^9, 
   3.5303392629752655`*^9}, {3.5303393462255936`*^9, 3.530339379356488*^9}, {
   3.5303395593277817`*^9, 3.5303395965239096`*^9}, {3.5303396538321877`*^9, 
   3.53033966855503*^9}, {3.530339718859907*^9, 3.5303397560450335`*^9}, {
   3.561373057914609*^9, 3.5613730781478443`*^9}, {3.5613731118907037`*^9, 
   3.5613731141995077`*^9}, {3.590145542465804*^9, 3.590145591761891*^9}, {
   3.5901456358631687`*^9, 3.590145637859972*^9}, {3.5901457447045593`*^9, 
   3.5901457832834272`*^9}, 3.590145934525693*^9, {3.5901459781121693`*^9, 
   3.5901459784241705`*^9}, {3.5908341902820997`*^9, 
   3.5908341976321096`*^9}, {3.883231832695993*^9, 3.883231844527833*^9}, {
   3.883231986756063*^9, 3.883232025876728*^9}, {3.883232841923864*^9, 
   3.883232846136992*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0bee0208-0f35-4fb8-a10d-4470fa3c6285"],

Cell["Step 2: ToClassTensor on product of tensors.", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.5901453192606125`*^9, 3.5901453238002205`*^9}, {
  3.590146459404215*^9, 3.5901464783582487`*^9}, {3.883232114132115*^9, 
  3.883232116470999*^9}, {3.888571085116641*^9, 
  3.88857109147691*^9}},ExpressionUUID->"1cbcf22b-3cfe-4114-a27f-\
0af080cdc678"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TimesToList", "[", "expr_Times", "]"}], ":=", 
  RowBox[{"List", "@@", "expr"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimesToList", "[", 
   RowBox[{
    RowBox[{"xAct`xTensor`Private`VerbatimProduct", "[", "Times", "]"}], "[", 
    "expr__", "]"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"List", "[", "expr", "]"}], "/.", 
    RowBox[{
     RowBox[{"xAct`xTensor`Private`Scalar1", "[", "Scalarexpr_", "]"}], ":>", 
     "Scalarexpr"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimesToList", "[", 
   RowBox[{
    RowBox[{"T_", "?", "xTensorQ"}], "[", "tensorinds__", "]"}], "]"}], ":=", 
  
  RowBox[{"List", "[", 
   RowBox[{"T", "[", "tensorinds", "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4955433817104*^9, 3.4955433834576*^9}, {
  3.544091693999056*^9, 3.5440917052310753`*^9}, {3.883233278963225*^9, 
  3.883233283595387*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"8e65383b-2bf7-4d66-ad67-838b82572a69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToClassTensor2", "[", 
   RowBox[{"expr_", ",", "class_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "slotexpr", ",", "slotrules", ",", "internalsym", ",", 
      "slotexprlist", ",", " ", "slotlist1", ",", " ", "slotlist2", ",", 
      "HeadList", ",", " ", "tensorinds"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "slotexpr", ",", "slotrules", ",", "internalsym"}], 
       "}"}], "=", 
      RowBox[{"List", "@@", 
       RowBox[{"SymmetryOf", "[", "expr", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Sort", " ", "the", " ", "tensors"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"slotexprlist", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"TimesToList", "@", "slotexpr"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slotlist1", "=", 
      RowBox[{"Join", "@@", 
       RowBox[{"List", "@@@", "slotexprlist"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Remove", " ", "slots", " ", "that", " ", "does", " ", "not", " ", 
       "contain", " ", "abstract", " ", "indices"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"slotlist2", "=", 
      RowBox[{"Select", "[", 
       RowBox[{"slotlist1", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", 
          "xAct`xTensor`Private`slot"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"HeadList", "=", 
      RowBox[{"Head", "/@", "slotexprlist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tensorinds", "=", 
      RowBox[{"slotlist1", "/.", "slotrules"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"HeadList", ",", "class"}], "]"}], "@@", "tensorinds"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5260451753516626`*^9, 3.5260452437545753`*^9}, {
   3.526049262340657*^9, 3.526049277051483*^9}, {3.53769451778975*^9, 
   3.5376945542938147`*^9}, {3.537694740824342*^9, 3.537694741853944*^9}, {
   3.537694820150481*^9, 3.5376948530665393`*^9}, {3.5376953690218453`*^9, 
   3.537695372812652*^9}, {3.5376954586128025`*^9, 3.537695489906458*^9}, {
   3.5376955534297695`*^9, 3.5376955698877983`*^9}, {3.537695779037366*^9, 
   3.537695811190022*^9}, {3.537695866211319*^9, 3.5376959024345827`*^9}, {
   3.537696094283719*^9, 3.5376961086825447`*^9}, {3.537696168274649*^9, 
   3.5376961848262787`*^9}, {3.53769633365054*^9, 3.5376963857858315`*^9}, {
   3.5376965434553084`*^9, 3.537696565732147*^9}, {3.5376969832522807`*^9, 
   3.537697021004347*^9}, {3.5376970787088485`*^9, 3.5376970883964653`*^9}, {
   3.5376972510423512`*^9, 3.537697327513685*^9}, {3.53769740414102*^9, 
   3.537697444451491*^9}, 3.5441028149857893`*^9, {3.544102893017126*^9, 
   3.544103031404969*^9}, {3.544103093992279*^9, 3.544103149699977*^9}, {
   3.5441076089552097`*^9, 3.5441076128552165`*^9}, 3.5634286701359267`*^9, {
   3.5678605942037807`*^9, 3.5678606151702175`*^9}, {3.567860669723513*^9, 
   3.5678607246668096`*^9}, {3.567860761904075*^9, 3.5678608031817474`*^9}, {
   3.5678615731533003`*^9, 3.567861600593748*^9}, {3.567861693944312*^9, 
   3.567861694334313*^9}, {3.567861791179283*^9, 3.5678617914444838`*^9}, {
   3.5678620138696737`*^9, 3.5678620175980806`*^9}, {3.567862151695916*^9, 
   3.5678621866243773`*^9}, 3.567862754279175*^9, {3.5679129491658506`*^9, 
   3.567913041081212*^9}, {3.567913395217434*^9, 3.5679134138438663`*^9}, {
   3.5689548532108946`*^9, 3.56895489072896*^9}, {3.574830260476557*^9, 
   3.574830314109451*^9}, {3.5748303465263076`*^9, 3.5748303663695426`*^9}, {
   3.574831933408895*^9, 3.5748319500853243`*^9}, 3.590146361482843*^9, {
   3.590147112281962*^9, 3.5901471195671744`*^9}, {3.6196885704675083`*^9, 
   3.619688570947509*^9}, {3.619688659627633*^9, 3.6196886758176556`*^9}, {
   3.8832321528715553`*^9, 3.8832321582516727`*^9}, {3.8832322326709337`*^9, 
   3.883232287708132*^9}, {3.883232389752625*^9, 3.883232403683201*^9}, {
   3.883232448938401*^9, 3.88323251133834*^9}, {3.883232559348528*^9, 
   3.883232598099956*^9}, {3.8832326795728703`*^9, 3.883232685255517*^9}, {
   3.883232737944138*^9, 3.883232738099792*^9}, 3.883232807666828*^9, {
   3.8832328548241987`*^9, 3.883232855427986*^9}, {3.883233031510687*^9, 
   3.883233144415133*^9}, {3.8832332932361193`*^9, 3.883233346887762*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"eb06141c-07d2-4c37-836d-8c4ced674b81"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ClassTensor", "::", "class"}], "=", 
    "\"\<The size of `1` should be less or equal to the number of \
indices\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{"ClassTensor", "/:", 
    RowBox[{
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens_", ",", "btab_"}], "]"}], "[", "inds___", "]"}], "/;", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "@@", "btab"}], "]"}], ">", 
      RowBox[{"Length", "[", 
       RowBox[{"List", "[", "inds", "]"}], "]"}]}]}], ":=", 
    RowBox[{"Throw", "@", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ClassTensor", "::", "class"}], ",", "btab"}], "]"}]}]}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8400798210997887`*^9, 3.840079823857358*^9}, {
   3.840080436880395*^9, 3.840080474218355*^9}, {3.8400805209094152`*^9, 
   3.8400805216145687`*^9}, {3.841735632131194*^9, 3.841735814699993*^9}, {
   3.8436270121825647`*^9, 3.843627046553306*^9}, {3.843627396436276*^9, 
   3.8436273965354652`*^9}, 3.847183186234448*^9, {3.8471834572613297`*^9, 
   3.847183462033813*^9}, {3.847183506829822*^9, 3.847183625095564*^9}, {
   3.8471836578824263`*^9, 3.8471836908461657`*^9}, {3.847184196044978*^9, 
   3.847184204694481*^9}, {3.847184432195463*^9, 3.847184523824856*^9}, {
   3.847184569476603*^9, 3.847184570015162*^9}, 3.84718464273174*^9, {
   3.882099423381014*^9, 3.882099479311014*^9}, {3.882099512624309*^9, 
   3.882099702992463*^9}, {3.8820997385876417`*^9, 3.882099783178926*^9}, {
   3.882986901930722*^9, 3.882986918244771*^9}, 
   3.8832923141129713`*^9},ExpressionUUID->"cd17faec-fb8a-461f-b95d-\
4ce271836259"]
}, Open  ]],

Cell[CellGroupData[{

Cell["d. Action of classes on ClassTensors", "Subsubsection",
 CellChangeTimes->{{3.8832930986427593`*^9, 
  3.8832931128837643`*^9}},ExpressionUUID->"cdd972f0-b3d3-48dc-b2ee-\
9adf36c71e71"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**", "**", " ", 
      "Need"}], " ", "to", " ", "check", " ", "convention", " ", 
     RowBox[{"right", "/", "left"}], " ", "action"}], " ", "..."}], " ", "**",
    "**", "**", "**", "**", "**", "**", "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.8832931506417303`*^9, 
  3.883293178803916*^9}},ExpressionUUID->"fc2c91ac-779f-46ca-9ac1-\
fb1505520419"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClassAction0", "[", 
   RowBox[{"btab1_Bracelets", ",", 
    RowBox[{
     RowBox[{"ClassTensor", "[", 
      RowBox[{"tens_", ",", 
       RowBox[{"btab2_", "?", "IdentityTabQ"}]}], "]"}], "[", "inds___", 
     "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ClassTensor", "[", 
    RowBox[{"tens", ",", "btab1"}], "]"}], "[", "inds", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClassAction0", "[", 
   RowBox[{
    RowBox[{"btab1_", "?", "IdentityTabQ"}], ",", 
    RowBox[{
     RowBox[{"ClassTensor", "[", 
      RowBox[{"tens_", ",", "btab2_"}], "]"}], "[", "inds___", "]"}]}], "]"}],
   ":=", 
  RowBox[{
   RowBox[{"ClassTensor", "[", 
    RowBox[{"tens", ",", "btab2"}], "]"}], "[", "inds", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClassAction0", "[", 
    RowBox[{"btab1_Bracelets", ",", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens_", ",", "btab2_"}], "]"}], "[", "inds___", "]"}]}], 
    "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SymplecticFormQ", "[", 
      RowBox[{"BilinearFormOfTensor", "[", 
       RowBox[{"tens", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens", ",", 
        RowBox[{"ConjugacyClassProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", 
            RowBox[{"DimOfManifold", "@@", 
             RowBox[{"DependenciesOfTensor", "[", 
              RowBox[{"tens", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "}"}], ",", "btab1",
           ",", "btab2"}], "]"}]}], "]"}], "[", "inds", "]"}], ",", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens", ",", 
        RowBox[{"ConjugacyClassProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"DimOfManifold", "@@", 
            RowBox[{"DependenciesOfTensor", "[", 
             RowBox[{"tens", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", "btab1", 
          ",", "btab2"}], "]"}]}], "]"}], "[", "inds", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClassAction", "[", 
   RowBox[{"btab1_Bracelets", ",", "exp_"}], "]"}], ":=", 
  RowBox[{"exp", "/.", 
   RowBox[{
    RowBox[{"x", ":", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens_", ",", "btab2_"}], "]"}], "[", "inds___", "]"}]}], ":>", 
    RowBox[{"ClassAction0", "[", 
     RowBox[{"btab1", ",", "x"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClassAction", "[", 
   RowBox[{"btab1_Bracelets", ",", 
    RowBox[{"k_", "*", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens_", ",", "btab2_"}], "]"}], "[", "inds___", "]"}]}]}], 
   "]"}], ":=", 
  RowBox[{"k", "*", 
   RowBox[{"ClassAction", "[", 
    RowBox[{"btab1", ",", 
     RowBox[{
      RowBox[{"ClassTensor", "[", 
       RowBox[{"tens", ",", "btab2"}], "]"}], "[", "inds", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClassAction", "[", 
   RowBox[{"btab1_Bracelets", ",", "exp_Plus"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ClassAction", "[", 
      RowBox[{"btab1", ",", "#"}], "]"}], "&"}], ",", "exp"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8829866044284*^9, 3.882986848382292*^9}, {
   3.882987155113817*^9, 3.882987157801297*^9}, 3.8829872484884367`*^9, 
   3.882987345243044*^9, 3.882987612370405*^9, {3.8829877596196632`*^9, 
   3.882987760609497*^9}, {3.882987808975637*^9, 3.882987811219605*^9}, {
   3.882987850161737*^9, 3.8829878867020187`*^9}, {3.883036384181568*^9, 
   3.883036399865391*^9}, {3.8830364325852957`*^9, 3.883036432959605*^9}, {
   3.88303656470385*^9, 3.883036573850545*^9}, {3.883293029623054*^9, 
   3.883293031126045*^9}, {3.883294151540625*^9, 3.883294153262396*^9}, {
   3.8832950017294407`*^9, 3.8832950017361593`*^9}, {3.883295514916275*^9, 
   3.883295514922285*^9}, 3.883320665455248*^9, 3.8834711400016947`*^9, {
   3.888650175664276*^9, 3.888650190158086*^9}, {3.8915112154112473`*^9, 
   3.8915112228809147`*^9}, {3.89210106417903*^9, 3.8921012312763557`*^9}, {
   3.892101263260302*^9, 3.892101268418642*^9}, {3.892101303791296*^9, 
   3.892101335958845*^9}},ExpressionUUID->"69ecee5e-7626-4330-848e-\
1e3efb8a6108"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["4. Tools from the representation theory of the \
symmetric group.",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.891341435083083*^9, 
  3.891341468529962*^9}},ExpressionUUID->"21bee6f8-05a6-441e-b6c1-\
f71abc539285"],

Cell[CellGroupData[{

Cell["4.1. CentralYoungProject", "Subsection",
 CellChangeTimes->{{3.8820217237296553`*^9, 3.882021737451881*^9}, {
  3.891341565196175*^9, 
  3.891341565582101*^9}},ExpressionUUID->"5c4c0fc9-acec-45a8-8ceb-\
9879ad97f10d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "CentralYoungProject", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CentralYoungProject", "[", 
    RowBox[{"exp_", ",", "\[Mu]_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"indice", "=", 
        RowBox[{"List", "@@", 
         RowBox[{
          RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}]}], ",",
        "output"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "output", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "CentralYoungProject", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MapIfPlus", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TracePermuteIndices", "[", 
            RowBox[{"#", ",", "indice", ",", 
             RowBox[{"CentralYoungProjector", "[", "\[Mu]", "]"}]}], "]"}], 
           "&"}], ",", "exp"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"output", "===", "ClassTensor"}], ",", 
          RowBox[{"ToClassTensor", "[", 
           RowBox[{"exp", ",", 
            RowBox[{"CentralYoungProjector", "[", "\[Mu]", "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.881844412009379*^9, 3.881844412999488*^9}, {
   3.8818444457893047`*^9, 3.8818445501852903`*^9}, {3.88202223551115*^9, 
   3.88202225695725*^9}, {3.8822655297516737`*^9, 3.8822656170493383`*^9}, {
   3.882265936784354*^9, 3.8822659844025*^9}, {3.886589384648245*^9, 
   3.886589384649912*^9}, {3.888568880063641*^9, 3.888568908629861*^9}, 
   3.888571219427219*^9},ExpressionUUID->"9d5866af-8157-4bc7-827d-\
fbcea953375b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.2. YoungSymmetrize", "Subsection",
 CellChangeTimes->{{3.882021746005343*^9, 3.8820217506097193`*^9}, {
  3.89134156886975*^9, 
  3.891341569892591*^9}},ExpressionUUID->"30d7f9e1-7257-4d05-99e6-\
ca63765019af"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"**", "**"}], "**"}], "*", " ", 
   RowBox[{"Experimental", " ", ":", " ", 
    RowBox[{"SymH", " ", "notation", " ", "for", " ", "YoungSymmetrize"}]}]}],
   "  ", "********)"}]], "Input",
 CellChangeTimes->{{3.882021838063599*^9, 3.882021855016368*^9}, {
  3.8820897952761307`*^9, 
  3.88208981038596*^9}},ExpressionUUID->"242cd9c3-c7a1-4a30-bc5e-\
220392680c89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymTableau", "[", 
   RowBox[{
    RowBox[{"tableau", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
    RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tab", ",", "manifestsym", ",", "transpose", ",", "sgs", ",", "cycles"}],
      "}"}], ",", 
    RowBox[{
     RowBox[{"manifestsym", "=", 
      RowBox[{
       RowBox[{"ManifestSym", "/.", " ", 
        RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
       RowBox[{"Options", "[", "YoungSymmetrizer", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"transpose", "=", 
      RowBox[{"TransposeTableau", "[", "tableau", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "The", " ", "first", " ", "set", " ", "of", " ", "cycles", " ", "is", 
       " ", "simply", " ", "the", " ", 
       RowBox[{"(", "anti", ")"}], "symmetrization", " ", "of", " ", "the", 
       " ", 
       RowBox[{"tableau", "."}]}], "*)"}], 
     RowBox[{"sgs", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"manifestsym", "===", "Antisymmetric"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Antisymmetric", "[", 
           RowBox[{"#", ",", "Cycles"}], "]"}], "&"}], "/@", "transpose"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Symmetric", "[", 
           RowBox[{"#", ",", "Cycles"}], "]"}], "&"}], "/@", "tableau"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cycles", "=", 
      RowBox[{"sgs", "/.", " ", 
       RowBox[{
        RowBox[{"StrongGenSet", "[", 
         RowBox[{"_List", ",", 
          RowBox[{"GenSet", "[", "c___", "]"}]}], "]"}], ":>", "c"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"StrongGenSet", "[", 
      RowBox[{
       RowBox[{"Union", "@@", "tableau"}], ",", 
       RowBox[{"GenSet", "@@", "cycles"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.87182044147548*^9, 3.871820533822798*^9}, 
   3.871820632227346*^9, {3.881992033708276*^9, 3.8819920386723957`*^9}, 
   3.893405762972342*^9, 
   3.89348631661495*^9},ExpressionUUID->"71f41b6e-33c5-4825-95d2-\
413191e6ec0a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"signperm", "[", "cycles_Cycles", "]"}], ":=", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"signperm", "[", 
   RowBox[{"-", "cycles_Cycles"}], "]"}], ":=", 
  RowBox[{"-", "1"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.871891001990383*^9, 3.871891060826281*^9}},
 CellLabel->
  "In[289]:=",ExpressionUUID->"8b005a18-fcd4-422b-9838-e5e6233f7f5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", " ", "Function"}], " ", "from", " ", 
    RowBox[{"xTras", " ", "**", "**", "**", "**", "**", "**"}]}], "******)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TableauSymmetric", "[", 
     RowBox[{
      RowBox[{"tableau_", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
      RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tab", ",", "manifestsym", ",", "transpose", ",", "sgs", ",", "cycles",
         ",", "samelengths", ",", "pairs", ",", "extracycles", ",", "sign"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"manifestsym", "=", 
        RowBox[{
         RowBox[{"ManifestSym", "/.", " ", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", " ", 
         RowBox[{"Options", "[", "YoungSymmetrizer", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"transpose", "=", 
        RowBox[{"TransposeTableau", "[", "tableau", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "first", " ", "set", " ", "of", " ", "cycles", " ", "is", 
         " ", "simply", " ", "the", " ", 
         RowBox[{"(", "anti", ")"}], "symmetrization", " ", "of", " ", "the", 
         " ", 
         RowBox[{"tableau", "."}]}], "*)"}], 
       RowBox[{"sgs", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"manifestsym", "===", "Antisymmetric"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"#", ",", "Cycles"}], "]"}], "&"}], "/@", "transpose"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Symmetric", "[", 
             RowBox[{"#", ",", "Cycles"}], "]"}], "&"}], "/@", "tableau"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cycles", "=", 
        RowBox[{"sgs", "/.", " ", 
         RowBox[{
          RowBox[{"StrongGenSet", "[", 
           RowBox[{"_List", ",", 
            RowBox[{"GenSet", "[", "c___", "]"}]}], "]"}], ":>", "c"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "second", " ", "set", " ", "of", " ", "cycles", " ", 
         "comes", " ", "from", " ", "the", " ", "additional", " ", "symmetry",
          " ", "present", " ", "when", " ", "two", " ", "or", " ", "more", 
         " ", "rows", " ", "or", " ", "columns", " ", "have", " ", "the", " ",
          "same", " ", "length", " ", "and", " ", "can", " ", "be", " ", 
         RowBox[{"interchanged", "."}]}], "*)"}], 
       RowBox[{"tab", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"manifestsym", "===", "Antisymmetric"}], ",", "transpose", 
          ",", "tableau"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"samelengths", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"Can", "'"}], "t", " ", "use", " ", "GatherBy", " ", 
            "here"}], ",", 
           RowBox[{"because", " ", 
            RowBox[{"that", "'"}], "s", " ", "MMA", " ", "7", " ", "and", " ", 
            RowBox[{"newer", "."}]}]}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"x", ",", 
             RowBox[{"Select", "[", 
              RowBox[{"tab", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "===", "x"}], "&"}]}], 
              "]"}]}], "]"}], "/@", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Length", "/@", "tab"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"manifestsym", "===", "Antisymmetric"}], ",", 
         RowBox[{"sign", "=", "1"}], ",", 
         RowBox[{"sign", "=", 
          RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pairs", "[", "list_List", "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{"Cycles", "@@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"list", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"list", "[", 
               RowBox[{"[", 
                RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Length", "@", "list"}], "-", "1"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extracycles", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"pairs", "/@", "samelengths"}], "]"}], "/.", " ", 
         RowBox[{"c_Cycles", ":>", 
          RowBox[{
           RowBox[{"sign", "^", 
            RowBox[{"Length", "[", "c", "]"}]}], "*", "c"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"The", " ", "complete", " ", "SGS", " ", "is", " ", 
         RowBox[{"then", ":"}]}], "*)"}], 
       RowBox[{"StrongGenSet", "[", 
        RowBox[{
         RowBox[{"Union", "@@", "tableau"}], ",", 
         RowBox[{"GenSet", "@@", 
          RowBox[{"Join", "[", 
           RowBox[{"cycles", ",", "extracycles"}], "]"}]}]}], "]"}]}]}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8707671492773447`*^9, 3.870767149278154*^9}, {
   3.870767197860669*^9, 3.8707672053180943`*^9}, {3.8819992258468037`*^9, 
   3.8819992514519663`*^9}, 3.881999285491622*^9, {3.882021869295992*^9, 
   3.8820218794892063`*^9}, 3.8934057661429167`*^9, 
   3.8934863170586853`*^9},ExpressionUUID->"bb642d14-9894-4ddd-a8e2-\
2db72eb80c0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Options", "[", "YoungProjectSymH", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"ManifestSym", "->", "Symmetric"}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"YoungProjectSymH", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}], ",", 
      "stdtab_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"manifestsym", ",", 
        RowBox[{"order", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"Flatten", "[", "stdtab", "]"}]}]}], ",", "sgs1", ",", 
        "sgs2", ",", "group1", ",", "group2", ",", "symfactor1", ",", 
        "symfactor11", ",", "symfactor2", ",", "supportstring", ",", 
        "indiceslist", ",", "signs", ",", 
        RowBox[{"multiplicities", "=", 
         RowBox[{"DimOfIrrepSn", "[", 
          RowBox[{"Length", "/@", "stdtab"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "manifestsym", "}"}], "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{
          RowBox[{"{", "YoungSymmetrizer", "}"}], ",", 
          RowBox[{"{", "options", "}"}], ",", 
          RowBox[{"{", "ManifestSym", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"manifestsym", "===", "Antisymmetric"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sgs1", "=", 
           RowBox[{"TableauSymmetric", "[", 
            RowBox[{"stdtab", ",", 
             RowBox[{"ManifestSym", "->", "Symmetric"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sgs2", "=", 
           RowBox[{"SymTableau", "[", 
            RowBox[{"stdtab", ",", 
             RowBox[{"ManifestSym", "->", "Antisymmetric"}]}], "]"}]}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sgs1", "=", 
           RowBox[{"TableauSymmetric", "[", 
            RowBox[{"stdtab", ",", 
             RowBox[{"ManifestSym", "->", "Antisymmetric"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sgs2", "=", 
           RowBox[{"SymTableau", "[", 
            RowBox[{"stdtab", ",", 
             RowBox[{"ManifestSym", "->", "Symmetric"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"group1", "=", 
        RowBox[{
         RowBox[{"List", "@@", 
          RowBox[{"Dimino", "[", "sgs1", "]"}]}], "/.", 
         RowBox[{"ID", "->", 
          RowBox[{"Cycles", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"group2", "=", 
        RowBox[{
         RowBox[{"List", "@@", 
          RowBox[{"Dimino", "[", "sgs2", "]"}]}], "/.", 
         RowBox[{"ID", "->", 
          RowBox[{"Cycles", "[", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"symfactor1", "=", 
        RowBox[{"OrderOfGroup", "[", "sgs1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"symfactor2", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Intersection", "[", 
          RowBox[{"group1", ",", "group2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"supportstring", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", 
              RowBox[{"sgs1", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "\"\<(\>\""}], "]"}], 
           ",", "\"\<)\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"signs", "=", 
        RowBox[{"signperm", "/@", "group2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"indiceslist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"PermuteList", "[", 
           RowBox[{
            RowBox[{"List", "[", "inds", "]"}], ",", "#"}], "]"}], "&"}], "/@",
          "group2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"symfactor1", "/", "symfactor2"}], "*", 
        RowBox[{"multiplicities", "/", 
         RowBox[{"(", 
          RowBox[{"order", "!"}], ")"}]}], 
        RowBox[{"Plus", "@@", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "*", 
             RowBox[{"ToCanonical", "[", "#2", "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"signs", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"SymH", "[", 
                  RowBox[{
                   RowBox[{"{", "tensor", "}"}], ",", "sgs1", ",", 
                   "supportstring"}], "]"}], "@@", "#"}], "&"}], ",", 
               "indiceslist"}], "]"}]}], "}"}]}], "]"}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", " ", "Need"}], " ", "to", " ", 
     "be", " ", "modified", " ", "to", " ", "work", " ", "on", " ", "general",
      " ", 
     RowBox[{"expression", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YoungProjectSymH", "[", 
     RowBox[{
      RowBox[{"k_", "*", "exp_Plus"}], ",", "stdtab_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"k", "*", 
     RowBox[{"YoungProjectSymH", "[", 
      RowBox[{"exp", ",", "stdtab", ",", "options"}], "]"}]}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.871908437888538*^9, 3.871908570482904*^9}, {
   3.8719086044196577`*^9, 3.871908684196663*^9}, {3.871908729549382*^9, 
   3.8719087570859222`*^9}, {3.871908815377956*^9, 3.87190887454877*^9}, {
   3.8719091073162107`*^9, 3.871909109918939*^9}, {3.871909337214711*^9, 
   3.871909340265443*^9}, {3.871909452024309*^9, 3.871909454007999*^9}, {
   3.871909485403625*^9, 3.8719096119229393`*^9}, {3.871909671422289*^9, 
   3.8719096717326927`*^9}, {3.881991834195601*^9, 3.881991835970231*^9}, {
   3.881991953036922*^9, 3.881991956167351*^9}, 3.8819994253842983`*^9, {
   3.881999608064115*^9, 3.881999611379887*^9}, {3.88202190868229*^9, 
   3.882021909836195*^9}, {3.882089484444707*^9, 3.882089544461409*^9}, {
   3.882089614291387*^9, 3.8820896160991383`*^9}, {3.8820896761854277`*^9, 
   3.882089722672448*^9}, {3.882089754780231*^9, 3.882089787103107*^9}, {
   3.893405736626775*^9, 3.893405743717123*^9}, {3.8934863173097067`*^9, 
   3.893486318319749*^9}},ExpressionUUID->"f7b32440-6878-479b-98d0-\
17d1f0b0f595"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"**", "**"}], "**"}], "*", " ", "The", " ", "YoungSymmetrize", 
   " ", "function"}], " ", "********)"}]], "Input",
 CellChangeTimes->{{3.882022072327443*^9, 
  3.882022086042245*^9}},ExpressionUUID->"5c37687e-9d98-46e5-ba63-\
0bb941917c32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**"}], "*", " ", "This", " ", "function", " ", "is", 
    " ", "kept", " ", "private", " ", "not", " ", "to", " ", "clash", " ", 
    "with", " ", "the", " ", "xTras", " ", "function"}], " ", "********)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "YoungSymmetrize", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"YoungSymmetrize", "[", 
      RowBox[{"exp_", ",", 
       RowBox[{"tableau", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"indice", "=", 
          RowBox[{"List", "@@", 
           RowBox[{
            RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}]}], 
         ",", "ms", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "output", "}"}], "=", 
         RowBox[{"OptionValue", "[", 
          RowBox[{
           RowBox[{"{", "YoungSymmetrize", "}"}], ",", 
           RowBox[{"{", "options", "}"}], ",", 
           RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ms", "=", 
         RowBox[{
          RowBox[{"ManifestSym", "/.", 
           RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
          RowBox[{"Options", "[", "YoungSymmetrizer", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapIfPlus", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TracePermuteIndices", "[", 
              RowBox[{"#", ",", "indice", ",", 
               RowBox[{"YoungSymmetrizer", "[", 
                RowBox[{"tableau", ",", 
                 RowBox[{"ManifestSym", "\[Rule]", "ms"}]}], "]"}]}], "]"}], 
             "&"}], ",", "exp"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapIfPlus", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"YoungProjectSymH", "[", 
              RowBox[{"#", ",", "tableau", ",", 
               RowBox[{"ManifestSym", "\[Rule]", "ms"}]}], "]"}], "&"}], ",", 
            "exp"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"YoungSymmetrize", "[", 
      RowBox[{"exp_", ",", 
       RowBox[{"tableau", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
       "indices_List", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ms", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "output", "}"}], "=", 
         RowBox[{"OptionValue", "[", 
          RowBox[{
           RowBox[{"{", "YoungSymmetrize", "}"}], ",", 
           RowBox[{"{", "options", "}"}], ",", 
           RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ms", "=", 
         RowBox[{
          RowBox[{"ManifestSym", "/.", 
           RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
          RowBox[{"Options", "[", "YoungSymmetrizer", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapIfPlus", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TracePermuteIndices", "[", 
              RowBox[{"#", ",", "indices", ",", 
               RowBox[{"YoungSymmetrizer", "[", 
                RowBox[{"tableau", ",", 
                 RowBox[{"ManifestSym", "\[Rule]", "ms"}]}], "]"}]}], "]"}], 
             "&"}], ",", "exp"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MapIfPlus", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"YoungProjectSymH", "[", 
              RowBox[{"#", ",", "tableau", ",", 
               RowBox[{"ManifestSym", "\[Rule]", "ms"}]}], "]"}], "&"}], ",", 
            "exp"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"YoungSymmetrize", "[", 
       RowBox[{"exp_", ",", "indtab_", ",", 
        RowBox[{"options", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"indice", "=", 
           RowBox[{"List", "@@", 
            RowBox[{
             RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}]}], 
          ",", "tableau", ",", "ms", ",", "output"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ms", ",", "output"}], "}"}], "=", 
          RowBox[{"OptionValue", "[", 
           RowBox[{
            RowBox[{"{", "YoungSymmetrize", "}"}], ",", 
            RowBox[{"{", "options", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ManifestSym", ",", "Output"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tableau", "=", 
          RowBox[{"indtab", "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"List", "@@", "indice"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "@", "indice"}], "]"}]}], "]"}], "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
           RowBox[{"MapIfPlus", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TracePermuteIndices", "[", 
               RowBox[{"#", ",", "indice", ",", 
                RowBox[{"YoungSymmetrizer", "[", 
                 RowBox[{"tableau", ",", 
                  RowBox[{"ManifestSym", "\[Rule]", "ms"}]}], "]"}]}], "]"}], 
              "&"}], ",", "exp"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"MapIfPlus", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"YoungProjectSymH", "[", 
               RowBox[{"#", ",", "tableau", ",", 
                RowBox[{"ManifestSym", "\[Rule]", "ms"}]}], "]"}], "&"}], ",",
              "exp"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.88199964453129*^9, 3.881999667939093*^9}, {
  3.8819997680332623`*^9, 3.881999768998192*^9}, {3.882000171455028*^9, 
  3.882000200085586*^9}, {3.882021936780959*^9, 3.8820219843331747`*^9}, {
  3.88202203829706*^9, 3.8820220627315273`*^9}, {3.882079686824683*^9, 
  3.882079757017467*^9}, {3.8820887426544037`*^9, 3.8820887542199*^9}, {
  3.8820890452013063`*^9, 3.882089055948523*^9}, {3.88208934858759*^9, 
  3.882089358425445*^9}, {3.883034099535871*^9, 3.8830341085591784`*^9}, {
  3.8865893846532516`*^9, 3.8865893846574717`*^9}, {3.891339106024426*^9, 
  3.891339181755468*^9}, {3.893405569645677*^9, 3.893405686327807*^9}, {
  3.8934863185256653`*^9, 3.893486320775654*^9}, {3.89350959333359*^9, 
  3.89350960037005*^9}, {3.893509656781658*^9, 
  3.8935096785525503`*^9}},ExpressionUUID->"5772bb73-3fa7-4125-937d-\
e49ca95d619c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.3. SemiNormalYoungProject", "Subsection",
 CellChangeTimes->{{3.88202176080315*^9, 3.882021768638548*^9}, {
  3.8913415749543877`*^9, 
  3.891341576355418*^9}},ExpressionUUID->"63a673bf-ee8f-4849-b921-\
aa8091b70487"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SemiNormalYoungProject", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"tableau", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
      "indices_List"}], "]"}], ":=", 
    RowBox[{"MapIfPlus", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"TracePermuteIndices", "[", 
        RowBox[{"#", ",", "indices", ",", 
         RowBox[{"SemiNormalYoungUnit", "[", "tableau", "]"}]}], "]"}], "&"}],
       ",", "exp"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SemiNormalYoungProject", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"tableau", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"indices", "=", 
       RowBox[{"List", "@@", 
        RowBox[{
         RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MapIfPlus", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"TracePermuteIndices", "[", 
         RowBox[{"#", ",", "indices", ",", 
          RowBox[{"SemiNormalYoungUnit", "[", "tableau", "]"}]}], "]"}], 
        "&"}], ",", "exp"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8276656764762573`*^9, 3.8276656919887323`*^9}, {
   3.8276657544447927`*^9, 3.827665766485301*^9}, 3.827672920177842*^9, {
   3.847171275750195*^9, 3.847171288314117*^9}, {3.8756964681631727`*^9, 
   3.8756964827080317`*^9}, {3.881844188507031*^9, 3.8818441889584618`*^9}, {
   3.88202216790123*^9, 3.882022181830934*^9}, {3.882088757637702*^9, 
   3.882088760609383*^9}, {3.883034119412793*^9, 3.883034134187047*^9}, {
   3.891338918847197*^9, 3.891338919473055*^9}, {3.891338952284965*^9, 
   3.891338971616934*^9}, {3.891339020362764*^9, 3.8913390983539457`*^9}, {
   3.891339406336295*^9, 
   3.891339407363925*^9}},ExpressionUUID->"1830426a-3a33-4803-ba17-\
f6bc47006255"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4.4. GL irreducible tensors", "Subsection",
 CellChangeTimes->{{3.882266108012753*^9, 3.8822661387099447`*^9}, 
   3.882438101723139*^9, {3.891341115338949*^9, 3.891341125947019*^9}, 
   3.891341156093177*^9, {3.891341579268153*^9, 
   3.891341580690168*^9}},ExpressionUUID->"928efc56-14d0-4e1a-89ba-\
5b67757cbfd1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PositionsIntersectingSublist", "[", "list_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", "aj"}], "}"}], ",", 
      RowBox[{"SparseArray`StronglyConnectedComponents", "[", 
       RowBox[{"Sign", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", ".", 
           RowBox[{"Transpose", "@", "#"}]}], "&"}], "@", 
         RowBox[{"SparseArray", "@", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Join", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"j", ",", "aj"}], "}"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"j", ",", "#"}], "}"}], "&"}], "/@", 
                  RowBox[{"Union", "@", "aj"}]}]}], "]"}], "@@@", 
               RowBox[{"Transpose", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Range", "@", 
                   RowBox[{"Length", "@", "list"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"list", "/.", " ", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"#", "->", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", "#"}]}]}], "]"}]}], "&"}], "@", 
                   RowBox[{"Union", "@", 
                    RowBox[{"Flatten", "@", "list"}]}]}]}], "}"}]}]}], 
              ")"}]}], "->", "1"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", 
     RowBox[{"Experimental", " ", ":", " ", 
      RowBox[{"may", " ", "need", " ", "to", " ", "be", " ", "improved"}]}]}],
     " ", "->", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Taking", " ", "exchange", " ", "symmetries", " ", "of", " ", "n"}], 
      "-", 
      RowBox[{
      "tuple", " ", "of", " ", "indices", " ", "into", " ", "account"}]}], 
     " ", "->", " ", 
     RowBox[{
      RowBox[{"Plethysm", " ", "?", " ", "Also"}], " ", "it", " ", "can", " ",
       "be", " ", "made", " ", "into", " ", "an", " ", "option", " ", "for", 
      " ", 
      RowBox[{"DefTensor", " ", ":", " ", 
       RowBox[{
       "also", " ", "it", " ", "should", " ", "depend", " ", "on", " ", "the",
         " ", "\[IndentingNewLine]", "dimension", " ", "of", " ", "the", " ", 
        "manifold"}]}]}]}]}], "  ", "*******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GLIrrepsOfTensor", "[", 
    RowBox[{"exp", ":", 
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "@@", 
          RowBox[{
           RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], 
         "]"}]}], ",", 
       RowBox[{"sym", "=", 
        RowBox[{"List", "@@", 
         RowBox[{"Last", "[", 
          RowBox[{"SymmetryGroupOfTensor", "[", "exp", "]"}], "]"}]}]}], ",", 
       
       RowBox[{"rule1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cycles", "[", "a_", "]"}]}], ":>", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "a"}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"Cycles", "[", "a_", "]"}], ":>", 
           RowBox[{"{", 
            RowBox[{"1", ",", "a"}], "}"}]}]}], "}"}]}], ",", 
       RowBox[{"rule2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", ":", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "list_List"}], "}"}], ",", "y___"}], 
             "}"}]}], ":>", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"list", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"List", "[", "y", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}]}]}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{
           RowBox[{"x", ":", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "list_List"}], "}"}], ",", "y___"}], "}"}]}],
            ":>", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"list", ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"List", "[", "y", "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}]}]}], 
              "}"}]}], "}"}]}]}], "}"}]}], ",", "symgrouped", ",", 
       "exchangesym", ",", "plethysmQ", ",", "partitions", ",", 
       "connectedsym"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"sym", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"LittlewoodRichardsonRule", "[", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", "n"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"symgrouped", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"sym", ",", 
            RowBox[{
             RowBox[{"Cycles", "[", 
              RowBox[{"a_", ",", "b__"}], "]"}], "|", 
             RowBox[{"-", 
              RowBox[{"Cycles", "[", 
               RowBox[{"a_", ",", "b__"}], "]"}]}]}]}], "]"}], "/.", 
          "rule1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "symgrouped", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"connectedsym", "=", 
         RowBox[{"PositionsIntersectingSublist", "[", 
          RowBox[{"symgrouped", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"symgrouped", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"symgrouped", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "/.", "rule2"}], "&"}], ",", 
           "connectedsym"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "symgrouped", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "exchangesym", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"partitions", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"indices", "=", 
                RowBox[{"Union", "@@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "==", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"TransposePartition", "[", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "indices", "]"}], "}"}], "]"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"Length", "[", "indices", "]"}], "}"}]}], "]"}]}], 
             "]"}], "&"}], ",", "symgrouped"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"partitions", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"partitions", ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"Tr", "[", 
               RowBox[{"Tr", "/@", "partitions"}], "]"}]}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "partitions", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"partitions", "=", 
         RowBox[{"LittlewoodRichardsonRule", "[", 
          RowBox[{"Sequence", "@@", "partitions"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"**", "**", "**", "**", " ", "Taking"}], " ", "exchange", " ", 
      "of", " ", "n"}], "-", 
     RowBox[{
     "tuple", " ", "of", " ", "indices", " ", "into", " ", "account"}]}], " ",
     "->", " ", 
    RowBox[{"Plethysm", "  ", ":", " ", 
     RowBox[{"in", " ", "developpement"}]}]}], " ", 
   "*******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GLIrrepsOfTensorPlethysm", "[", 
   RowBox[{"exp", ":", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"List", "@@", 
         RowBox[{
          RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], 
        "]"}]}], ",", 
      RowBox[{"sym", "=", 
       RowBox[{"List", "@@", 
        RowBox[{"Last", "[", 
         RowBox[{"SymmetryGroupOfTensor", "[", "exp", "]"}], "]"}]}]}], ",", 
      RowBox[{"rule1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cycles", "[", "a_", "]"}]}], ":>", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "a"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"Cycles", "[", "a_", "]"}], ":>", 
          RowBox[{"{", 
           RowBox[{"1", ",", "a"}], "}"}]}]}], "}"}]}], ",", 
      RowBox[{"rule2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "list_List"}], "}"}], ",", "y___"}], 
            "}"}]}], ":>", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{"list", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"List", "[", "y", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}]}]}], "}"}]}],
            "}"}]}], ",", 
         RowBox[{
          RowBox[{"x", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "list_List"}], "}"}], ",", "y___"}], "}"}]}], 
          ":>", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"list", ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"List", "[", "y", "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}]}]}], "}"}]}],
            "}"}]}]}], "}"}]}], ",", "symgrouped", ",", "exchangesym", ",", 
      "plethysmQ", ",", "partitionsindices", ",", "symgroupedindices", ",", 
      "connectedsym", ",", "nakedindices"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sym", "===", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"LittlewoodRichardsonRule", "[", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "n"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"symgrouped", "=", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"sym", ",", 
           RowBox[{
            RowBox[{"Cycles", "[", 
             RowBox[{"a_", ",", "b__"}], "]"}], "|", 
            RowBox[{"-", 
             RowBox[{"Cycles", "[", 
              RowBox[{"a_", ",", "b__"}], "]"}]}]}]}], "]"}], "/.", 
         "rule1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "symgrouped", "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"symgrouped", "=!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"connectedsym", "=", 
           RowBox[{"PositionsIntersectingSublist", "[", 
            RowBox[{"symgrouped", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"symgrouped", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"symgrouped", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "/.", "rule2"}], "&"}], ",", 
             "connectedsym"}], "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"symgroupedindices", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"symgrouped", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "symgrouped", "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Print", "[", "symgroupedindices", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"partitionsindices", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"indices", "=", 
               RowBox[{"Union", "@@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"TransposePartition", "[", 
                  RowBox[{"{", 
                   RowBox[{"Length", "[", "indices", "]"}], "}"}], "]"}], ",",
                  "indices"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "indices", "]"}], "}"}], ",", 
                 "indices"}], "}"}]}], "]"}]}], "]"}], "&"}], ",", 
          "symgrouped"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "partitionsindices", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"**", 
         RowBox[{
         "*", " ", "Indices", " ", "with", " ", "no", " ", "\"\<group\>\"", 
          " ", "symmetries"}]}], " ", "****)"}], "\[IndentingNewLine]", 
       RowBox[{"nakedindices", "=", 
        RowBox[{"mycomplementSmall", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", "symgroupedindices"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partitionsindices", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"partitionsindices", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "#", "}"}]}], "}"}], "&"}], ",", "nakedindices"}],
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "partitionsindices", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"partitionsindices", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"partitionsindices", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"Tr", "[", 
                RowBox[{"Tr", "/@", "partitionsindices"}], "]"}]}]}], "]"}]}],
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"exchangesym", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"sym", ",", 
          RowBox[{
           RowBox[{"Cycles", "[", "a_", "]"}], "|", 
           RowBox[{"-", 
            RowBox[{"Cycles", "[", "a_", "]"}]}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "exchangesym", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.8915135621067553`*^9, 3.891513731895859*^9}, {
   3.891513765650354*^9, 3.891513769378632*^9}, {3.891513808676693*^9, 
   3.891513815530181*^9}, {3.891513849129837*^9, 3.891513855427292*^9}, {
   3.891513885483616*^9, 3.891513901223668*^9}, {3.891513945901906*^9, 
   3.891513963852071*^9}, {3.8915140408523903`*^9, 3.8915140550845833`*^9}, {
   3.8915141522497797`*^9, 3.89151418154776*^9}, {3.891514233229986*^9, 
   3.891514268217424*^9}, 3.89151430222858*^9, {3.891514486008407*^9, 
   3.891514525340315*^9}, {3.8915145651459312`*^9, 3.891514617571618*^9}, {
   3.891514714346045*^9, 3.8915147316311007`*^9}, {3.8915147624104223`*^9, 
   3.891514948579522*^9}, {3.891517160077697*^9, 3.891517426602272*^9}, {
   3.891517464633535*^9, 3.8915174757443647`*^9}, {3.8915175660657578`*^9, 
   3.891517568333517*^9}, {3.8915176008196173`*^9, 3.8915176244272738`*^9}, {
   3.891517698993511*^9, 3.891517717016041*^9}, {3.891518325104473*^9, 
   3.891518335891144*^9}, {3.891519201067301*^9, 3.891519230112875*^9}, {
   3.891587555457835*^9, 3.891587608244238*^9}, {3.891597969048436*^9, 
   3.891598022564294*^9}},ExpressionUUID->"040af338-6750-4df5-a24a-\
39c6a3750788"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GLIsotypicProject", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", " ", "Projection", " ", "onto", " ", "the", 
    " ", "direct", " ", "sum", " ", "of", " ", "equivalent", " ", "irreps"}], 
   " ", "*****)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GLIsotypicProject", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"diagram", ":", 
      RowBox[{"{", "___Integer", "}"}]}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "output", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "output", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "GLIrreducibleProject", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"CentralYoungProject", "[", 
       RowBox[{"exp", ",", "diagram", ",", 
        RowBox[{"Output", "->", "output"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "Optimization"}], " ", "from", " ", "symmetries",
     " ", "of", " ", "tensor"}], " ", "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GLIsotypicProject", "[", 
      RowBox[{
       RowBox[{"exp", ":", 
        RowBox[{
         RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], ",", 
       RowBox[{"diagram", ":", 
        RowBox[{"{", "___Integer", "}"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"GLIrrepsOfTensor", "[", "exp", "]"}], ",", "diagram"}], 
       "]"}]}]}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "GLCentralIrreducibleProject"}], "=", 
    "GLIsotypicProject"}], " ", "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "GLIsotypicProject", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GLCentralIrreducibleProject", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"diagram", ":", 
      RowBox[{"{", "___Integer", "}"}]}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"GLIsotypicProject", "[", 
    RowBox[{"exp", ",", "diagram", ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GLCentralIrreducibleProject", "[", 
      RowBox[{
       RowBox[{"exp", ":", 
        RowBox[{
         RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], ",", 
       RowBox[{"diagram", ":", 
        RowBox[{"{", "___Integer", "}"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"GLIrrepsOfTensor", "[", "exp", "]"}], ",", "diagram"}], 
       "]"}]}]}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891658329827198*^9, 3.891658360183527*^9}, {
  3.8935092110411777`*^9, 3.8935092131393948`*^9}, {3.908783506150502*^9, 
  3.908783506154737*^9}, {3.909038687349721*^9, 3.909038722298781*^9}, {
  3.9090387560577497`*^9, 
  3.909038790468738*^9}},ExpressionUUID->"ac4a2837-51ad-4acf-81d4-\
e529b5b97dee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "GLIrreducibleProject", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Method", "->", "SemiNormalYoungUnit"}], ",", 
    RowBox[{"Output", "->", "Tensor"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GLIrreducibleProject", "[", 
   RowBox[{"exp_", ",", 
    RowBox[{"tableau", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
    "indices_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"method", ",", "ms"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "method", "}"}], "=", 
      RowBox[{"OptionValue", "[", 
       RowBox[{
        RowBox[{"{", "GLIrreducibleProject", "}"}], ",", 
        RowBox[{"{", "options", "}"}], ",", 
        RowBox[{"{", "Method", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "===", "SemiNormalYoungUnit"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SemiNormalYoungProject", "[", 
        RowBox[{"exp", ",", "tableau", ",", "indices"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"method", "===", "YoungSymmetrizer"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"YoungSymmetrize", "[", 
          RowBox[{"exp", ",", "tableau", ",", "indices"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GLIrreducibleProject", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"tableau", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"GLIrreducibleProject", "[", 
    RowBox[{"exp", ",", "tableau", ",", 
     RowBox[{"List", "@@", 
      RowBox[{
       RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], ",", 
     "options"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "Optimization"}], " ", "from", " ", "symmetries",
     " ", "of", " ", "tensor"}], " ", "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GLIrreducibleProject", "[", 
    RowBox[{
     RowBox[{"exp", ":", 
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], ",", 
     RowBox[{"tableau", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "___Integer", "}"}], "..."}], "}"}]}], ",", 
     "indices_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"GLIrrepsOfTensor", "[", "exp", "]"}], ",", 
      RowBox[{"Length", "/@", "tableau"}]}], "]"}]}]}], ":=", "0"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.888656986846827*^9, 3.888657022156156*^9}, {
  3.8886573024336987`*^9, 3.888657306102007*^9}, {3.8886574774916153`*^9, 
  3.888657482206194*^9}, {3.891339297757289*^9, 3.891339313925645*^9}, {
  3.891339346391412*^9, 3.891339358105579*^9}, {3.8913405857071943`*^9, 
  3.891340591946459*^9}, {3.891518418902021*^9, 3.891518468476787*^9}, {
  3.89151854726377*^9, 3.8915185646307793`*^9}, {3.891518643738332*^9, 
  3.891518656534157*^9}, {3.891519143668232*^9, 3.891519148476975*^9}, {
  3.8915192553215733`*^9, 3.891519258049198*^9}, {3.8915192914923162`*^9, 
  3.89151939477309*^9}, {3.891658321734447*^9, 3.891658323057164*^9}, {
  3.8934058970408487`*^9, 3.893405937867169*^9}, {3.8934863209867773`*^9, 
  3.893486321277348*^9}, {3.893509544158133*^9, 3.893509581354693*^9}, {
  3.893509638581358*^9, 
  3.893509646321063*^9}},ExpressionUUID->"a945f853-6d86-4e3b-87e2-\
0a1cc10d3b6a"],

Cell[BoxData[{
 RowBox[{"Unprotect", "[", "Plethysm", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plethysm", "[", 
   RowBox[{"\[Mu]_List", ",", "\[Lambda]_List"}], "]"}], ":=", 
  RowBox[{"Sequence", "@@@", 
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"Plethysm", "[", 
      RowBox[{
       RowBox[{"SchurFunction", "[", "\[Mu]", "]"}], ",", 
       RowBox[{"SchurFunction", "[", "\[Lambda]", "]"}]}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plethysm", "[", 
   RowBox[{"\[Mu]_List", ",", 
    RowBox[{"x", ":", 
     RowBox[{"{", "\[Lambda]__List", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Plethysm", "[", 
        RowBox[{"\[Mu]", ",", "#"}], "]"}], "&"}], ",", "x"}], "]"}], ",", 
    "1"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891572866721519*^9, 3.891572956785347*^9}, {
  3.891573038741888*^9, 3.8915730952664127`*^9}, {3.8915731311232767`*^9, 
  3.891573135319804*^9}},ExpressionUUID->"994637d2-6eb0-4d0d-b809-\
b4c1ccc81c7e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["5. Traceless tensors and Irreducible decomposition of \
tensors under  the action of the Orthogonal group. ",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.891341502107904*^9, 
  3.8913415232995462`*^9}},ExpressionUUID->"d827e076-6ab5-4142-8459-\
164e8c75b235"],

Cell[CellGroupData[{

Cell["5.1. Traceless and trace projection of tensors ", "Subsection",
 CellChangeTimes->{{3.881664978014206*^9, 3.881664987255829*^9}, 
   3.8819958850525637`*^9, 3.882161676563404*^9, 3.891341543707534*^9, {
   3.891510837390974*^9, 
   3.891510837668189*^9}},ExpressionUUID->"d2b59517-43ff-4c3c-95aa-\
0dd4424c094c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", "**", " ", "To"}], " ", "Traceless", " ", 
   RowBox[{"tensor", " ", ":", " ", 
    RowBox[{"old", " ", "function"}]}]}], " ", "*****)"}]], "Input",
 CellChangeTimes->{{3.870956838533141*^9, 3.870956841355369*^9}, {
  3.882950149758563*^9, 3.882950153660928*^9}, {3.882950193786379*^9, 
  3.882950195130061*^9}},ExpressionUUID->"63fcfceb-90e5-472f-a625-\
d32949f4ed21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**"}], "*", " ", "Private", " ", "functions", 
    " ", "for", " ", "collecting", " ", "expression", " ", "with", " ", 
    "metric", " ", "or", " ", "symplectic", " ", "form"}], " ", "***)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MetricProducts", "[", 
     RowBox[{"inds_", ",", "metric_", ",", "1"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"metric", "@@", "#"}], "&"}], ",", 
      RowBox[{"Subsets", "[", 
       RowBox[{"inds", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MetricProducts", "[", 
       RowBox[{"inds_", ",", "metric_", ",", "n_"}], "]"}], "/;", 
      RowBox[{"n", ">", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], "]"}]}]}], ":=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MetricProducts", "[", 
     RowBox[{"inds_", ",", "metric_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Times", "@@@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"MetricProducts", "[", 
          RowBox[{"inds", ",", "metric", ",", "1"}], "]"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"DuplicateFreeQ", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"List", "@@", "#"}], "&"}], ",", "#"}], "]"}], "]"}], 
         "]"}], "&"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SymplecticFormProducts", "[", 
     RowBox[{"inds_", ",", "metric_", ",", "1"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"UpIndexQ", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
          RowBox[{"UpIndexQ", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Inv", "[", "metric", "]"}], "@@", "#"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"DownIndexQ", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
            RowBox[{"DownIndexQ", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"metric", "@@", "#"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DownIndexQ", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
              RowBox[{"UpIndexQ", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"delta", "@@", "#"}], ",", 
             RowBox[{"delta", "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}]}], 
          "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"Subsets", "[", 
       RowBox[{"inds", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SymplecticFormProducts", "[", 
       RowBox[{"inds_", ",", "metric_", ",", "n_"}], "]"}], "/;", 
      RowBox[{"n", ">", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], "]"}]}]}], ":=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SymplecticFormProducts", "[", 
     RowBox[{"inds_", ",", "metric_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Times", "@@@", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"SymplecticFormProducts", "[", 
          RowBox[{"inds", ",", "metric", ",", "1"}], "]"}], ",", 
         RowBox[{"{", "n", "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"DuplicateFreeQ", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"List", "@@", "#"}], "&"}], ",", "#"}], "]"}], "]"}], 
         "]"}], "&"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BilinearFormProducts", "[", 
     RowBox[{"inds_", ",", "metric_", ",", "1"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SymplecticFormQ", "[", "metric", "]"}], ",", 
      RowBox[{"SymplecticFormProducts", "[", 
       RowBox[{"inds", ",", "metric", ",", "1"}], "]"}], ",", 
      RowBox[{"MetricProducts", "[", 
       RowBox[{"inds", ",", "metric", ",", "1"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"BilinearFormProducts", "[", 
       RowBox[{"inds_", ",", "metric_", ",", "n_"}], "]"}], "/;", 
      RowBox[{"n", ">", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], "]"}]}]}], ":=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BilinearFormProducts", "[", 
     RowBox[{"inds_", ",", "metric_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"SymplecticFormQ", "[", "metric", "]"}], ",", 
      RowBox[{"SymplecticFormProducts", "[", 
       RowBox[{"inds", ",", "metric", ",", "n"}], "]"}], ",", 
      RowBox[{"MetricProducts", "[", 
       RowBox[{"inds", ",", "metric", ",", "n"}], "]"}]}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.882272037871767*^9, 3.882272116492435*^9}, {
  3.882272216290431*^9, 3.8822722255369987`*^9}, {3.882272271623168*^9, 
  3.8822722987813587`*^9}, {3.882272354289253*^9, 3.882272415658668*^9}, {
  3.882272695627364*^9, 3.88227271307649*^9}, {3.882273802169832*^9, 
  3.882273803742855*^9}, {3.882273897418496*^9, 3.8822739100078087`*^9}, {
  3.882611838666937*^9, 3.882611877594056*^9}, {3.882700827780966*^9, 
  3.882700844540429*^9}, {3.882701642886869*^9, 3.88270178474269*^9}, {
  3.882704221278328*^9, 3.882704252448811*^9}, {3.882704291986116*^9, 
  3.882704396040078*^9}, {3.8827855126927423`*^9, 3.882785514176075*^9}, {
  3.8827861632957478`*^9, 3.882786163492154*^9}, {3.882786200388056*^9, 
  3.882786205539452*^9}},ExpressionUUID->"5e6febdc-4a6a-44b2-a2fa-\
f67c053381da"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"**", "**", " ", 
   RowBox[{"TracelessProject", " ", ":", " ", 
    RowBox[{"new", " ", "function"}]}]}], " ", "*****)"}]], "Input",
 CellChangeTimes->{{3.8829501787890778`*^9, 3.8829501884774027`*^9}, {
  3.882967231677093*^9, 
  3.882967235345978*^9}},ExpressionUUID->"c22448c9-016e-4ca0-841f-\
60bb921e5a45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**"}], "*", " ", "Projections", " ", "of", " ", 
    "tensors", " ", "which", " ", "are", " ", "not", " ", "irreps", " ", "of",
     " ", "GL"}], " ", "***********)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "TracelessProject", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Output", "->", "Tensor"}], ",", 
      RowBox[{"Collect", "->", "True"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr_", ",", "f_Integer", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
       
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "@", "inds"}]}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{"DimOfManifold", "@@", 
           RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], ",", 
         "projector", ",", 
         RowBox[{"symplecticQ", "=", 
          RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}], ",", 
         RowBox[{"tensors", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<_\>\"", ",", 
                RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
            ",", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Head", "/@", 
              RowBox[{"FindAllOfType", "[", 
               RowBox[{"expr", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}], 
         ",", "output", ",", "collectQ"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"output", ",", "collectQ"}], "}"}], "=", 
         RowBox[{"OptionValue", "[", 
          RowBox[{
           RowBox[{"{", "TracelessProject", "}"}], ",", 
           RowBox[{"{", "options", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Output", ",", "Collect"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symplecticQ", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "dim", "]"}], ",", 
            RowBox[{"projector", "=", 
             RowBox[{"TracelessProjector", "[", 
              RowBox[{"n", ",", "f", ",", 
               RowBox[{"{", 
                RowBox[{"-", "dim"}], "}"}], ",", 
               RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}]}], 
            ",", 
            RowBox[{"projector", "=", 
             RowBox[{
              RowBox[{"TracelessProjector", "[", 
               RowBox[{"n", ",", "f", ",", 
                RowBox[{"{", "dim", "}"}], ",", 
                RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}], "/.", 
              RowBox[{"dim", "->", 
               RowBox[{"-", "dim"}]}]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"projector", "=", 
           RowBox[{"TracelessProjector", "[", 
            RowBox[{"n", ",", "f", ",", 
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"SchurWeylDual", "->", "OrthogonalGroup"}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"output", "===", "ClassTensor"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ToClassTensor", "[", 
           RowBox[{"expr", ",", "projector"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"collectQ", ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"collectlist", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"BilinearFormProducts", "[", 
                    RowBox[{"inds", ",", "metric", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], "]"}], 
                    "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", "tensors"}]}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"Collect", "[", 
                 RowBox[{
                  RowBox[{"TracePermuteIndices", "[", 
                   RowBox[{
                   "expr", ",", "inds", ",", "projector", ",", "metric"}], 
                   "]"}], ",", "collectlist", ",", "Factor"}], "]"}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"TracePermuteIndices", "[", 
               RowBox[{"expr", ",", "inds", ",", "projector", ",", "metric"}],
                "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "indices", 
     " ", "in", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr_", ",", "f_Integer", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr", ",", "f", ",", "metric", ",", 
       RowBox[{"List", "@@", 
        RowBox[{
         RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
       "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "f", " ", 
     "in", " ", "the", " ", 
     RowBox[{"input", " ", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr_", ",", "inds_List", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr", ",", "1", ",", "metric", ",", "inds", ",", "options"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "metric", 
     " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", ":", " ", 
      RowBox[{
      "need", " ", "BiliniarForm", " ", "of", " ", "Expression", " ", "and", 
       " ", "error", " ", "message", " ", "if", " ", "several", " ", 
       "bilinear", " ", "forms"}]}]}], "*******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr_", ",", "f_Integer", ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bilinearforms", "=", 
        RowBox[{"BilinearFormsOfExpression", "[", "expr", "]"}]}], "}"}], ",", 
      RowBox[{"TracelessProject", "[", 
       RowBox[{"expr", ",", "f", ",", 
        RowBox[{"bilinearforms", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "indices", 
     " ", "and", " ", "no", " ", "f", " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{
       RowBox[{"metric_", "?", "MetricQ"}], "|", 
       RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr", ",", "1", ",", "metric", ",", "options"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "indices", 
     " ", "and", " ", "no", " ", "metric", " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr_", ",", "f_Integer", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr", ",", "f", ",", 
      RowBox[{"List", "@@", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
      "options"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "f", " ", 
     "and", " ", "no", " ", "metric", " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr_", ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TracelessProject", "[", 
     RowBox[{"expr", ",", "1", ",", 
      RowBox[{"List", "@@", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
      "options"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", 
      "indices"}], ",", " ", 
     RowBox[{
     "no", " ", "f", " ", "and", " ", "no", " ", "metric", " ", "in", " ", 
      "the", " ", 
      RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TracelessProject", "[", 
      RowBox[{"expr", ",", 
       RowBox[{"List", "@@", 
        RowBox[{
         RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
       "options"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.828694255492148*^9, 3.8286943865493383`*^9}, {
   3.828694419369896*^9, 3.828694451927595*^9}, {3.828694503050111*^9, 
   3.8286945036481123`*^9}, 3.828694540232154*^9, {3.828694605630211*^9, 
   3.828694629833784*^9}, {3.8286946902977037`*^9, 3.828694690628763*^9}, {
   3.8286954177316227`*^9, 3.8286954752965717`*^9}, {3.828696222100518*^9, 
   3.828696243283635*^9}, {3.828696287539961*^9, 3.828696295558951*^9}, {
   3.828696413123377*^9, 3.828696425794367*^9}, {3.8286967116577377`*^9, 
   3.828696711817933*^9}, {3.828696817746862*^9, 3.828696862623391*^9}, {
   3.828698156777796*^9, 3.828698157332685*^9}, {3.829641590027568*^9, 
   3.829641595295115*^9}, {3.829641651619035*^9, 3.82964169366619*^9}, {
   3.829641749270976*^9, 3.8296418153959827`*^9}, {3.829641852422901*^9, 
   3.829641935146082*^9}, {3.8296425329401417`*^9, 3.829642539437151*^9}, {
   3.8296429082075872`*^9, 3.829642914244141*^9}, {3.8296437789600897`*^9, 
   3.8296439199285316`*^9}, {3.840513336431158*^9, 3.840513407786227*^9}, {
   3.840513837729328*^9, 3.840513839509609*^9}, {3.84051475822396*^9, 
   3.840514784465199*^9}, {3.840702417407357*^9, 3.840702417850747*^9}, {
   3.840702484966563*^9, 3.840702514057457*^9}, 3.840702569102914*^9, {
   3.840702711856558*^9, 3.84070273374175*^9}, {3.84070314616642*^9, 
   3.84070316415242*^9}, {3.840703233467865*^9, 3.840703249709621*^9}, {
   3.8407033098162937`*^9, 3.840703311675294*^9}, {3.840703692066598*^9, 
   3.8407036952688704`*^9}, {3.8407038561831827`*^9, 3.84070387661605*^9}, {
   3.840704054982057*^9, 3.8407040865502567`*^9}, {3.840704141685788*^9, 
   3.840704145684408*^9}, {3.840704230696423*^9, 3.8407042324247913`*^9}, {
   3.8407042853327303`*^9, 3.840704303638969*^9}, {3.8407050996589108`*^9, 
   3.840705187468124*^9}, {3.8407053613259487`*^9, 3.840705391073876*^9}, {
   3.840705448787118*^9, 3.840705467845117*^9}, {3.840705748314269*^9, 
   3.840705790129671*^9}, {3.840705851165779*^9, 3.840705869039*^9}, {
   3.840706538079256*^9, 3.8407065416638823`*^9}, {3.840707135049481*^9, 
   3.840707144860446*^9}, {3.84071045647719*^9, 3.840710627063889*^9}, {
   3.8407108191734333`*^9, 3.8407108222031393`*^9}, {3.840711232290121*^9, 
   3.840711244734789*^9}, {3.840773460992818*^9, 3.8407734723668413`*^9}, {
   3.840868939216289*^9, 3.840868982142365*^9}, {3.840869224232601*^9, 
   3.84086923103926*^9}, {3.840869307589973*^9, 3.840869323890253*^9}, {
   3.840869425029358*^9, 3.8408696355947037`*^9}, {3.840869695840281*^9, 
   3.840869700447118*^9}, {3.8408707599961042`*^9, 3.840870767401642*^9}, {
   3.840871301408779*^9, 3.840871319280241*^9}, {3.84113720481768*^9, 
   3.841137210042776*^9}, {3.8411374226468287`*^9, 3.841137429311903*^9}, 
   3.841725565298251*^9, 3.841735284303685*^9, {3.843550052567919*^9, 
   3.843550058470765*^9}, {3.843550691429968*^9, 3.843550699707327*^9}, {
   3.843561366557241*^9, 3.8435614042088003`*^9}, {3.843561606708921*^9, 
   3.843561609295207*^9}, {3.843561779200941*^9, 3.8435617798078547`*^9}, 
   3.843562233192564*^9, {3.843562281688797*^9, 3.843562282384563*^9}, {
   3.843727760581643*^9, 3.843727901899439*^9}, {3.84372794785286*^9, 
   3.843727971016006*^9}, {3.843728319516531*^9, 3.8437283453978577`*^9}, {
   3.843834997568549*^9, 3.843834999787722*^9}, {3.865506648446239*^9, 
   3.865506679126203*^9}, {3.8655068192870007`*^9, 3.865506819488022*^9}, {
   3.8655068885110207`*^9, 3.865506896056041*^9}, {3.8655069829870768`*^9, 
   3.8655069846341267`*^9}, {3.865507035559084*^9, 3.865507047099936*^9}, {
   3.865507114575283*^9, 3.8655071251779222`*^9}, {3.8709587612528067`*^9, 
   3.870958761722559*^9}, {3.871113256765883*^9, 3.871113364621464*^9}, {
   3.871114481021537*^9, 3.871114514538583*^9}, {3.8711146054919653`*^9, 
   3.871114739110169*^9}, {3.871114893762689*^9, 3.87111489418134*^9}, {
   3.8711153266337643`*^9, 3.871115333866975*^9}, 3.871118500192664*^9, {
   3.8818280519992447`*^9, 3.8818281329983397`*^9}, {3.88182817216597*^9, 
   3.8818282137924*^9}, {3.881829792331079*^9, 3.8818299746707172`*^9}, {
   3.881830005622725*^9, 3.881830149711849*^9}, {3.8818302170579844`*^9, 
   3.881830242093328*^9}, {3.881830295345068*^9, 3.88183031479377*^9}, {
   3.8818304003486567`*^9, 3.881830612888053*^9}, {3.881838554523127*^9, 
   3.881838554704483*^9}, {3.8818386848081083`*^9, 3.881838749379518*^9}, {
   3.8818442620734043`*^9, 3.881844271498847*^9}, {3.8818443150588818`*^9, 
   3.88184431562074*^9}, {3.881994771500079*^9, 3.8819947738625183`*^9}, {
   3.881995072477285*^9, 3.881995316651017*^9}, {3.88199547703227*^9, 
   3.881995477820723*^9}, {3.881995518635586*^9, 3.88199553731601*^9}, {
   3.881995596286194*^9, 3.8819956239750557`*^9}, {3.881995667933393*^9, 
   3.881995709019133*^9}, {3.881996403703929*^9, 3.8819965077836246`*^9}, {
   3.881996541672923*^9, 3.881996542112413*^9}, {3.881996617115355*^9, 
   3.8819966172892323`*^9}, {3.881997094435977*^9, 3.881997177408454*^9}, {
   3.882021667483878*^9, 3.8820216770217457`*^9}, {3.882083499927855*^9, 
   3.882083512200461*^9}, {3.882083857950457*^9, 3.8820838733596773`*^9}, {
   3.882100450338941*^9, 3.882100498841548*^9}, {3.882161773828169*^9, 
   3.88216185570901*^9}, {3.882270100937089*^9, 3.882270215417699*^9}, {
   3.882273866566432*^9, 3.8822738840884037`*^9}, {3.8822739328195963`*^9, 
   3.882274032966576*^9}, {3.882275162961935*^9, 3.882275228797098*^9}, {
   3.882275365782936*^9, 3.8822753664355803`*^9}, {3.882339988357912*^9, 
   3.882339990545724*^9}, {3.882613980037306*^9, 3.882614015167285*^9}, {
   3.8826140843291273`*^9, 3.882614259624962*^9}, {3.882614294933454*^9, 
   3.88261438782408*^9}, {3.8826147107756968`*^9, 3.882614793301866*^9}, {
   3.882615015380178*^9, 3.882615039745791*^9}, {3.8826193231008043`*^9, 
   3.882619399543693*^9}, {3.882619532312768*^9, 3.8826195505799417`*^9}, {
   3.882620422547063*^9, 3.8826204253327503`*^9}, {3.882704418040313*^9, 
   3.882704419179268*^9}, {3.882731211713718*^9, 3.8827312285335827`*^9}, {
   3.882731336044572*^9, 3.882731518737596*^9}, {3.882731557295155*^9, 
   3.882731650581249*^9}, {3.882731704649939*^9, 3.882731707259272*^9}, {
   3.8827317462746277`*^9, 3.882731877842862*^9}, {3.882776121624854*^9, 
   3.882776253331174*^9}, {3.8827765028622837`*^9, 3.882776518180244*^9}, {
   3.8827766155438843`*^9, 3.882776630782441*^9}, 3.8827767485071497`*^9, {
   3.882777470225007*^9, 3.882777543400721*^9}, {3.88277757564361*^9, 
   3.882777765262401*^9}, {3.882777818907652*^9, 3.8827778782885303`*^9}, 
   3.882779252297089*^9, {3.882782316571076*^9, 3.8827823860423727`*^9}, {
   3.882782420351324*^9, 3.88278258136754*^9}, {3.882947360874384*^9, 
   3.882947460484742*^9}, {3.882947686763154*^9, 3.88294774897159*^9}, {
   3.88294778040609*^9, 3.882948217144452*^9}, {3.882948249332514*^9, 
   3.8829486464865294`*^9}, {3.882948694627243*^9, 3.88294876501476*^9}, {
   3.882948834480324*^9, 3.882949047322015*^9}, {3.882949922166346*^9, 
   3.882949927780765*^9}, {3.882959006136949*^9, 3.882959020136677*^9}, {
   3.882965716553055*^9, 3.882965729570138*^9}, {3.8829660382377443`*^9, 
   3.882966044347342*^9}, {3.882967245498035*^9, 3.882967253999666*^9}, {
   3.882967992247025*^9, 3.8829679926925087`*^9}, {3.882968083905781*^9, 
   3.882968085100647*^9}, {3.8829708922198*^9, 3.8829709000664377`*^9}, {
   3.88346960115958*^9, 3.8834696248093233`*^9}, {3.886589384620842*^9, 
   3.8865893846338367`*^9}, {3.8886505046145277`*^9, 3.888650516041471*^9}, {
   3.888650789822425*^9, 3.888650900732812*^9}, {3.888653173687448*^9, 
   3.888653182288704*^9}},ExpressionUUID->"4b6698b9-f54b-4c7f-8be8-\
4b5e5b298e66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**"}], "***)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**"}], "*", " ", "Projections", " ", "of", " ", 
    "tensors", " ", "which", " ", "are", " ", "irreps", " ", "of", " ", 
    "GL"}], " ", "***********)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**"}], "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "GLTracelessProject", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Output", "->", "Tensor"}], ",", 
      RowBox[{"Collect", "->", "True"}], ",", 
      RowBox[{"Dressed", "->", "None"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProject", "[", 
      RowBox[{"expr_", ",", "\[Mu]_List", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
       
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "@", "inds"}]}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{"DimOfManifold", "@@", 
           RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], ",", 
         "projector", ",", 
         RowBox[{"symplecticQ", "=", 
          RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}], ",", 
         RowBox[{"tensors", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<_\>\"", ",", 
                RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
            ",", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Head", "/@", 
              RowBox[{"FindAllOfType", "[", 
               RowBox[{"expr", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}], 
         ",", "output", ",", "collectQ", ",", "dressed"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"output", ",", "collectQ", ",", "dressed"}], "}"}], "=", 
         RowBox[{"OptionValue", "[", 
          RowBox[{
           RowBox[{"{", "GLTracelessProject", "}"}], ",", 
           RowBox[{"{", "options", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Output", ",", "Collect", ",", "Dressed"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symplecticQ", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "dim", "]"}], ",", 
            RowBox[{"projector", "=", 
             RowBox[{"SnTracelessProjector", "[", 
              RowBox[{"n", ",", 
               RowBox[{"TransposePartition", "[", "\[Mu]", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"-", "dim"}], "}"}], ",", 
               RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}], ",", 
               RowBox[{"Dressed", "->", "dressed"}]}], "]"}]}], ",", 
            RowBox[{"projector", "=", 
             RowBox[{
              RowBox[{"SnTracelessProjector", "[", 
               RowBox[{"n", ",", 
                RowBox[{"TransposePartition", "[", "\[Mu]", "]"}], ",", 
                RowBox[{"{", "dim", "}"}], ",", 
                RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}], ",", 
                RowBox[{"Dressed", "->", "dressed"}]}], "]"}], "/.", 
              RowBox[{"dim", "->", 
               RowBox[{"-", "dim"}]}]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"projector", "=", 
           RowBox[{"SnTracelessProjector", "[", 
            RowBox[{"n", ",", "\[Mu]", ",", 
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"SchurWeylDual", "->", "OrthogonalGroup"}], ",", 
             RowBox[{"Dressed", "->", "dressed"}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"output", "===", "ClassTensor"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ToClassTensor", "[", 
           RowBox[{"expr", ",", "projector"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"collectQ", ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"collectlist", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"BilinearFormProducts", "[", 
                    RowBox[{"inds", ",", "metric", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], "]"}], 
                    "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", "tensors"}]}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"Collect", "[", 
                 RowBox[{
                  RowBox[{"TracePermuteIndices", "[", 
                   RowBox[{
                   "expr", ",", "inds", ",", "projector", ",", "metric"}], 
                   "]"}], ",", "collectlist", ",", "Factor"}], "]"}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"TracePermuteIndices", "[", 
               RowBox[{"expr", ",", "inds", ",", "projector", ",", "metric"}],
                "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "indices", 
     " ", "in", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GLTracelessProject", "[", 
      RowBox[{"expr_", ",", "\[Mu]_List", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"GLTracelessProject", "[", 
      RowBox[{"expr", ",", "\[Mu]", ",", "metric", ",", 
       RowBox[{"List", "@@", 
        RowBox[{
         RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
       "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "metric", 
     " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", ":", " ", 
      RowBox[{
      "need", " ", "BiliniarForm", " ", "of", " ", "Expression", " ", "and", 
       " ", "error", " ", "message", " ", "if", " ", "several", " ", 
       "bilinear", " ", "forms"}]}]}], "*******)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GLTracelessProject", "[", 
     RowBox[{"expr_", ",", "\[Mu]_List", ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bilinearforms", "=", 
        RowBox[{"BilinearFormsOfExpression", "[", "expr", "]"}]}], "}"}], ",", 
      RowBox[{"GLTracelessProject", "[", 
       RowBox[{"expr", ",", "\[Mu]", ",", 
        RowBox[{"bilinearforms", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**"}], "*", " ", "No", " ", "indices", 
     " ", "and", " ", "no", " ", "metric", " ", "in", " ", "the", " ", 
     RowBox[{"input", " ", "**", "**", "**", "**", "**"}]}], "*****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GLTracelessProject", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"\[Mu]_List", "?", "IntegerListQ"}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"GLTracelessProject", "[", 
     RowBox[{"expr", ",", "\[Mu]", ",", 
      RowBox[{"List", "@@", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
      "options"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.888656314683734*^9, 3.8886563418877573`*^9}, {
  3.8886563731170607`*^9, 3.888656385375268*^9}, {3.8886564365569696`*^9, 
  3.888656445263061*^9}},ExpressionUUID->"69d9be5f-146b-437d-a0fd-\
fa773d37e4d4"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.881833040846739*^9, {3.888650910268993*^9, 3.88865092686602*^9}, 
   3.8886531882111387`*^9},ExpressionUUID->"51468820-ccfd-47dc-8e5a-\
71ff6410f875"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**"}], "****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", " ", "Scalar"}], " ", 
    RowBox[{"invariant", " ", ":", " ", "TraceProject"}]}], " ", "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**"}], "****)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "TraceProject", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Output", "\[Rule]", "Tensor"}], ",", 
      RowBox[{"Collect", "->", "True"}]}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceProject", "[", 
      RowBox[{"exp_", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", "inds_List", ",", 
       
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{"Length", "@", "inds"}]}], ",", "projector", ",", 
         RowBox[{"dim", "=", 
          RowBox[{"DimOfManifold", "@@", 
           RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}]}], ",", 
         RowBox[{"symplecticQ", "=", 
          RowBox[{"SymplecticFormQ", "[", "metric", "]"}]}], ",", 
         RowBox[{"tensors", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<_\>\"", ",", 
                RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
            ",", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Head", "/@", 
              RowBox[{"FindAllOfType", "[", 
               RowBox[{"exp", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}], ",",
          "output", ",", "collectQ"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"output", ",", "collectQ"}], "}"}], "=", 
         RowBox[{"OptionValue", "[", 
          RowBox[{
           RowBox[{"{", "TraceProject", "}"}], ",", 
           RowBox[{"{", "options", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Output", ",", "Collect"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"symplecticQ", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "dim", "]"}], ",", 
            RowBox[{"projector", "=", 
             RowBox[{"TraceProjector", "[", 
              RowBox[{"n", ",", 
               RowBox[{"{", 
                RowBox[{"-", "dim"}], "}"}], ",", 
               RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}]}], 
            ",", 
            RowBox[{"projector", "=", 
             RowBox[{
              RowBox[{"TraceProjector", "[", 
               RowBox[{"n", ",", 
                RowBox[{"{", "dim", "}"}], ",", 
                RowBox[{"SchurWeylDual", "->", "SymplecticGroup"}]}], "]"}], "/.", 
              RowBox[{"dim", "->", 
               RowBox[{"-", "dim"}]}]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"projector", "=", 
           RowBox[{"TraceProjector", "[", 
            RowBox[{"n", ",", 
             RowBox[{"{", "dim", "}"}], ",", 
             RowBox[{"SchurWeylDual", "->", "OrthogonalGroup"}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"output", "===", "ClassTensor"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ToClassTensor", "[", 
           RowBox[{"exp", ",", "projector"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"output", "===", "Tensor"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"collectQ", ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"collectlist", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"BilinearFormProducts", "[", 
                    RowBox[{"inds", ",", "metric", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"Reverse", "[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"IntegerPart", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "inds", "]"}], "/", "2"}], "]"}], 
                    "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Sequence", "@@", "tensors"}]}], "}"}]}], "}"}], 
                ",", 
                RowBox[{"Collect", "[", 
                 RowBox[{
                  RowBox[{"TracePermuteIndices", "[", 
                   RowBox[{
                   "exp", ",", "inds", ",", "projector", ",", "metric"}], 
                   "]"}], ",", "collectlist", ",", "Factor"}], "]"}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"TracePermuteIndices", "[", 
               RowBox[{"exp", ",", "inds", ",", "projector", ",", "metric"}], 
               "]"}]}], "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"**", 
     RowBox[{
     "*", " ", "No", " ", "indices", " ", "in", " ", "the", " ", "input"}]}], 
    " ", "****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TraceProject", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{
        RowBox[{"metric_", "?", "MetricQ"}], "|", 
        RowBox[{"metric_", "?", "SymplecticFormQ"}]}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"TraceProject", "[", 
      RowBox[{"expr", ",", "metric", ",", 
       RowBox[{"List", "@@", 
        RowBox[{
         RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "expr", "]"}]}], ",", 
       "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"**", 
     RowBox[{
     "*", " ", "No", " ", "metric", " ", "in", " ", "the", " ", "input"}]}], 
    " ", "****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TraceProject", "[", 
     RowBox[{"expr_", ",", "inds_List", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bilinearforms", "=", 
        RowBox[{"BilinearFormsOfExpression", "[", "expr", "]"}]}], "}"}], ",", 
      RowBox[{"TraceProject", "[", 
       RowBox[{"expr", ",", 
        RowBox[{"bilinearforms", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "inds", ",", "options"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"**", 
     RowBox[{
     "*", " ", "No", " ", "metric", " ", "and", " ", "no", " ", "indices", 
      " ", "in", " ", "the", " ", "input"}]}], " ", "****)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TraceProject", "[", 
     RowBox[{"exp_", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"TraceProject", "[", 
     RowBox[{"exp", ",", 
      RowBox[{"List", "@@", 
       RowBox[{
        RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], ",", 
      "options"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.828697111700696*^9, 3.828697133764291*^9}, {
   3.828698158939199*^9, 3.828698159287599*^9}, {3.829642011985462*^9, 
   3.82964206052805*^9}, {3.8296420916919737`*^9, 3.829642133835168*^9}, {
   3.829642541672085*^9, 3.829642547981462*^9}, {3.829643362943458*^9, 
   3.82964337515569*^9}, {3.829643969772018*^9, 3.829643994992285*^9}, {
   3.84051348860356*^9, 3.840513540374802*^9}, {3.840513834536729*^9, 
   3.8405138352467747`*^9}, {3.840514025869956*^9, 3.84051403207685*^9}, {
   3.840781443627523*^9, 3.840781448344789*^9}, {3.840781491510395*^9, 
   3.840781515404558*^9}, 3.841137448779831*^9, 3.8417255662845163`*^9, {
   3.8435615281537657`*^9, 3.843561597242558*^9}, {3.843561790027317*^9, 
   3.843561804858733*^9}, {3.8435620840521727`*^9, 3.843562098900461*^9}, {
   3.8437279905097713`*^9, 3.843728120169353*^9}, {3.84372836403141*^9, 
   3.843728376412826*^9}, {3.862569231841124*^9, 3.8625692641520967`*^9}, {
   3.865506691110186*^9, 3.865506699304093*^9}, {3.865506799803486*^9, 
   3.8655068104424667`*^9}, {3.8655069019802713`*^9, 3.865506908346874*^9}, 
   3.865507145220316*^9, {3.870958769947946*^9, 3.870958771211253*^9}, {
   3.871113376202085*^9, 3.871113416602701*^9}, {3.8818282234609222`*^9, 
   3.88182833063161*^9}, {3.8818328995160427`*^9, 3.881832977040122*^9}, {
   3.881838560894763*^9, 3.8818385790875607`*^9}, {3.8820214213920603`*^9, 
   3.88202159675491*^9}, {3.8820216907368298`*^9, 3.882021695699925*^9}, 
   3.882080211295616*^9, {3.8820805441382227`*^9, 3.882080547846408*^9}, {
   3.8820835226106787`*^9, 3.882083540314241*^9}, {3.882161907162656*^9, 
   3.882161938088354*^9}, {3.882275247919643*^9, 3.8822752643570423`*^9}, {
   3.882275325010468*^9, 3.882275345073245*^9}, {3.88227538880099*^9, 
   3.882275397976777*^9}, {3.88233999169832*^9, 3.8823399928174953`*^9}, {
   3.882619461901699*^9, 3.8826195163629417`*^9}, 3.8827044215486517`*^9, {
   3.8827305696777*^9, 3.882730603762908*^9}, {3.882731277680583*^9, 
   3.882731306543499*^9}, 3.8827319163089027`*^9, {3.8827319526786127`*^9, 
   3.882731980828388*^9}, {3.88273623650618*^9, 3.8827362369650497`*^9}, {
   3.882776693094956*^9, 3.8827768178807793`*^9}, {3.882777915552292*^9, 
   3.882777942241274*^9}, {3.882782597417976*^9, 3.882782678956328*^9}, {
   3.883469635304637*^9, 3.88346968980711*^9}, {3.8865893846425467`*^9, 
   3.886589384645946*^9}, {3.8886505634103603`*^9, 3.888650572494341*^9}, {
   3.888652604482366*^9, 3.888652630311952*^9}, {3.888652766424871*^9, 
   3.8886527739216957`*^9}, {3.8886528085739737`*^9, 3.888652927218939*^9}, {
   3.888653189847316*^9, 3.8886532076683483`*^9}, {3.888653281839141*^9, 
   3.888653419193913*^9}, 3.888653508210685*^9, {3.888653586396496*^9, 
   3.8886536309400663`*^9}, {3.8886537607433767`*^9, 
   3.88865376089501*^9}},ExpressionUUID->"fc21331a-5cc9-46a5-bee5-\
50c04037690a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["5.2. Irreducible decomposition of tensors under O(N) action ", \
"Subsection",
 CellChangeTimes->{{3.843627972794182*^9, 3.8436279928380747`*^9}, {
   3.865495754626532*^9, 3.8654957552353497`*^9}, 3.8824381276790943`*^9, 
   3.891510842699685*^9, {3.8915109820733223`*^9, 
   3.891511007465764*^9}},ExpressionUUID->"e578289e-806c-417f-817d-\
85728ea085a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], "**", "**", "**",
      "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}]}], "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", "Central"}], " ", "irreducible", " ", 
    RowBox[{"decomposition", " ", "**", "**", "**", "**", "**", "**"}]}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**"}]}], "******)"}]}]], "Input",
 CellChangeTimes->{{3.891688618595441*^9, 
  3.891688646268114*^9}},ExpressionUUID->"7b1672de-02ff-4fbf-bff4-\
f043589aa02b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", " ", "Like"}], " ", "GLIrrepsOfTensor", 
    " ", "OIrrepsOfTensor", " ", "should", " ", "be", " ", "made", " ", "to", 
    " ", "depend", " ", "on", " ", "dim", " ", "of", " ", "manifold", " ", 
    "also"}], " ", "****)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"OIrrepsOfTensor", "[", 
    RowBox[{"exp", ":", 
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], "]"}], ":=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BranchingRule", "[", 
           RowBox[{"#", ",", "GeneralLinearGroup", ",", "OrthogonalGroup"}], 
           "]"}], "&"}], ",", 
         RowBox[{"GLIrrepsOfTensor", "[", "exp", "]"}]}], "]"}], ",", "1"}], 
      "]"}], ",", 
     RowBox[{
      RowBox[{"Tr", "[", "#", "]"}], "&"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8915980792664843`*^9, 3.891598094702985*^9}, {
  3.891598133848649*^9, 3.89159814824159*^9}, {3.891598236303388*^9, 
  3.8915983314127502`*^9}, {3.891598506585403*^9, 3.891598521922963*^9}, {
  3.89159892957719*^9, 3.891598938473197*^9}, {3.891599153773687*^9, 
  3.8915991545356503`*^9}},ExpressionUUID->"f35c8a5d-c328-4536-a33a-\
38fc0f557beb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OIsotypicProject", "[", 
      RowBox[{
       RowBox[{"exp", ":", 
        RowBox[{
         RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], ",", 
       "\[Lambda]_List", ",", "rest___", ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"OIrrepsOfTensor", "[", "exp", "]"}], ",", "\[Lambda]"}], 
       "]"}]}]}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "OIsotypicProject", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OIsotypicProject", "[", 
     RowBox[{
     "exp_", ",", "n_Integer", ",", "\[Lambda]_List", ",", "indices_List", 
      ",", 
      RowBox[{"metric_", "?", "MetricQ"}], ",", 
      RowBox[{"dim_Symbol", "|", "dim_Integer", "|", "dim_Plus"}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"output", ",", 
        RowBox[{"tensors", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<_\>\"", ",", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
           ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Head", "/@", 
             RowBox[{"FindAllOfType", "[", 
              RowBox[{"exp", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "output", "}"}], "=", 
        RowBox[{"OptionValue", "[", 
         RowBox[{
          RowBox[{"{", "OIsotypicProject", "}"}], ",", 
          RowBox[{"{", "options", "}"}], ",", 
          RowBox[{"{", "Output", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"output", "===", "ClassTensor"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ToClassTensor", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"CentralIdempotent", "[", 
            RowBox[{"n", ",", "\[Lambda]", ",", "dim"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"collectlist", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"BilinearFormProducts", "[", 
                   RowBox[{"indices", ",", "metric", ",", "#"}], "]"}], "&"}],
                  "/@", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Range", "[", 
                   RowBox[{"IntegerPart", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "indices", "]"}], "/", "2"}], 
                    "]"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"Sequence", "@@", "tensors"}]}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{"TracePermuteIndices", "[", 
              RowBox[{"exp", ",", "indices", ",", 
               RowBox[{"CentralIdempotent", "[", 
                RowBox[{"n", ",", "\[Lambda]", ",", "dim"}], "]"}], ",", 
               "metric"}], "]"}], ",", "collectlist", ",", "Factor"}], 
            "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{
   "exp_", ",", "n_Integer", ",", "\[Lambda]_List", ",", "indices_List", ",", 
    
    RowBox[{"metric_", "?", "MetricQ"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{
   "exp", ",", "n", ",", "\[Lambda]", ",", "indices", ",", "metric", ",", 
    RowBox[{"DimOfManifold", "@@", 
     RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}], ",", "options"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{
   "exp_", ",", "n_Integer", ",", "\[Lambda]_List", ",", "indices_List", ",", 
    
    RowBox[{"dim_Symbol", "|", "dim_Integer", "|", "dim_Plus"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"metric", "=", 
      RowBox[{
       RowBox[{"BilinearFormsOfExpression", "[", "exp", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"OIsotypicProject", "[", 
     RowBox[{
     "exp", ",", "n", ",", "\[Lambda]", ",", "indices", ",", "metric", ",", 
      "dim", ",", "options"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{
   "exp_", ",", "n_Integer", ",", "\[Lambda]_List", ",", "indices_List", ",", 
    
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{"exp", ",", "n", ",", "\[Lambda]", ",", "indices", ",", 
    RowBox[{"DimOfVBundle", "[", 
     RowBox[{"VBundleOfIndex", "[", 
      RowBox[{"indices", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", "options"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{"exp_", ",", "n_Integer", ",", "\[Lambda]_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{"exp", ",", "n", ",", "\[Lambda]", ",", 
    RowBox[{"List", "@@", 
     RowBox[{
      RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], ",", 
    "options"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{"exp_", ",", "n_Integer", ",", "\[Lambda]_List", ",", 
    RowBox[{"metric_", "?", "MetricQ"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{"exp", ",", "n", ",", "\[Lambda]", ",", 
    RowBox[{"List", "@@", 
     RowBox[{
      RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], ",", 
    "metric", ",", "options"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OIsotypicProject", "[", 
     RowBox[{"exp_", ",", "\[Lambda]_List", ",", "rest___", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"OIsotypicProject", "[", 
     RowBox[{"exp", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"List", "@@", 
        RowBox[{
         RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], "]"}], 
      ",", "\[Lambda]", ",", "rest", ",", "options"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", " ", "OCentralIrreducibleProject"}], 
    "=", 
    RowBox[{"OIsotypicProject", " ", "**", "**", "**", "**", "**"}]}], 
   "******)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "OCentralIrreducibleProject", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"Output", "->", "Tensor"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OCentralIrreducibleProject", "[", 
   RowBox[{"exp__", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIsotypicProject", "[", 
   RowBox[{"exp", ",", "options"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891508675524775*^9, 3.891508681837702*^9}, {
   3.891508713325144*^9, 3.8915087885755568`*^9}, {3.891508837204196*^9, 
   3.891508851005884*^9}, {3.8915089500564337`*^9, 3.891508990757286*^9}, {
   3.891509089659788*^9, 3.8915092084374723`*^9}, {3.891509313658477*^9, 
   3.891509330933571*^9}, {3.891509396304925*^9, 3.891509445671489*^9}, {
   3.89150948327324*^9, 3.8915095467430077`*^9}, {3.891509593912195*^9, 
   3.891509595785048*^9}, {3.8915096858124037`*^9, 3.891509739811388*^9}, 
   3.891509809835371*^9, {3.891509906314526*^9, 3.891509909752726*^9}, {
   3.891509984470828*^9, 3.891510254817338*^9}, {3.891510314313046*^9, 
   3.8915103296054707`*^9}, {3.8915111859238358`*^9, 3.891511203480949*^9}, {
   3.891597611487115*^9, 3.891597611767458*^9}, {3.8916893343674726`*^9, 
   3.891689340755908*^9}, {3.908783791444558*^9, 3.908783791491871*^9}, {
   3.909038832557024*^9, 
   3.909038933753201*^9}},ExpressionUUID->"71a0505e-fd7b-4c23-a458-\
e6d795d28dcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], "**", "**", "**",
      "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", 
     "**"}]}], "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**"}], "*", " ", 
    "Irreducible", " ", 
    RowBox[{"decomposition", " ", "**", "**", "**"}]}], "*************)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**"}]}], "******)"}]}]], "Input",
 CellChangeTimes->{{3.891688618595441*^9, 
  3.891688659950542*^9}},ExpressionUUID->"b49beaa6-f8c5-4517-916d-\
1d125e2a872b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"OIsotypicProject0", "[", 
    RowBox[{
    "exp_", ",", "n_", ",", "\[Lambda]_", ",", "indices_", ",", "metric_", 
     ",", "dim_"}], "]"}], ":=", 
   RowBox[{"TracePermuteIndices", "[", 
    RowBox[{"exp", ",", "indices", ",", 
     RowBox[{"CentralIdempotent", "[", 
      RowBox[{"n", ",", "\[Lambda]", ",", "dim"}], "]"}], ",", "metric"}], 
    "]"}]}], "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891685932997974*^9, 3.891685992668977*^9}, {
   3.891686275265328*^9, 3.891686322920179*^9}, {3.891686395756791*^9, 
   3.8916863981012983`*^9}, {3.891686440689815*^9, 3.891686465926734*^9}, {
   3.891686530955789*^9, 3.8916865317999563`*^9}, {3.891688729186481*^9, 
   3.891688774121019*^9}, 3.892024094126794*^9, 
   3.908783791493146*^9},ExpressionUUID->"204ffee4-26d4-451a-9536-\
70a9fd6a0893"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OIrreducibleProject", "[", 
     RowBox[{
      RowBox[{"exp", ":", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}]}], ",", 
      "path_List", ",", "rest___", ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"OIrrepsOfTensor", "[", "exp", "]"}], ",", 
       RowBox[{"Last", "[", "path", "]"}]}], "]"}]}]}], ":=", "0"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"OIrreducibleProject", "[", 
     RowBox[{"exp_", ",", "path_List", ",", "indices_List", ",", 
      RowBox[{"metric_", "?", "MetricQ"}], ",", 
      RowBox[{"dim_Symbol", "|", "dim_Integer", "|", "dim_Plus"}], ",", 
      RowBox[{"options", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lp", "=", 
         RowBox[{"Length", "[", "path", "]"}]}], ",", 
        RowBox[{"tensors", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<_\>\"", ",", 
               RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "]"}], "&"}], 
           ",", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Head", "/@", 
             RowBox[{"FindAllOfType", "[", 
              RowBox[{"exp", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}], ",", 
        "collectlist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"collectlist", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xAct`xBrauer`Private`BilinearFormProducts", "[", 
              RowBox[{"indices", ",", "metric", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{
                RowBox[{"Length", "[", "indices", "]"}], "/", "2"}], "]"}], 
              "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Sequence", "@@", "tensors"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{"Fold", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ContractMetric", "[", 
             RowBox[{"ToCanonical", "[", 
              RowBox[{"OIsotypicProject0", "[", 
               RowBox[{"#1", ",", 
                RowBox[{"Sequence", "@@", "#2"}], ",", "indices", ",", 
                "metric", ",", "dim"}], "]"}], "]"}], "]"}], "&"}], ",", 
           "exp", ",", 
           RowBox[{"Rest", "@", 
            RowBox[{"Thread", "[", 
             RowBox[{"List", "[", 
              RowBox[{
               RowBox[{"Range", "[", "lp", "]"}], ",", "path"}], "]"}], 
             "]"}]}]}], "]"}], ",", "collectlist", ",", "Factor"}], "]"}]}]}],
      "]"}]}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp_", ",", "path_List", ",", "indices_List", ",", 
    RowBox[{"metric_", "?", "MetricQ"}], ",", 
    RowBox[{"dim_Symbol", "|", "dim_Integer", "|", "dim_Plus"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"lp", "=", 
       RowBox[{"Length", "[", "path", "]"}]}], ",", 
      RowBox[{"tensors", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<_\>\"", ",", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "]"}], "&"}], ",", 
         
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Head", "/@", 
           RowBox[{"FindAllOfType", "[", 
            RowBox[{"exp", ",", "Tensor"}], "]"}]}], "]"}]}], "]"}]}], ",", 
      "collectlist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"collectlist", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xAct`xBrauer`Private`BilinearFormProducts", "[", 
            RowBox[{"indices", ",", "metric", ",", "#"}], "]"}], "&"}], "/@", 
          
          RowBox[{"Reverse", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"IntegerPart", "[", 
             RowBox[{
              RowBox[{"Length", "[", "indices", "]"}], "/", "2"}], "]"}], 
            "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Sequence", "@@", "tensors"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"TracePermuteIndices", "[", 
        RowBox[{"exp", ",", "indices", ",", 
         RowBox[{"CanonicalPrimitiveIdempotent", "[", 
          RowBox[{"lp", ",", "path", ",", "dim"}], "]"}], ",", "metric"}], 
        "]"}], ",", "collectlist", ",", "Factor"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891684094469401*^9, 3.891684131710793*^9}, {
   3.8916853448403254`*^9, 3.891685352058887*^9}, {3.8916854071680593`*^9, 
   3.891685465259101*^9}, {3.891686643708416*^9, 3.8916866778262157`*^9}, {
   3.891686725252598*^9, 3.891686819751359*^9}, {3.891687805607587*^9, 
   3.891687833296089*^9}, {3.8916879069851723`*^9, 3.891687907564067*^9}, {
   3.891688048670848*^9, 3.891688059563409*^9}, {3.8916881039098883`*^9, 
   3.891688171752143*^9}, {3.8916882061107388`*^9, 3.891688288475383*^9}, 
   3.8916891032589273`*^9, {3.892023893294536*^9, 3.8920239254500227`*^9}, {
   3.89202408123044*^9, 3.892024084512185*^9}, {3.892026021482862*^9, 
   3.8920260229170103`*^9}, {3.892026309361313*^9, 3.892026356784176*^9}, 
   3.908783791566267*^9},ExpressionUUID->"7db838f5-7a64-4284-9155-\
1c68e8b2309c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp_", ",", "path_List", ",", "indices_List", ",", 
    RowBox[{"metric_", "?", "MetricQ"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp", ",", "path", ",", "indices", ",", "metric", ",", 
    RowBox[{"DimOfManifold", "@@", 
     RowBox[{"DependenciesOfTensor", "[", "metric", "]"}]}], ",", "options"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp_", ",", "path_List", ",", "indices_List", ",", 
    RowBox[{"dim_Symbol", "|", "dim_Integer", "|", "dim_Plus"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"metric", "=", 
      RowBox[{
       RowBox[{
       "xAct`xBrauer`Private`BilinearFormsOfExpression", "[", "exp", "]"}], 
       "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"OIrreducibleProject", "[", 
     RowBox[{
     "exp", ",", "path", ",", "indices", ",", "metric", ",", "dim", ",", 
      "options"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp_", ",", "path_List", ",", "indices_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp", ",", "path", ",", "indices", ",", 
    RowBox[{"DimOfVBundle", "[", 
     RowBox[{"VBundleOfIndex", "[", 
      RowBox[{"indices", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", "options"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp_", ",", "path_List", ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp", ",", "path", ",", 
    RowBox[{"List", "@@", 
     RowBox[{
      RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], ",", 
    "options"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp_", ",", "path_", ",", 
    RowBox[{"metric_", "?", "MetricQ"}], ",", 
    RowBox[{"options", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"OIrreducibleProject", "[", 
   RowBox[{"exp", ",", "path", ",", 
    RowBox[{"List", "@@", 
     RowBox[{
      RowBox[{"IndicesOf", "[", "Free", "]"}], "[", "exp", "]"}]}], ",", 
    "metric", ",", "options"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.891688405657177*^9, 3.8916885311564903`*^9}, {
   3.891688670641119*^9, 3.891688688509141*^9}, {3.891689090271583*^9, 
   3.891689095792426*^9}, 3.891689165383761*^9, 
   3.8916896005523376`*^9},ExpressionUUID->"259dc72d-3de1-4c81-a806-\
0ebb7ed34b22"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["6. Modifications and extension of xTensor. ",
 FontColor->RGBColor[0, 0, 1]]], "Section",
 CellChangeTimes->{{3.840532945457539*^9, 3.840532982835741*^9}, {
   3.840878820815134*^9, 3.84087883224865*^9}, {3.841216591941935*^9, 
   3.8412166123846893`*^9}, {3.841388355326851*^9, 3.841388389024646*^9}, 
   3.841724638157975*^9, 3.842186592500814*^9, {3.858243166132765*^9, 
   3.85824316659702*^9}, {3.863770429282282*^9, 3.8637704295195017`*^9}, 
   3.8637705034627447`*^9, 3.875173092029264*^9, 3.878026367614517*^9, 
   3.8781199855677233`*^9, 3.883308040769578*^9, 3.891341659406887*^9, 
   3.891510844668665*^9, {3.8934893026280622`*^9, 
   3.893489330732061*^9}},ExpressionUUID->"cfdaff87-ccfe-4194-879d-\
aa085645a191"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FirstMetricOfVBundle", "[", 
    RowBox[{"vbundle_", ",", 
     RowBox[{"mess_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"firstmetricofvbundle", "[", 
    RowBox[{"vbundle", ",", 
     RowBox[{"MetricsOfVBundle", "[", "vbundle", "]"}], ",", "mess"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstmetricofvbundle", "[", 
    RowBox[{"vbundle_", ",", 
     RowBox[{"{", "}"}], ",", "True"}], "]"}], ":=", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"MetricsOfVBundle", "::", "missing"}], ",", "\"\<metric\>\"", 
      ",", "vbundle"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstmetricofvbundle", "[", 
    RowBox[{"vbundle_", ",", 
     RowBox[{"{", "}"}], ",", "False"}], "]"}], ":=", "Null"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstmetricofvbundle", "[", 
    RowBox[{"vbundle_", ",", "list_List", ",", "_"}], "]"}], ":=", 
   RowBox[{"First", "[", "list", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"firstmetricofvbundle", "[", 
    RowBox[{"vbundle_", ",", "list_", ",", "_"}], "]"}], ":=", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"MetricsOfVBundle", "::", "invalid"}], ",", "list", ",", 
      "\"\<list of metrics\>\""}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[146]:=",ExpressionUUID->"84d301dd-252a-4b94-a532-5522c6192c07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FirstMetricQ", "[", 
    RowBox[{"Null", ",", "___"}], "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FirstMetricQ", "[", "metric_", "]"}], ":=", 
   RowBox[{"FirstMetricQ", "[", 
    RowBox[{"metric", ",", 
     RowBox[{"VBundleOfMetric", "[", "metric", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FirstMetricQ", "[", 
    RowBox[{"metric_", ",", "vbundle_"}], "]"}], ":=", 
   RowBox[{"metric", "===", 
    RowBox[{"FirstMetricOfVBundle", "[", 
     RowBox[{"vbundle", ",", "True"}], "]"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[151]:=",ExpressionUUID->"f4831d8e-86fd-408b-91c4-dd80f1cb4c0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FrozenMetricQ", "[", "metric_", "]"}], ":=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ",", 
     RowBox[{
      RowBox[{"InducedFrom", "[", "metric", "]"}], "===", "Null"}]}], "]"}]}],
   ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[154]:=",ExpressionUUID->"8439c640-10e0-45b3-8e0f-e168838cc843"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LeviCivitaQ", "[", 
   RowBox[{
    RowBox[{"covd_", "?", "CovDQ"}], ",", 
    RowBox[{"metric_", "?", "MetricQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"torsionQ", "=", 
       RowBox[{"TorsionQ", "[", "covd", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"met", "=", 
       RowBox[{"MetricOfCovD", "[", "covd", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"metricQ", "=", " ", 
       RowBox[{
        RowBox[{"MetricOfCovD", "[", "covd", "]"}], "=!=", " ", "Null"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"!", 
        RowBox[{"TorsionQ", "[", "covd", "]"}]}], "&&", 
       RowBox[{"(", "metricQ", ")"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ToString", "[", "met", "]"}], "\[Equal]", 
         RowBox[{"ToString", "[", "metric", "]"}]}], ",", "True", ",", 
        "False"}], "]"}], ",", "False"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeviCivitaQ", "[", 
   RowBox[{"covd_", "?", "CovDQ"}], "]"}], ":=", 
  RowBox[{"LeviCivitaQ", "[", 
   RowBox[{"covd", ",", 
    RowBox[{"MasterOf", "[", "covd", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeviCivitaQ", "[", 
    RowBox[{
     RowBox[{"covd_", "?", "CovDQ"}], ",", "_"}], "]"}], ":=", "False"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811523731415325*^9, 3.811523852013445*^9}, {
   3.8115239015970984`*^9, 3.811523901769834*^9}, {3.8115239654428043`*^9, 
   3.81152396630057*^9}, {3.811524047978445*^9, 3.811524071216761*^9}, {
   3.811524124209721*^9, 3.811524196764229*^9}, 3.811524244585137*^9, {
   3.811524308465046*^9, 3.8115243108605757`*^9}, {3.811524393896584*^9, 
   3.811524396002603*^9}, {3.811524443522737*^9, 3.81152444822615*^9}, {
   3.8115244983052607`*^9, 3.811524623274358*^9}, {3.8115250089583197`*^9, 
   3.811525011882827*^9}, {3.811525063092449*^9, 3.811525077888919*^9}, 
   3.812365567192217*^9, 3.893391688546171*^9, {3.893512213060985*^9, 
   3.893512215845243*^9}, {3.8941958346712227`*^9, 
   3.894195890940544*^9}},ExpressionUUID->"9ea0ca5f-cbce-4284-a76b-\
2508812f991e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", " ", "Convenient", " ", "Private", " ", 
    "functions"}], " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SafeCanonical", "[", "e_", "]"}], ":=", 
    RowBox[{"ToCanonical", "[", 
     RowBox[{"e", ",", " ", 
      RowBox[{"UseMetricOnVBundle", " ", "->", " ", "None"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SafeToRule", "[", "exp_", "]"}], ":=", 
     RowBox[{"ToRule", "[", 
      RowBox[{"exp", ",", 
       RowBox[{"MetricOn", "\[Rule]", "None"}], ",", 
       RowBox[{"ContractMetrics", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SafeMakeRule", "[", "e_List", "]"}], ":=", 
    RowBox[{"MakeRule", "[", 
     RowBox[{"e", ",", 
      RowBox[{"MetricOn", "\[Rule]", "None"}], ",", 
      RowBox[{"ContractMetrics", "\[Rule]", "False"}]}], "]"}]}]}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.811525443457665*^9, 3.811525536564933*^9}, {
   3.8115255883321342`*^9, 3.811525596284936*^9}, 3.815669056306604*^9, 
   3.8297443400542383`*^9, {3.8407822537967*^9, 3.8407822839776897`*^9}, {
   3.840782329107333*^9, 3.8407823345402*^9}, {3.840785087625366*^9, 
   3.8407850895878763`*^9}, {3.840786373022681*^9, 3.840786373453681*^9}, {
   3.845273348918295*^9, 3.8452733564061127`*^9}, {3.89349789656641*^9, 
   3.893497905727909*^9}},ExpressionUUID->"5f565292-0c64-4423-894a-\
cb364e0f1664"],

Cell[CellGroupData[{

Cell["\<\
6.1. Frozen metric and conformal relations ( this part is a bit messy : \
should be replace by some extension of DefMetric )\
\>", "Subsection",
 CellChangeTimes->{{3.84121663553861*^9, 3.8412166618122053`*^9}, 
   3.8417246402896013`*^9, {3.843662670124535*^9, 3.8436626762050467`*^9}, {
   3.843662708943633*^9, 3.843662730120853*^9}, 3.843894171628194*^9, {
   3.843894218057283*^9, 3.84389421837901*^9}, {3.8439033545549717`*^9, 
   3.843903354738961*^9}, {3.844690726449163*^9, 3.844690740404179*^9}, {
   3.863770505241004*^9, 3.863770505398177*^9}, 3.875173103615376*^9, 
   3.882438117390785*^9, 
   3.89151084733724*^9},ExpressionUUID->"b6eb75c3-ade6-45c2-9d34-\
bed3a8c99a7c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"**", " ", "Modification"}], " ", "of", " ", "DefMetric", " ", 
   "when", " ", "metric", " ", "is", " ", 
   RowBox[{"frozen", " ", ":", " ", 
    RowBox[{
    "we", " ", "overwrite", " ", "SetConformalTo", " ", "of", " ", 
     "xTensor"}]}]}], " ", "***)"}]], "Input",
 CellChangeTimes->{{3.8408733975492783`*^9, 3.8408734342540913`*^9}, {
  3.841480605774169*^9, 
  3.8414806149876842`*^9}},ExpressionUUID->"04421028-981a-4e52-a987-\
4c0417380e59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetConformalTo", "[", 
   RowBox[{
    RowBox[{"metric_", "?", "MetricQ"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"originalmetric_", "?", "MetricQ"}], ",", "confactor_"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"prot", "=", 
       RowBox[{"Unprotect", "[", "metric", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"vb", "=", 
       RowBox[{"VBundleOfMetric", "[", "metric", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"indices", " ", "=", " ", 
       RowBox[{"GetIndicesOfVBundle", "[", 
        RowBox[{
         RowBox[{"VBundleOfMetric", "[", "metric", "]"}], ",", " ", "4"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"covdmet", "=", 
       RowBox[{"CovDOfMetric", "[", "metric", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"covdomet", "=", 
       RowBox[{"CovDOfMetric", "[", "originalmetric", "]"}]}], ",", 
      "metToomet", ",", "ometTomet", ",", "christToochrist", ",", 
      "ochristTochrist", ",", "\[IndentingNewLine]", "riemTooriem", ",", 
      "oriemToriem", ",", "ricciTooricci", ",", "oricciToricci", ",", " ", 
      "riccisTooriccis", ",", "oriccisToriccis"}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"i1", "=", " ", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{"i2", "=", " ", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"i3", "=", " ", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"i4", "=", " ", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
        
        RowBox[{"imet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Inv", ",", "metric"}], "]"}]}], ",", "\[IndentingNewLine]",
         "\t", 
        RowBox[{"iomet", "=", 
         RowBox[{"Inv", "[", "originalmetric", "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"chrismet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Christoffel", ",", "covdmet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"chrisomet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Christoffel", ",", "covdomet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"riemmet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Riemann", ",", "covdmet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"riemomet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Riemann", ",", "covdomet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"riccimet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Ricci", ",", "covdmet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ricciomet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Ricci", ",", "covdomet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ricciscalarmet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"RicciScalar", ",", "covdmet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"ricciscalaromet", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"RicciScalar", ",", "covdomet"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"curvQmet", "=", 
         RowBox[{"CurvatureRelationsQ", "[", "covdmet", "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"curvQomet", "=", 
         RowBox[{"CurvatureRelationsQ", "[", "covdomet", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"curvQmet", ",", 
         RowBox[{"ClearCurvatureRelations", "[", "covdmet", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"curvQomet", ",", 
         RowBox[{"ClearCurvatureRelations", "[", "covdomet", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"ReportSet", "[", 
        RowBox[{"$CommuteCovDsOnScalars", ",", "True"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "*", "  ", "Composition", " ", "for", " ", "covariant", " ", 
         "derivative"}], " ", "**)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"covdomet", "[", "a_", "]"}], "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "args___", "]"}], 
          ")"}]}], ":=", 
        RowBox[{"xAct`xTensor`Private`multiD", "[", 
         RowBox[{
          RowBox[{"covdomet", "[", "a", "]"}], ",", 
          RowBox[{"f", "[", "args", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**"}], "*****)"}], "\[IndentingNewLine]", 
       RowBox[{"metric", "/:", 
        RowBox[{"ConformalFactor", "[", 
         RowBox[{"metric", ",", "originalmetric"}], "]"}], "=", "confactor"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"metric", "/:", 
        RowBox[{"ConformalFactor", "[", 
         RowBox[{"originalmetric", ",", "metric"}], "]"}], "=", 
        RowBox[{"1", "/", "confactor"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"metToomet", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MakeRule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"ConformalFactor", "[", 
                RowBox[{"metric", ",", "originalmetric"}], "]"}], "*", 
               RowBox[{"originalmetric", "[", 
                RowBox[{
                 RowBox[{"-", "i1"}], ",", 
                 RowBox[{"-", "i2"}]}], "]"}]}]}], "}"}], ",", 
            RowBox[{"MetricOn", "\[Rule]", "None"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MakeRule", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"imet", "[", 
               RowBox[{"i1", ",", "i2"}], "]"}], ",", 
              RowBox[{
               RowBox[{"ConformalFactor", "[", 
                RowBox[{"originalmetric", ",", "metric"}], "]"}], "*", 
               RowBox[{"iomet", "[", 
                RowBox[{"i1", ",", "i2"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"MetricOn", "\[Rule]", "None"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Determinant", "[", "metric", "]"}], "[", "]"}], 
            "\[Rule]", 
            RowBox[{
             RowBox[{"confactor", "^", 
              RowBox[{"DimOfVBundle", "[", 
               RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}], " ", 
             
             RowBox[{
              RowBox[{"Determinant", "[", "originalmetric", "]"}], "[", 
              "]"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ometTomet", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FirstMetricQ", "[", "originalmetric", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"MakeRule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"originalmetric", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", " ", 
                    RowBox[{"-", "i2"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", " ", 
                    RowBox[{"-", "i2"}]}], "]"}], "*", 
                   RowBox[{"ConformalFactor", "[", 
                    RowBox[{"originalmetric", ",", "metric"}], "]"}]}]}], 
                 "}"}], ",", 
                RowBox[{"MetricOn", "\[Rule]", "None"}]}], "]"}], ",", 
              RowBox[{"MakeRule", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"iomet", "[", 
                   RowBox[{"i1", ",", " ", "i2"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"ConformalFactor", "[", 
                    RowBox[{"metric", ",", "originalmetric"}], "]"}], "*", 
                   RowBox[{"imet", "[", 
                    RowBox[{"i1", ",", " ", "i2"}], "]"}]}]}], "}"}], ",", 
                RowBox[{"MetricOn", "\[Rule]", "None"}]}], "]"}]}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Determinant", "[", "originalmetric", "]"}], "[", "]"}], 
            "\[Rule]", 
            RowBox[{
             RowBox[{
              RowBox[{"Determinant", "[", "metric", "]"}], "[", "]"}], "/", 
             RowBox[{"confactor", "^", 
              RowBox[{"DimOfVBundle", "[", 
               RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "]"}]}]}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"christToochrist", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"chrismet", "[", 
            RowBox[{"i1", ",", 
             RowBox[{"-", "i2"}], ",", 
             RowBox[{"-", "i3"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"ChangeCovD", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"chrismet", "[", 
                  RowBox[{"i1", ",", 
                   RowBox[{"-", "i2"}], ",", 
                   RowBox[{"-", "i3"}]}], "]"}], "//", 
                 "ChristoffelToGradMetric"}], ")"}], "/.", "metToomet"}], ",",
               "PD", ",", "covdomet"}], "]"}], "//", "SafeCanonical"}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ochristTochrist", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"chrisomet", "[", 
            RowBox[{"i1", ",", 
             RowBox[{"-", "i2"}], ",", 
             RowBox[{"-", "i3"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"ChangeCovD", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"chrisomet", "[", 
                  RowBox[{"i1", ",", 
                   RowBox[{"-", "i2"}], ",", 
                   RowBox[{"-", "i3"}]}], "]"}], "//", 
                 "ChristoffelToGradMetric"}], ")"}], "/.", "ometTomet"}], ",",
               "PD", ",", "covdmet"}], "]"}], "//", "SafeCanonical"}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"riemTooriem", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"riemmet", "[", 
            RowBox[{
             RowBox[{"-", "i1"}], ",", 
             RowBox[{"-", "i2"}], ",", 
             RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", 
           RowBox[{"CollectTensors", "[", 
            RowBox[{
             RowBox[{"ChangeCovD", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ChangeCurvature", "[", 
                    RowBox[{
                    RowBox[{"riemmet", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", "covdmet", 
                    ",", "covdomet"}], "]"}], "//", "BreakChristoffel"}], 
                    ")"}], "/.", "ochristTochrist"}], "/.", "ometTomet"}], "/.",
                  "christToochrist"}], "/.", "metToomet"}], ",", "covdmet", 
               ",", "covdomet"}], "]"}], ",", 
             RowBox[{"CollectMethod", "\[Rule]", "Default"}]}], "]"}]}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"oriemToriem", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"riemomet", "[", 
            RowBox[{
             RowBox[{"-", "i1"}], ",", 
             RowBox[{"-", "i2"}], ",", 
             RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", 
           RowBox[{"CollectTensors", "[", 
            RowBox[{
             RowBox[{"ChangeCovD", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ChangeCurvature", "[", 
                    RowBox[{
                    RowBox[{"riemomet", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", "covdomet", 
                    ",", "covdmet"}], "]"}], "//", "BreakChristoffel"}], 
                    ")"}], "/.", "christToochrist"}], "/.", "metToomet"}], "/.",
                  "ochristTochrist"}], "/.", "ometTomet"}], ",", "covdomet", 
               ",", "covdmet"}], "]"}], ",", 
             RowBox[{"CollectMethod", "\[Rule]", "SafeCanonical"}]}], "]"}]}],
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ricciTooricci", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"riccimet", "[", 
            RowBox[{
             RowBox[{"-", "i1"}], ",", 
             RowBox[{"-", "i2"}]}], "]"}], ",", 
           RowBox[{"CollectTensors", "[", 
            RowBox[{
             RowBox[{"riemmet", "[", 
              RowBox[{
               RowBox[{"-", "i1"}], ",", 
               RowBox[{"-", "i4"}], ",", 
               RowBox[{"-", "i2"}], ",", "i4"}], "]"}], "/.", "riemTooriem"}],
             "]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"oricciToricci", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ricciomet", "[", 
            RowBox[{
             RowBox[{"-", "i1"}], ",", 
             RowBox[{"-", "i2"}]}], "]"}], ",", 
           RowBox[{"CollectTensors", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"riemomet", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i4"}], ",", 
                RowBox[{"-", "i2"}], ",", "i4"}], "]"}], "/.", 
              "oriemToriem"}], ",", 
             RowBox[{"CollectMethod", "\[Rule]", "SafeCanonical"}]}], "]"}]}],
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"riccisTooriccis", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ricciscalarmet", "[", "]"}], ",", 
           RowBox[{"CollectTensors", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"imet", "[", 
                RowBox[{"i1", ",", "i2"}], "]"}], 
               RowBox[{"riccimet", "[", 
                RowBox[{
                 RowBox[{"-", "i1"}], ",", 
                 RowBox[{"-", "i2"}]}], "]"}]}], "/.", "metToomet"}], "/.", 
             "ricciTooricci"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"oriccisToriccis", "=", 
        RowBox[{"SafeMakeRule", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ricciscalaromet", "[", "]"}], ",", 
           RowBox[{"CollectTensors", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"iomet", "[", 
                 RowBox[{"i1", ",", "i2"}], "]"}], "*", 
                RowBox[{"ricciomet", "[", 
                 RowBox[{
                  RowBox[{"-", "i1"}], ",", 
                  RowBox[{"-", "i2"}]}], "]"}]}], "/.", "ometTomet"}], "/.", 
              "oricciToricci"}], ",", 
             RowBox[{"CollectMethod", "\[Rule]", "SafeCanonical"}]}], "]"}]}],
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", " ", "we"}], " ", "collect", " ", "all", " ", "the", 
         " ", "rules", " ", "in", " ", "ConformalRules"}], " ", "***)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"metric", "/:", 
        RowBox[{"ConformalRules", "[", 
         RowBox[{"metric", ",", "originalmetric"}], "]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "metToomet", ",", "christToochrist", ",", "riemTooriem", ",", 
          "ricciTooricci", ",", "riccisTooriccis"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"metric", "/:", 
        RowBox[{"ConformalRules", "[", 
         RowBox[{"originalmetric", ",", "metric"}], "]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "ometTomet", ",", "ochristTochrist", ",", "oriemToriem", ",", 
          "oricciToricci", ",", "oriccisToriccis"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"curvQmet", ",", 
         RowBox[{"SetCurvatureRelations", "[", "covdmet", "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"curvQomet", ",", 
         RowBox[{"SetCurvatureRelations", "[", "covdomet", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Protect", "[", 
        RowBox[{"Evaluate", "[", "prot", "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.841202119006778*^9, 3.8412024221642017`*^9}, {
   3.84120571798178*^9, 3.84120574560918*^9}, {3.841205782924128*^9, 
   3.841205910404303*^9}, 3.841205951264161*^9, {3.8412059824937963`*^9, 
   3.841206051078847*^9}, {3.841206817616105*^9, 3.84120690995282*^9}, 
   3.841206966959844*^9, {3.8412088258275023`*^9, 3.841208835194783*^9}, {
   3.8412129269810133`*^9, 3.8412129842235003`*^9}, {3.841213111220421*^9, 
   3.841213156158285*^9}, {3.841224664625511*^9, 3.841224669172434*^9}, {
   3.8412250473499804`*^9, 3.841225121986786*^9}, {3.841225215808226*^9, 
   3.841225401919939*^9}, {3.841225531431134*^9, 3.841225609706767*^9}, {
   3.841225639819708*^9, 3.8412257637375107`*^9}, {3.841225811423938*^9, 
   3.8412258398674583`*^9}, {3.8412258927501583`*^9, 3.8412259670023518`*^9}, 
   3.841226006299164*^9, {3.841226364734812*^9, 3.841226390556576*^9}, {
   3.841226439804265*^9, 3.841226709747341*^9}, {3.841226746715534*^9, 
   3.841226808799581*^9}, {3.841226921285138*^9, 3.841226930059764*^9}, {
   3.8412270603317947`*^9, 3.841227085496447*^9}, {3.841227215901338*^9, 
   3.84122721816873*^9}, {3.8412272627951307`*^9, 3.841227285424489*^9}, {
   3.841227351515686*^9, 3.841227595014462*^9}, {3.841227732769063*^9, 
   3.841227760895568*^9}, 3.8412278427612877`*^9, {3.841227900846249*^9, 
   3.841227907112403*^9}, {3.8413801700079527`*^9, 3.841380174718185*^9}, {
   3.841386267691308*^9, 3.8413862856203947`*^9}, 3.8413863359819508`*^9, {
   3.841386639195363*^9, 3.8413866905574636`*^9}, {3.841386754342605*^9, 
   3.841386784043563*^9}, {3.841387161487163*^9, 3.8413871623829517`*^9}, 
   3.84148031737213*^9, {3.908886150948079*^9, 3.908886167101709*^9}, 
   3.908886265270451*^9, {3.9088865866166563`*^9, 3.908886589690919*^9}, 
   3.908887284272058*^9},ExpressionUUID->"7fcecb45-ceb1-4e77-97c6-\
63c49e1dbcc0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetConformalTo", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"metric_", "?", "MetricQ"}], "[", 
      RowBox[{
       RowBox[{"-", "i1_"}], ",", 
       RowBox[{"-", "i2_"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"originalmetric_", "?", "MetricQ"}], "[", 
        RowBox[{
         RowBox[{"-", "i1_"}], ",", 
         RowBox[{"-", "i2_"}]}], "]"}], ",", "confactor_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"SetConformalTo", "[", 
    RowBox[{"metric", ",", 
     RowBox[{"{", 
      RowBox[{"originalmetric", ",", "confactor"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841480480680387*^9, 
  3.8414804993127203`*^9}},ExpressionUUID->"b04a3d73-9931-4cdf-8c64-\
5e3772bb9049"],

Cell["A driver for conformal transformation ", "Text",
 CellChangeTimes->{{3.843208258962152*^9, 
  3.843208266272739*^9}},ExpressionUUID->"68947a28-0bc2-4bdc-b982-\
991f0902d5e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConformalTransform", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"met_", "?", "MetricQ"}], ",", 
     RowBox[{"confmet_", "?", "MetricQ"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"covdmet", "=", 
        RowBox[{"CovDOfMetric", "[", "met", "]"}]}], ",", 
       RowBox[{"covdconfmet", "=", 
        RowBox[{"CovDOfMetric", "[", "confmet", "]"}]}], ",", 
       RowBox[{"TM", "=", 
        RowBox[{"VBundleOfMetric", "[", "met", "]"}]}], ",", "res"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "*", " ", "We", " ", "modify", " ", "the", " ", "canonical", " ", 
       "slots", " ", "of", " ", "Riemann", " ", "tensor", " ", "for", " ", 
       "the", " ", "first", " ", "metric"}], " ", "**)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "$Metrics", "]"}], "===", "met"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SlotsOfTensor", "[", 
          RowBox[{"Riemann", "[", "covdmet", "]"}], "]"}], "^:=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "TM"}], ",", 
           RowBox[{"-", "TM"}], ",", 
           RowBox[{"-", "TM"}], ",", "TM"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "$Metrics", "]"}], "===", "confmet"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SlotsOfTensor", "[", 
          RowBox[{"Riemann", "[", "covdconfmet", "]"}], "]"}], "^:=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "TM"}], ",", 
           RowBox[{"-", "TM"}], ",", 
           RowBox[{"-", "TM"}], ",", "TM"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "$Metrics", "]"}], "=!=", "confmet"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"CollectTensors", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SeparateMetric", "[", "met", "]"}], "[", 
               RowBox[{"FixedPoint", "[", 
                RowBox[{"BreakChristoffel", ",", 
                 RowBox[{"ChangeCovD", "[", 
                  RowBox[{"exp", ",", "covdmet", ",", "covdconfmet"}], 
                  "]"}]}], "]"}], "]"}], ")"}], "/.", 
             RowBox[{"ConformalRules", "[", 
              RowBox[{"met", ",", "confmet"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"CollectMethod", "\[Rule]", "SafeCanonical"}], "}"}]}], 
           "]"}], ",", "Module"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"CollectTensors", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SeparateMetric", "[", "met", "]"}], "[", 
              RowBox[{"FixedPoint", "[", 
               RowBox[{"BreakChristoffel", ",", 
                RowBox[{"ChangeCovD", "[", 
                 RowBox[{"exp", ",", "covdmet", ",", "covdconfmet"}], "]"}]}],
                "]"}], "]"}], ")"}], "/.", 
            RowBox[{"ConformalRules", "[", 
             RowBox[{"met", ",", "confmet"}], "]"}]}], "]"}], ",", "Module"}],
          "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843208271023551*^9, 3.843208404912945*^9}, {
   3.843208729105544*^9, 3.843208969752939*^9}, {3.843209184537215*^9, 
   3.843209314070895*^9}, 3.843209557807617*^9, {3.843273000210634*^9, 
   3.843273015541007*^9}, {3.8432864151889*^9, 3.8432864169173813`*^9}, {
   3.843312395403905*^9, 
   3.843312426987214*^9}},ExpressionUUID->"4bb47987-7588-43b1-8dda-\
67cb146dfa5d"],

Cell["Modification of SetConformal and DefCovD in DefMetric", "Text",
 CellChangeTimes->{{3.841135384795581*^9, 
  3.841135404279916*^9}},ExpressionUUID->"5f6b65b6-49e5-416c-accb-\
7cd7a0b87c83"],

Cell[BoxData[{
 RowBox[{"Unprotect", "[", "DefMetric", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"RuleDelayed", "::", "rhs"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "DefMetric", "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PrintAs", "\[Rule]", "Identity"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FlatMetric", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
    RowBox[{"InducedFrom", "\[Rule]", "Null"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ConformalTo", "\[Rule]", "Null"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OtherDependencies", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"WeightedWithBasis", "\[Rule]", "Null"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"epsilonOrientationInBasis", "\[RuleDelayed]", 
     RowBox[{"{", 
      RowBox[{"AIndex", ",", "$epsilonSign"}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Master", "\[Rule]", "Null"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ProtectNewSymbol", "\[RuleDelayed]", "$ProtectNewSymbols"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"DefInfo", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"DefMetricPerturbation", "\[Rule]", "True"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DefMetric", "[", 
    RowBox[{"signdet_", ",", 
     RowBox[{"metric_", "[", 
      RowBox[{
       RowBox[{"-", "ind1_"}], ",", 
       RowBox[{"-", "ind2_"}]}], "]"}], ",", "covd_", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Catch", "@", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"vbundle", "=", 
        RowBox[{"VBundleOfIndex", "[", "ind1", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "covdsymbol", ",", "flat", ",", "inducedfrom", ",", "confto", ",", 
          "odeps", ",", "wwb", ",", "eoib", ",", "pns", ",", "info", ",", 
          "flatPD", ",", "inducedQ", ",", "dim", ",", "integerdimQ", ",", 
          "frozenQ", ",", "firstQ", ",", "invertQ", ",", "firstmetric", ",", 
          "supermetric", ",", "vector", ",", "LCmetric", ",", "test"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Options", " ", "and", " ", "checks"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "covdsymbol", ",", "flat", ",", "inducedfrom", ",", "confto", ",", 
            "odeps", ",", "wwb", ",", "eoib", ",", "pns", ",", "info"}], 
           "}"}], "=", 
          RowBox[{"OptionValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"DefMetric", ",", "DefCovD"}], "}"}], ",", 
            RowBox[{"{", "options", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "SymbolOfCovD", ",", "FlatMetric", ",", "InducedFrom", ",", 
              "ConformalTo", ",", "OtherDependencies", ",", 
              "WeightedWithBasis", ",", "epsilonOrientationInBasis", ",", 
              "ProtectNewSymbol", ",", "DefInfo"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"xAct`xTensor`Private`DefMetricCheck", "[", 
          RowBox[{"signdet", ",", 
           RowBox[{"metric", "[", 
            RowBox[{
             RowBox[{"-", "ind1"}], ",", 
             RowBox[{"-", "ind2"}]}], "]"}], ",", "covd", ",", "covdsymbol", 
           ",", "flat", ",", "inducedfrom", ",", "confto", ",", "odeps", ",", 
           "wwb", ",", "eoib"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Explore", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"flatPD", "=", 
          RowBox[{"flat", "&&", 
           RowBox[{"(", 
            RowBox[{"covd", "===", "PD"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dim", "=", 
          RowBox[{"DimOfVBundle", "[", "vbundle", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"integerdimQ", "=", 
          RowBox[{"IntegerQ", "[", "dim", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "One", " ", "and", " ", "only", " ", "one", " ", "of", " ", 
            "firstQ"}], ",", " ", "inducedQ", ",", " ", 
           RowBox[{"frozenQ", " ", "is", " ", "True"}], ",", " ", 
           RowBox[{
           "and", " ", "the", " ", "other", " ", "two", " ", "are", " ", 
            "False"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"firstQ", "=", 
          RowBox[{
           RowBox[{"MetricsOfVBundle", "[", "vbundle", "]"}], "===", 
           RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"inducedQ", "=", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"!", "firstQ"}], ",", 
            RowBox[{"inducedfrom", "=!=", "Null"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"frozenQ", "=", 
          RowBox[{"And", "[", 
           RowBox[{
            RowBox[{"!", "firstQ"}], ",", 
            RowBox[{"!", "inducedQ"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"If", "[", 
          RowBox[{"inducedQ", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"supermetric", ",", "vector"}], "}"}], "=", 
            "inducedfrom"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"frozenQ", ",", 
           RowBox[{"firstmetric", "=", 
            RowBox[{"First", "[", 
             RowBox[{"MetricsOfVBundle", "[", "vbundle", "]"}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"manifold", "=", 
              RowBox[{"BaseOfVBundle", "[", "vbundle", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"deps", "=", 
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"BaseOfVBundle", "[", "vbundle", "]"}], "}"}], ",", 
                "odeps"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"vbQ", "=", 
              RowBox[{
              "xAct`xTensor`Private`VBundleIndexQ", "[", "vbundle", "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"vbpmQ", "=", 
              RowBox[{
              "xAct`xTensor`Private`VBundleIndexPMQ", "[", "vbundle", "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"invmetric", "=", 
              RowBox[{"If", "[", 
               RowBox[{"frozenQ", ",", 
                RowBox[{"GiveSymbol", "[", 
                 RowBox[{"Inv", ",", "metric"}], "]"}], ",", "metric"}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Avoid", " ", "messages", " ", "from", " ", "options", " ", "of", 
             " ", "DefMetric", " ", "not", " ", "accepted", " ", "in", " ", 
             "DefTensor", " ", "or", " ", "DefCovD"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Off", "[", 
             RowBox[{"OptionValue", "::", "nodef"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Define", " ", "metric", " ", 
              RowBox[{"tensor", ".", " ", "Do"}], " ", "not", " ", "protect", 
              " ", 
              RowBox[{"symbol", ".", " ", "Do"}], " ", "not", " ", "use", " ", 
              RowBox[{"ProjectedWith", ".", " ", "It"}], " ", "is", " ", 
              "always", " ", "symmetric"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"metric", "[", 
               RowBox[{
                RowBox[{"-", "ind1"}], ",", 
                RowBox[{"-", "ind2"}]}], "]"}], ",", "deps", ",", 
              RowBox[{"Symmetric", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"inducedQ", ",", 
                 RowBox[{"{", 
                  RowBox[{"vector", "[", "ind1", "]"}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"info", "===", "False"}], ",", "False", ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<symmetric metric tensor\>\"", ",", "\"\<\>\""}], 
                  "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "options"}], 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"MakexTensions", "[", 
             RowBox[{
             "DefMetric", ",", "\"\<Beginning\>\"", ",", "signdet", ",", 
              RowBox[{"metric", "[", 
               RowBox[{
                RowBox[{"-", "ind1"}], ",", 
                RowBox[{"-", "ind2"}]}], "]"}], ",", "covd", ",", "options"}],
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Register", " ", "structure"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendToUnevaluated", "[", 
             RowBox[{"$Metrics", ",", "metric"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MetricQ", "[", "metric", "]"}], "^=", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CovDOfMetric", "[", "metric", "]"}], "^=", "covd"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "^=", 
             "vbundle"}], ";", "\[IndentingNewLine]", 
            RowBox[{"xUpAppendTo", "[", 
             RowBox[{
              RowBox[{"MetricsOfVBundle", "[", "vbundle", "]"}], ",", 
              "metric"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FlatMetricQ", "[", "metric", "]"}], "^=", "flat"}], ";",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"InducedFrom", "[", "metric", "]"}], "^=", 
             "inducedfrom"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "Signature", " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "signdet", "]"}], "===", "List"}], " ", "&&", 
               RowBox[{
                RowBox[{"Length", "[", "signdet", "]"}], "===", "3"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"SignatureOfMetric", "[", "metric", "]"}], "^=", 
                "signdet"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"SignDetOfMetric", "[", "metric", "]"}], "^=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"signdet", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "===", "0"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                   RowBox[{"signdet", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "0"}], "]"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"SignDetOfMetric", "[", "metric", "]"}], "^=", 
                "signdet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "Invertibility", " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"invertQ", "=", 
             RowBox[{
              RowBox[{"SignDetOfMetric", "[", "metric", "]"}], "=!=", "0"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Define", " ", "inverse", " ", 
              RowBox[{"metric", ".", " ", 
               RowBox[{"TODO", ":", " ", 
                RowBox[{"Orthogonal", " ", "and", " ", 
                 RowBox[{"Projected", "?"}]}]}]}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"invertQ", ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"frozenQ", " ", ",", "\[IndentingNewLine]", 
                RowBox[{"DefTensor", "[", 
                 RowBox[{
                  RowBox[{"invmetric", "[", 
                   RowBox[{"ind1", ",", "ind2"}], "]"}], ",", "deps", ",", 
                  RowBox[{"Symmetric", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Master", "\[Rule]", "metric"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"DefInfo", "\[RuleDelayed]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"info", "===", "False"}], ",", "False", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<inverse metric tensor\>\"", ",", 
                    "\"\<Metric is frozen!\>\""}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"TensorID", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"InvMetric", ",", "metric"}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"PrintAs", "\[RuleDelayed]", 
                   RowBox[{"GiveOutputString", "[", 
                    RowBox[{"Inv", ",", "metric"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", "options"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
              "Print", "[", 
               "\"\<** DefMetric: non-invertible metric being defined! \
Dangerous!\>\"", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Directional", " ", "indices", " ", "are", " ", "not", " ", 
              "allowed", " ", "in", " ", 
              RowBox[{"metrics", ".", " ", "Why"}], " ", "only", " ", "for", 
              " ", "first", " ", 
              RowBox[{"metrics", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"If", "[", 
             RowBox[{"firstQ", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"Dir", "[", "expr_", "]"}], ",", "b_"}], "]"}], ":=", 
                RowBox[{"ReplaceIndex", "[", 
                 RowBox[{"expr", ",", 
                  RowBox[{
                   RowBox[{
                   "xAct`xTensor`Private`UltraindexOf", "[", "expr", "]"}], 
                   "\[Rule]", "b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"metric", "[", 
                 RowBox[{"a_", ",", 
                  RowBox[{"Dir", "[", "expr_", "]"}]}], "]"}], ":=", 
                RowBox[{"ReplaceIndex", "[", 
                 RowBox[{"expr", ",", 
                  RowBox[{
                   RowBox[{
                   "xAct`xTensor`Private`UltraindexOf", "[", "expr", "]"}], 
                   "\[Rule]", "a"}]}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Define", " ", "epsilon", " ", "tensor"}], ",", " ", 
              RowBox[{"with", " ", "covariant", " ", 
               RowBox[{"indices", ".", " ", "Do"}], " ", "not", " ", 
               "protect", " ", "symbol"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"metric", "/:", 
             RowBox[{"epsilonOrientation", "[", 
              RowBox[{"metric", ",", 
               RowBox[{"eoib", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "=", 
             RowBox[{"eoib", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"epsilonname", "=", 
                 RowBox[{"GiveSymbol", "[", 
                  RowBox[{"epsilon", ",", "metric"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"inds", "=", 
                 RowBox[{"GetIndicesOfVBundle", "[", 
                  RowBox[{"vbundle", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{"integerdimQ", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{"inducedQ", ",", 
                    RowBox[{"dim", "-", "1"}], ",", "dim"}], "]"}], ",", 
                    "2"}], "]"}]}], "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"DefTensor", "[", 
                RowBox[{
                 RowBox[{"epsilonname", "@@", 
                  RowBox[{"(", 
                   RowBox[{"ChangeIndex", "/@", "inds"}], ")"}]}], ",", 
                 "deps", ",", 
                 RowBox[{"Antisymmetric", "@", 
                  RowBox[{"Range", "@", 
                   RowBox[{"Length", "@", "inds"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"PrintAs", "\[RuleDelayed]", 
                  RowBox[{"GiveOutputString", "[", 
                   RowBox[{"epsilon", ",", "metric"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Master", "\[Rule]", "metric"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
                  RowBox[{"If", "[", 
                   RowBox[{"inducedQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"vector", "[", 
                    RowBox[{"First", "[", "inds", "]"}], "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ProjectedWith", "\[RuleDelayed]", 
                  RowBox[{"If", "[", 
                   RowBox[{"inducedQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"DummyIn", "[", "vbundle", "]"}]}], ",", 
                    RowBox[{"First", "[", "inds", "]"}]}], "]"}], "}"}], ",", 
                    
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"DefInfo", "\[RuleDelayed]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"info", "===", "False"}], ",", "False", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<antisymmetric tensor\>\"", ",", "\"\<\>\""}],
                     "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"TensorID", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"epsilon", ",", "metric"}], "}"}]}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Not", "@", "integerdimQ"}], " ", "&&", " ", 
                  RowBox[{"Not", "@", "inducedQ"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"TagSetDelayed", "[", 
                   RowBox[{"epsilonname", ",", 
                    RowBox[{"SymmetryGroupOfTensor", "[", 
                    RowBox[{"epsilonname", "[", "inds1__", "]"}], "]"}], ",", 
                    
                    RowBox[{"Antisymmetric", "[", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", 
                    RowBox[{"{", "inds1", "}"}]}]}], "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"TagUnset", "[", 
                   RowBox[{"epsilonname", ",", 
                    RowBox[{
                    "SymmetryGroupOfTensor", "[", "epsilonname", "]"}]}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"TagSetDelayed", "[", 
                   RowBox[{"epsilonname", ",", 
                    RowBox[{
                    "SymmetryGroupOfTensor", "[", "epsilonname", "]"}], ",", 
                    RowBox[{"Antisymmetric", "[", 
                    RowBox[{"Range", "@", 
                    RowBox[{"DimOfVBundle", "@", "vbundle"}]}], "]"}]}], 
                   "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Products", " ", "of", " ", "two", " ", 
                 RowBox[{"epsilons", ".", " ", "In"}], " ", "the", " ", 
                 "induced", " ", "and", " ", "frozen", " ", "cases", " ", 
                 "expansions", " ", "give", " ", "metric", " ", "and", " ", 
                 "not", " ", "delta"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"inducedQ", " ", "||", "frozenQ"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"epsilonname", "/:", 
                  RowBox[{
                   RowBox[{"epsilonname", "[", "inds1__", "]"}], 
                   RowBox[{"epsilonname", "[", "inds2__", "]"}]}], ":=", 
                  RowBox[{
                   RowBox[{"SignDetOfMetric", "[", "metric", "]"}], 
                   RowBox[{
                    RowBox[{"expandGdelta", "[", "metric", "]"}], "[", 
                    RowBox[{"inds1", ",", "inds2"}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"epsilonname", "/:", 
                  RowBox[{
                   RowBox[{"epsilonname", "[", "inds1__", "]"}], 
                   RowBox[{"epsilonname", "[", "inds2__", "]"}]}], ":=", 
                  RowBox[{
                   RowBox[{"SignDetOfMetric", "[", "metric", "]"}], 
                   RowBox[{"ExpandGdelta", "[", 
                    RowBox[{"Gdelta", "[", 
                    RowBox[{"inds1", ",", "inds2"}], "]"}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Derivatives", " ", "of", " ", 
                 RowBox[{"epsilon", ".", " ", "Note"}], " ", "that", " ", 
                 "we", " ", "have", " ", "not", " ", "yet", " ", "defined", 
                 " ", "covd", " ", 
                 RowBox[{"(", 
                  RowBox[{"!", "?"}], ")"}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"frozenQ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"covd", "[", "a_", "]"}], "[", 
                   RowBox[{"epsilonname", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", 
                    RowBox[{"b_", "?", "vbQ"}]}], ")"}], ".."}], "]"}], "]"}],
                   "^=", "0"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"covd", "[", "a_", "]"}], "[", 
                   RowBox[{"epsilonname", "[", 
                    RowBox[{"b__", "?", "vbpmQ"}], "]"}], "]"}], "^=", 
                  "0"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"TensorDerivative", "[", 
                 RowBox[{"epsilonname", ",", "covd", ",", "___"}], "]"}], ":=",
                 "Zero"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "inducedQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"!", "frozenQ"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"epsilonname", "/:", 
                    RowBox[{
                    RowBox[{"LieD", "[", "v_", "]"}], "[", 
                    RowBox[{"epsilonname", "[", 
                    RowBox[{"inds1__", "?", "UpIndexQ"}], "]"}], "]"}], ":=", 
                    
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dummy", "=", 
                    RowBox[{"DummyIn", "[", "vbundle", "]"}]}], "}"}], ",", 
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"covd", "[", 
                    RowBox[{"-", "dummy"}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"ReplaceIndex", "[", 
                    RowBox[{"v", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"UltraindexOf", "[", "v", "]"}], "\[Rule]", 
                    "dummy"}], "}"}]}], "]"}], 
                    RowBox[{"epsilonname", "[", "inds1", "]"}]}], "]"}]}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"epsilonname", "/:", 
                   RowBox[{
                    RowBox[{"LieD", "[", "v_", "]"}], "[", 
                    RowBox[{"epsilonname", "[", 
                    RowBox[{"inds1__", "?", "DownIndexQ"}], "]"}], "]"}], ":=", 
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dummy", "=", 
                    RowBox[{"DummyIn", "[", "vbundle", "]"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"covd", "[", 
                    RowBox[{"-", "dummy"}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"ReplaceIndex", "[", 
                    RowBox[{"v", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"UltraindexOf", "[", "v", "]"}], "\[Rule]", 
                    "dummy"}], "}"}]}], "]"}], 
                    RowBox[{"epsilonname", "[", "inds1", "]"}]}], "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"epsilonname", "/:", 
                   RowBox[{"TensorDerivative", "[", 
                    RowBox[{"epsilonname", ",", 
                    RowBox[{"LieD", "[", 
                    RowBox[{
                    RowBox[{"vhead_", "?", "xTensorQ"}], "[", "_", "]"}], 
                    "]"}]}], "]"}], ":=", 
                   RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"dummy", "=", 
                    RowBox[{"DummyIn", "[", "vbundle", "]"}]}], "}"}], ",", 
                    RowBox[{"MultiplyHead", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TensorDerivative", "[", 
                    RowBox[{"vhead", ",", "covd"}], "]"}], "[", 
                    RowBox[{"dummy", ",", 
                    RowBox[{"-", "dummy"}]}], "]"}], ",", "epsilonname"}], 
                    "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                 "Special", " ", "relation", " ", "in", " ", "2", "d"}], ",", 
                 " ", 
                 RowBox[{
                 "valid", " ", "for", " ", "all", " ", "types", " ", "of", 
                  " ", "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"dim", "===", "2"}], "&&", "firstQ"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"epsilonname", "[", 
                    RowBox[{"a_", ",", "b_"}], "]"}], 
                    RowBox[{"epsilonname", "[", 
                    RowBox[{"c_", ",", "d_"}], "]"}]}], "^=", 
                   RowBox[{
                    RowBox[{"SignDetOfMetric", "[", "metric", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], 
                    RowBox[{"metric", "[", 
                    RowBox[{"b", ",", "d"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"a", ",", "d"}], "]"}], 
                    RowBox[{"metric", "[", 
                    RowBox[{"b", ",", "c"}], "]"}]}]}], ")"}]}]}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Define", " ", "Tetra"}], ",", " ", 
                 RowBox[{
                 "only", " ", "in", " ", "dimension", " ", "4.", " ", "This", 
                  " ", "is", " ", "an", " ", "algebraic", " ", 
                  "construction"}], ",", " ", 
                 RowBox[{
                 "hence", " ", "valid", " ", "for", " ", "frozen", " ", 
                  "metrics"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"dim", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"TetraName", "=", 
                    RowBox[{"GiveSymbol", "[", 
                    RowBox[{"Tetra", ",", "metric"}], "]"}]}], "}"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}], 
                    "=", 
                    RowBox[{"GetIndicesOfVBundle", "[", 
                    RowBox[{"vbundle", ",", "4"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DefTensor", "[", 
                    RowBox[{
                    RowBox[{"TetraName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", 
                    RowBox[{"-", "i4"}]}], "]"}], ",", "deps", ",", 
                    RowBox[{"GenSet", "[", 
                    RowBox[{
                    RowBox[{"xAct`xPerm`Cycles", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", 
                    RowBox[{"xAct`xPerm`Cycles", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dagger", "\[Rule]", "Complex"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PrintAs", "\[RuleDelayed]", 
                    RowBox[{"GiveOutputString", "[", 
                    RowBox[{"Tetra", ",", "metric"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Master", "\[Rule]", "metric"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"DefInfo", "\[RuleDelayed]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"info", "===", "False"}], ",", "False", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<tetrametric\>\"", ",", "\"\<\>\""}], "}"}]}],
                     "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"TetraRule", "[", "metric", "]"}], "^:=", 
                    RowBox[{"MakeRule", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"TetraName", "[", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"I", "/", "2"}], 
                    RowBox[{"epsilonOrientation", "[", 
                    RowBox[{"metric", ",", "AIndex"}], "]"}], 
                    RowBox[{"epsilonname", "[", 
                    RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}]}], 
                    "+", 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"i1", ",", "i4"}], "]"}], 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"i2", ",", "i3"}], "]"}], "/", "2"}]}], "-", 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"i1", ",", "i3"}], "]"}], 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"i2", ",", "i4"}], "]"}], "/", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"i1", ",", "i2"}], "]"}], 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{"i3", ",", "i4"}], "]"}], "/", "2"}]}]}]}], "}"}],
                     ",", 
                    RowBox[{"Evaluate", "\[Rule]", "True"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"TetraNamedag", "=", 
                    RowBox[{"Dagger", "[", "TetraName", "]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"TetraNamedag", "[", 
                    RowBox[{"i1_", ",", "i2_", ",", "i3_", ",", "i4_"}], 
                    "]"}], ":=", 
                    RowBox[{"TetraName", "[", 
                    RowBox[{"i1", ",", "i4", ",", "i3", ",", "i2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{"$ProtectNewSymbols", ",", 
                    RowBox[{"Protect", "[", 
                    RowBox[{"TetraName", ",", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"Dagger", "@", "TetraName"}], "]"}]}], "]"}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"$ProtectNewSymbols", ",", 
                 RowBox[{"Protect", "[", "epsilonname", "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Self", "-", 
              RowBox[{
               RowBox[{"contractions", ".", " ", "Transformation"}], " ", 
               "to", " ", "delta", " ", "or", " ", "metric", " ", "for", " ", 
               "A"}], "-", 
              RowBox[{
              "indices", " ", "contraction", " ", "of", " ", "two", " ", 
               "metrics", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                 "this", " ", "could", " ", "be", " ", "generalized"}], ")"}],
                 ".", " ", "Projectors"}], " ", "not", " ", "automatically", 
               " ", "converted", " ", "into", " ", "delta"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"frozenQ", ",", "\[IndentingNewLine]", 
              StyleBox[
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
                    "*", "*", 
                    RowBox[{"**", "**", "**", "**", "**", "**", "**"}]}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**", "**", "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**********)"}],
               FontColor->RGBColor[1, 0, 0],
               Background->RGBColor[1, 0.85, 0.85]], 
              StyleBox["\[IndentingNewLine]",
               FontColor->RGBColor[1, 0, 0],
               Background->RGBColor[1, 0.85, 0.85]], 
              StyleBox[
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"**", "**"}], "*", " ", "xBrauer", " ", 
                 RowBox[{"MODIFICATION", " ", ":", " ", 
                  RowBox[{
                  "If", " ", "metric", " ", "is", " ", "frozen", " ", 
                   "metric", " ", "with", " ", "mixed", " ", "indices", " ", 
                   "is", " ", "also", " ", "passed", " ", "to", " ", 
                   "delta"}]}]}], " ", "*****)"}],
               FontColor->RGBColor[1, 0, 0],
               Background->RGBColor[1, 0.85, 0.85]], 
              StyleBox["\[IndentingNewLine]",
               FontColor->RGBColor[1, 0, 0],
               Background->RGBColor[1, 0.85, 0.85]], 
              StyleBox[
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**"}], "**"}],
                     "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                   "**"}], "**"}], "**"}], 
                "*******************************************)"}],
               FontColor->RGBColor[1, 0, 0],
               Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"metric", "/:", 
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"a_", "?", "UpIndexQ"}], ",", 
                  RowBox[{"b_", "?", "DownIndexQ"}]}], "]"}], ":=", 
                RowBox[{"delta", "[", 
                 RowBox[{"b", ",", "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"metric", "/:", 
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"a_", "?", "DownIndexQ"}], ",", 
                  RowBox[{"b_", "?", "UpIndexQ"}]}], "]"}], ":=", 
                RowBox[{"delta", "[", 
                 RowBox[{"a", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{"invmetric", "[", 
                 RowBox[{
                  RowBox[{"a_", "?", "UpIndexQ"}], ",", 
                  RowBox[{"-", "b_Symbol"}]}], "]"}], ":=", 
                RowBox[{"delta", "[", 
                 RowBox[{
                  RowBox[{"-", "b"}], ",", "a"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{"invmetric", "[", 
                 RowBox[{
                  RowBox[{"-", "a_Symbol"}], ",", 
                  RowBox[{"b_", "?", "UpIndexQ"}]}], "]"}], ":=", 
                RowBox[{"delta", "[", 
                 RowBox[{
                  RowBox[{"-", "a"}], ",", "b"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{"a_", ",", 
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "vbQ"}]}]}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{
                   RowBox[{"b_", "?", "EIndexQ"}], ",", "c_"}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "vbQ"}]}], ",", "a_"}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{
                   RowBox[{"b_", "?", "EIndexQ"}], ",", "c_"}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{"a_", ",", 
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "vbQ"}]}]}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{"c_", ",", 
                   RowBox[{"b_", "?", "EIndexQ"}]}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "vbQ"}]}], ",", "a_"}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{"c_", ",", 
                   RowBox[{"b_", "?", "EIndexQ"}]}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{"a_", ",", 
                   RowBox[{"b_", "?", "vbQ"}]}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}], ",", "c_"}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{
                   RowBox[{"b_", "?", "vbQ"}], ",", "a_"}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}], ",", "c_"}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{"a_", ",", 
                   RowBox[{"b_", "?", "vbQ"}]}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{"c_", ",", 
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}]}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"invmetric", "/:", 
                RowBox[{
                 RowBox[{"metric", "[", 
                  RowBox[{
                   RowBox[{"b_", "?", "vbQ"}], ",", "a_"}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{"c_", ",", 
                   RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}]}], "]"}]}], ":=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Inv", "[", "metric", "]"}], "^=", "metric"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"inducedQ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"a_", "?", "vbQ"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"a_", "?", "EIndexQ"}]}]}], "]"}], ":=", 
                   RowBox[{"dim", "-", "1"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"a_", "?", "vbQ"}]}], ",", 
                    RowBox[{"a_", "?", "EIndexQ"}]}], "]"}], ":=", 
                   RowBox[{"dim", "-", "1"}]}]}]}], "\[IndentingNewLine]", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"firstQ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"a_", "?", "UpIndexQ"}], ",", 
                    RowBox[{"b_", "?", "DownIndexQ"}]}], "]"}], ":=", 
                   RowBox[{"delta", "[", 
                    RowBox[{"b", ",", "a"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"a_", "?", "DownIndexQ"}], ",", 
                    RowBox[{"b_", "?", "UpIndexQ"}]}], "]"}], ":=", 
                   RowBox[{"delta", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{
                  RowBox[{"metric", "[", 
                   RowBox[{"a_", ",", 
                    RowBox[{"b_", "?", "vbQ"}]}], "]"}], 
                  RowBox[{"metric", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}], ",", "c_"}], "]"}]}], 
                 "]"}], "^:=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{
                  RowBox[{"metric", "[", 
                   RowBox[{"a_", ",", 
                    RowBox[{"b_", "?", "vbQ"}]}], "]"}], 
                  RowBox[{"metric", "[", 
                   RowBox[{"c_", ",", 
                    RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}]}], "]"}]}], "]"}], "^:=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{
                  RowBox[{"metric", "[", 
                   RowBox[{
                    RowBox[{"b_", "?", "vbQ"}], ",", "a_"}], "]"}], 
                  RowBox[{"metric", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}], ",", "c_"}], "]"}]}], 
                 "]"}], "^:=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"HoldPattern", "[", 
                 RowBox[{
                  RowBox[{"metric", "[", 
                   RowBox[{
                    RowBox[{"b_", "?", "vbQ"}], ",", "a_"}], "]"}], 
                  RowBox[{"metric", "[", 
                   RowBox[{"c_", ",", 
                    RowBox[{"-", 
                    RowBox[{"b_", "?", "EIndexQ"}]}]}], "]"}]}], "]"}], "^:=", 
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Define", " ", "covariant", " ", "derivative", 
              RowBox[{
               RowBox[{"(", "s", ")"}], ".", " ", "Do"}], " ", "not", " ", 
              "protect", " ", "symbol"}], " ", "*)"}], "\[IndentingNewLine]", 
            
            RowBox[{"If", "[", 
             RowBox[{"flatPD", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"Flat", " ", "metric", " ", "with", " ", 
                RowBox[{"PD", ".", " ", "Derivative"}], " ", "already", " ", 
                "defined"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "Print", "[", 
                "\"\<** DefMetric: Associating fiducial flat derivative PD to \
metric.\>\"", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Unprotect", "[", "PD", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"MetricOfCovD", "[", "PD", "]"}], "^=", "metric"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"PD", "[", "c_", "]"}], "[", 
                 RowBox[{"metric", "[", 
                  RowBox[{
                   RowBox[{"a_", "?", "vbpmQ"}], ",", 
                   RowBox[{"b_", "?", "vbpmQ"}]}], "]"}], "]"}], "^=", "0"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"metric", "/:", 
                RowBox[{"TensorDerivative", "[", 
                 RowBox[{"metric", ",", "PD"}], "]"}], ":=", "Zero"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", "frozenQ"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{
                   "Place", " ", "rule", " ", "for", " ", "this", " ", 
                    "metric", " ", "second"}], ",", " ", 
                   RowBox[{
                   "after", " ", "the", " ", "general", " ", "rule", " ", 
                    "for", " ", "lower", " ", "indices"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"$SortPDsRules", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"PD", "[", 
                    RowBox[{"b_", "?", "vbpmQ"}], "]"}], "[", 
                    RowBox[{
                    RowBox[{"PD", "[", 
                    RowBox[{"a_", "?", "vbpmQ"}], "]"}], "[", "expr1_", "]"}],
                     "]"}], "\[RuleDelayed]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"PD", "[", "a", "]"}], "[", 
                    RowBox[{
                    RowBox[{"PD", "[", "b", "]"}], "[", "expr1", "]"}], "]"}],
                     "/;", 
                    RowBox[{"DisorderedPairQ", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"Other", " ", 
                RowBox[{"cases", ".", " ", "Define"}], " ", 
                RowBox[{"derivative", ".", " ", "For"}], " ", "a", " ", 
                "frozen", " ", "metric", " ", "the", " ", "associated", " ", 
                "tensors", " ", "are", " ", 
                RowBox[{"wrong", "!"}], " ", "TODO"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"frozenQ", ",", "\[IndentingNewLine]", 
                RowBox[{"DefCovDFrozen", "[", 
                 RowBox[{
                  RowBox[{"covd", "[", 
                   RowBox[{"-", "ind1"}], "]"}], ",", "covdsymbol", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"FromMetric", "\[Rule]", "metric"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Curvature", "\[RuleDelayed]", 
                   RowBox[{"Not", "[", "flat", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"OtherDependencies", "\[Rule]", "odeps"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
                   RowBox[{"If", "[", 
                    RowBox[{"inducedQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"vector", "[", "ind1", "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ProjectedWith", "\[RuleDelayed]", 
                   RowBox[{"If", "[", 
                    RowBox[{"inducedQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"metric", "[", 
                    RowBox[{"ind1", ",", 
                    RowBox[{"-", "ind2"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Master", "\[Rule]", "metric"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"{", "options", "}"}], ",", 
                    RowBox[{"_", "[", 
                    RowBox[{"PrintAs", ",", "_"}], "]"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"DefCovD", "[", 
                 RowBox[{
                  RowBox[{"covd", "[", 
                   RowBox[{"-", "ind1"}], "]"}], ",", "covdsymbol", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"FromMetric", "\[Rule]", "metric"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Curvature", "\[RuleDelayed]", 
                   RowBox[{"Not", "[", "flat", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"OtherDependencies", "\[Rule]", "odeps"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
                   RowBox[{"If", "[", 
                    RowBox[{"inducedQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"vector", "[", "ind1", "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"ProjectedWith", "\[RuleDelayed]", 
                   RowBox[{"If", "[", 
                    RowBox[{"inducedQ", ",", 
                    RowBox[{"{", 
                    RowBox[{"metric", "[", 
                    RowBox[{"ind1", ",", 
                    RowBox[{"-", "ind2"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Master", "\[Rule]", "metric"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"{", "options", "}"}], ",", 
                    RowBox[{"_", "[", 
                    RowBox[{"PrintAs", ",", "_"}], "]"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"InducedCovDQ", "[", "covd", "]"}], "=", "inducedQ"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Torsion", ".", " ", 
              RowBox[{"TODO", ":", " ", 
               RowBox[{
               "modify", " ", "the", " ", "covdsymbol", " ", "in", " ", "the",
                 " ", "LCmetric"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"LCmetric", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"TorsionQ", "[", "covd", "]"}], ",", 
               RowBox[{"LC", "[", "metric", "]"}], ",", "covd"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"CovDQ", "[", "LCmetric", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DefCovD", "[", 
               RowBox[{
                RowBox[{"LCmetric", "[", 
                 RowBox[{"-", "ind1"}], "]"}], ",", "covdsymbol", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FromMetric", "\[Rule]", "metric"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Torsion", "\[Rule]", "False"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Curvature", "\[Rule]", "True"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"OtherDependencies", "\[Rule]", "odeps"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{"inducedQ", ",", 
                   RowBox[{"{", 
                    RowBox[{"vector", "[", "ind1", "]"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"ProjectedWith", "\[RuleDelayed]", 
                 RowBox[{"If", "[", 
                  RowBox[{"inducedQ", ",", 
                   RowBox[{"{", 
                    RowBox[{"metric", "[", 
                    RowBox[{"ind1", ",", 
                    RowBox[{"-", "ind2"}]}], "]"}], "}"}], ",", 
                   RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"Master", "\[Rule]", "metric"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"ProtectNewSymbol", "\[Rule]", "False"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"{", "options", "}"}], ",", 
                  RowBox[{"_", "[", 
                   RowBox[{"PrintAs", ",", "_"}], "]"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"metric", "/:", 
             RowBox[{"CovDOfMetric", "[", 
              RowBox[{"metric", ",", 
               RowBox[{"Torsion", "[", "covd", "]"}]}], "]"}], "=", "covd"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"metric", "/:", 
             RowBox[{"CovDOfMetric", "[", 
              RowBox[{"metric", ",", 
               RowBox[{"Torsion", "[", "LCmetric", "]"}]}], "]"}], "=", 
             "LCmetric"}], ";", "\[IndentingNewLine]", 
            RowBox[{"metric", "/:", 
             RowBox[{"CovDOfMetric", "[", 
              RowBox[{"metric", ",", "Zero"}], "]"}], "=", "LCmetric"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"metric", "/:", 
             RowBox[{"LC", "[", "metric", "]"}], "=", "LCmetric"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"flatPD", ",", 
              RowBox[{"Protect", "[", "PD", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"$ProtectNewSymbols", ",", 
              RowBox[{"Protect", "[", "covd", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Derivatives", " ", "of", " ", "the", " ", "metric", " ", "are", 
              " ", "defined", " ", "in", " ", "DefCovD"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Other", " ", "covariant", " ", "derivatives", " ", "on", " ", 
              "the", " ", "metric", " ", "with", " ", "upstairs", " ", 
              "abstract", " ", "indices"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "inducedQ"}], ",", "\[IndentingNewLine]", 
              RowBox[{"invmetric", "/:", 
               RowBox[{"HoldPattern", "[", 
                RowBox[{
                 RowBox[{"der_", "?", "FirstDerQ"}], "[", 
                 RowBox[{"invmetric", "[", 
                  RowBox[{
                   RowBox[{"b_", "?", "vbQ"}], ",", 
                   RowBox[{"c_", "?", "vbQ"}]}], "]"}], "]"}], "]"}], ":=", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"b1", "=", 
                    RowBox[{"DummyIn", "[", "vbundle", "]"}]}], ",", 
                   RowBox[{"c1", "=", 
                    RowBox[{"DummyIn", "[", "vbundle", "]"}]}]}], "}"}], ",", 
                 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"invmetric", "[", 
                    RowBox[{"b", ",", "b1"}], "]"}]}], 
                  RowBox[{"invmetric", "[", 
                   RowBox[{"c", ",", "c1"}], "]"}], 
                  RowBox[{"der", "[", 
                   RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "b1"}], ",", 
                    RowBox[{"-", "c1"}]}], "]"}], "]"}]}]}], "]"}]}]}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "There", " ", "is", " ", "no", " ", "simple", " ", 
              "generalization", " ", "for", " ", "induced", " ", 
              RowBox[{"metrics", ".", "\[IndentingNewLine]", 
               RowBox[{"QUESTION", ":", " ", 
                RowBox[{
                "Is", " ", "there", " ", "an", " ", "equivalent", " ", "rule",
                  " ", "for", " ", "the", " ", "epsilon", " ", 
                 RowBox[{"tensor", "?"}]}]}]}]}], "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Determinant", " ", "in", " ", "the", " ", "basis", " ", 
              RowBox[{"AIndex", ".", " ", "Has"}], " ", "to", " ", "be", " ", 
              "defined", " ", "after", " ", "the", " ", "covd", " ", "and", 
              " ", "the", " ", "invmetric"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"info", "===", "False"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"$DefInfoQ", "=", "False"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Determinant", "[", 
                  RowBox[{"metric", ",", "AIndex"}], "]"}], "[", "]"}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Determinant", "[", 
                RowBox[{"metric", ",", "AIndex"}], "]"}], "[", "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Define", " ", "induced", " ", "metric"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"inducedQ", ",", 
              RowBox[{"xAct`xTensor`Private`DefInducedMetric", "[", 
               RowBox[{
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"-", "ind1"}], ",", 
                  RowBox[{"-", "ind2"}]}], "]"}], ",", 
                RowBox[{"{", "manifold", "}"}], ",", "covd", ",", 
                RowBox[{"{", 
                 RowBox[{"vector", ",", "supermetric", ",", 
                  RowBox[{"CovDOfMetric", "[", "supermetric", "]"}]}], "}"}], 
                ",", "flat"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Store", " ", "conformal", " ", "relations"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"confto", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
              RowBox[{"SetConformalTo", "[", 
               RowBox[{
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"-", "ind1"}], ",", 
                  RowBox[{"-", "ind2"}]}], "]"}], ",", "confto"}], "]"}]}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"SetConformalToNew", "[", 
               RowBox[{"metric", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Head", "[", 
                   RowBox[{"confto", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"confto", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "*)"}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "xTras", " ", "extension", " ", "using", " ", "xPert",
                " ", "to", " ", "automatically", " ", "define", " ", "metric",
                " ", 
               RowBox[{"perturbations", " ", ":", " ", 
                RowBox[{
                "not", " ", "needed", " ", "because", " ", "we", " ", "load", 
                 " ", "xTras"}]}]}], " ", "**)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"TrueQ", "@", 
                 RowBox[{"And", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DefMetricPerturbation", "/.", 
                    RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
                    RowBox[{"Options", "[", "DefMetric", "]"}]}], ",", 
                   RowBox[{"!", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FlatMetric", "/.", 
                    RowBox[{"CheckOptions", "[", "options", "]"}]}], "/.", 
                    RowBox[{"Options", "[", "DefMetric", "]"}]}], ")"}]}]}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"DefMetricPerturbation", "[", 
                  RowBox[{"metric", ",", 
                   RowBox[{"GiveSymbol", "[", 
                    RowBox[{"Perturbation", ",", "metric"}], "]"}], ",", 
                   RowBox[{"GiveSymbol", "[", 
                    RowBox[{"PerturbationParameter", ",", "metric"}], "]"}]}],
                   "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"PrintAs", "[", 
                   RowBox[{"Evaluate", "@", 
                    RowBox[{"GiveSymbol", "[", 
                    RowBox[{"Perturbation", ",", "metric"}], "]"}]}], "]"}], "^=", 
                  RowBox[{"StringJoin", "[", 
                   RowBox[{
                    RowBox[{"PrintAs", "[", 
                    RowBox[{"Evaluate", "@", "Perturbation"}], "]"}], ",", 
                    RowBox[{"PrintAs", "[", 
                    RowBox[{"Evaluate", "@", "metric"}], "]"}]}], "]"}]}]}]}],
                "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"MakexTensions", "[", 
             RowBox[{"DefMetric", ",", "\"\<End\>\"", ",", "signdet", ",", 
              RowBox[{"metric", "[", 
               RowBox[{
                RowBox[{"-", "ind1"}], ",", 
                RowBox[{"-", "ind2"}]}], "]"}], ",", "covd", ",", "options"}],
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"On", "[", 
             RowBox[{"OptionValue", "::", "nodef"}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"pns", ",", 
              RowBox[{"Protect", "[", "metric", "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefMetric", "[", 
    RowBox[{"_", ",", "metric_", ",", "_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Message", "[", 
    RowBox[{
     RowBox[{"DefMetric", "::", "invalid"}], ",", "metric", ",", 
     "\"\<metric\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetNumberOfArguments", "[", 
   RowBox[{"DefMetric", ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "Infinity"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "DefMetric", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"RuleDelayed", "::", "rhs"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8408783818360367`*^9, 3.840878440011726*^9}, {
   3.840878474515469*^9, 3.840878486381621*^9}, {3.84111723744458*^9, 
   3.841117254581728*^9}, {3.8411177914049463`*^9, 3.841117792117796*^9}, {
   3.841121190358819*^9, 3.8411212006252728`*^9}, 3.841122010312353*^9, {
   3.841122122766848*^9, 3.841122133715807*^9}, 3.8411268264519567`*^9, {
   3.841127385676159*^9, 3.841127389241741*^9}, 3.841135096085223*^9, 
   3.841139333876293*^9, {3.8411395196649237`*^9, 3.841139546178681*^9}, 
   3.841480271530321*^9, {3.841484969484791*^9, 3.841485008565482*^9}, {
   3.8414860489556007`*^9, 3.841486049500386*^9}, {3.841486137477861*^9, 
   3.8414861957773314`*^9}, {3.841486377574553*^9, 3.8414863850855007`*^9}, {
   3.8414866185775433`*^9, 3.841486621569745*^9}, {3.841486756597226*^9, 
   3.841486775201993*^9}, 3.841741405318067*^9, {3.8417414459512*^9, 
   3.841741446412693*^9}, {3.8417414798079033`*^9, 3.8417414802772017`*^9}, {
   3.841741532814859*^9, 3.841741534419587*^9}, {3.8432956776969147`*^9, 
   3.8432959231327868`*^9}, {3.843296084596979*^9, 3.843296159983721*^9}, {
   3.843296407126009*^9, 3.843296425512834*^9}, {3.843296507076536*^9, 
   3.843296508482008*^9}, {3.8432966365770073`*^9, 3.843296654368828*^9}, {
   3.843297260659647*^9, 3.843297307222303*^9}, {3.8432976239833393`*^9, 
   3.843297657435275*^9}, {3.843297694744526*^9, 3.843297774702094*^9}, {
   3.843301318530149*^9, 3.843301523626691*^9}, {3.843553247619883*^9, 
   3.8435532657722282`*^9}, {3.843553296336713*^9, 3.8435533570527487`*^9}, {
   3.84357870208947*^9, 3.8435787390613728`*^9}, {3.843820063214219*^9, 
   3.8438200693615513`*^9}, {3.843903708368924*^9, 3.843903789531906*^9}, 
   3.843903838354938*^9, {3.843903936380867*^9, 3.843903937741193*^9}, {
   3.843904040296537*^9, 3.843904055750125*^9}, {3.843904204901278*^9, 
   3.8439042359549313`*^9}, {3.8439043848232203`*^9, 3.843904405063945*^9}, {
   3.843904558859538*^9, 3.843904562976919*^9}, 3.847361303949307*^9, 
   3.847361344228353*^9, 3.8474398336720057`*^9, 3.865503234775062*^9, {
   3.8934912359680777`*^9, 3.8934913054423027`*^9}, {3.8934913355996227`*^9, 
   3.893491343060358*^9}, {3.893491393101651*^9, 3.8934915095498447`*^9}, {
   3.893497340437496*^9, 3.893497340973092*^9}, {3.893497567530039*^9, 
   3.893497599265191*^9}, {3.893500801759656*^9, 3.893500802709819*^9}, 
   3.8935008650984097`*^9, {3.89350090629792*^9, 3.893500929653253*^9}, {
   3.893503299404858*^9, 
   3.893503299840075*^9}},ExpressionUUID->"70469fdd-020a-4dec-b2a4-\
9e16dfff3314"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"**", "**", "**", "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
         "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "********)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Modification", " ", "of", " ", "WeylToRiemann", " ", "and", " ", 
    "CurvatureRelations", " ", "for", " ", "frozen", " ", 
    RowBox[{"metric", " ", ":", " ", 
     RowBox[{"definition", " ", "of", " ", "DefCovDFrozen"}]}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "********)"}]}]], "Input",
 CellChangeTimes->{{3.841116227242599*^9, 3.8411162586974583`*^9}, {
  3.841116414142193*^9, 3.841116418021216*^9}, {3.8411178144193*^9, 
  3.841117828097618*^9}, {3.841127124348352*^9, 3.841127135041019*^9}, {
  3.841135459472682*^9, 
  3.841135462524193*^9}},ExpressionUUID->"11901663-6fa4-4b7a-91a0-\
f12332b0afa7"],

Cell["Copy/paste from xTensor", "Text",
 CellChangeTimes->{{3.8411354279679813`*^9, 
  3.841135433322693*^9}},ExpressionUUID->"413e44d3-b23b-40af-826a-\
7407e982021a"],

Cell["1) Backwards compatibility:", "Text",
 CellChangeTimes->{3.8411276743335323`*^9, 
  3.841139241342271*^9},ExpressionUUID->"cf542ad0-321f-45eb-91bd-\
dd0cd052540d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd_", "[", "ind_", "]"}], ",", 
     RowBox[{"symbol", ":", 
      RowBox[{"{", 
       RowBox[{"_String", ",", "_String"}], "}"}]}], ",", "options___"}], 
    "]"}], ":=", 
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd", "[", "ind", "]"}], ",", 
     RowBox[{"VBundleOfIndex", "[", "ind", "]"}], ",", 
     RowBox[{"SymbolOfCovD", "\[Rule]", "symbol"}], ",", "options"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd_", "[", "ind_", "]"}], ",", "vbundles_", ",", 
     RowBox[{"symbol", ":", 
      RowBox[{"{", 
       RowBox[{"_String", ",", "_String"}], "}"}]}], ",", "options___"}], 
    "]"}], ":=", 
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd", "[", "ind", "]"}], ",", "vbundles", ",", 
     RowBox[{"SymbolOfCovD", "\[Rule]", "symbol"}], ",", "options"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd_", "[", "ind_", "]"}], ",", 
     RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd", "[", "ind", "]"}], ",", 
     RowBox[{"VBundleOfIndex", "[", "ind", "]"}], ",", "options"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841127711347118*^9, 
  3.841127723098261*^9}},ExpressionUUID->"d1a81c4a-8dce-423d-ae2f-\
4a59ee8cce22"],

Cell["\<\
2) This is the main command. Mostly copy/paste of DefCovD in xTensor\
\>", "Text",
 CellChangeTimes->{{3.841127696865077*^9, 3.841127708561297*^9}, 
   3.841139242448086*^9},ExpressionUUID->"16d38e95-8dee-456d-a6a6-\
ba3840c793e6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DefCovDFrozen", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SymbolOfCovD", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<;\>\"", ",", "\"\<\[EmptyDownTriangle]\>\""}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Torsion", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Curvature", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FromMetric", "\[Rule]", "Null"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CurvatureRelations", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtendedFrom", "\[Rule]", "Null"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"OtherDependencies", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"OrthogonalTo", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ProjectedWith", "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"WeightedWithBasis", "\[Rule]", "Null"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ProtectNewSymbol", "\[RuleDelayed]", "$ProtectNewSymbols"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Master", "\[Rule]", "Null"}], ",", "\[IndentingNewLine]", 
     RowBox[{"DefInfo", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<covariant derivative\>\"", ",", "\"\<\>\""}], "}"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefCovDFrozen", "[", 
    RowBox[{
     RowBox[{"covd_", "[", "ind_", "]"}], ",", "vbundles_", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Catch", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{
          RowBox[{"AIndexQ", "[", "ind", "]"}], "&&", 
          RowBox[{"DownIndexQ", "[", "ind", "]"}]}], "]"}], ",", 
        RowBox[{"Throw", "[", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"DefCovD", "::", "invalid"}], ",", 
           "\"\<covariant abstract-index\>\"", ",", "ind"}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tbundle", "=", 
           RowBox[{"VBundleOfIndex", "[", "ind", "]"}]}], ",", 
          RowBox[{"manifold", "=", 
           RowBox[{"BaseOfVBundle", "@", 
            RowBox[{"VBundleOfIndex", "[", "ind", "]"}]}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "allbundles", ",", "symbol", ",", "torsion", ",", "curvature", ",",
             "metric", ",", "curvrels", ",", "ef", ",", "odeps", ",", "wwb", 
            ",", "pns", ",", "master", ",", "info", ",", "ot", ",", "pw", ",",
             "curvedbundles"}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Options", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "symbol", ",", "torsion", ",", "curvature", ",", "metric", ",", 
              "curvrels", ",", "ot", ",", "pw", ",", "ef", ",", "odeps", ",", 
              "wwb", ",", "pns", ",", "master", ",", "info"}], "}"}], "=", 
            RowBox[{"OptionValue", "[", 
             RowBox[{"{", 
              RowBox[{
              "SymbolOfCovD", ",", "Torsion", ",", "Curvature", ",", 
               "FromMetric", ",", "CurvatureRelations", ",", "OrthogonalTo", 
               ",", "ProjectedWith", ",", "ExtendedFrom", ",", 
               "OtherDependencies", ",", "WeightedWithBasis", ",", 
               "ProtectNewSymbol", ",", "Master", ",", "DefInfo"}], "}"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ot", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", "ot", "}"}], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pw", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"{", "pw", "}"}], ",", "1"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Checks", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"allbundles", "=", 
            RowBox[{"DeleteDuplicates", "@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"tbundle", ",", "vbundles", ",", 
                RowBox[{"Dagger", "/@", 
                 RowBox[{"{", "vbundles", "}"}]}]}], "}"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"curvedbundles", "=", 
            RowBox[{"xAct`xTensor`Private`DefCovDCheck", "[", 
             RowBox[{
             "covd", ",", "manifold", ",", "allbundles", ",", "symbol", ",", 
              RowBox[{"{", 
               RowBox[{
               "torsion", ",", "curvature", ",", "metric", ",", "curvrels", 
                ",", "ef", ",", "odeps", ",", "wwb"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Register", " ", "*)"}], "\[IndentingNewLine]", 
           
           RowBox[{"xAct`xTensor`Private`MakeDefInfo", "[", 
            RowBox[{"DefCovD", ",", 
             RowBox[{"covd", "[", "ind", "]"}], ",", "info"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CovDQ", "[", "covd", "]"}], "^=", "True"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendToUnevaluated", "[", 
            RowBox[{"$CovDs", ",", "covd"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SymbolOfCovD", "[", "covd", "]"}], "^=", "symbol"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ManifoldOfCovD", "[", "covd", "]"}], "^=", "manifold"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VBundlesOfCovD", "[", "covd", "]"}], "^=", 
            "allbundles"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], "^=", 
            RowBox[{"xAct`xTensor`Private`SortDependencies", "@", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "manifold", "}"}], ",", "odeps"}], "]"}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TorsionQ", "[", "covd", "]"}], "^=", "torsion"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TagSet", "[", 
              RowBox[{"covd", ",", 
               RowBox[{"CurvatureQ", "[", 
                RowBox[{"covd", ",", "#"}], "]"}], ",", "True"}], "]"}], 
             "&"}], "/@", "curvedbundles"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TagSet", "[", 
              RowBox[{"covd", ",", 
               RowBox[{"CurvatureQ", "[", 
                RowBox[{"covd", ",", "#"}], "]"}], ",", "False"}], "]"}], 
             "&"}], "/@", 
            RowBox[{"Complement", "[", 
             RowBox[{"allbundles", ",", "curvedbundles"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MetricOfCovD", "[", "covd", "]"}], "^=", "metric"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"WeightedWithBasis", "[", "covd", "]"}], "^=", "wwb"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MasterOf", "[", "covd", "]"}], "^=", "metric"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"xAct`xTensor`Private`SymbolRelations", "[", 
            RowBox[{"covd", ",", "master", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ef", "===", "Null"}], ",", 
               RowBox[{"{", "manifold", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"manifold", ",", "ef"}], "}"}]}], "]"}]}], "]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DefInfo", "[", "covd", "]"}], "^=", "info"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"**", 
             RowBox[{
             "*", " ", "Define", " ", "derivative", " ", "operator"}]}], " ", 
            "****)"}], "\[IndentingNewLine]", 
           RowBox[{"xAct`xTensor`Private`MakeLinearDerivative", "[", 
            RowBox[{"covd", ",", 
             RowBox[{"ot", "===", 
              RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "xAct`xTensor`Private`MakeTensorialDerivative", "[", "covd", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ot", "=!=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"xAct`xTensor`Private`MakeOrthogonalDerivative", "[", 
              RowBox[{"covd", ",", 
               RowBox[{"First", "[", "pw", "]"}], ",", 
               RowBox[{"First", "[", "ot", "]"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pw", "=!=", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"xAct`xTensor`Private`MakeProjectedDerivative", "[", 
              RowBox[{"covd", ",", 
               RowBox[{"First", "[", "pw", "]"}], ",", 
               RowBox[{"First", "[", "ot", "]"}]}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Define", " ", "curvature", " ", "tensors", " ", "and", " ", 
             "other", " ", "properties"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"info", "=!=", "False"}], ",", 
             RowBox[{"info", "=", "$DefInfoQ"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"defcovdTangentFrozen", "[", 
            RowBox[{"covd", ",", "tbundle", ",", 
             RowBox[{"{", 
              RowBox[{"torsion", ",", 
               RowBox[{"CurvatureQ", "[", 
                RowBox[{"covd", ",", "tbundle"}], "]"}], ",", "metric", ",", 
               "curvrels"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ot", ",", "pw", ",", "info"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"pns", ",", 
             RowBox[{"Protect", "[", "covd", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.841117874133687*^9, 3.841117874811903*^9}, {
   3.8411181254536533`*^9, 3.8411181304167643`*^9}, {3.8411182568114557`*^9, 
   3.841118260566318*^9}, {3.841118334048661*^9, 3.841118335601844*^9}, {
   3.84112075347326*^9, 3.841120754239304*^9}, {3.841120942094779*^9, 
   3.841120942739353*^9}, 3.841121012283551*^9, {3.841121749219939*^9, 
   3.8411217643478107`*^9}, {3.8411380099447927`*^9, 3.841138014837449*^9}, {
   3.8411386137878313`*^9, 3.841138643501768*^9}, 3.841139200322859*^9, 
   3.8411392588133717`*^9, {3.841206621862966*^9, 3.8412066491180487`*^9}, 
   3.8412070326488533`*^9, 3.841207066155385*^9, 3.841207278378428*^9, {
   3.841207438651245*^9, 3.841207479628668*^9}, {3.8412076545725613`*^9, 
   3.841207663406839*^9}, {3.841207754693675*^9, 3.841207784644287*^9}, {
   3.84120787984107*^9, 3.841207880231765*^9}, {3.8412231369736834`*^9, 
   3.841223144893766*^9}},ExpressionUUID->"32fb5a03-ac7b-4cfd-b17d-\
4a5910239068"],

Cell[BoxData[
 RowBox[{
  RowBox[{"defcovdTangentFrozen", "[", 
   RowBox[{"covd_", ",", "tbundle_", ",", 
    RowBox[{"{", 
     RowBox[{"torQ_", ",", "curvQ_", ",", "metric_", ",", "curvrels_"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ov_", ",", "pw_", ",", "info_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Reinterpretation", " ", "of", " ", "input"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"indexlist", "=", 
       RowBox[{"GetIndicesOfVBundle", "[", 
        RowBox[{"tbundle", ",", "9"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"dim", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pw", "===", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"DimOfVBundle", "[", "tbundle", "]"}], ",", 
         RowBox[{
          RowBox[{"DimOfVBundle", "[", "tbundle", "]"}], "-", "1"}]}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"metricQ", "=", 
       RowBox[{"(", 
        RowBox[{"metric", "=!=", "Null"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"orthogonalQ", "=", 
       RowBox[{"(", 
        RowBox[{"ov", "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"projectedQ", "=", 
       RowBox[{"(", 
        RowBox[{"pw", "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"endowedQ", "=", 
       RowBox[{"MetricEndowedQ", "[", "tbundle", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"frozenQ", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"metric", "=!=", "Null"}], ",", 
         RowBox[{"FrozenMetricQ", "[", "metric", "]"}], ",", "False"}], 
        "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Secondary", " ", "definitions"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"tbQ", "=", 
         RowBox[{
         "xAct`xTensor`Private`VBundleIndexQ", "[", "tbundle", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"tbpmQ", "=", 
         RowBox[{
         "xAct`xTensor`Private`VBundleIndexPMQ", "[", "tbundle", "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"invmetric", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"If", "[", 
            RowBox[{"frozenQ", ",", 
             RowBox[{"GiveSymbol", "[", 
              RowBox[{"Inv", ",", "metric"}], "]"}], ",", "metric"}], "]"}], 
           ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"TorsionName", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Torsion", ",", "covd"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelName", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Christoffel", ",", "covd"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannName", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Riemann", ",", "covd"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannDownName", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"GiveSymbol", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"frozenQ", ",", "RiemannDown", ",", "Riemann"}], "]"}], 
             ",", "covd"}], "]"}], ",", "$Failed"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciName", "=", 
         RowBox[{"GiveSymbol", "[", 
          RowBox[{"Ricci", ",", "covd"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WeylName", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"GiveSymbol", "[", 
            RowBox[{"Weyl", ",", "covd"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TFRicciName", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"GiveSymbol", "[", 
            RowBox[{"TFRicci", ",", "covd"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EinsteinName", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"GiveSymbol", "[", 
            RowBox[{"Einstein", ",", "covd"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarName", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"GiveSymbol", "[", 
            RowBox[{"RicciScalar", ",", "covd"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"KretschmannName", "=", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", 
           RowBox[{"GiveSymbol", "[", 
            RowBox[{"Kretschmann", ",", "covd"}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"i1", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i2", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i3", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i4", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i5", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i1d", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i2d", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "7", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i3d", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "8", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"i4d", "=", 
         RowBox[{"indexlist", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"integerdimQ", "=", 
         RowBox[{"IntegerQ", "[", "dim", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "prot", ",", "vector", ",", "projector", ",", "tmp", ",", 
          "vanishQ"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "0.", " ", "Check", " ", "orthogonality", " ", "and", " ", 
          "projections"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", "endowedQ"}], "&&", 
            RowBox[{"(", 
             RowBox[{"projectedQ", "||", "orthogonalQ"}], ")"}]}], ",", 
           RowBox[{"Throw", "@", 
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"DefCovD", "::", "error"}], ",", 
              "\"\<xTensor cannot yet project in a vector bundle without \
metric.\>\""}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"orthogonalQ", ",", 
           RowBox[{"vector", "=", 
            RowBox[{"ov", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "0"}], "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"projectedQ", ",", 
           RowBox[{"projector", "=", 
            RowBox[{"pw", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "0"}], "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"1.", " ", "Define", " ", "torsion", " ", "tensor"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"vanishQ", "=", 
          RowBox[{"!", "torQ"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DefTensor", "[", 
          RowBox[{
           RowBox[{"TorsionName", "[", 
            RowBox[{"i1", ",", 
             RowBox[{"-", "i2"}], ",", 
             RowBox[{"-", "i3"}]}], "]"}], ",", 
           RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
           RowBox[{"Antisymmetric", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PrintAs", "\[RuleDelayed]", 
            RowBox[{"GiveOutputString", "[", 
             RowBox[{"Torsion", ",", "covd"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Master", "\[Rule]", "covd"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"orthogonalQ", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"vector", "[", 
                 RowBox[{"-", "i1"}], "]"}], ",", 
                RowBox[{"vector", "[", "i2", "]"}], ",", 
                RowBox[{"vector", "[", "i3", "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ProjectedWith", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"projectedQ", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"projector", "[", 
                 RowBox[{
                  RowBox[{"-", "i1"}], ",", "i1d"}], "]"}], ",", 
                RowBox[{"projector", "[", 
                 RowBox[{"i2", ",", 
                  RowBox[{"-", "i2d"}]}], "]"}], ",", 
                RowBox[{"projector", "[", 
                 RowBox[{"i3", ",", 
                  RowBox[{"-", "i3d"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"DefInfo", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"info", ",", 
              RowBox[{"{", 
               RowBox[{"\"\<torsion tensor\>\"", ",", "\"\<\>\""}], "}"}], 
              ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"TensorID", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Torsion", ",", "covd"}], "}"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "2.", " ", "Define", " ", "Christoffel", " ", "tensor", " ", 
           "relating", " ", "covd", " ", "to", " ", 
           RowBox[{"PD", ".", " ", "Always"}], " ", "nonzero"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"DefTensor", "[", 
          RowBox[{
           RowBox[{"ChristoffelName", "[", 
            RowBox[{"i1", ",", 
             RowBox[{"-", "i2"}], ",", 
             RowBox[{"-", "i3"}]}], "]"}], ",", 
           RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{"torQ", ",", 
             RowBox[{"StrongGenSet", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"GenSet", "[", "]"}]}], "]"}], ",", 
             RowBox[{"Symmetric", "[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3"}], "}"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PrintAs", "\[RuleDelayed]", 
            RowBox[{"GiveOutputString", "[", 
             RowBox[{"Christoffel", ",", "covd"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Master", "\[Rule]", "covd"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"orthogonalQ", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"vector", "[", 
                 RowBox[{"-", "i1"}], "]"}], ",", 
                RowBox[{"vector", "[", "i2", "]"}], ",", 
                RowBox[{"vector", "[", "i3", "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ProjectedWith", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"projectedQ", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"projector", "[", 
                 RowBox[{
                  RowBox[{"-", "i1"}], ",", "i1d"}], "]"}], ",", 
                RowBox[{"projector", "[", 
                 RowBox[{"i2", ",", 
                  RowBox[{"-", "i2d"}]}], "]"}], ",", 
                RowBox[{"projector", "[", 
                 RowBox[{"i3", ",", 
                  RowBox[{"-", "i3d"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"DefInfo", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"info", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                  "torQ", ",", "\"\<non-symmetric \>\"", ",", 
                   "\"\<symmetric \>\""}], "]"}], "<>", 
                 "\"\<Christoffel tensor\>\""}], ",", "\"\<\>\""}], "}"}], 
              ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"TensorID", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Christoffel", ",", "covd", ",", "PD"}], "}"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"xAct`xTensor`Private`$Christoffels", ",", 
           RowBox[{"{", 
            RowBox[{"ChristoffelName", ",", 
             RowBox[{"{", 
              RowBox[{"Christoffel", ",", "covd", ",", "PD"}], "}"}], ",", 
             RowBox[{"{", "tbundle", "}"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "3.", " ", "Automatic", " ", "commutativity", " ", "of", " ", 
            "scalars"}], ",", " ", 
           RowBox[{"even", " ", "if", " ", "there", " ", "is", " ", 
            RowBox[{"torsion", ".", " ", "Only"}], " ", "for", " ", 
            "covariant", " ", "derivatives", " ", "with", " ", "abstract", 
            " ", "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "CovDTODO", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"covd", "[", 
            RowBox[{"-", 
             RowBox[{"b_", "?", "tbQ"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"covd", "[", 
             RowBox[{"-", 
              RowBox[{"a_", "?", "tbQ"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"scalar_", "?", "xTensorQ"}], "[", "]"}], "]"}], "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"covd", "[", 
              RowBox[{"-", "a"}], "]"}], "[", 
             RowBox[{
              RowBox[{"covd", "[", 
               RowBox[{"-", "b"}], "]"}], "[", 
              RowBox[{"scalar", "[", "]"}], "]"}], "]"}], "+", 
            RowBox[{"$TorsionSign", " ", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"dummy", "=", 
                 RowBox[{"DummyIn", "[", "tbundle", "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"TorsionName", "[", 
                 RowBox[{"dummy", ",", 
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{"-", "b"}]}], "]"}], 
                RowBox[{
                 RowBox[{"covd", "[", 
                  RowBox[{"-", "dummy"}], "]"}], "[", 
                 RowBox[{"scalar", "[", "]"}], "]"}]}]}], "]"}]}]}], "/;", 
           RowBox[{"$CommuteCovDsOnScalars", "&&", 
            RowBox[{"DisorderedPairQ", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"*", " ", "3.", 
           RowBox[{"b", " ", ":", " ", "Composition"}]}], " ", "**)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"covd", "[", "a_", "]"}], "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "args___", "]"}], 
            ")"}]}], ":=", 
          RowBox[{"xAct`xTensor`Private`multiD", "[", 
           RowBox[{
            RowBox[{"covd", "[", "a", "]"}], ",", 
            RowBox[{"f", "[", "args", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{"4.", " ", "Metric", " ", "compatibility"}], " ", "*)"}],
          FontColor->RGBColor[1, 0.5, 0],
          Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "CovDTODO", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"frozenQ", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"covd", "[", "a_", "]"}], "[", 
                RowBox[{"invmetric", "[", 
                 RowBox[{
                  RowBox[{"b_Symbol", "?", "tbQ"}], ",", 
                  RowBox[{"c_Symbol", "?", "tbQ"}]}], "]"}], "]"}], ":=", 
               "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"covd", "[", "a_", "]"}], "[", 
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"b_Symbol", "?", "tbQ"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"c_Symbol", "?", "tbQ"}]}]}], "]"}], "]"}], ":=", 
               "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"covd", "[", "a_", "]"}], "[", 
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"b_Symbol", "?", "tbQ"}], ",", 
                  RowBox[{"c_Symbol", "?", "tbQ"}]}], "]"}], "]"}], ":=", 
               "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"covd", "/:", 
               RowBox[{"TensorDerivative", "[", 
                RowBox[{"invmetric", ",", "covd", ",", "___"}], "]"}], ":=", 
               "Zero"}], ";", "\[IndentingNewLine]", 
              RowBox[{"covd", "/:", 
               RowBox[{"TensorDerivative", "[", 
                RowBox[{"metric", ",", "covd", ",", "___"}], "]"}], ":=", 
               "Zero"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"covd", "[", "a_", "]"}], "[", 
                RowBox[{"metric", "[", 
                 RowBox[{
                  RowBox[{"b_", "?", "tbpmQ"}], ",", 
                  RowBox[{"c_", "?", "tbpmQ"}]}], "]"}], "]"}], ":=", "0"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"covd", "/:", 
               RowBox[{"TensorDerivative", "[", 
                RowBox[{"metric", ",", "covd", ",", "___"}], "]"}], ":=", 
               "Zero"}]}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "5.", " ", "Only", " ", "if", " ", "there", " ", "is", " ", "a", 
           " ", "metric", " ", "and", " ", "no", " ", "torsion", " ", "the", 
           " ", "RiemannDown", " ", "tensor", " ", "has", " ", "its", " ", 
           "full", " ", 
           RowBox[{"symmetries", " ", ":", " ", 
            RowBox[{
            "Why", " ", "do", " ", "we", " ", "need", " ", "to", " ", 
             "define", " ", "RiemannDown", " ", 
             RowBox[{"??", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"vanishQ", "=", 
          RowBox[{
           RowBox[{"!", "curvQ"}], "||", 
           RowBox[{"If", "[", 
            RowBox[{"integerdimQ", ",", 
             RowBox[{"dim", "<", "2"}], ",", "False"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{"DefTensor", "[", 
            RowBox[{
             RowBox[{"RiemannDownName", "[", 
              RowBox[{
               RowBox[{"-", "i1"}], ",", 
               RowBox[{"-", "i2"}], ",", 
               RowBox[{"-", "i3"}], ",", 
               RowBox[{"-", "i4"}]}], "]"}], ",", 
             RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{"torQ", ",", 
               RowBox[{"JoinSGS", "[", 
                RowBox[{
                 RowBox[{"Antisymmetric", "[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
                 RowBox[{"Antisymmetric", "[", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "4"}], "}"}], "]"}]}], "]"}], ",", 
               RowBox[{"RiemannSymmetric", "[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"PrintAs", "\[RuleDelayed]", 
              RowBox[{"GiveOutputString", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"frozenQ", ",", "RiemannDown", ",", "Riemann"}], 
                 "]"}], ",", "covd"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Master", "\[Rule]", "covd"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{"orthogonalQ", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"vector", "[", "i1", "]"}], ",", 
                  RowBox[{"vector", "[", "i2", "]"}], ",", 
                  RowBox[{"vector", "[", "i3", "]"}], ",", 
                  RowBox[{"vector", "[", "i4", "]"}]}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"ProjectedWith", "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{"projectedQ", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"projector", "[", 
                   RowBox[{"i1", ",", 
                    RowBox[{"-", "i1d"}]}], "]"}], ",", 
                  RowBox[{"projector", "[", 
                   RowBox[{"i2", ",", 
                    RowBox[{"-", "i2d"}]}], "]"}], ",", 
                  RowBox[{"projector", "[", 
                   RowBox[{"i3", ",", 
                    RowBox[{"-", "i3d"}]}], "]"}], ",", 
                  RowBox[{"projector", "[", 
                   RowBox[{"i4", ",", 
                    RowBox[{"-", "i4d"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"DefInfo", "\[RuleDelayed]", 
              RowBox[{"If", "[", 
               RowBox[{"info", ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Riemann tensor\>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                   "torQ", ",", 
                    "\"\<Antisymmetric pairs cannot be exchanged.\>\"", ",", 
                    "\"\<\>\""}], "]"}]}], "}"}], ",", "False"}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"TensorID", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Riemann", ",", "covd"}], "}"}]}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"metricQ", "&&", "frozenQ"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"RiemannName", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}], ",", 
                RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", 
              RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"torQ", ",", 
                RowBox[{"JoinSGS", "[", 
                 RowBox[{
                  RowBox[{"Antisymmetric", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
                  RowBox[{"Antisymmetric", "[", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "]"}]}], "]"}], ",", 
                RowBox[{"RiemannSymmetric", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}],
                "]"}], ",", 
              RowBox[{"ForceSymmetries", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PrintAs", "\[RuleDelayed]", 
               RowBox[{"GiveOutputString", "[", 
                RowBox[{"Riemann", ",", "covd"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Master", "\[Rule]", "covd"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"orthogonalQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vector", "[", "i1", "]"}], ",", 
                   RowBox[{"vector", "[", "i2", "]"}], ",", 
                   RowBox[{"vector", "[", "i3", "]"}], ",", 
                   RowBox[{"vector", "[", 
                    RowBox[{"-", "i4"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ProjectedWith", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"projectedQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"projector", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"-", "i1d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{"i2", ",", 
                    RowBox[{"-", "i2d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{"i3", ",", 
                    RowBox[{"-", "i3d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{
                    RowBox[{"-", "i4"}], ",", "i4d"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Riemann tensor\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    "curvQ", ",", 
                    "\"\<Antisymmetric only in the first pair.\>\"", ",", 
                    "\"\<\>\""}], "]"}]}], "}"}], ",", "False"}], "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"TensorID", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Riemann", ",", "covd"}], "}"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"RiemannName", "/:", 
             RowBox[{"RiemannName", "[", 
              RowBox[{"i1_", ",", "i2_", ",", 
               RowBox[{"-", "i3_"}], ",", "i3_"}], "]"}], ":=", "0"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"RiemannName", "/:", 
             RowBox[{"RiemannName", "[", 
              RowBox[{"i1_", ",", "i2_", ",", "i3_", ",", 
               RowBox[{"-", "i3_"}]}], "]"}], ":=", "0"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "6.", " ", "Only", " ", "if", " ", "there", " ", "is", " ", "a", 
             " ", "metric", " ", "and", " ", "no", " ", "torsion", " ", "the",
              " ", "Ricci", " ", "tensor", " ", "is", " ", "symmetric"}], ";",
             " ", 
            RowBox[{
            "we", " ", "use", " ", "MakeRule", " ", "without", " ", 
             "restrictions"}]}], " ", "*)"}],
          FontColor->RGBColor[1, 0, 0],
          Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
         RowBox[{"vanishQ", "=", 
          RowBox[{
           RowBox[{"!", "curvQ"}], "||", 
           RowBox[{"If", "[", 
            RowBox[{"integerdimQ", ",", 
             RowBox[{"dim", "<", "2"}], ",", "False"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"DefTensor", "[", 
          RowBox[{
           RowBox[{"RicciName", "[", 
            RowBox[{
             RowBox[{"-", "i1"}], ",", 
             RowBox[{"-", "i2"}]}], "]"}], ",", 
           RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"metricQ", "&&", 
              RowBox[{"!", "torQ"}]}], ",", 
             RowBox[{"Symmetric", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
             RowBox[{"StrongGenSet", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"GenSet", "[", "]"}]}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PrintAs", "\[RuleDelayed]", 
            RowBox[{"GiveOutputString", "[", 
             RowBox[{"Ricci", ",", "covd"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Master", "\[Rule]", "covd"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"orthogonalQ", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"vector", "[", "i1", "]"}], ",", 
                RowBox[{"vector", "[", "i2", "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ProjectedWith", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"projectedQ", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"projector", "[", 
                 RowBox[{"i1", ",", 
                  RowBox[{"-", "i1d"}]}], "]"}], ",", 
                RowBox[{"projector", "[", 
                 RowBox[{"i2", ",", 
                  RowBox[{"-", "i2d"}]}], "]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"DefInfo", "\[RuleDelayed]", 
            RowBox[{"If", "[", 
             RowBox[{"info", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"vanishQ", ",", "\"\<\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"metricQ", "&&", 
                    RowBox[{"!", "torQ"}]}], ",", "\"\<symmetric \>\"", ",", 
                    "\"\<non-symmetric \>\""}], "]"}]}], "]"}], "<>", 
                 "\"\<Ricci tensor\>\""}], ",", "\"\<\>\""}], "}"}], ",", 
              "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"TensorID", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Ricci", ",", "covd"}], "}"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "vanishQ"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"covd", "/:", 
             RowBox[{"CurvatureRelations", "[", 
              RowBox[{"covd", ",", "Riemann"}], "]"}], "=", 
             RowBox[{"MakeRule", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"RiemannName", "[", 
                  RowBox[{
                   RowBox[{"-", "i1"}], ",", 
                   RowBox[{"-", "i2"}], ",", 
                   RowBox[{"-", "i3"}], ",", "i2"}], "]"}], ",", 
                 RowBox[{"$RicciSign", " ", 
                  RowBox[{"RicciName", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}]}]}], "}"}], ",", 
               RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
               RowBox[{"UseSymmetries", "\[Rule]", "True"}], ",", 
               RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"curvrels", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{
                 "Print", "[", 
                  "\"\<** DefCovD:  Contractions of Riemann automatically \
replaced by Ricci.\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"prot", "=", 
                RowBox[{"Unprotect", "[", "RiemannName", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AutomaticRules", "[", 
                RowBox[{"RiemannName", ",", 
                 RowBox[{"CurvatureRelations", "[", 
                  RowBox[{"covd", ",", "Riemann"}], "]"}], ",", 
                 RowBox[{"Verbose", "\[Rule]", "False"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Protect", "[", 
                RowBox[{"Evaluate", "[", "prot", "]"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"7.", " ", "The", " ", "Ricci", " ", "scalar"}], " ", ";",
             " ", 
            RowBox[{
            "we", " ", "use", " ", "MakeRule", " ", "without", " ", 
             "restrictions"}]}], "  ", "*)"}],
          Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vanishQ", "=", 
             RowBox[{
              RowBox[{"!", "curvQ"}], "||", 
              RowBox[{"If", "[", 
               RowBox[{"integerdimQ", ",", 
                RowBox[{"dim", "<", "2"}], ",", "False"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"RicciScalarName", "[", "]"}], ",", 
              RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PrintAs", "\[RuleDelayed]", 
               RowBox[{"GiveOutputString", "[", 
                RowBox[{"Ricci", ",", "covd"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Master", "\[Rule]", "covd"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Ricci scalar\>\"", ",", "\"\<\>\""}], "}"}], 
                 ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"TensorID", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"RicciScalar", ",", "covd"}], "}"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "vanishQ"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"covd", "/:", 
                RowBox[{"CurvatureRelations", "[", 
                 RowBox[{"covd", ",", "Ricci"}], "]"}], "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"MakeRule", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"invmetric", "[", 
                    RowBox[{"i1", ",", "i2"}], "]"}], 
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}]}], ",", 
                    RowBox[{"RicciScalarName", "[", "]"}]}], "}"}], "]"}], 
                  ",", 
                  RowBox[{"MakeRule", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", "i1"}], "]"}], ",", 
                    RowBox[{"RicciScalarName", "[", "]"}]}], "}"}], "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{"curvrels", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{"info", ",", 
                    RowBox[{
                    "Print", "[", 
                    "\"\<** DefCovD:  Contractions of Ricci automatically \
replaced by RicciScalar.\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"prot", "=", 
                   RowBox[{"Unprotect", "[", "RicciName", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"AutomaticRules", "[", 
                   RowBox[{"RicciName", ",", 
                    RowBox[{"CurvatureRelations", "[", 
                    RowBox[{"covd", ",", "Ricci"}], "]"}], ",", 
                    RowBox[{"Verbose", "\[Rule]", "False"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Protect", "[", 
                   RowBox[{"Evaluate", "[", "prot", "]"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"8.", " ", "The", " ", "Einstein", " ", "tensor"}], " ", 
            ";", " ", 
            RowBox[{
            "we", " ", "use", " ", "MakeRule", " ", "without", " ", 
             "restrictions"}]}], 
           StyleBox[
            RowBox[{
             StyleBox["  ",
              Background->RGBColor[1, 0.85, 0.85]], " "}]], "*)"}],
          Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vanishQ", "=", 
             RowBox[{
              RowBox[{"!", "curvQ"}], "||", 
              RowBox[{"If", "[", 
               RowBox[{"integerdimQ", ",", 
                RowBox[{"dim", "<", "3"}], ",", "False"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"EinsteinName", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}]}], "]"}], ",", 
              RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"torQ", ",", 
                RowBox[{"StrongGenSet", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"GenSet", "[", "]"}]}], "]"}], ",", 
                RowBox[{"Symmetric", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PrintAs", "\[RuleDelayed]", 
               RowBox[{"GiveOutputString", "[", 
                RowBox[{"Einstein", ",", "covd"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Master", "\[Rule]", "covd"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"orthogonalQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vector", "[", "i1", "]"}], ",", 
                   RowBox[{"vector", "[", "i2", "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ProjectedWith", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"projectedQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"projector", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"-", "i1d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{"i2", ",", 
                    RowBox[{"-", "i2d"}]}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"vanishQ", ",", "\"\<\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    "torQ", ",", "\"\<non-symmetric \>\"", ",", 
                    "\"\<symmetric \>\""}], "]"}]}], "]"}], "<>", 
                    "\"\<Einstein tensor\>\""}], ",", "\"\<\>\""}], "}"}], 
                 ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"TensorID", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Einstein", ",", "covd"}], "}"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", "vanishQ"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"prot", "=", 
                RowBox[{"Unprotect", "[", "invmetric", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AutomaticRules", "[", 
                RowBox[{"invmetric", ",", 
                 RowBox[{"MakeRule", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"invmetric", "[", 
                    RowBox[{"i2", ",", "i3"}], "]"}], 
                    RowBox[{
                    RowBox[{"covd", "[", 
                    RowBox[{"-", "i3"}], "]"}], "[", 
                    RowBox[{"EinsteinName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"$TorsionSign", " ", 
                    RowBox[{"invmetric", "[", 
                    RowBox[{"i2", ",", "i3"}], "]"}], 
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i4"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], 
                    RowBox[{"TorsionName", "[", 
                    RowBox[{"i4", ",", 
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}]}], "-", 
                    RowBox[{"$TorsionSign", " ", 
                    RowBox[{"$RicciSign", "/", "2"}], " ", 
                    RowBox[{"invmetric", "[", 
                    RowBox[{"i2", ",", "i3"}], "]"}], 
                    RowBox[{"RiemannName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i4"}], ",", 
                    RowBox[{"-", "i2"}], ",", "i5"}], "]"}], 
                    RowBox[{"TorsionName", "[", 
                    RowBox[{"i4", ",", 
                    RowBox[{"-", "i3"}], ",", 
                    RowBox[{"-", "i5"}]}], "]"}]}]}]}], "}"}], "]"}], ",", 
                 RowBox[{"Verbose", "\[Rule]", "False"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Protect", "[", 
                RowBox[{"Evaluate", "[", "prot", "]"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "9.", " ", "We", " ", "define", " ", "the", " ", "Weyl", " ", 
           RowBox[{"tensor", " ", ":", " ", 
            RowBox[{
            "here", " ", "the", " ", "Weyl", " ", "tensor", " ", "is", " ", 
             "defined", " ", "with", " ", "the", " ", "last", " ", "index", 
             " ", "up"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Weyl", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vanishQ", "=", 
             RowBox[{
              RowBox[{"!", "curvQ"}], "||", 
              RowBox[{"If", "[", 
               RowBox[{"integerdimQ", ",", 
                RowBox[{"dim", "<", "4"}], ",", "False"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"WeylName", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}], ",", 
                RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", 
              RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"torQ", ",", 
                RowBox[{"JoinSGS", "[", 
                 RowBox[{
                  RowBox[{"Antisymmetric", "[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
                  RowBox[{"Antisymmetric", "[", 
                   RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}], "]"}]}], "]"}], ",", 
                RowBox[{"RiemannSymmetric", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}],
                "]"}], ",", 
              RowBox[{"ForceSymmetries", "\[Rule]", "True"}], ",", 
              RowBox[{"TraceFree", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "i1"}], ",", 
                 RowBox[{"-", "i2"}], ",", 
                 RowBox[{"-", "i3"}], ",", "i4"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PrintAs", "\[RuleDelayed]", 
               RowBox[{"GiveOutputString", "[", 
                RowBox[{"Weyl", ",", "covd"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Master", "\[Rule]", "covd"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"orthogonalQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vector", "[", "i1", "]"}], ",", 
                   RowBox[{"vector", "[", "i2", "]"}], ",", 
                   RowBox[{"vector", "[", "i3", "]"}], ",", 
                   RowBox[{"vector", "[", 
                    RowBox[{"-", "i4"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ProjectedWith", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"projectedQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"projector", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"-", "i1d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{"i2", ",", 
                    RowBox[{"-", "i2d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{"i3", ",", 
                    RowBox[{"-", "i3d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{
                    RowBox[{"-", "i4"}], ",", "i4d"}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Weyl tensor\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    "torQ", ",", 
                    "\"\<Antisymmetric pairs cannot be exchanged.\>\"", ",", 
                    "\"\<\>\""}], "]"}]}], "}"}], ",", "False"}], "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"TensorID", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Weyl", ",", "covd"}], "}"}]}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "10.", " ", "TFRicci", " ", "for", " ", "metric", " ", 
            "connections"}], ",", " ", 
           RowBox[{"even", " ", "with", " ", "torsion"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vanishQ", "=", 
             RowBox[{
              RowBox[{"!", "curvQ"}], "||", 
              RowBox[{"If", "[", 
               RowBox[{"integerdimQ", ",", 
                RowBox[{"dim", "<", "3"}], ",", "False"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"TFRicciName", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}]}], "]"}], ",", 
              RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{"torQ", ",", 
                RowBox[{"StrongGenSet", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"GenSet", "[", "]"}]}], "]"}], ",", 
                RowBox[{"Symmetric", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}], ",", 
              RowBox[{"TraceFree", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "i1"}], ",", 
                 RowBox[{"-", "i2"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PrintAs", "\[RuleDelayed]", 
               RowBox[{"GiveOutputString", "[", 
                RowBox[{"TFRicci", ",", "covd"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Master", "\[Rule]", "covd"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"OrthogonalTo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"orthogonalQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vector", "[", "i1", "]"}], ",", 
                   RowBox[{"vector", "[", "i2", "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ProjectedWith", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"projectedQ", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"projector", "[", 
                    RowBox[{"i1", ",", 
                    RowBox[{"-", "i1d"}]}], "]"}], ",", 
                   RowBox[{"projector", "[", 
                    RowBox[{"i2", ",", 
                    RowBox[{"-", "i2d"}]}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{"vanishQ", ",", "\"\<\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    "torQ", ",", "\"\<non-symmetric \>\"", ",", 
                    "\"\<symmetric \>\""}], "]"}]}], "]"}], "<>", 
                    "\"\<TFRicci tensor\>\""}], ",", "\"\<\>\""}], "}"}], ",",
                  "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"TensorID", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"TFRicci", ",", "covd"}], "}"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"10", 
            RowBox[{"b", ".", " ", "Kretschmann"}], " ", "for", " ", "metric",
             " ", "connections"}], ",", " ", 
           RowBox[{"even", " ", "with", " ", "torsion"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"metricQ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vanishQ", "=", 
             RowBox[{"!", "curvQ"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"DefTensor", "[", 
             RowBox[{
              RowBox[{"KretschmannName", "[", "]"}], ",", 
              RowBox[{"DependenciesOfCovD", "[", "covd", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PrintAs", "\[RuleDelayed]", 
               RowBox[{"GiveOutputString", "[", 
                RowBox[{"Kretschmann", ",", "covd"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"VanishingQ", "\[Rule]", "vanishQ"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Master", "\[Rule]", "covd"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"DefInfo", "\[RuleDelayed]", 
               RowBox[{"If", "[", 
                RowBox[{"info", ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<Kretschmann scalar\>\"", ",", "\"\<\>\""}], 
                  "}"}], ",", "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"TensorID", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Kretschmann", ",", "covd"}], "}"}]}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{"11.", " ", "Riemann", " ", "versus", " ", "Weyl", " ", 
            RowBox[{"(", " ", 
             RowBox[{
             "we", " ", "use", " ", "xBrauer", " ", "functions", " ", 
              "TracelessProject", " ", "and", " ", 
              RowBox[{"TraceProject", " ", ":", " ", 
               RowBox[{"problem", " ", "with", " ", 
                RowBox[{"$RicciSign", " ", "?"}]}]}]}], " ", ")"}]}], " ", 
           "*)"}],
          Background->RGBColor[1, 0.85, 0.85]], "\[IndentingNewLine]", 
         "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`RiemannToWeylRules", "[", "covd", "]"}], "=", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"curvQ", "&&", "metricQ", "&&", 
             RowBox[{"If", "[", 
              RowBox[{"integerdimQ", ",", 
               RowBox[{"dim", ">", "1"}], ",", "True"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"info", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<** DefCovD:  Computing RiemannToWeylRules for dim \>\"", 
                 ",", "dim"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dim", "===", "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"SafeMakeRule", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RiemannName", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", 
                  RowBox[{"$RicciSign", " ", 
                   RowBox[{"RicciScalarName", "[", "]"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}], 
                    RowBox[{"delta", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", "i4"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"delta", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", "i4"}], "]"}], 
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}]}]}], ")"}], "/", "2"}]}]}], 
                 "}"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"dim", "===", "3"}], ",", 
               RowBox[{"SafeMakeRule", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RiemannName", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"$RicciSign", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}], 
                    RowBox[{"invmetric", "[", 
                    RowBox[{"i4", ",", "i5"}], "]"}], 
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i5"}]}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"delta", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", "i4"}], "]"}], 
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"delta", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", "i4"}], "]"}], 
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}], 
                    RowBox[{"invmetric", "[", 
                    RowBox[{"i4", ",", "i5"}], "]"}], 
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i5"}]}], "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"dim", "-", "2"}], ")"}]}]}], "-", 
                   RowBox[{"$RicciSign", " ", 
                    RowBox[{"RicciScalarName", "[", "]"}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}], 
                    RowBox[{"delta", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", "i4"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"delta", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", "i4"}], "]"}], 
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}]}], "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"dim", "-", "1"}], ")"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"dim", "-", "2"}], ")"}]}]}]}]}], "}"}], "]"}], 
               ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
               RowBox[{"SafeToRule", "[", 
                RowBox[{
                 RowBox[{"RiemannName", "[", 
                  RowBox[{
                   RowBox[{"-", "i1"}], ",", 
                   RowBox[{"-", "i2"}], ",", 
                   RowBox[{"-", "i3"}], ",", "i4"}], "]"}], "\[Equal]", 
                 RowBox[{"Collect", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"WeylName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], "+", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"TracelessProject", "[", 
                    RowBox[{
                    RowBox[{"RiemannName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", "2", ",", 
                    "metric"}], "]"}], "+", 
                    RowBox[{"TraceProject", "[", 
                    RowBox[{
                    RowBox[{"RiemannName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", "metric"}], 
                    "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    "_metric", ",", "_invmetric", ",", "_delta", ",", 
                    "_WeylName", ",", "_RicciName", ",", 
                    RowBox[{"_", " ", "RicciScalarName"}]}], "}"}], ",", 
                   "Factor"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`WeylToRiemannRules", "[", "covd", "]"}], "=", 
          
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"integerdimQ", ",", 
               RowBox[{"dim", "\[GreaterEqual]", "4"}], ",", "True"}], "]"}], 
             "&&", "metricQ", "&&", "curvQ"}], ",", 
            RowBox[{"SafeToRule", "[", 
             RowBox[{
              RowBox[{"WeylName", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}], ",", 
                RowBox[{"-", "i3"}], ",", "i4"}], "]"}], "\[Equal]", 
              RowBox[{"Collect", "[", 
               RowBox[{
                RowBox[{"TracelessProject", "[", 
                 RowBox[{
                  RowBox[{"RiemannName", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}], ",", 
                    RowBox[{"-", "i3"}], ",", "i4"}], "]"}], ",", "1", ",", 
                  "metric"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "_metric", ",", "_invmetric", ",", "_delta", ",", 
                  "_RiemannName", ",", "_RicciName", ",", 
                  "_RicciScalarName"}], "}"}], ",", "Factor"}], "]"}]}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "We", " ", "leave", " ", "these", " ", "Rules", " ", 
           "but", " ", "i", " ", 
           RowBox[{"don", "'"}], "t", " ", "know", " ", "what", " ", "are", 
           " ", "there", " ", "purposes"}], " ", "**)"}], 
         "\[IndentingNewLine]", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`RiemannToRiemannDownRules", "[", "covd", 
           "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"metricQ", "&&", "frozenQ", "&&", "curvQ"}], ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RiemannName", "[", 
                 RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}], ",", 
                
                RowBox[{
                 RowBox[{"RiemannDownName", "[", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", 
                   RowBox[{"-", "i1d"}]}], "]"}], 
                 RowBox[{"invmetric", "[", 
                  RowBox[{"i1d", ",", "i4"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
              RowBox[{"TestIndices", "\[Rule]", "False"}], ",", 
              RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`RiemannDownToRiemannRules", "[", "covd", 
           "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"metricQ", "&&", "curvQ"}], ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RiemannDownName", "[", 
                 RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "]"}], ",", 
                
                RowBox[{
                 RowBox[{"RiemannName", "[", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "i1d"}], "]"}], 
                 RowBox[{"metric", "[", 
                  RowBox[{
                   RowBox[{"-", "i1d"}], ",", "i4"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
              RowBox[{"TestIndices", "\[Rule]", "False"}], ",", 
              RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"12.", " ", "Ricci", " ", "versus", " ", 
           RowBox[{"TFRicci", ".", " ", 
            RowBox[{"QUESTION", ":", " ", 
             RowBox[{
             "Are", " ", "dimensions", " ", "right", " ", "when", " ", 
              "orthogonalQ", " ", "or", " ", 
              RowBox[{"projectedQ", "?"}]}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`RicciToTFRicciRules", "[", "covd", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"curvQ", "&&", "metricQ", "&&", 
             RowBox[{"If", "[", 
              RowBox[{"integerdimQ", ",", 
               RowBox[{"dim", ">", "1"}], ",", "True"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"info", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<** DefCovD:  Computing RicciToTFRicci for dim \>\"", ",",
                  "dim"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dim", "===", "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"SafeMakeRule", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"RicciName", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"RicciScalarName", "[", "]"}], 
                   RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "/", "2"}]}]}], "}"}], 
                "]"}], ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{"SafeToRule", "[", 
                RowBox[{
                 RowBox[{"RicciName", "[", 
                  RowBox[{
                   RowBox[{"-", "i1"}], ",", 
                   RowBox[{"-", "i2"}]}], "]"}], "\[Equal]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"TFRicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "+", 
                   RowBox[{"TraceProject", "[", 
                    RowBox[{
                    RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], ",", "metric"}], "]"}]}], 
                  ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`TFRicciToRicciRules", "[", "covd", "]"}], "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"integerdimQ", ",", 
               RowBox[{"dim", "\[GreaterEqual]", "3"}], ",", "True"}], "]"}], 
             "&&", "metricQ", "&&", "curvQ"}], ",", "\[IndentingNewLine]", 
            RowBox[{"SafeToRule", "[", 
             RowBox[{
              RowBox[{"TFRicciName", "[", 
               RowBox[{
                RowBox[{"-", "i1"}], ",", 
                RowBox[{"-", "i2"}]}], "]"}], "\[Equal]", 
              RowBox[{"(", 
               RowBox[{"TracelessProject", "[", 
                RowBox[{
                 RowBox[{"TFRicciName", "[", 
                  RowBox[{
                   RowBox[{"-", "i1"}], ",", 
                   RowBox[{"-", "i2"}]}], "]"}], ",", "1", ",", "metric"}], 
                "]"}], ")"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"13.", " ", "Ricci", " ", "versus", " ", "Einstein"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`RicciToEinsteinRules", "[", "covd", "]"}], 
          "=", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"curvQ", "&&", "metricQ", "&&", 
             RowBox[{"If", "[", 
              RowBox[{"integerdimQ", ",", 
               RowBox[{"dim", ">", "1"}], ",", "True"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"info", ",", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<** DefCovD:  Computing RicciToEinsteinRules for dim \
\>\"", ",", "dim"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dim", "===", "2"}], ",", "\[IndentingNewLine]", 
               RowBox[{"SafeMakeRule", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "/", "2"}], 
                    RowBox[{"RicciScalarName", "[", "]"}]}]}], "}"}], ",", 
                 RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
                 RowBox[{"TestIndices", "\[Rule]", "False"}], ",", 
                 RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}], ",",
                "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
               RowBox[{"SafeMakeRule", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"RicciName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"EinsteinName", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"metric", "[", 
                    RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "/", "2"}], 
                    RowBox[{"RicciScalarName", "[", "]"}]}]}]}], "}"}], ",", 
                 RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
                 RowBox[{"TestIndices", "\[Rule]", "False"}], ",", 
                 RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "xAct`xTensor`Private`EinsteinToRicciRules", "[", "covd", "]"}], 
          "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{"integerdimQ", ",", 
               RowBox[{"dim", "\[GreaterEqual]", "3"}], ",", "True"}], "]"}], 
             "&&", "metricQ", "&&", "curvQ"}], ",", 
            RowBox[{"SafeMakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"EinsteinName", "[", 
                RowBox[{
                 RowBox[{"-", "i1"}], ",", 
                 RowBox[{"-", "i2"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"RicciName", "[", 
                 RowBox[{
                  RowBox[{"-", "i1"}], ",", 
                  RowBox[{"-", "i2"}]}], "]"}], "-", 
                RowBox[{
                 RowBox[{
                  RowBox[{"metric", "[", 
                   RowBox[{
                    RowBox[{"-", "i1"}], ",", 
                    RowBox[{"-", "i2"}]}], "]"}], "/", "2"}], "*", 
                 RowBox[{"RicciScalarName", "[", "]"}]}]}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8411183944529667`*^9, 3.8411183972483463`*^9}, {
   3.8411184830158587`*^9, 3.8411184883672256`*^9}, {3.8411185239231577`*^9, 
   3.841118532863762*^9}, {3.841118580315226*^9, 3.8411186502634983`*^9}, {
   3.841118693470889*^9, 3.8411187306209803`*^9}, {3.841118780199511*^9, 
   3.841118824955381*^9}, {3.841118875748763*^9, 3.841118939649432*^9}, {
   3.841119002179062*^9, 3.841119143852462*^9}, {3.8411191796867*^9, 
   3.841119190459902*^9}, {3.8411192500231447`*^9, 3.841119250190428*^9}, {
   3.8411192912882566`*^9, 3.841119360152994*^9}, {3.8411194456804323`*^9, 
   3.841119480585032*^9}, {3.841119600784155*^9, 3.841119710396133*^9}, {
   3.8411197424008102`*^9, 3.841119746089656*^9}, {3.8411197863403*^9, 
   3.841119846655051*^9}, {3.841119959789253*^9, 3.841120068361775*^9}, {
   3.8411201046270103`*^9, 3.841120234708179*^9}, {3.84112028594573*^9, 
   3.841120374178545*^9}, {3.8411204455689297`*^9, 3.841120513337818*^9}, {
   3.8411205447186527`*^9, 3.841120565402186*^9}, {3.8411206167434273`*^9, 
   3.841120647057068*^9}, {3.841121356896957*^9, 3.8411213622506*^9}, {
   3.8411214383862333`*^9, 3.8411214390434237`*^9}, {3.8411214803893833`*^9, 
   3.841121561987493*^9}, {3.8411281584969482`*^9, 3.8411281630993023`*^9}, 
   3.841128446658744*^9, {3.84112870670338*^9, 3.8411287070277576`*^9}, 
   3.841128821333128*^9, {3.841131643775532*^9, 3.841131741856675*^9}, {
   3.84113178673085*^9, 3.841131802109992*^9}, {3.841132200297627*^9, 
   3.841132261930291*^9}, {3.8411323514342117`*^9, 3.841132360859941*^9}, {
   3.841136265792019*^9, 3.841136295066712*^9}, {3.841201730398699*^9, 
   3.841201731482502*^9}, {3.841201900570281*^9, 3.841201954386791*^9}, 
   3.841206735688999*^9, 3.841214057475728*^9, 3.841214231780871*^9, 
   3.841214361219461*^9, {3.841214612614059*^9, 3.841214633081407*^9}, {
   3.841214893089591*^9, 3.841214908415351*^9}, 3.8412153946924047`*^9, 
   3.841483966675207*^9, {3.844692762662416*^9, 3.844692766257498*^9}, {
   3.844692950005865*^9, 3.844692952843734*^9}, {3.8934911516519327`*^9, 
   3.893491161189884*^9}, {3.893491227263977*^9, 3.893491227983961*^9}, {
   3.893497963806241*^9, 3.893497998216028*^9}, {3.893513391243997*^9, 
   3.893513396957219*^9}, 3.8935140106651382`*^9, {3.893514261726169*^9, 
   3.893514264915677*^9}, {3.8935149933235903`*^9, 3.893515007766488*^9}, {
   3.908886560178665*^9, 3.908886569383007*^9}, {3.908886831666223*^9, 
   3.908886840407282*^9}, {3.9088869310736437`*^9, 3.908886959411852*^9}, {
   3.9088870094301567`*^9, 3.9088870594722023`*^9}, {3.9088875481465807`*^9, 
   3.9088875773355083`*^9}},ExpressionUUID->"d7361d27-389f-4c5d-831b-\
c4fb3485b31d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
6.2. Modification of SeparateMetric and ContractMetric for better use of \
multiple metrics\
\>", "Subsection",
 CellChangeTimes->{{3.8412166858788843`*^9, 3.8412166963959627`*^9}, 
   3.841724645412078*^9, {3.8421865949060287`*^9, 3.842186605733068*^9}, {
   3.8433079042312107`*^9, 3.843307916495667*^9}, {3.844140152601377*^9, 
   3.8441401769809113`*^9}, {3.8441415567723103`*^9, 3.844141607915388*^9}, {
   3.863770512249815*^9, 3.863770512407074*^9}, {3.863770857224728*^9, 
   3.863770873177236*^9}, 3.875173104631501*^9, 3.882438122165433*^9, 
   3.891510851280891*^9},ExpressionUUID->"d8327917-99a6-4ae4-9733-\
225208f20e53"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"*", " ", "Error", " ", "messages"}], " ", "**)"}]], "Input",
 CellChangeTimes->{{3.8400796644010553`*^9, 3.8400796672585583`*^9}, {
   3.841219495797056*^9, 3.841219496086296*^9}, 3.847361303973351*^9, 
   3.847361344230899*^9, 3.847439833694948*^9, {3.893496085883575*^9, 
   3.893496088746203*^9}},ExpressionUUID->"90abaf5b-ff4e-4e0f-bea4-\
70faa61f04e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bimetric", "::", "nomet"}], "=", 
   "\"\<There is no metric associated to `1`.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8400798210997887`*^9, 3.840079823857358*^9}, {
  3.840080436880395*^9, 3.840080474218355*^9}, {3.8400805209094152`*^9, 
  3.8400805216145687`*^9}, {3.8412194394830112`*^9, 
  3.841219480548476*^9}},ExpressionUUID->"7b800d19-0d6b-4fdc-89c2-\
72f86638b58d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"InducedMetricQ", "[", 
    RowBox[{"metric_", "?", "MetricQ"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"InducedFrom", "[", "metric", "]"}], "===", "Null"}], ",", 
     "False", ",", "True"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.814276378712103*^9, 3.814276521194351*^9}, {
  3.814276593265671*^9, 3.81427662888004*^9}, {3.8418192386819773`*^9, 
  3.8418192427595177`*^9}, {3.84181954868016*^9, 
  3.841819575220138*^9}},ExpressionUUID->"4605514b-9245-499a-baf9-\
ab622ae8cc34"],

Cell["\<\
At definition time of a tensor one would have to specify to which metric it \
is associated to. \
\>", "Text",
 CellChangeTimes->{{3.841216703928317*^9, 3.84121678526556*^9}, 
   3.841219003569228*^9, {3.843287931312896*^9, 
   3.8432879393807573`*^9}},ExpressionUUID->"9d2a8008-9b56-45ff-8da0-\
0ff4515ee286"],

Cell[CellGroupData[{

Cell["1. Modification of SeparateMetric", "Subsubsection",
 CellChangeTimes->{{3.843298947098723*^9, 
  3.8432989564334373`*^9}},ExpressionUUID->"f5cafb96-a93f-4078-bed1-\
53264258d563"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "Correction"}], " ", "of", " ", "a", " ", "small", " ",
     "bug", " ", "when", " ", "we", " ", "separate", " ", "metric", " ", "of",
     " ", "an", " ", "expression", " ", "with", " ", "covariant", " ", 
    "derivative", " ", "and", " ", "frozen", " ", 
    RowBox[{"metric", " ", ":", " ", 
     RowBox[{
     "need", " ", "to", " ", "delete", " ", "duplicate", " ", "indices"}]}]}],
    " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateMetric", "[", 
       RowBox[{"metric_", ",", "basis_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "list_IndexList"}], "]"}], ":=", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{"SeparateMetric", "[", 
        RowBox[{"metric", ",", "basis"}], "]"}], ",", "expr", ",", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"list", ",", 
          RowBox[{"_LI", "|", 
           RowBox[{"-", "_LI"}]}]}], "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "********)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "Modification"}], " ", "of", " ", "SeparateMetric1"}],
     " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "********)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "For"}], " ", "induced", " ", "metric"}], " ", 
    "****)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric1", "[", 
       RowBox[{"basis_", ",", "metric_", ",", "metric1_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "index_"}], "]"}], "=."}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric1", "[", 
       RowBox[{"basis_", ",", 
        RowBox[{"metric_", "?", "InducedMetricQ"}], ",", "metric1_"}], "]"}], 
      "[", 
      RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
        RowBox[{"basis", ",", "metric"}], "]"}], "[", 
       RowBox[{"expr", ",", "index"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"VBundleOfMetric", "[", "metric", "]"}], "===", 
       RowBox[{"VBundleOfIndex", "[", "index", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "We"}], " ", "add", " ", "the", " ", "definition", 
     " ", "for", " ", "frozen", " ", "metric", " ", "which", " ", "has", " ", 
     "recently", " ", "been", " ", "removed", " ", "from", " ", "xTensor"}], 
    " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric1", "[", 
       RowBox[{"basis_", ",", 
        RowBox[{"frozen_", "?", "FrozenMetricQ"}], ",", "metric1_"}], "]"}], 
      "[", 
      RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
        RowBox[{"basis", ",", "frozen"}], "]"}], "[", 
       RowBox[{"expr", ",", "index"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"VBundleOfMetric", "[", "frozen", "]"}], "===", 
       RowBox[{"VBundleOfMetric", "[", "metric1", "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "********)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "Modification"}], " ", "of", " ", "SeparateMetric2"}],
     " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**"}], "********)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
       RowBox[{"basis_", ",", "metric_"}], "]"}], "[", 
      RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"expr", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
          RowBox[{"i1___", ",", "index", ",", "i2___"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dummy", "=", 
             RowBox[{"DummyAs", "[", 
              RowBox[{"index", ",", "basis"}], "]"}]}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", 
                "metric"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", 
                  "Null"}], "&&", 
                 RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
              ")"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"UpIndexQ", "[", "index", "]"}], ",", 
                RowBox[{"metric", "[", 
                 RowBox[{"index", ",", "dummy"}], "]"}], ",", 
                RowBox[{"metric", "[", 
                 RowBox[{"dummy", ",", "index"}], "]"}]}], "]"}], 
              RowBox[{"tensor", "[", 
               RowBox[{"i1", ",", 
                RowBox[{"ChangeIndex", "[", "dummy", "]"}], ",", "i2"}], 
               "]"}]}], ",", 
             RowBox[{"tensor", "[", 
              RowBox[{"i1", ",", "index", ",", "i2"}], "]"}]}], "]"}]}], 
          "]"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"covd_", "?", "CovDQ"}], "[", 
           RowBox[{"i1___", ",", "index", ",", "i2___"}], "]"}], "[", 
          "expr1_", "]"}], "\[RuleDelayed]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dummy", "=", 
             RowBox[{"DummyAs", "[", 
              RowBox[{"index", ",", "basis"}], "]"}]}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MasterOf", "[", "covd", "]"}], "===", "metric"}], ",", 
             
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"UpIndexQ", "[", "index", "]"}], ",", 
                RowBox[{"metric", "[", 
                 RowBox[{"index", ",", "dummy"}], "]"}], ",", 
                RowBox[{"metric", "[", 
                 RowBox[{"dummy", ",", "index"}], "]"}]}], "]"}], 
              RowBox[{
               RowBox[{"covd", "[", 
                RowBox[{"i1", ",", 
                 RowBox[{"ChangeIndex", "[", "dummy", "]"}], ",", "i2"}], 
                "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"covd", "[", 
               RowBox[{"i1", ",", "index", ",", "i2"}], "]"}], "[", "expr1", 
              "]"}]}], "]"}]}], "]"}]}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "New"}], " ", "definition", " ", "for", " ", "frozen",
      " ", "metric"}], " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
       RowBox[{"AIndex", ",", 
        RowBox[{"metric_", "?", "FrozenMetricQ"}]}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"metric_", "?", "FrozenMetricQ"}], "[", 
        RowBox[{
         RowBox[{"-", "i1_Symbol"}], ",", 
         RowBox[{"-", "i2_Symbol"}]}], "]"}], ",", "index_"}], "]"}], ":=", 
     RowBox[{"metric", "[", 
      RowBox[{
       RowBox[{"-", "i1"}], ",", 
       RowBox[{"-", "i2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
       RowBox[{"AIndex", ",", 
        RowBox[{"metric_", "?", "FrozenMetricQ"}]}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"metric_", "?", "FrozenMetricQ"}], "[", 
        RowBox[{"i1_Symbol", ",", "i2_Symbol"}], "]"}], ",", "index_"}], 
      "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"DummyAs", "[", "i1", "]"}]}], ",", 
         RowBox[{"b", "=", 
          RowBox[{"DummyAs", "[", "i2", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Inv", "[", "metric", "]"}], "[", 
         RowBox[{"a", ",", "i1"}], "]"}], 
        RowBox[{
         RowBox[{"Inv", "[", "metric", "]"}], "[", 
         RowBox[{"b", ",", "i2"}], "]"}], 
        RowBox[{"metric", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
       RowBox[{"AIndex", ",", 
        RowBox[{"metric_", "?", "FrozenMetricQ"}]}], "]"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"metric_", "?", "FrozenMetricQ"}], "[", 
        RowBox[{
         RowBox[{"-", "i1_Symbol"}], ",", 
         RowBox[{"-", "i2_Symbol"}]}], "]"}], ",", "index_"}], "]"}], ":=", 
     RowBox[{"metric", "[", 
      RowBox[{
       RowBox[{"-", "i1"}], ",", 
       RowBox[{"-", "i2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xAct`xTensor`Private`SeparateMetric2", "[", 
      RowBox[{"basis_", ",", 
       RowBox[{"metric_", "?", "xAct`xTensor`Private`FrozenMetricQ"}]}], 
      "]"}], "[", 
     RowBox[{"expr_", ",", "index_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"imetric", "=", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "}"}], ",", 
      RowBox[{"expr", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
           RowBox[{"i1___", ",", "index", ",", "i2___"}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dummy", "=", 
              RowBox[{"DummyAs", "[", 
               RowBox[{"index", ",", "basis"}], "]"}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", 
               "metric"}], ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"UpIndexQ", "[", "index", "]"}], ",", 
                 RowBox[{"imetric", "[", 
                  RowBox[{"index", ",", "dummy"}], "]"}], ",", 
                 RowBox[{"metric", "[", 
                  RowBox[{"dummy", ",", "index"}], "]"}]}], "]"}], 
               RowBox[{"tensor", "[", 
                RowBox[{"i1", ",", 
                 RowBox[{"ChangeIndex", "[", "dummy", "]"}], ",", "i2"}], 
                "]"}]}], ",", 
              RowBox[{"tensor", "[", 
               RowBox[{"i1", ",", "index", ",", "i2"}], "]"}]}], "]"}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"covd_", "?", "CovDQ"}], "[", 
            RowBox[{"i1___", ",", "index", ",", "i2___"}], "]"}], "[", 
           "expr1_", "]"}], "\[RuleDelayed]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dummy", "=", 
              RowBox[{"DummyAs", "[", 
               RowBox[{"index", ",", "basis"}], "]"}]}], "}"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MasterOf", "[", "covd", "]"}], "===", "metric"}], ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"UpIndexQ", "[", "index", "]"}], ",", 
                 RowBox[{"imetric", "[", 
                  RowBox[{"index", ",", "dummy"}], "]"}], ",", 
                 RowBox[{"metric", "[", 
                  RowBox[{"dummy", ",", "index"}], "]"}]}], "]"}], 
               RowBox[{
                RowBox[{"covd", "[", 
                 RowBox[{"i1", ",", 
                  RowBox[{"ChangeIndex", "[", "dummy", "]"}], ",", "i2"}], 
                 "]"}], "[", "expr1", "]"}]}], ",", 
              RowBox[{
               RowBox[{"covd", "[", 
                RowBox[{"i1", ",", "index", ",", "i2"}], "]"}], "[", "expr1", 
               "]"}]}], "]"}]}], "]"}]}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "Separate"}], " ", "Metric", " ", "with", " ", "Lie", 
     " ", "Derivative"}], " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateMetric", "[", 
       RowBox[{"metric_", "?", "MetricQ"}], "]"}], "[", 
      RowBox[{
       RowBox[{"LieD", "[", 
        RowBox[{
         RowBox[{"nvec_", "?", "xTensorQ"}], "[", "ind_", "]"}], "]"}], "[", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds___", "]"}], "]"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"septens", ",", "tensor1", ",", "metriclist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"septens", "=", 
         RowBox[{
          RowBox[{"SeparateMetric", "[", "metric", "]"}], "[", 
          RowBox[{"tensor", "[", "inds", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"septens", "===", 
           RowBox[{"tensor", "[", "inds", "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LieD", "[", 
              RowBox[{"nvec", "[", "ind", "]"}], "]"}], "[", 
             RowBox[{"tensor", "[", "inds", "]"}], "]"}], ",", "Module"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"metriclist", "=", 
         RowBox[{"FindAllOfType", "[", 
          RowBox[{"septens", ",", "Metric"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tensor1", "=", 
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"FindAllOfType", "[", 
             RowBox[{"septens", ",", "Tensor"}], "]"}], ",", "metriclist"}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Times", "@@", "metriclist"}], "*", 
          RowBox[{
           RowBox[{"LieD", "[", 
            RowBox[{"nvec", "[", "ind", "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"SeparateMetric", "[", "metric", "]"}], "[", "tensor1", 
            "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"LieD", "[", 
            RowBox[{"nvec", "[", "ind", "]"}], "]"}], "[", 
           RowBox[{"Times", "@@", "metriclist"}], "]"}], "*", 
          "tensor1"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "SeparateMetric"}], " ", "driver", " ", "with", " ", 
     "option"}], " ", "***)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SeparateMetric", "[", "]"}], "[", "exp_", "]"}], ":=", 
     RowBox[{"Fold", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"SeparateMetric", "[", "#2", "]"}], "[", "#1", "]"}], "&"}], 
       ",", "exp", ",", "$Metrics"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SeparateMetric", "[", 
      RowBox[{"exp_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MetricQ", "[", "#", "]"}]}], "&"}], ")"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SeparateMetric", "[", "]"}], "[", "exp", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811525443457665*^9, 3.811525536564933*^9}, {
   3.8115255883321342`*^9, 3.811525596284936*^9}, 3.815669056306604*^9, 
   3.8297443400542383`*^9, {3.840869800689934*^9, 3.840869800947257*^9}, {
   3.840870235661085*^9, 3.840870262095048*^9}, {3.840870305585228*^9, 
   3.8408703152793217`*^9}, {3.840870350985859*^9, 3.840870511812584*^9}, 
   3.840870551039014*^9, {3.841129826228821*^9, 3.8411298301417007`*^9}, {
   3.841130616342188*^9, 3.84113063721427*^9}, {3.841131177693733*^9, 
   3.841131195460924*^9}, 3.841394458035368*^9, 3.8432991508558607`*^9, {
   3.843299187318288*^9, 3.843299203344623*^9}, {3.843299236052101*^9, 
   3.8432994022980423`*^9}, 3.843299457538929*^9, {3.843299857361822*^9, 
   3.8432999081165533`*^9}, {3.8432999796625547`*^9, 3.843300101310358*^9}, {
   3.843300140469021*^9, 3.8433001749121523`*^9}, {3.843300606100931*^9, 
   3.843300615719556*^9}, {3.843300651324679*^9, 3.8433006517042522`*^9}, {
   3.843300709296587*^9, 3.843300736921216*^9}, {3.843300955580389*^9, 
   3.8433009712328777`*^9}, {3.843304812860795*^9, 3.84330484041343*^9}, {
   3.843304989687134*^9, 3.8433049935083847`*^9}, {3.843305113430491*^9, 
   3.843305153879045*^9}, 3.843305390608488*^9, 3.8433058531546392`*^9, 
   3.843305943382091*^9, 3.843306065467163*^9, 3.843306981324407*^9, 
   3.843307014766234*^9, {3.8433079307041807`*^9, 3.843307946246895*^9}, {
   3.843308080175786*^9, 3.8433080968129787`*^9}, 3.843449448183724*^9, 
   3.8435379022664824`*^9, 3.843537947268104*^9, 3.843538081949296*^9, {
   3.843539901837495*^9, 3.843539956654188*^9}, {3.843539988738298*^9, 
   3.843540028514181*^9}, {3.843553721864479*^9, 3.843553737147277*^9}, {
   3.843553773062006*^9, 3.843553796973205*^9}, {3.8435538943680696`*^9, 
   3.843553896263056*^9}, {3.843553952621917*^9, 3.843554073652995*^9}, {
   3.843554214898525*^9, 3.8435542169859543`*^9}, {3.843726836582406*^9, 
   3.84372683817723*^9}, {3.843729236777322*^9, 3.843729273069202*^9}, {
   3.843729409359561*^9, 3.843729412204589*^9}, {3.8438137268600063`*^9, 
   3.8438137839359694`*^9}, {3.8438138974331713`*^9, 3.843813931475852*^9}, {
   3.843814000423957*^9, 3.843814003572975*^9}, {3.843814239085788*^9, 
   3.8438143025700827`*^9}, {3.84381435051087*^9, 3.843814353529839*^9}, {
   3.843814389347199*^9, 3.843814395358487*^9}, {3.8438145154491777`*^9, 
   3.843814515980691*^9}, {3.843814633309537*^9, 3.843814649020487*^9}, {
   3.843815534936801*^9, 3.843815566971183*^9}, {3.843815634069158*^9, 
   3.843815636910927*^9}, {3.843816036849983*^9, 3.843816037225112*^9}, {
   3.844690773715448*^9, 3.844690819488307*^9}, {3.8446908879709177`*^9, 
   3.844690982700465*^9}, {3.84513272769086*^9, 3.845132728487515*^9}, {
   3.845365534596239*^9, 3.845365564217587*^9}, {3.845365608781396*^9, 
   3.845365608990527*^9}, {3.845366912762171*^9, 3.845366990989544*^9}, {
   3.845369214144514*^9, 3.845369269017358*^9}, 3.845369324878976*^9, {
   3.845369491696594*^9, 3.8453694999163713`*^9}, {3.845369570048479*^9, 
   3.8453695775422297`*^9}, {3.8453697479089127`*^9, 3.845369758595512*^9}, {
   3.8453715990392323`*^9, 3.845371611237196*^9}, {3.84537189131544*^9, 
   3.8453719247367783`*^9}, {3.8453720214979877`*^9, 3.845372023158698*^9}, {
   3.845372060158134*^9, 3.845372183191317*^9}, {3.84537230082891*^9, 
   3.8453723306840887`*^9}, {3.8453724895036087`*^9, 3.84537249885839*^9}, {
   3.845372985487805*^9, 3.845373002250566*^9}, {3.845378490996593*^9, 
   3.845378573015369*^9}, {3.845378661987303*^9, 3.8453788535853033`*^9}, {
   3.8453790702934723`*^9, 3.845379071418022*^9}, {3.845379109649712*^9, 
   3.8453791208671637`*^9}, {3.845379379725452*^9, 3.845379380639789*^9}, {
   3.8453796842183733`*^9, 3.8453797176447983`*^9}, {3.845379769034687*^9, 
   3.8453797836783133`*^9}, {3.845379825068863*^9, 3.845379856775629*^9}, {
   3.8453802235624123`*^9, 
   3.845380223908083*^9}},ExpressionUUID->"474c4c96-1d6d-4788-9a42-\
337974bdf5b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Modification of ContractMetric", "Subsubsection",
 CellChangeTimes->{{3.843298929185896*^9, 
  3.843298938365378*^9}},ExpressionUUID->"04d6380a-feae-4880-85ae-\
1606ae3e5c18"],

Cell["\<\
We modify ContractMetric of xTensor to make it work for a frozen metric if \
the tensor which has to be contracted is associated to the aforementioned \
frozen metric. \
\>", "Text",
 CellChangeTimes->{{3.84328795101689*^9, 3.84328803730378*^9}, 
   3.84657241999338*^9},ExpressionUUID->"ec23b456-da1e-4ee4-ac25-\
82197e68b6fa"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "*", " ", "First", " ", "we", " ", "overwrite", " ", "NormalVectorOf", " ", 
   "private", " ", "function", " ", "of", " ", "xTensor"}], " ", 
  "**)"}]], "Input",
 CellChangeTimes->{{3.843288574278286*^9, 
  3.843288598628265*^9}},ExpressionUUID->"9f4eec53-1d24-4ba3-b27a-\
9875f04b2cc4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ContractMetric", "::", "frozen"}], "=", 
   "\"\<Cannot contract frozen metric `1`.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xAct`xTensor`Private`NormalVectorOf", "[", "metric_", "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"InducedFrom", "[", "metric", "]"}], "===", "Null"}], ",", 
     "Null", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InducedFrom", "[", "metric", "]"}], "=!=", "Null"}], ",", 
     RowBox[{"VectorOfInducedMetric", "[", "metric", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8432886455957127`*^9, 
  3.843288705634639*^9}},ExpressionUUID->"57db0e7c-9581-4449-b9d4-\
8ca91ea69071"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "ContractMetric", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ContractMetric", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"ContractMetric", "[", 
    RowBox[{"expr", ",", "$Metrics", ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "ContractMetric", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.843290265626409*^9, {3.843290311116798*^9, 
   3.843290332387291*^9}},ExpressionUUID->"8dfa67bc-7582-41a9-8f7f-\
6e74f7cecc42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Contractions", " ", "inside", " ", "first"}], "-", 
    RowBox[{"derivatives", " ", "with", " ", "inverse", " ", "metric"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"CM", ":", 
       RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"der_", "?", "FirstDerQ"}], "[", "expr_", "]"}], 
      RowBox[{"met", ":", 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dm", "=", 
          RowBox[{"der", "[", "met", "]"}]}], ",", "result"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"od", "||", 
            RowBox[{"dm", "===", "0"}]}], ")"}], "&&", 
          RowBox[{"xAct`xTensor`Private`differentexpressionsQ", "[", 
           RowBox[{
            RowBox[{"result", "=", 
             RowBox[{"CM", "[", 
              RowBox[{"expr", " ", "met"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"expr", ",", "met"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CM", "[", 
           RowBox[{"rest", " ", 
            RowBox[{"der", "[", "result", "]"}]}], "]"}], "-", 
          RowBox[{"CM", "[", 
           RowBox[{"rest", " ", "dm", " ", "expr"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"CM", "[", 
           RowBox[{"rest", " ", "met"}], "]"}], 
          RowBox[{"der", "[", "expr", "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"FindFreeIndices", "[", "expr", "]"}], ",", 
         RowBox[{
          RowBox[{"ChangeIndex", "[", "c", "]"}], "|", 
          RowBox[{"ChangeIndex", "[", "b", "]"}]}]}], "]"}], "&&", 
       RowBox[{
        RowBox[{"Head", "[", "expr", "]"}], "=!=", "metric"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}]}], ")"}]}]}], ";"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.843447813434593*^9, 3.843447814776659*^9}, 
   3.843447855348159*^9, {3.8434478979737177`*^9, 3.843447902820016*^9}, {
   3.84344799605894*^9, 3.843448000652824*^9}, 3.8434480733555937`*^9, {
   3.843448224910757*^9, 
   3.84344822710215*^9}},ExpressionUUID->"12b828ee-592b-4734-82ee-\
64b4714bf3dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Contraction", " ", "metric", "*", 
    RowBox[{"der", "[", "metric", "]"}], " ", "is", " ", "left", " ", 
    "untouched", " ", "to", " ", "avoid", " ", "infinite", " ", "recursion"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"CM", ":", 
       RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
     RowBox[{"rest_.", " ", 
      RowBox[{
       RowBox[{"der_", "?", "FirstDerQ"}], "[", 
       RowBox[{"metric_", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "]"}], 
      RowBox[{"metric_", "[", 
       RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], "=."}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"der_", "?", "FirstDerQ"}], "[", 
        RowBox[{"metric_", "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"c_", ",", "d_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"metric", "[", 
          RowBox[{"c", ",", "d"}], "]"}]}], "]"}], 
       RowBox[{"der", "[", 
        RowBox[{"metric", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PairQ", "[", 
         RowBox[{"a", ",", "d"}], "]"}], "||", 
        RowBox[{"PairQ", "[", 
         RowBox[{"b", ",", "d"}], "]"}], "||", 
        RowBox[{"PairQ", "[", 
         RowBox[{"a", ",", "c"}], "]"}], "||", 
        RowBox[{"PairQ", "[", 
         RowBox[{"b", ",", "c"}], "]"}]}], ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8438117569132*^9, 3.843811770457693*^9}, {
  3.8438118472504063`*^9, 
  3.8438118517594557`*^9}},ExpressionUUID->"7686e07f-21d1-4112-b5d6-\
910b9ebd6a87"],

Cell["\<\
Modification of PRJ : we allowed contraction if the tensor is orthogonal to \
the normal vector and also if MetricOfTensor[tens] is equal to the induced \
metric . For induced covariant derivative we allow contraction if \
MasterOf[covd] is equal to induced metric. \
\>", "Text",
 CellChangeTimes->{{3.8439069988462954`*^9, 3.843907092306539*^9}, {
  3.8439071337988987`*^9, 3.8439071441846457`*^9}, {3.843907197471715*^9, 
  3.843907254125936*^9}},ExpressionUUID->"ba2c1d31-5341-4f24-8ffc-\
16b0369161d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Contraction", " ", "of", " ", "projector", " ", "on", " ", "an", " ", 
    "spatial", " ", "tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"xAct`xTensor`Private`PRJ", "[", 
      RowBox[{"nv_", ",", 
       RowBox[{"tensor_", "?", "xTensorQ"}], ",", "indumetric_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "indumetric"}],
        ",", "True", ",", 
       RowBox[{
        RowBox[{"OrthogonalToVectorQ", "[", "nv", "]"}], "[", "tensor", 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Contraction", " ", "of", " ", "projector", " ", "through", " ", "its", 
      " ", "Levi"}], "-", 
     RowBox[{"Civita", " ", "connection"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xAct`xTensor`Private`PRJ", "[", 
      RowBox[{"nv_", ",", 
       RowBox[{"covd_", "?", "CovDQ"}], ",", "indumetric_"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MasterOf", "[", "covd", "]"}], "===", "indumetric"}], ",", 
       "True", ",", 
       RowBox[{
        RowBox[{"CovDOfMetric", "[", "indumetric", "]"}], "===", "covd"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843907118745332*^9, 3.843907210896803*^9}, {
  3.8439072617886353`*^9, 3.843907311011455*^9}, {3.882440926179603*^9, 
  3.88244093204068*^9}},ExpressionUUID->"34be49d9-c7fa-499a-b1a1-\
c0a0e7c6657b"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
     RowBox[{"**", "**", "**", "**"}]}], "******)"}],
   FontColor->RGBColor[1, 0.5, 0]], 
  StyleBox["\t",
   FontColor->RGBColor[1, 0.5, 0]], "\n", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", 
     " ", "We", " ", "overwrite", " ", "ContractMetric1", " ", "private", " ",
      "function", " ", "of", " ", "xTensor"}], " ", 
    "*****************************)"}],
   FontColor->RGBColor[1, 0.5, 0]], "\n", 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
       "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
     RowBox[{"**", "**", "**", "**", "**", "**"}]}], "******)"}],
   FontColor->RGBColor[1, 0.5, 0]], "\t", "\[IndentingNewLine]", 
  "\t\t\t\t\t\t\t\t\t\t", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
        RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], "=."}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"covd_", "?", "CovDQ"}], "[", 
         RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], "[", "expr_", 
        "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], "=."}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"prod_", "?", "ProductQ"}], "[", 
        RowBox[{"left___", ",", 
         RowBox[{
          RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
          RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], ",", 
         "right___"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], "=."}], ";"}], "\t", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "Copy"}], " ", "paste", " ", "from", " ", "xtensor", 
     " ", "the", " ", "code", " ", "for", " ", "induced", " ", "metric"}], 
    " ", "***)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "New"}], " ", "code", " ", "for", " ", "metric", " ", 
     "and", " ", "frozen", " ", "metric"}], " ", "***)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Second", " ", "index", " ", "of", " ", "metric"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
        RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"metric", ",", "c", ",", "a"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"tensor", "[", 
          RowBox[{"i1", ",", "b", ",", "i2"}], "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"c", ",", "a"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"covd_", "?", "CovDQ"}], "[", 
         RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], "[", "expr_", 
        "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"metric", ",", "c", ",", "a"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"i1", ",", "b", ",", "i2"}], "]"}], "[", "expr", "]"}]}], 
        "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"c", ",", "a"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"aud", "||", 
         RowBox[{"DownIndexQ", "[", "b", "]"}]}], ")"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "covd", ",", "metric"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MasterOf", "[", "covd", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MasterOf", "[", "covd", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"prod_", "?", "ProductQ"}], "[", 
        RowBox[{"left___", ",", 
         RowBox[{
          RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
          RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], ",", 
         "right___"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"metric", ",", "c", ",", "a"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"prod", "[", 
          RowBox[{"left", ",", 
           RowBox[{"tensor", "[", 
            RowBox[{"i1", ",", "b", ",", "i2"}], "]"}], ",", "right"}], 
          "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"c", ",", "a"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], " ", "&&", 
       RowBox[{
        RowBox[{"ScalarsOfProduct", "[", "prod", "]"}], "[", 
        RowBox[{"metric", "[", 
         RowBox[{"b", ",", "c"}], "]"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"First", " ", "index", " ", "of", " ", "metric"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
        RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"metric", ",", "a", ",", "b"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"tensor", "[", 
          RowBox[{"i1", ",", "c", ",", "i2"}], "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"covd_", "?", "CovDQ"}], "[", 
         RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], "[", "expr_", 
        "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"metric", ",", "a", ",", "b"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"i1", ",", "c", ",", "i2"}], "]"}], "[", "expr", "]"}]}], 
        "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"aud", "||", 
         RowBox[{"DownIndexQ", "[", "c", "]"}]}], ")"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "covd", ",", "metric"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MasterOf", "[", "covd", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MasterOf", "[", "covd", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"prod_", "?", "ProductQ"}], "[", 
        RowBox[{"left___", ",", 
         RowBox[{
          RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
          RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], ",", 
         "right___"}], "]"}], 
       RowBox[{"metric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"metric", ",", "a", ",", "b"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"prod", "[", 
          RowBox[{"left", ",", 
           RowBox[{"tensor", "[", 
            RowBox[{"i1", ",", "c", ",", "i2"}], "]"}], ",", "right"}], 
          "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], " ", "&&", 
       RowBox[{
        RowBox[{"ScalarsOfProduct", "[", "prod", "]"}], "[", 
        RowBox[{
         RowBox[{"metric", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}],
            "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}],
              "&&", 
             RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], ")"}]}],
         "]"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", " ", "Inverse"}], " ", "Metric"}], " ", "***)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Second", " ", "index", " ", "of", " ", "metric"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
        RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"invmetric", ",", "c", ",", "a"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"tensor", "[", 
          RowBox[{"i1", ",", "b", ",", "i2"}], "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"c", ",", "a"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"covd_", "?", "CovDQ"}], "[", 
         RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], "[", "expr_", 
        "]"}], 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"invmetric", ",", "c", ",", "a"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"i1", ",", "b", ",", "i2"}], "]"}], "[", "expr", "]"}]}], 
        "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"c", ",", "a"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"aud", "||", 
         RowBox[{"DownIndexQ", "[", "b", "]"}]}], ")"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "covd", ",", "metric"}], "]"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MasterOf", "[", "covd", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MasterOf", "[", "covd", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"prod_", "?", "ProductQ"}], "[", 
        RowBox[{"left___", ",", 
         RowBox[{
          RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
          RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], ",", 
         "right___"}], "]"}], 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"invmetric", ",", "c", ",", "a"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"prod", "[", 
          RowBox[{"left", ",", 
           RowBox[{"tensor", "[", 
            RowBox[{"i1", ",", "b", ",", "i2"}], "]"}], ",", "right"}], 
          "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"c", ",", "a"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], " ", "&&", 
       RowBox[{
        RowBox[{"ScalarsOfProduct", "[", "prod", "]"}], "[", 
        RowBox[{"metric", "[", 
         RowBox[{"b", ",", "c"}], "]"}], "]"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"First", " ", "index", " ", "of", " ", "metric"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
        RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"invmetric", ",", "a", ",", "b"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"tensor", "[", 
          RowBox[{"i1", ",", "c", ",", "i2"}], "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"covd_", "?", "CovDQ"}], "[", 
         RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], "[", "expr_", 
        "]"}], 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"invmetric", ",", "a", ",", "b"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{
          RowBox[{"covd", "[", 
           RowBox[{"i1", ",", "c", ",", "i2"}], "]"}], "[", "expr", "]"}]}], 
        "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"aud", "||", 
         RowBox[{"DownIndexQ", "[", "c", "]"}]}], ")"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "covd", ",", "metric"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MasterOf", "[", "covd", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MasterOf", "[", "covd", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"CM", ":", 
        RowBox[{"xAct`xTensor`Private`ContractMetric1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"od_", ",", "aud_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"metric_", ",", "nv_"}], "}"}]}], "]"}]}], ")"}], "[", 
      RowBox[{"rest_.", " ", 
       RowBox[{
        RowBox[{"prod_", "?", "ProductQ"}], "[", 
        RowBox[{"left___", ",", 
         RowBox[{
          RowBox[{"tensor_", "?", "xTensorQ"}], "[", 
          RowBox[{"i1___", ",", "a_", ",", "i2___"}], "]"}], ",", 
         "right___"}], "]"}], 
       RowBox[{"invmetric_", "[", 
        RowBox[{"b_", ",", "c_"}], "]"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"xAct`xTensor`Private`SMP", "[", 
        RowBox[{"invmetric", ",", "a", ",", "b"}], "]"}], 
       RowBox[{"CM", "[", 
        RowBox[{"rest", " ", 
         RowBox[{"prod", "[", 
          RowBox[{"left", ",", 
           RowBox[{"tensor", "[", 
            RowBox[{"i1", ",", "c", ",", "i2"}], "]"}], ",", "right"}], 
          "]"}]}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"PairQ", "[", 
        RowBox[{"a", ",", "b"}], "]"}], "&&", 
       RowBox[{"xAct`xTensor`Private`PRJ", "[", 
        RowBox[{"nv", ",", "tensor", ",", "metric"}], "]"}], " ", "&&", 
       RowBox[{
        RowBox[{"ScalarsOfProduct", "[", "prod", "]"}], "[", 
        RowBox[{"metric", "[", 
         RowBox[{"b", ",", "c"}], "]"}], "]"}], "&&", 
       RowBox[{"invmetric", "===", 
        RowBox[{"Inv", "[", "metric", "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "metric"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricOfTensor", "[", "tensor", "]"}], "===", "Null"}], "&&", 
           RowBox[{"FirstMetricQ", "[", "metric", "]"}]}], ")"}]}], 
        ")"}]}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843293747323401*^9, 3.84329376360919*^9}, {
   3.843294097967353*^9, 3.843294101245243*^9}, {3.8432944481716547`*^9, 
   3.8432944504468203`*^9}, {3.843294560760467*^9, 3.8432945612614107`*^9}, {
   3.843294622896742*^9, 3.8432946632115593`*^9}, {3.843294837765077*^9, 
   3.8432948942219*^9}, {3.843376705485712*^9, 3.843376855809721*^9}, {
   3.843376905638932*^9, 3.8433769060505953`*^9}, {3.84338232366463*^9, 
   3.843382381796171*^9}, {3.84338306062759*^9, 3.843383062265238*^9}, 
   3.843383099053063*^9, {3.843383177542934*^9, 3.8433834391185913`*^9}, {
   3.8433834769894543`*^9, 3.843383514232019*^9}, 3.84338356494429*^9, {
   3.8433836375586443`*^9, 3.8433837019073057`*^9}, {3.8433837664651012`*^9, 
   3.84338377976678*^9}, {3.843797941792797*^9, 3.843797976505005*^9}, {
   3.843906564478509*^9, 3.843906612664344*^9}, {3.843906648034026*^9, 
   3.843906657446066*^9}, {3.843906694564991*^9, 3.843906714230596*^9}, 
   3.84657451138444*^9},ExpressionUUID->"66841c53-2c1b-4587-b4c9-\
416ff408bc14"]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Modification of ChangeCurvature", "Subsubsection",
 CellChangeTimes->{{3.843384153282037*^9, 
  3.8433841596842537`*^9}},ExpressionUUID->"5df75eb5-ea81-453d-ac21-\
91a7af80165c"],

Cell["Potentially problematic ... ? ", "Text",
 CellChangeTimes->{{3.843390418202833*^9, 
  3.843390424525618*^9}},ExpressionUUID->"8e186ea3-e4c4-4472-bf11-\
04c76ee7ad09"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", " ", "Ricci", " ", 
    RowBox[{"Scalar", " ", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"changeRicciScalar", "[", 
       RowBox[{"covd1_", ",", "covd2_", ",", "metricofcovd1_"}], "]"}], "[", 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"DummyIn", "[", 
           RowBox[{"TangentBundleOfCovD", "[", "covd1", "]"}], "]"}]}], ",", 
         RowBox[{"b", "=", 
          RowBox[{"DummyIn", "[", 
           RowBox[{"TangentBundleOfCovD", "[", "covd1", "]"}], "]"}]}]}], 
        "}"}], ",", 
       RowBox[{"Scalar", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Inv", "[", "metricofcovd1", "]"}], "[", 
          RowBox[{"a", ",", "b"}], "]"}], 
         RowBox[{
          RowBox[{"changeRicci", "[", 
           RowBox[{"covd1", ",", "covd2", ",", "HELLO"}], "]"}], "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"makeChangeRicciScalarRule", "[", 
       RowBox[{"covd2_", ",", "Null"}], "]"}], "[", "covd1_", "]"}], ":=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"makeChangeRicciScalarRule", "[", 
       RowBox[{"covd2_", ",", "metricofcovd1_"}], "]"}], "[", "covd1_", "]"}],
      ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ricciscalar", "=", 
         RowBox[{"RicciScalar", "[", "covd1", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"HoldPattern", "[", 
         RowBox[{"ricciscalar", "[", "]"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"changeRicciScalar", "[", 
          RowBox[{"covd1", ",", "covd2", ",", "metricofcovd1"}], "]"}], "[", 
         "]"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843533590840619*^9, 3.8435335910762672`*^9}, {
   3.843533785336297*^9, 3.8435338744512367`*^9}, {3.843533910712379*^9, 
   3.8435339857355137`*^9}, 3.843534166959529*^9, {3.84353437836237*^9, 
   3.843534616170412*^9}, {3.843534658817582*^9, 3.843534668141964*^9}, {
   3.843534762687688*^9, 3.843534790924593*^9}, {3.843535091976941*^9, 
   3.8435351035177317`*^9}, 3.843535516303705*^9, 3.843535559777184*^9, {
   3.843535682746272*^9, 3.843535977951762*^9}, {3.843545968064847*^9, 
   3.8435459825279837`*^9}, {3.8437952936950903`*^9, 3.843795297936636*^9}, {
   3.843795336148817*^9, 3.8437953779466476`*^9}, 3.8437964143834057`*^9, {
   3.8437964680396967`*^9, 3.843796468156476*^9}, {3.843796610881913*^9, 
   3.843796615844343*^9}, {3.843796695146385*^9, 3.843796699557991*^9}, {
   3.843796734011201*^9, 3.843796748646172*^9}, {3.843796801221345*^9, 
   3.843796821369124*^9}, 3.843796964455949*^9, {3.863770910128831*^9, 
   3.8637709115528727`*^9}},ExpressionUUID->"cea66ad3-6e0e-45c8-8eba-\
2722afd39da0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xAct`xTensor`Private`makeChangeCurvatureRules", "[", 
    RowBox[{"covd2_", ",", "metrics_"}], "]"}], "[", "covd1_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vbundles", "=", 
      RowBox[{"VBundlesOfCovD", "[", "covd1", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"CurvatureQ", "[", 
         RowBox[{"covd1", ",", 
          RowBox[{"First", "[", "vbundles", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"xAct`xTensor`Private`makeChangeRiemannRule", "[", 
             RowBox[{"covd2", ",", "metrics", ",", "Riemann"}], "]"}], "[", 
            "covd1", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xAct`xTensor`Private`makeChangeRicciRule", "[", 
             RowBox[{"covd2", ",", "delta"}], "]"}], "[", "covd1", "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xAct`xTensor`Private`makeChangeRicciScalarRule", "[", 
             RowBox[{"covd2", ",", 
              RowBox[{"MasterOf", "[", "covd1", "]"}]}], "]"}], "[", "covd1", 
            "]"}]}], "}"}], "\[IndentingNewLine]", "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "vbundles", "]"}], ">", "1"}], "&&", 
         RowBox[{"CurvatureQ", "[", 
          RowBox[{"covd1", ",", 
           RowBox[{"Last", "[", "vbundles", "]"}]}], "]"}]}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xAct`xTensor`Private`makeChangeRiemannRule", "[", 
            RowBox[{"covd2", ",", "metrics", ",", "FRiemann"}], "]"}], "[", 
           "covd1", "]"}], "}"}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843534671896552*^9, 3.843534692688713*^9}, {
  3.843535991804213*^9, 3.84353599796634*^9}, {3.843546190211752*^9, 
  3.843546191808399*^9}, {3.8437951230137453`*^9, 3.84379512452142*^9}, {
  3.843795180299931*^9, 3.843795246319601*^9}, {3.8637709334481277`*^9, 
  3.8637709338222857`*^9}, {3.86377096429171*^9, 
  3.863770964480977*^9}},ExpressionUUID->"8cbb5c16-ce8f-4a1a-a317-\
9ae030548181"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "ChangeCurvature", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChangeCurvature", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"covd1_Symbol", "?", "CurvatureQ"}], ",", 
     RowBox[{"covd2_", ":", "PD"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"xAct`xTensor`Private`CompatibleCovDsQ", "[", 
      RowBox[{"covd1", ",", "covd2"}], "]"}], ",", 
     RowBox[{"ContractMetric", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"SeparateMetric", "[", "expr", "]"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"xAct`xTensor`Private`makeChangeCurvatureRules", "[", 
         RowBox[{"covd2", ",", 
          RowBox[{"xAct`xTensor`Private`metricsof", "[", "covd1", "]"}]}], 
         "]"}], "[", "covd1", "]"}]}], "]"}], ",", "expr"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "ChangeCurvature", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843389290762219*^9, 3.843389357562666*^9}, {
   3.843389496343958*^9, 3.843389498229753*^9}, 3.843390137129716*^9, {
   3.843390251728911*^9, 3.843390269030858*^9}, {3.8433904469135313`*^9, 
   3.843390472025969*^9}, 3.843794702335578*^9, 
   3.843794755411927*^9},ExpressionUUID->"c33a3223-50c3-4813-9625-\
389653e4dac1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
4. Modification of MakeRule (In particular we overwrite changeRuleforfreepmQ )\
\>", "Subsubsection",
 CellChangeTimes->{{3.843830629134177*^9, 
  3.843830661361655*^9}},ExpressionUUID->"2e7a5851-86b9-4a38-bc8c-\
56ad61ceb72f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xAct`xTensor`Private`changeRuleforfreepmQ", "[", 
    RowBox[{
     RowBox[{"HoldPattern", "[", 
      RowBox[{"LHS_Hold", "\[Rule]", "RHS_Hold"}], "]"}], ",", "index_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"ReplaceIndex", "[", 
     RowBox[{"LHS", ",", 
      RowBox[{"index", "\[Rule]", 
       RowBox[{"UpIndex", "[", "index", "]"}]}]}], "]"}], "\[Rule]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dummy", "=", 
        RowBox[{"DummyAs", "[", "index", "]"}]}], "}"}], ",", 
      RowBox[{"xAct`xTensor`Private`putmetric", "[", 
       RowBox[{
        RowBox[{"ReplaceIndex", "[", 
         RowBox[{"RHS", ",", 
          RowBox[{"index", "\[Rule]", "dummy"}]}], "]"}], ",", 
        RowBox[{"metricOf", "[", 
         RowBox[{"Sequence", "@@", "LHS"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"UpIndex", "[", "index", "]"}], ",", 
          RowBox[{"-", "dummy"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843830681775392*^9, 3.843830708164138*^9}, {
   3.8438313395996323`*^9, 3.843831359793913*^9}, {3.843831417961154*^9, 
   3.843831420366507*^9}, 3.8438316929917793`*^9, 3.843831952571074*^9, {
   3.84383271146484*^9, 3.8438327137988997`*^9}, 3.8438331184617977`*^9, 
   3.843833325941284*^9, 3.843836482157165*^9, {3.843836535583117*^9, 
   3.843836539583198*^9}, {3.843836619036256*^9, 3.843836619222784*^9}, {
   3.84383665412166*^9, 3.843836654299548*^9}, {3.843836715431026*^9, 
   3.8438367424176483`*^9}, {3.843839827992221*^9, 3.843839828601863*^9}, 
   3.84384001709018*^9, {3.843840171053412*^9, 3.8438401822035217`*^9}, {
   3.843896298940011*^9, 3.843896303340974*^9}, 
   3.843900181228854*^9},ExpressionUUID->"e5694041-9a92-432c-b345-\
542a213f64d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
5. Undefinition of SetProjected which causes problems for simplifying \
\[OpenCurlyDoubleQuote]induced\[CloseCurlyDoubleQuote] expressions.\
\>", "Subsubsection",
 CellChangeTimes->{{3.843905120116179*^9, 3.843905127076911*^9}, {
   3.843909638316599*^9, 3.843909640407743*^9}, 3.843909914815214*^9, {
   3.844140187967338*^9, 
   3.844140220784584*^9}},ExpressionUUID->"f4a6e4ed-2a7e-4ea2-a5ab-\
353f6949c332"],

Cell[BoxData[{
 RowBox[{"Unprotect", "[", "SetProjected", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetProjected", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds__", "]"}], ",", 
     RowBox[{"projector_", "?", "xTensorQ"}]}], "]"}], "=."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetProjected", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds__", "]"}], ",", 
     RowBox[{
      RowBox[{"projector_", "?", "xTensorQ"}], "[", 
      RowBox[{"i1_", ",", "i2_"}], "]"}]}], "]"}], "=."}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Proctect", "[", "SetProjected", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.843909645924724*^9, 3.843909705743208*^9}, {
   3.8439098670593348`*^9, 3.843909867423338*^9}, 3.8439099248587923`*^9, 
   3.844139012247528*^9},ExpressionUUID->"8d990a9f-ebfe-49d6-9a68-\
a20f73efcb95"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
6. xTension of DefTensor for projected tensors and rule for contraction of \
tensors on a symplectic manifold. \
\>", "Subsubsection",
 CellChangeTimes->{{3.844140311064486*^9, 3.8441403448236113`*^9}, {
  3.882697344035982*^9, 
  3.882697364457244*^9}},ExpressionUUID->"7051ce90-18b6-4208-ae99-\
cceb5142a364"],

Cell["\<\
If a tensor is projected with some induced metric we set MasterOf[tensor] to \
the induced metric. This will allow ContractMetric, SeparateMetric, and \
MakeRule to work in the desired fashion. \
\>", "Text",
 CellChangeTimes->{{3.8441403765471163`*^9, 
  3.844140450946948*^9}},ExpressionUUID->"c8d611ca-3e20-42bf-8d62-\
25f88b722e7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xTension", "[", 
    RowBox[{
    "\"\<xBrauer`xTensor`\>\"", ",", "DefTensor", ",", "\"\<End\>\""}], "]"}],
    ":=", "xBrauerxTensorDefTensor"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.844140347117889*^9, 3.844140369356653*^9}, {
  3.84414045910848*^9, 3.844140463453559*^9}, {3.847361303999672*^9, 
  3.847361304000704*^9}, {3.847361344232964*^9, 3.8473613442338552`*^9}, {
  3.847439833722164*^9, 3.847439833723358*^9}, {3.863770993343685*^9, 
  3.8637709990063953`*^9}},ExpressionUUID->"a8198c3b-d846-41ad-ae7e-\
8d08552ca38a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xBrauerxTensorDefTensor", "[", 
    RowBox[{
     RowBox[{"head_", "[", "indices___", "]"}], ",", "dependencies_", ",", 
     "sym_", ",", "options___"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pw", "=", 
        RowBox[{
         RowBox[{"ProjectedWith", "/.", " ", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], " ", "/.", " ", 
         RowBox[{"Options", "[", "DefTensor", "]"}]}]}], ",", "\n", "\t", 
       RowBox[{"ov", "=", 
        RowBox[{
         RowBox[{"OrthogonalTo", "/.", " ", 
          RowBox[{"CheckOptions", "[", "options", "]"}]}], " ", "/.", " ", 
         RowBox[{"Options", "[", "DefTensor", "]"}]}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pw", "=!=", 
          RowBox[{"{", "}"}]}], "&&", 
         RowBox[{"Equal", "@@", 
          RowBox[{"(", 
           RowBox[{"Head", "/@", "pw"}], ")"}]}], "&&", 
         RowBox[{
          RowBox[{"MasterOf", "[", "head", "]"}], "===", "Null"}]}], ",", 
        RowBox[{
         RowBox[{"MasterOf", "[", "head", "]"}], "^:=", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Head", "[", 
           RowBox[{"pw", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SymplecticFormQ", "[", 
         RowBox[{"MasterOf", "[", "head", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"head", "/:", 
         RowBox[{"head", "[", 
          RowBox[{"i___", " ", ",", "i1_Symbol", ",", "j___", ",", 
           RowBox[{"-", "i1_Symbol"}], ",", "k___"}], "]"}], ":=", 
         RowBox[{"-", 
          RowBox[{"head", "[", 
           RowBox[{"i", " ", ",", 
            RowBox[{"-", "i1"}], ",", "j", ",", "i1", ",", "k"}], "]"}]}]}]}],
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.844140548645409*^9, 3.8441405796643*^9}, {
   3.844140626083495*^9, 3.844140675637697*^9}, {3.844140870259995*^9, 
   3.8441409545695477`*^9}, {3.8441410081505404`*^9, 3.844141080423731*^9}, {
   3.84414118874459*^9, 3.8441411891600437`*^9}, 3.844141378616487*^9, {
   3.844148105313583*^9, 3.8441481100699377`*^9}, 3.8473613040045147`*^9, 
   3.847361344235668*^9, 3.847439833727195*^9, {3.863771002350555*^9, 
   3.863771002889331*^9}, {3.882696798254642*^9, 3.8826968655912857`*^9}, 
   3.882696924067767*^9},ExpressionUUID->"535fb215-1067-4608-8a3e-\
ba148f9a9c08"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6.3. Using VarD version of xTras", "Subsection",
 CellChangeTimes->{{3.893491560079981*^9, 
  3.8934915693659487`*^9}},ExpressionUUID->"6652419b-9420-48c6-a33a-\
8d7731d51bbd"],

Cell[CellGroupData[{

Cell["1. xTension of DefMetricPerturbation and DefMetricVariation.", \
"Subsubsection",
 CellChangeTimes->{{3.845115772798568*^9, 3.845115799171562*^9}, {
   3.845117276188936*^9, 3.845117280779553*^9}, 3.865413209137686*^9, 
   3.893487578703272*^9},ExpressionUUID->"409697d1-6594-4069-b258-\
08f68259a6ae"],

Cell["\<\
We need to set MasterOf[pertubedmetric] to the metric  (in \
DefMetricPerturbation)  and MasterOf[var] to metric (in DefMetricVariation) \
for perturbation and variational calculus to work properly.  For VarD to work \
with induced metric we also need to set pertmetric orthogonal to the normal \
vector. \
\>", "Text",
 CellChangeTimes->{{3.845115808109817*^9, 3.845115879559125*^9}, {
  3.8451172865497026`*^9, 3.845117346194634*^9}, {3.8465929698256187`*^9, 
  3.8465930615248938`*^9}},ExpressionUUID->"6361c0eb-3366-4177-88f8-\
ea877589c215"],

Cell["For DefMetricPertubation we do an extension ...", "Text",
 CellChangeTimes->{{3.845117377263166*^9, 3.845117378785084*^9}, {
  3.8451174089063063`*^9, 
  3.8451174280555*^9}},ExpressionUUID->"490861f8-0eff-45b7-9681-bd1eb7658325"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xTension", "[", 
    RowBox[{
    "\"\<xBrauer`xPert`\>\"", ",", "DefMetricPerturbation", ",", 
     "\"\<End\>\""}], "]"}], ":=", "xBrauerxPertDefMetricPerturbation"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8451159373442097`*^9, 3.845115961360341*^9}, {
  3.893513787018928*^9, 3.893513788653492*^9}, {3.8972330339022503`*^9, 
  3.897233034453326*^9}},ExpressionUUID->"3ebda563-4c4d-4fbb-a6b2-\
0ec523085ad5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xBrauerxPertDefMetricPerturbation", "[", 
    RowBox[{"metric_", ",", "pert_", ",", "param_", ",", 
     RowBox[{"options___", "?", "OptionQ"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"InducedMetricQ", "[", "metric", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MasterOf", "[", "pert", "]"}], "^=", "metric"}], ";", 
      RowBox[{
       RowBox[{
        RowBox[{"OrthogonalToVectorQ", "[", 
         RowBox[{
          RowBox[{"InducedFrom", "[", "metric", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", "pert", "]"}], "^=", 
       "True"}]}], ",", 
     RowBox[{
      RowBox[{"MasterOf", "[", "pert", "]"}], "^=", "metric"}]}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845115993683957*^9, 3.84511599368542*^9}, {
   3.8451160653823023`*^9, 3.84511611424992*^9}, 3.8451162447935133`*^9, {
   3.8451179828552847`*^9, 3.845118003280102*^9}, {3.845121232582026*^9, 
   3.8451212348097887`*^9}, {3.845121271033339*^9, 3.845121275456357*^9}, {
   3.84659410513374*^9, 3.8465941745229597`*^9}, 3.893492253443685*^9, 
   3.893492329911613*^9, {3.8935006232380857`*^9, 3.893500625601027*^9}, 
   3.893513794709207*^9},ExpressionUUID->"64b86333-f245-48b4-a652-\
db025b4b5c13"],

Cell["modification of the code in xTras.", "Text",
 CellChangeTimes->{{3.845117433236087*^9, 3.845117476597171*^9}, {
  3.893492228174658*^9, 3.893492239634652*^9}, {3.893513806624997*^9, 
  3.893513824014969*^9}},ExpressionUUID->"11396e2c-5fbd-45ea-8fff-\
92c675c1c387"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xAct`xTras`Private`DefMetricVariation", "[", 
    RowBox[{
     RowBox[{"metric_", "?", "MetricQ"}], ",", "per_", ",", "param_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "var", ",", "M", ",", "vb", ",", "a", ",", "b", ",", "c", ",", "d", ",",
        "normalvector"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vb", "=", 
       RowBox[{"VBundleOfMetric", "@", "metric"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M", "=", 
       RowBox[{"BaseOfVBundle", "@", "vb"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "=", 
       RowBox[{"GetIndicesOfVBundle", "[", 
        RowBox[{"vb", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Perturbation", "[", 
          RowBox[{"metric", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}]}], "]"}], "]"}], "=!=", 
         RowBox[{"per", "[", 
          RowBox[{
           RowBox[{"LI", "[", "1", "]"}], ",", 
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], "]"}]}], ",", 
        RowBox[{"Throw", "@", 
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"DefMetricPerturbation", "::", "error"}], ",", 
           "\"\<Metric perturbation does not match or is not defined.\>\""}], 
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$DefInfoQ", "=", "False"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"InducedMetricQ", "[", "metric", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"normalvector", "=", 
            RowBox[{
             RowBox[{"InducedFrom", "[", "metric", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"**", "**"}], "*", " ", "We", " ", "set", " ", 
             "Perturbation", " ", "of", " ", "Projected", " ", "tensors", " ",
              "as", " ", "projected", " ", 
             RowBox[{"quantities", " ", ":", " ", 
              RowBox[{"dangerous", " ", 
               RowBox[{"??", "?"}]}]}]}], " ", "***)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"OrthogonalToVectorQ", "[", "normalvector", "]"}], "[", 
             RowBox[{"Perturbation", "[", 
              RowBox[{
               RowBox[{"tensor_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OrthogonalToVectorQ", "[", "normalvector", "]"}], 
                   "[", "#", "]"}], "&"}], ")"}]}], "[", "inds___", "]"}], 
              "]"}], "]"}], "^=", "True"}], ";", "\[IndentingNewLine]", 
           RowBox[{"DefTensor", "[", 
            RowBox[{
             RowBox[{"var", "[", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "b"}]}], "]"}], ",", "M", ",", 
             RowBox[{"Symmetric", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "a"}], ",", 
                RowBox[{"-", "b"}]}], "}"}], "]"}], ",", 
             RowBox[{"OrthogonalTo", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"normalvector", "[", "a", "]"}], ",", 
                RowBox[{"normalvector", "[", "b", "]"}]}], "}"}]}], ",", 
             RowBox[{"ProjectedWith", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"metric", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"-", "c"}]}], "]"}], ",", 
                RowBox[{"metric", "[", 
                 RowBox[{"b", ",", 
                  RowBox[{"-", "d"}]}], "]"}]}], "}"}]}], ",", 
             RowBox[{"Master", "->", "metric"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DefTensor", "[", 
           RowBox[{
            RowBox[{"var", "[", 
             RowBox[{
              RowBox[{"-", "a"}], ",", 
              RowBox[{"-", "b"}]}], "]"}], ",", "M", ",", 
            RowBox[{"Symmetric", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "a"}], ",", 
               RowBox[{"-", "b"}]}], "}"}], "]"}], ",", 
            RowBox[{"Master", "->", "metric"}]}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cd", "=", 
           RowBox[{"CovDOfMetric", "[", "metric", "]"}]}], ",", 
          RowBox[{"sqrt", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"SignDetOfMetric", "[", "metric", "]"}], " ", "*", 
             RowBox[{
              RowBox[{"Determinant", "[", "metric", "]"}], "[", "]"}]}], 
            "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "We", " ", "can", " ", "now", " ", "define", " ", "a", " ", "total", 
          " ", "variation", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w", ".", "r", ".", "t", ".", "to"}], " ", "metric"}], 
           ")"}], " ", "as", " ", 
          RowBox[{"follows", ".", "Note"}], " ", "that", " ", 
          RowBox[{"we", "'"}], "re", " ", "only", " ", "varying", " ", "the", 
          " ", "metric", " ", "and", " ", "hence", " ", "set", " ", 
          "variations", " ", "of", " ", "any", " ", "other", " ", "tensors", 
          " ", "to", " ", 
          RowBox[{"zero", "."}]}], "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{"VarDt", "[", 
           RowBox[{"metric", ",", "expr_"}], "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "mod", "}"}], ",", 
            RowBox[{
             RowBox[{"mod", "=", 
              RowBox[{"MapIfPlus", "[", 
               RowBox[{"ContractMetric", ",", 
                RowBox[{"Expand", "@", 
                 RowBox[{"Perturbation", "[", "expr", "]"}]}]}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ExpandPerturbation", "@", 
               RowBox[{"SameDummies", "@", "mod"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"per", "[", 
                  RowBox[{
                   RowBox[{"LI", "[", "1", "]"}], ",", "inds__"}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"var", "[", "inds", "]"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p", ":", 
                   RowBox[{"(", 
                    RowBox[{"tensor_", "[", 
                    RowBox[{
                    RowBox[{"LI", "[", "1", "]"}], ",", "___"}], "]"}], 
                    ")"}]}], "/;", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"xTensorQ", "[", "tensor", "]"}], "&&", 
                    RowBox[{"tensor", "=!=", "per"}], "&&", 
                    RowBox[{
                    RowBox[{"PerturbationOrder", "[", "p", "]"}], "===", 
                    "1"}]}], ")"}]}], "\[Rule]", "0"}]}], "}"}]}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "The", " ", "functional", " ", "derivation", " ", "is", " ", 
            "then", " ", "defined", " ", "as"}], "..."}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"VarD", "[", 
            RowBox[{
             RowBox[{"metric", "[", 
              RowBox[{
               RowBox[{"-", "i1_Symbol"}], ",", 
               RowBox[{"-", "i2_Symbol"}]}], "]"}], ",", "cd"}], "]"}], "[", 
           "expr_", "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mod", ",", "withvar", ",", "novar"}], "}"}], ",", 
            RowBox[{
             RowBox[{"mod", "=", 
              RowBox[{"Expand", "@", 
               RowBox[{"VarDt", "[", 
                RowBox[{"metric", ",", "expr"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"novar", "=", 
              RowBox[{"mod", "/.", 
               RowBox[{
                RowBox[{"var", "[", "__", "]"}], "\[Rule]", "0"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"withvar", "=", 
              RowBox[{"mod", "-", "novar"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ContractMetric", "[", 
              RowBox[{
               RowBox[{"VarD", "[", 
                RowBox[{
                 RowBox[{"var", "[", 
                  RowBox[{
                   RowBox[{"-", "i1"}], ",", 
                   RowBox[{"-", "i2"}]}], "]"}], ",", "cd"}], "]"}], "[", 
               "withvar", "]"}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"VarD", "[", 
            RowBox[{
             RowBox[{"metric", "[", 
              RowBox[{
               RowBox[{"+", "i1_Symbol"}], ",", 
               RowBox[{"+", "i2_Symbol"}]}], "]"}], ",", "cd"}], "]"}], "[", 
           "expr_", "]"}], ":=", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"mod", ",", "withvar", ",", "novar"}], "}"}], ",", 
            RowBox[{
             RowBox[{"mod", "=", 
              RowBox[{"Expand", "@", 
               RowBox[{"VarDt", "[", 
                RowBox[{"metric", ",", "expr"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"novar", "=", 
              RowBox[{"mod", "/.", 
               RowBox[{
                RowBox[{"var", "[", "__", "]"}], "\[Rule]", "0"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"withvar", "=", 
              RowBox[{"mod", "-", "novar"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"-", 
              RowBox[{
               RowBox[{"VarD", "[", 
                RowBox[{
                 RowBox[{"var", "[", 
                  RowBox[{"i1", ",", "i2"}], "]"}], ",", "cd"}], "]"}], "[", 
               "withvar", "]"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "And", " ", "finally", " ", "one", " ", "handy", " ", "function", 
            " ", "that", " ", "varies", " ", "Lagrangians"}], ",", 
           RowBox[{
           "and", " ", "thus", " ", "takes", " ", "care", " ", "of", " ", 
            "the", " ", "square", " ", "root", " ", "of", " ", "the", " ", 
            RowBox[{"determinant", "."}]}]}], "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"VarL", "[", 
            RowBox[{"metric", "[", "inds__", "]"}], "]"}], "[", "L_", "]"}], ":=", 
          RowBox[{
           RowBox[{"VarL", "[", 
            RowBox[{
             RowBox[{"metric", "[", "inds", "]"}], ",", "cd"}], "]"}], "[", 
           "L", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"VarL", "[", 
            RowBox[{
             RowBox[{"metric", "[", "inds__", "]"}], ",", "cd"}], "]"}], "[", 
           "L_", "]"}], ":=", 
          RowBox[{
           RowBox[{
            RowBox[{"VarD", "[", 
             RowBox[{
              RowBox[{"metric", "[", "inds", "]"}], ",", "cd"}], "]"}], "[", 
            "L", "]"}], "+", 
           RowBox[{
            RowBox[{"ReplaceDummies", "[", "L", "]"}], " ", 
            RowBox[{
             RowBox[{
              RowBox[{"VarD", "[", 
               RowBox[{
                RowBox[{"metric", "[", "inds", "]"}], ",", "cd"}], "]"}], "[",
               "sqrt", "]"}], "/", "sqrt"}]}]}]}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8451172723426733`*^9, 3.845117272346291*^9}, {
   3.845117486057454*^9, 3.845117489254672*^9}, {3.845117523185528*^9, 
   3.845117526350532*^9}, {3.845117575106099*^9, 3.845117581330165*^9}, {
   3.845117946768652*^9, 3.84511795173451*^9}, 3.845118396334938*^9, {
   3.846592558488339*^9, 3.84659257085707*^9}, {3.84659274806181*^9, 
   3.84659291417313*^9}, {3.8465931246387377`*^9, 3.846593129760558*^9}, {
   3.846593706192112*^9, 3.846593781827868*^9}, {3.846593841585589*^9, 
   3.8465939321193533`*^9}, {3.893492061760416*^9, 3.893492081604886*^9}, {
   3.893492127220697*^9, 3.893492129087945*^9}, {3.893492180197927*^9, 
   3.893492213332069*^9}, {3.893492279556843*^9, 3.8934923211759367`*^9}, {
   3.893492380831648*^9, 3.8934924050560303`*^9}, {3.893493301782852*^9, 
   3.893493311033195*^9}, {3.893493447261853*^9, 3.893493472887315*^9}, {
   3.893493740880824*^9, 3.8934937426332893`*^9}, {3.893493870320805*^9, 
   3.893493870719782*^9}, {3.893493921411605*^9, 3.893493962390163*^9}, {
   3.893494299202978*^9, 3.89349433061617*^9}, {3.89349504120111*^9, 
   3.893495055546659*^9}, {3.893496325327497*^9, 3.893496361350659*^9}, {
   3.8934964116242313`*^9, 3.8934964170107393`*^9}, 3.893500748647681*^9, {
   3.8935009762271338`*^9, 3.893500976604122*^9}, {3.893501025695004*^9, 
   3.893501042711379*^9}, {3.893501101921027*^9, 3.8935011021515417`*^9}, {
   3.893503338753476*^9, 3.893503339012611*^9}, 
   3.893503830640039*^9},ExpressionUUID->"892c5637-36a8-4a98-b54b-\
edf414849e67"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VarD", "[", 
    RowBox[{
     RowBox[{"tensor_", "[", "inds1___", "]"}], ",", "der_"}], "]"}], "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds2___", "]"}], ",", 
    "rest_"}], "]"}], "=."}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.845111616088047*^9, {3.845112898184771*^9, 3.845112898654265*^9}, {
   3.893492513023295*^9, 3.893492515734187*^9}, {3.893493406089238*^9, 
   3.893493407848339*^9}},ExpressionUUID->"587f7d86-6d24-4521-b586-\
f199522696bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "One"}], " ", "need", " ", "to", " ", "be", " ", 
    "careful", " ", "with", " ", "induced", " ", 
    RowBox[{"metric", " ", ":", " ", 
     RowBox[{
     "it", " ", "may", " ", "need", " ", "to", " ", "be", " ", 
      "improved"}]}]}], " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VarD", "[", 
      RowBox[{
       RowBox[{"tensor_", "[", "inds1___", "]"}], ",", "der_"}], "]"}], "[", 
     RowBox[{
      RowBox[{
       RowBox[{"tensor_", "?", "xTensorQ"}], "[", "inds2___", "]"}], ",", 
      "rest_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"clist", "=", 
         RowBox[{"ChangeIndex", "/@", 
          RowBox[{"IndexList", "[", "inds1", "]"}]}]}], ",", 
        RowBox[{"metric", "=", 
         RowBox[{"MetricOfTensor", "[", "tensor", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ToCanonical", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImposeSymmetry", "[", 
          RowBox[{
           RowBox[{"Inner", "[", 
            RowBox[{"metric", ",", "clist", ",", 
             RowBox[{"IndexList", "[", "inds2", "]"}], ",", "Times"}], "]"}], 
           ",", "clist", ",", 
           RowBox[{"SymmetryGroupOfTensor", "[", 
            RowBox[{"tensor", "[", "inds1", "]"}], "]"}]}], "]"}], "rest"}], 
        ",", 
        RowBox[{"UseMetricOnVBundle", "\[Rule]", "None"}]}], "]"}]}], "]"}]}],
    ";"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"89f16ceb-a859-4c1d-99a2-0d1b1bd5666b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
7. Irreducible decomposition of tensors under  the action of the Orthogonal \
group (In Dev Private). \
\>", "Section",
 CellChangeTimes->{{3.8114175146364603`*^9, 3.811417547105*^9}, {
   3.8114338409786243`*^9, 3.8114338499341927`*^9}, {3.811442241137931*^9, 
   3.8114422673701973`*^9}, {3.811442390132452*^9, 3.811442400220068*^9}, 
   3.811594410937559*^9, 3.8123607257806463`*^9, {3.8140821701609383`*^9, 
   3.814082173314975*^9}, {3.815743349467043*^9, 3.815743351828436*^9}, {
   3.826801622983886*^9, 3.826801626733089*^9}, {3.829412855455162*^9, 
   3.829412892358152*^9}, {3.8297353902811613`*^9, 3.829735399114277*^9}, 
   3.8417245945540943`*^9, {3.843623002551301*^9, 3.8436230029186373`*^9}, 
   3.8436279194718447`*^9, {3.858243161775502*^9, 3.8582431622468157`*^9}, {
   3.908884706248868*^9, 3.9088847155894938`*^9}},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"8bfd21ed-e317-4a38-bb5d-890a8b1bd5c5"],

Cell[CellGroupData[{

Cell["1. Definition of irreducible tensors ", "Subsection",
 CellChangeTimes->{{3.843627972794182*^9, 3.8436279928380747`*^9}, {
  3.893393187274131*^9, 
  3.8933931997266617`*^9}},ExpressionUUID->"dae5dff9-1226-4fb0-bc42-\
cd16d535fce2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IRDMapping", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IRDMapping", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"IRDMethod", "\[Rule]", "SNYoungProject"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IRDRules", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IRDRules", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"IRDMethod", "\[Rule]", "SNYoungProject"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToIRD", "[", 
    RowBox[{"exp_", ",", 
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"IRDMethod", "\[Rule]", "method_"}]}], "]"}], ":=", "exp"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8399213481938543`*^9, 3.8399213666670017`*^9}, {
  3.843647581741295*^9, 3.843647618863365*^9}, {3.843647685074675*^9, 
  3.843647689782414*^9}},ExpressionUUID->"97bd6ed1-ae2d-4094-b40c-\
1241243c7b76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "DefIRD", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}], ",", 
    RowBox[{"ManifestSym", "\[Rule]", "Antisymmetric"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "IRDMapping", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Options", "[", "IRDRules", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefIRD", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", "inds_List", ",", 
     "indsmapping_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"deg", "=", 
        RowBox[{"Length", "[", "inds", "]"}]}], ",", "sdttab", ",", 
       "ruleindex", ",", "indtabs", ",", "assotensor", ",", 
       RowBox[{"M", "=", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"DependenciesOfTensor", "[", "tensor", "]"}]}]}], ",", 
       "method", ",", "listtabtensor", ",", "manifsym", ",", 
       RowBox[{"symtensor", "=", 
        RowBox[{"SymmetryGroupOfTensor", "[", "tensor", "]"}]}], ",", 
       "maxsym", ",", "tfQ", ",", "tftensor", ",", "tensorSymbol"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "method", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "DefIRD", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "IRDMethod", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "manifsym", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "DefIRD", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "ManifestSym", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"manifsym", "===", "Antisymmetric"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"sdttab", "=", 
         RowBox[{"Reverse", "@", 
          RowBox[{"StdTableaux", "[", "deg", "]"}]}]}], ",", 
        RowBox[{"sdttab", "=", 
         RowBox[{"StdTableaux", "[", "deg", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ruleindex", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"indsmapping", ",", "inds"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"indtabs", "=", 
       RowBox[{"sdttab", "/.", "ruleindex"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tfQ", "=", 
       RowBox[{"TraceFreeQ", "[", 
        RowBox[{"tensor", "@@", "inds"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**"}], "**"}], "**"}], "**"}], "**"}],
                     "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                  "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
           "**"}], "**"}], "**"}], "**"}], "**************)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**", "**", "**", " ", "If"}], " ", "the", 
        " ", "tensor", " ", "is", " ", "already", " ", "tracefree", " ", "we",
         " ", "decompose", " ", "it", " ", "with", " ", 
        RowBox[{"Young", "/", "SNYoung"}], " ", 
        RowBox[{"operators", " ", "**", "**", "**", "**"}]}], "*****)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
                     "**", "**", "**", "**", "**", "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
             "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"tfQ", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorID", "[", "tensor", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"tensorSymbol", "=", 
            RowBox[{
             RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"tensorSymbol", "=", "tensor"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"method", "===", "YoungProject"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"listtabtensor", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", 
                 RowBox[{"ToCanonical", "[", 
                  RowBox[{"YoungProject2", "[", 
                   RowBox[{
                    RowBox[{"tensor", "@@", "inds"}], ",", "#", ",", 
                    RowBox[{"ManifestSym", "\[Rule]", "manifsym"}]}], "]"}], 
                  "]"}]}], "&"}], ",", "indtabs"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"listtabtensor", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"listtabtensor", ",", 
               RowBox[{"a_List", "\[Rule]", "0"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "*", " ", "We", " ", "delete", " ", "antisymmetric", " ", "part",
               " ", "of", " ", "Weyl", " ", "because", " ", "of", " ", 
              "bianchi", " ", "identity"}], " ", "**)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "===", "Weyl"}], "&&", 
               RowBox[{"LeviCivitaQ", "[", 
                RowBox[{
                 RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "&&", 
               RowBox[{"manifsym", "===", "Antisymmetric"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"listtabtensor", "=", 
               RowBox[{"listtabtensor", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"indtabs", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
               "listtabtensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tensorSymbol", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<IRD\>\"", ",", 
               "n_Integer"}], "]"}], ":=", 
             RowBox[{"GiveSymbol", "[", 
              RowBox[{"tensorSymbol", ",", 
               RowBox[{
                RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<IRD\>\"", ",", 
               "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"assotensor", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"tensorSymbol", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<IRD\>\"", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "&"}], ",", 
               RowBox[{"Normal", "@", 
                RowBox[{"PositionIndex", "@", "indtabs"}]}]}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"method", "===", "SNYoungProject"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"listtabtensor", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", 
                 RowBox[{"ToCanonical", "[", 
                  RowBox[{"SNYoungProject", "[", 
                   RowBox[{
                    RowBox[{"tensor", "@@", "inds"}], ",", "#"}], "]"}], 
                  "]"}]}], "&"}], ",", "indtabs"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"listtabtensor", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"listtabtensor", ",", 
               RowBox[{"a_List", "\[Rule]", "0"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "*", " ", "We", " ", "delete", " ", "antisymmetric", " ", "part",
               " ", "of", " ", "Weyl", " ", "because", " ", "of", " ", 
              "bianchi", " ", "identity"}], " ", "**)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "===", "Weyl"}], "&&", 
               RowBox[{"LeviCivitaQ", "[", 
                RowBox[{
                 RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "&&", 
               RowBox[{"manifsym", "===", "Antisymmetric"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"listtabtensor", "=", 
               RowBox[{"listtabtensor", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"indtabs", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
               "listtabtensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tensorSymbol", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<SNIRD\>\"", ",", 
               "n_Integer"}], "]"}], ":=", 
             RowBox[{"GiveSymbol", "[", 
              RowBox[{"tensorSymbol", ",", 
               RowBox[{
                RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<SNIRD\>\"", ",", 
               "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"assotensor", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"tensorSymbol", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<SNIRD\>\"", ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "&"}], ",", 
               RowBox[{"Normal", "@", 
                RowBox[{"PositionIndex", "@", "indtabs"}]}]}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MasterOf", "[", "tensor", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DefTensor", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], ",", "M", 
                ",", 
                RowBox[{"PrintAs", "\[Rule]", 
                 RowBox[{"xMAGIRDPrint", "[", 
                  RowBox[{"tensorSymbol", ",", 
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"ToExpression", "@", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]}], "]"}], "&"}], 
             ",", "assotensor"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DefTensor", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], ",", "M", 
                ",", 
                RowBox[{"PrintAs", "\[Rule]", 
                 RowBox[{"xMAGPrint", "[", 
                  RowBox[{"tensor", ",", 
                   RowBox[{"ToExpression", "@", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]}], "]"}], "&"}], 
             ",", "assotensor"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"IRDMapping", "[", 
           RowBox[{"tensor", ",", 
            RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"TableauForm", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
                RowBox[{"HoldFirst", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], "]"}]}], 
               "&"}], ",", "assotensor"}], "]"}], ",", 
            RowBox[{"ToRule", "[", 
             RowBox[{
              RowBox[{"tensor", "@@", "inds"}], "\[Equal]", 
              RowBox[{"Total", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], "&"}], "/@",
                  "assotensor"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"IRDRules", "[", 
           RowBox[{"tensor", ",", 
            RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "=", 
          RowBox[{"Flatten", "@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ToRule", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "@@", "inds"}], "\[Equal]", 
                
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                   "assotensor"}], "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                   "listtabtensor"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**"}], "*", 
        RowBox[{"**", "**", "**", "**"}]}], "***********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"**", 
        RowBox[{
        "*", " ", "If", " ", "the", " ", "tensor", " ", "is", " ", "not", " ",
          "tracefree", " ", "we", " ", "project", " ", "the", " ", "tensor", 
         " ", "onto", " ", "it", " ", "tracefree", " ", "part", "  ", "and", 
         " ", "then", " ", "apply", " ", 
         RowBox[{"Young", "/", "SNYoung"}], " ", "operators"}]}], " ", 
       "****)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
          "**", "**", "**", "**", "**", "**", "**"}], "*", "**"}], 
       "***********)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "tfQ"}], ",", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"DefTraceDecomposition", "[", "tensor", "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorID", "[", "tensor", "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"tftensor", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<TF\>\"", ",", 
               RowBox[{"ToString", "[", "tensor", "]"}]}], "]"}], "]"}]}], 
           ",", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "===", "Riemann"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"tftensor", "=", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", "Weyl", "]"}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ",", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"tftensor", "=", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringJoin", "[", 
                RowBox[{"\"\<TF\>\"", ",", 
                 RowBox[{"ToString", "[", "tensor", "]"}]}], "]"}], "]"}]}]}],
             "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", 
          "\t", "]"}], ";", "\t\t", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"xTensorQ", "[", "tftensor", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TensorID", "[", "tftensor", "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ",", 
              RowBox[{"tensorSymbol", "=", 
               RowBox[{
                RowBox[{"TensorID", "[", "tftensor", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"tensorSymbol", "=", "tftensor"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"method", "===", "YoungProject"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"listtabtensor", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", 
                    RowBox[{"ToCanonical", "[", 
                    RowBox[{"YoungProject2", "[", 
                    RowBox[{
                    RowBox[{"tftensor", "@@", "inds"}], ",", "#", ",", 
                    RowBox[{"ManifestSym", "\[Rule]", "manifsym"}]}], "]"}], 
                    "]"}]}], "&"}], ",", "indtabs"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"listtabtensor", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"listtabtensor", ",", 
                  RowBox[{"a_List", "\[Rule]", "0"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"(*", 
                RowBox[{
                "*", " ", "We", " ", "delete", " ", "antisymmetric", " ", 
                 "part", " ", "of", " ", "Riemann", " ", "because", " ", "of",
                  " ", "bianchi", " ", "identity"}], " ", "**)"}], 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "===", "Riemann"}], "&&", 
                  
                  RowBox[{"LeviCivitaQ", "[", 
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "&&", 
                  RowBox[{"manifsym", "===", "Antisymmetric"}]}], ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"listtabtensor", "=", 
                  RowBox[{"listtabtensor", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}]}], 
                "\[IndentingNewLine]", "\t", "]"}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"indtabs", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                  "listtabtensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{
                RowBox[{"tensorSymbol", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<IRD\>\"", ",", 
                  "n_Integer"}], "]"}], ":=", 
                RowBox[{"GiveSymbol", "[", 
                 RowBox[{"tensorSymbol", ",", 
                  RowBox[{
                   RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<IRD\>\"", ",", 
                  "n"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
               RowBox[{"assotensor", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"tensorSymbol", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<IRD\>\"", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "&"}], ",", 
                  RowBox[{"Normal", "@", 
                   RowBox[{"PositionIndex", "@", "indtabs"}]}]}], "]"}]}]}]}],
              "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
            "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"method", "===", "SNYoungProject"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"listtabtensor", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", 
                    RowBox[{"ToCanonical", "[", 
                    RowBox[{"SNYoungProject", "[", 
                    RowBox[{
                    RowBox[{"tftensor", "@@", "inds"}], ",", "#"}], "]"}], 
                    "]"}]}], "&"}], ",", "indtabs"}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"listtabtensor", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"listtabtensor", ",", 
                  RowBox[{"a_List", "\[Rule]", "0"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"(*", 
                RowBox[{
                "*", " ", "We", " ", "delete", " ", "antisymmetric", " ", 
                 "part", " ", "of", " ", "Riemann", " ", "because", " ", "of",
                  " ", "bianchi", " ", "identity"}], " ", "**)"}], 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "===", "Riemann"}], "&&", 
                  
                  RowBox[{"LeviCivitaQ", "[", 
                   RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "&&", 
                  RowBox[{"manifsym", "===", "Antisymmetric"}]}], ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"listtabtensor", "=", 
                  RowBox[{"listtabtensor", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}]}]}], 
                "\[IndentingNewLine]", "\t", "]"}], ";", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"indtabs", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                  "listtabtensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{
                RowBox[{"tensorSymbol", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<SNIRD\>\"", ",", 
                  "n_Integer"}], "]"}], ":=", 
                RowBox[{"GiveSymbol", "[", 
                 RowBox[{"tensorSymbol", ",", 
                  RowBox[{
                   RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<SNIRD\>\"", ",", 
                  "n"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
               RowBox[{"assotensor", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"tensorSymbol", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TensorID", "[", "tensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<SNIRD\>\"", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "&"}], ",", 
                  RowBox[{"Normal", "@", 
                   RowBox[{"PositionIndex", "@", "indtabs"}]}]}], "]"}]}]}]}],
              "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"MasterOf", "[", "tensor", "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DefTensor", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], ",", "M", 
                   ",", 
                   RowBox[{"PrintAs", "\[Rule]", 
                    RowBox[{"xMAGIRDPrint", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TensorID", "[", "tftensor", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"TensorID", "[", "tftensor", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"ToExpression", "@", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]}], "]"}], "&"}], 
                ",", "assotensor"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DefTensor", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], ",", "M", 
                   ",", 
                   RowBox[{"PrintAs", "\[Rule]", 
                    RowBox[{"xMAGPrint", "[", 
                    RowBox[{"tensor", ",", 
                    RowBox[{"ToExpression", "@", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}]}]}], "]"}]}]}], "]"}], "&"}], 
                ",", "assotensor"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"IRDMapping", "[", 
              RowBox[{"tensor", ",", 
               RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"TableauForm", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
                   RowBox[{"HoldFirst", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], "]"}]}], 
                  "&"}], ",", "assotensor"}], "]"}], ",", 
               RowBox[{"ToRule", "[", 
                RowBox[{
                 RowBox[{"tensor", "@@", "inds"}], "\[Equal]", 
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tensor", "@@", "inds"}], "-", 
                    RowBox[{"tftensor", "@@", "inds"}], "+", 
                    RowBox[{"Total", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "@@", "inds"}], "&"}], "/@",
                     "assotensor"}], ")"}]}]}], ")"}], "/.", 
                   RowBox[{"TraceDecompose", "[", "tensor", "]"}]}], "]"}]}], 
                "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"IRDRules", "[", 
              RowBox[{"tensor", ",", 
               RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "=", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToRule", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "@@", "inds"}], 
                   "\[Equal]", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                    "assotensor"}], "]"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                    "listtabtensor"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829477039834547*^9, 3.829477081470872*^9}, {
   3.8294771304531603`*^9, 3.82947715901965*^9}, {3.829477282154559*^9, 
   3.8294773156218023`*^9}, {3.829478512735677*^9, 3.8294785577857847`*^9}, {
   3.8294786331151857`*^9, 3.829478686481926*^9}, {3.829478763015214*^9, 
   3.82947879072799*^9}, {3.829478837237074*^9, 3.829479280211101*^9}, {
   3.829479348011231*^9, 3.829479396476577*^9}, {3.829479574421647*^9, 
   3.829479590845375*^9}, 3.829481604065484*^9, {3.829622125840955*^9, 
   3.8296221333372393`*^9}, {3.8296222294917107`*^9, 3.829622230857613*^9}, {
   3.82962232241225*^9, 3.829622339579401*^9}, {3.8296225116329412`*^9, 
   3.829622542587702*^9}, {3.829622573989162*^9, 3.8296226105047817`*^9}, {
   3.829622702855205*^9, 3.829622711189065*^9}, {3.8296294812799683`*^9, 
   3.829629692559824*^9}, {3.829629739899838*^9, 3.8296297999298153`*^9}, {
   3.829629840695046*^9, 3.829629874613492*^9}, {3.829629910866152*^9, 
   3.8296299613029823`*^9}, {3.829630897336904*^9, 3.829630908188571*^9}, {
   3.82963094817292*^9, 3.829631132693614*^9}, 3.829631172852515*^9, 
   3.829631282829111*^9, {3.829631371632058*^9, 3.829631383830492*^9}, {
   3.829631417731566*^9, 3.829631428309733*^9}, {3.829631462201531*^9, 
   3.829631501906344*^9}, {3.829631542477928*^9, 3.829631748148938*^9}, {
   3.829631781346942*^9, 3.829631788785187*^9}, {3.8296321702741833`*^9, 
   3.829632175886595*^9}, {3.8296322062852707`*^9, 3.8296322504581003`*^9}, {
   3.829632414156704*^9, 3.829632441183358*^9}, {3.8296324856512403`*^9, 
   3.829632487034926*^9}, {3.829632550541452*^9, 3.82963262110771*^9}, 
   3.829632709182536*^9, 3.829632869617947*^9, {3.829633352087442*^9, 
   3.829633352715105*^9}, {3.829633559628742*^9, 3.8296336286507*^9}, {
   3.829633673266849*^9, 3.829633713205949*^9}, {3.8296337775396357`*^9, 
   3.829633786054695*^9}, {3.8296338721242*^9, 3.8296339433613443`*^9}, {
   3.829633986366522*^9, 3.8296339884332647`*^9}, {3.8296340553160477`*^9, 
   3.8296340562332897`*^9}, {3.82963412669378*^9, 3.8296341287636127`*^9}, {
   3.8296341830006657`*^9, 3.82963418814182*^9}, {3.82963430366886*^9, 
   3.82963431139624*^9}, {3.829634363035076*^9, 3.8296344250896997`*^9}, {
   3.8296344595552797`*^9, 3.8296344601558533`*^9}, {3.829636777059497*^9, 
   3.8296368298735657`*^9}, {3.829638796450326*^9, 3.8296390471093607`*^9}, {
   3.829646057028244*^9, 3.829646118245051*^9}, {3.82964638825554*^9, 
   3.8296463953172407`*^9}, {3.82964646298174*^9, 3.8296466556075077`*^9}, {
   3.8296467966882677`*^9, 3.829646825580371*^9}, {3.829646879756585*^9, 
   3.82964690314392*^9}, {3.8296469685291557`*^9, 3.829646986472686*^9}, {
   3.8296480308965*^9, 3.829648037390427*^9}, {3.8296480981264887`*^9, 
   3.82964815923034*^9}, {3.8296485869566927`*^9, 3.829648733645258*^9}, {
   3.829648854813833*^9, 3.8296489489433107`*^9}, {3.8296490711798363`*^9, 
   3.8296491081719513`*^9}, {3.829649194188568*^9, 3.8296492175671062`*^9}, {
   3.829649587138851*^9, 3.829649689478635*^9}, {3.8296497755698957`*^9, 
   3.8296498905848417`*^9}, {3.829649926771546*^9, 3.829649943056941*^9}, {
   3.8296499749754972`*^9, 3.8296499751672907`*^9}, {3.829650038190639*^9, 
   3.829650046180636*^9}, {3.829650076301065*^9, 3.829650076483686*^9}, {
   3.829650125163014*^9, 3.829650133319214*^9}, {3.829650212860198*^9, 
   3.829650216881352*^9}, {3.829650274744372*^9, 3.829650303268537*^9}, {
   3.829650417548973*^9, 3.8296504690913982`*^9}, {3.829650503430407*^9, 
   3.829650506639359*^9}, {3.829650719196207*^9, 3.82965072270043*^9}, {
   3.829651338740806*^9, 3.829651381725339*^9}, {3.829651432535602*^9, 
   3.829651566383163*^9}, {3.829651619791562*^9, 3.829651643671473*^9}, {
   3.829651687597312*^9, 3.8296516913466597`*^9}, {3.829651819267137*^9, 
   3.829651834632329*^9}, {3.829651873926097*^9, 3.829651909283265*^9}, {
   3.829663136921546*^9, 3.829663240428917*^9}, {3.829663292595475*^9, 
   3.829663300553845*^9}, 3.829663365585343*^9, {3.82966369338485*^9, 
   3.8296637221320267`*^9}, {3.829664047265505*^9, 3.829664047439418*^9}, {
   3.829664180052123*^9, 3.8296641956300364`*^9}, {3.8296643991725817`*^9, 
   3.829664410587757*^9}, {3.8296649964472723`*^9, 3.829665020299962*^9}, {
   3.829665109071558*^9, 3.829665117681335*^9}, {3.829665269222875*^9, 
   3.829665289646029*^9}, {3.8296653315748568`*^9, 3.8296654093530397`*^9}, {
   3.829665443245069*^9, 3.829665508555016*^9}, 3.8296656017358913`*^9, {
   3.829666378361105*^9, 3.829666378490398*^9}, {3.829667700671413*^9, 
   3.829667700678444*^9}, {3.829667894810288*^9, 3.829667932273716*^9}, 
   3.829667986084667*^9, {3.829668397888665*^9, 3.829668399938733*^9}, {
   3.8296684525061274`*^9, 3.829668454974009*^9}, {3.829736723411002*^9, 
   3.8297367599547777`*^9}, {3.829736881423864*^9, 3.8297368923937683`*^9}, {
   3.829736991421028*^9, 3.829736997789318*^9}, {3.829737031357163*^9, 
   3.829737082249702*^9}, {3.829737135450835*^9, 3.829737185089703*^9}, {
   3.829737324551462*^9, 3.8297373420982323`*^9}, 3.829737427481697*^9, {
   3.829737881520855*^9, 3.829737921465851*^9}, {3.829737993599872*^9, 
   3.8297379965668163`*^9}, {3.829738289518627*^9, 3.8297382957872467`*^9}, {
   3.8297384945270023`*^9, 3.8297385123300743`*^9}, {3.82973854558766*^9, 
   3.829738563066236*^9}, {3.8297386548658447`*^9, 3.829738655392013*^9}, {
   3.829738688054823*^9, 3.8297388568457403`*^9}, {3.829738890067013*^9, 
   3.8297389648807373`*^9}, {3.829739008879724*^9, 3.8297390275391483`*^9}, {
   3.829739064611601*^9, 3.8297392667999*^9}, {3.829739318750668*^9, 
   3.829739319013254*^9}, {3.8297394505104723`*^9, 3.8297394507094584`*^9}, {
   3.8297395735288754`*^9, 3.8297395815676327`*^9}, {3.8297396118690023`*^9, 
   3.8297396591490593`*^9}, {3.829739740704447*^9, 3.829739760062767*^9}, {
   3.829739910172688*^9, 3.829739921498219*^9}, {3.829739953653706*^9, 
   3.829739958094757*^9}, {3.829745738840029*^9, 3.8297457589132137`*^9}, {
   3.839919041057321*^9, 3.839919199574988*^9}, {3.839919375477626*^9, 
   3.839919473313308*^9}, {3.839919593991128*^9, 3.83991960067616*^9}, {
   3.8399199121433563`*^9, 3.839919923555722*^9}, {3.8399199819137907`*^9, 
   3.8399200581103373`*^9}, {3.839920094240003*^9, 3.83992028353906*^9}, 
   3.8399206269187098`*^9, {3.839920881603932*^9, 3.839920916415338*^9}, {
   3.8399212127018623`*^9, 3.839921253971774*^9}, {3.839921337314513*^9, 
   3.839921338204138*^9}, {3.8436249800325823`*^9, 3.843625038375124*^9}, {
   3.8436250779146967`*^9, 3.843625086460451*^9}, {3.843636083425888*^9, 
   3.84363611457231*^9}, 3.843636151768806*^9, {3.84363827838842*^9, 
   3.843638296270996*^9}, {3.8436428947962627`*^9, 3.8436430037870693`*^9}, {
   3.843643225290166*^9, 3.843643246383994*^9}, {3.8436433112459183`*^9, 
   3.843643313649952*^9}, {3.843644900739451*^9, 3.843644934399239*^9}, {
   3.843645014080587*^9, 3.8436450227823668`*^9}, {3.8436451000421352`*^9, 
   3.843645117054243*^9}, 3.843645198868208*^9, {3.843645291106819*^9, 
   3.843645293860639*^9}, {3.8436455020182*^9, 3.843645504471786*^9}, {
   3.843645666755765*^9, 3.843645702828514*^9}, {3.8436464752063313`*^9, 
   3.843646475429598*^9}, {3.843647911462267*^9, 3.8436479532756157`*^9}, {
   3.8436481102980137`*^9, 3.843648148004848*^9}, {3.84364821820888*^9, 
   3.843648233811693*^9}, {3.8436483143479767`*^9, 3.8436483210327044`*^9}, {
   3.8436614931074047`*^9, 3.8436616553310223`*^9}, {3.843661774748938*^9, 
   3.843661834317272*^9}, 3.847185897006852*^9, {3.84718596809823*^9, 
   3.847185968343389*^9}, {3.847361303554187*^9, 3.8473613035747423`*^9}, {
   3.847361344099859*^9, 3.847361344118908*^9}, {3.847439833333623*^9, 
   3.847439833352345*^9}, {3.893486342561777*^9, 
   3.89348634296729*^9}},ExpressionUUID->"3a535915-ac0f-4269-9ace-\
d33438677260"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IRDRules", "[", 
    RowBox[{"tensor_", "?", "xTensorQ"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"IRDRules", "[", 
      RowBox[{"tensor", ",", 
       RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}]}], "]"}], ",", 
     RowBox[{"IRDRules", "[", 
      RowBox[{"tensor", ",", 
       RowBox[{"IRDMethod", "\[Rule]", "SNYoungProject"}]}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IRDMapping", "[", 
    RowBox[{"tensor_", "?", "xTensorQ"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"IRDMapping", "[", 
      RowBox[{"tensor", ",", 
       RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}]}], "]"}], ",", 
     RowBox[{"IRDMapping", "[", 
      RowBox[{"tensor", ",", 
       RowBox[{"IRDMethod", "\[Rule]", "SNYoungProject"}]}], "]"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.839920539087739*^9, 3.839920565494237*^9}, {
  3.839920654138392*^9, 3.83992070525209*^9}, {3.839920853413822*^9, 
  3.839920864772517*^9}, {3.908884732538604*^9, 
  3.908884732976121*^9}},ExpressionUUID->"93016839-1fff-4d70-93a7-\
89b4df2ee65d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Options", "[", "UndefIRD", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"IRDMethod", "\[Rule]", "YoungProject"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UndefIRD", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "method", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "method", "}"}], "=", 
       RowBox[{"OptionValue", "[", 
        RowBox[{
         RowBox[{"{", "UndefIRD", "}"}], ",", 
         RowBox[{"{", "options", "}"}], ",", 
         RowBox[{"{", "IRDMethod", "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"length", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"IRDMapping", "[", 
            RowBox[{"tensor", ",", 
             RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"IRDRules", "[", 
           RowBox[{"tensor", ",", 
            RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "=."}], ";", 
         
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"UndefTensor", "[", 
             RowBox[{"Head", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "&"}], 
           ",", 
           RowBox[{
            RowBox[{"IRDMapping", "[", 
             RowBox[{"tensor", ",", 
              RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", 
              RowBox[{"length", "-", "1"}]}], "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"IRDMapping", "[", 
           RowBox[{"tensor", ",", 
            RowBox[{"IRDMethod", "\[Rule]", "method"}]}], "]"}], "=."}], 
         ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.82947942502037*^9, 3.829479477396737*^9}, {
   3.829479519608725*^9, 3.82947956097712*^9}, {3.829479691999405*^9, 
   3.8294797007026787`*^9}, {3.8294814716345463`*^9, 3.829481521789014*^9}, {
   3.829481555674478*^9, 3.829481565689947*^9}, {3.829634527409521*^9, 
   3.829634538331411*^9}, {3.829634570456889*^9, 3.829634577132038*^9}, 
   3.829646437118538*^9, {3.829650533027802*^9, 3.829650560287848*^9}, {
   3.829650679999195*^9, 3.829650683012618*^9}, {3.829740133907392*^9, 
   3.829740252518735*^9}, {3.829744262549407*^9, 3.829744280786285*^9}, {
   3.8399196490423*^9, 3.839919657634894*^9}, {3.8436365346453753`*^9, 
   3.8436365460371017`*^9}, {3.843636703349366*^9, 3.843636804480144*^9}, {
   3.843637092148378*^9, 3.843637100868021*^9}, {3.843646271621047*^9, 
   3.843646352306724*^9}, {3.843646731774848*^9, 3.843646750941413*^9}, {
   3.843646875816175*^9, 
   3.843646879716159*^9}},ExpressionUUID->"ad6f652f-dfd0-43d8-aa6a-\
3d157f1c0289"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DefIRD", "[", 
    RowBox[{
     RowBox[{"tensor_", "?", "xTensorQ"}], ",", "inds_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"DefIRD", "[", 
    RowBox[{"tensor", ",", "inds", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "inds", "]"}], "]"}], ",", "options"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefIRD", "[", 
    RowBox[{"tensorfunc_", ",", "indsmapping_List", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"DefIRD", "[", 
    RowBox[{
     RowBox[{"Head", "@", "tensorfunc"}], ",", 
     RowBox[{"List", "@@", "tensorfunc"}], ",", "indsmapping", ",", 
     "options"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DefIRD", "[", 
    RowBox[{"tensorfunc_", ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"DefIRD", "[", 
    RowBox[{
     RowBox[{"Head", "@", "tensorfunc"}], ",", 
     RowBox[{"List", "@@", "tensorfunc"}], ",", "options"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.829663759874728*^9, 3.829663769690189*^9}, {
  3.829663800955406*^9, 3.829664000424581*^9}, {3.8296640407257032`*^9, 
  3.829664041013435*^9}},
 CellLabel->
  "In[692]:=",ExpressionUUID->"8f8abaf6-96d2-453a-af0f-959ee4897eed"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["8. End private and package", "Section",
 CellChangeTimes->{{3.811409549495804*^9, 3.811409550461585*^9}, 
   3.811417539902953*^9, 3.811442369030696*^9, {3.812360738802966*^9, 
   3.812360741918885*^9}, {3.8285174452039957`*^9, 3.828517445532598*^9}, 
   3.860569998430805*^9, 3.8637703150056477`*^9, 3.869902188591577*^9, 
   3.875173118059382*^9, {3.876046698128962*^9, 3.876046699308329*^9}, 
   3.8764869010073433`*^9, 3.878026280967785*^9, 3.878026370490356*^9, 
   3.878120000946187*^9, 3.883308050696772*^9, 3.908884702779195*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"d157c404-9bd3-4389-8876-ebb9a589ff81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Protect", "@@", 
  RowBox[{
  "Names", "[", "\"\<xAct`xBrauer`*\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Unprotect", "[", "$SymplecticForms", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.811414040907868*^9, 3.81141404860459*^9}, 
   3.8121082399709272`*^9, {3.8121936631480083`*^9, 3.812193666595285*^9}, {
   3.8121947211723146`*^9, 3.812194729073523*^9}, {3.8759555655746613`*^9, 
   3.875955576077923*^9}, 3.876970439198427*^9, {3.8780254290373573`*^9, 
   3.8780254392187138`*^9}, {3.882339674816682*^9, 3.8823396751319027`*^9}, {
   3.882339705978374*^9, 3.882339724396906*^9}, {3.882445654228047*^9, 
   3.88244565460566*^9}, {3.882530681378583*^9, 3.8825306933850183`*^9}, 
   3.883307042288039*^9, 
   3.8833091555025673`*^9},ExpressionUUID->"fdd62791-9699-4aea-9439-\
fb3f5dd1f149"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
Evaluator->"Local",
WindowSize->{1440., 746.25},
WindowMargins->{{0, Automatic}, {Automatic, 27.75}},
SpellingDictionaries->{"CorrectWords"->{
 "Contorsion", "Palatini", "Metricity", "Galileon", "Disformation", 
  "Metriciy", "metricity", "Disformal", "Seminormal", "Goncharov", "Yegor"}},
Magnification:>1. Inherited,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"859f12da-d9e8-40af-9090-f8316915e248"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 841, 13, 100, "Chapter",ExpressionUUID->"52886c0e-0117-4f34-9f17-2333192fb30d"],
Cell[1424, 37, 1374, 22, 122, "Subsubtitle",ExpressionUUID->"2c0ff4c3-d842-450f-a54c-b762f1845f31"],
Cell[2801, 61, 1922, 30, 105, "Text",ExpressionUUID->"22e3d543-18da-4759-b461-b14ae684f794"],
Cell[CellGroupData[{
Cell[4748, 95, 1530, 34, 87, "Input",ExpressionUUID->"528dbdcb-3a1e-4c3f-adac-ac5334040dae",
 InitializationCell->True],
Cell[6281, 131, 25807, 352, 33, "Output",ExpressionUUID->"284f956a-bad8-4d2a-b29f-05baeae3f695"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32125, 488, 187, 6, 68, "Section",ExpressionUUID->"452e7aa3-04d7-4f81-bb10-d8f1e3a8706e"],
Cell[CellGroupData[{
Cell[32337, 498, 239, 4, 45, "Subsubsection",ExpressionUUID->"14ec624c-f949-412b-bad8-8639d36d5b9e"],
Cell[32579, 504, 443, 9, 32, "Input",ExpressionUUID->"af9cc293-5c86-4a84-a230-155ac904fb37"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33059, 518, 88, 0, 45, "Subsubsection",ExpressionUUID->"6c7b7745-4d1b-4902-879a-a236450fd7f3"],
Cell[33150, 520, 2471, 53, 259, "Input",ExpressionUUID->"e5b23ef2-606b-4ba0-a720-a469c2133c48",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[35658, 578, 97, 0, 45, "Subsubsection",ExpressionUUID->"8db9a4ee-4177-4195-9b3d-727eccc96972"],
Cell[35758, 580, 1114, 40, 514, "Input",ExpressionUUID->"653c46e6-9402-4994-ba04-39c497d51544",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[36909, 625, 97, 0, 45, "Subsubsection",ExpressionUUID->"53873783-da1d-4c42-8d90-f0ebc5b46037"],
Cell[37009, 627, 286, 4, 35, "Text",ExpressionUUID->"dbd169e2-e4a0-491b-bcb9-71c8d803b504"],
Cell[37298, 633, 2443, 48, 149, "Input",ExpressionUUID->"c890133e-8df5-4972-906c-bbda724bbc68",
 InitializationCell->True],
Cell[39744, 683, 226, 8, 35, "Text",ExpressionUUID->"389103e4-2622-4249-864e-1ba3754c11dd"],
Cell[39973, 693, 1383, 38, 87, "Input",ExpressionUUID->"da3d03b6-896a-4a67-9cbd-af24c41194f9",
 InitializationCell->True],
Cell[41359, 733, 130, 2, 35, "Text",ExpressionUUID->"143af8a5-d855-4fc5-896a-7ebef2f1c576"],
Cell[CellGroupData[{
Cell[41514, 739, 946, 22, 92, "Input",ExpressionUUID->"2cf45679-4fef-4a58-8aaf-531208a1712c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[42485, 765, 25920, 352, 23, "Print",ExpressionUUID->"69c48794-0225-476f-9946-765b28b1fa5e"],
Cell[68408, 1119, 26196, 360, 25, "Print",ExpressionUUID->"30ce9503-b1e5-46b0-9623-aa61fcd66282"],
Cell[94607, 1481, 25928, 352, 25, "Print",ExpressionUUID->"0943a9c2-971a-4354-b225-a9f8f2020031"]
}, Open  ]]
}, Open  ]],
Cell[120562, 1837, 465, 9, 35, "Text",ExpressionUUID->"67046a70-27e6-49a8-ad21-21b49a8207c1"],
Cell[121030, 1848, 1830, 31, 324, "Input",ExpressionUUID->"177331d4-6fd1-4f6d-8164-3105a567912d",
 InitializationCell->True],
Cell[122863, 1881, 386, 8, 35, "Text",ExpressionUUID->"56320610-cc8f-4c7c-aaec-95a070b5441c"],
Cell[CellGroupData[{
Cell[123274, 1893, 1156, 25, 178, "Input",ExpressionUUID->"bcc65c83-37ed-4942-b90f-4ba73edbe076",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[124455, 1922, 25889, 352, 23, "Print",ExpressionUUID->"49ffc0d3-106d-48c2-ac50-68f54fa32ec0"],
Cell[150347, 2276, 26044, 354, 45, "Print",ExpressionUUID->"9fb39ea6-f48f-4f56-b6c9-e31146e4b22f"],
Cell[176394, 2632, 25888, 352, 23, "Print",ExpressionUUID->"54d1ba97-b67a-4de9-a8da-055cf447df98"]
}, Open  ]]
}, Open  ]],
Cell[202309, 2988, 215, 6, 35, "Text",ExpressionUUID->"7ed0d2f5-fecf-4f8e-a113-8c27c1a30642"],
Cell[202527, 2996, 117, 0, 35, "Text",ExpressionUUID->"dd185764-c883-434c-9958-91e444ac75c0"]
}, Open  ]],
Cell[202659, 2999, 103, 0, 45, "Subsubsection",ExpressionUUID->"79488d97-b3e3-4592-80ca-988dc5c7d2e0"],
Cell[CellGroupData[{
Cell[202787, 3003, 302, 6, 37, "Subsubsection",ExpressionUUID->"5ea2d342-01ea-4df4-b0a5-293a645dbecd"],
Cell[203092, 3011, 2345, 33, 51, "Code",ExpressionUUID->"0aa686c6-463d-4687-9c82-209c58cf8505"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205474, 3049, 146, 3, 45, "Subsubsection",ExpressionUUID->"d3ebe61c-50f8-4d32-92fb-e20e7a505c69"],
Cell[205623, 3054, 169, 3, 35, "Text",ExpressionUUID->"f5485f81-c10c-4678-b0d8-2ce643e91523"],
Cell[205795, 3059, 753, 16, 69, "Input",ExpressionUUID->"dbb93d31-e9de-47de-8b4d-989845c68a3c",
 InitializationCell->True],
Cell[206551, 3077, 408, 8, 32, "Input",ExpressionUUID->"f7cee69a-2630-46af-9f6b-ae9e5d0502ed"],
Cell[206962, 3087, 57088, 926, 2643, "Code",ExpressionUUID->"cd7bc4de-5cf3-43c2-883e-d368e48ba56d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264087, 4018, 98, 0, 45, "Subsubsection",ExpressionUUID->"2a52b782-39b3-473f-bcd1-7f16b3e843ae"],
Cell[CellGroupData[{
Cell[264210, 4022, 184, 4, 45, "Input",ExpressionUUID->"27c8d571-8850-4ed4-b09b-9aed01378bd0",
 InitializationCell->True],
Cell[264397, 4028, 402, 6, 33, "Output",ExpressionUUID->"4d0b5ced-e5bd-455a-852d-e495f179839e"]
}, Open  ]],
Cell[264814, 4037, 155, 3, 35, "Text",ExpressionUUID->"74cc563e-6060-4c8e-9ae9-8c48b5ad236e"],
Cell[264972, 4042, 514, 8, 29, "Input",ExpressionUUID->"567ee559-6583-4c3d-881e-1bae3d98d237"],
Cell[CellGroupData[{
Cell[265511, 4054, 117, 2, 29, "Input",ExpressionUUID->"ac08f0cd-558b-4603-bd7d-471ca9756600"],
Cell[265631, 4058, 272, 4, 33, "Output",ExpressionUUID->"56dfd421-745f-44e2-a7fa-88855b6b5594"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265952, 4068, 179, 3, 45, "Subsubsection",ExpressionUUID->"69c4fc57-885e-4862-8b73-6365eded4ae8"],
Cell[266134, 4073, 2076, 58, 196, "Input",ExpressionUUID->"d9292542-253c-4bbe-b926-4efdd5b15903",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268259, 4137, 244, 4, 68, "Section",ExpressionUUID->"49ad5304-c6ae-45fe-963b-12af745782ae"],
Cell[CellGroupData[{
Cell[268528, 4145, 286, 4, 54, "Subsection",ExpressionUUID->"fcaaf38c-7f0a-4ec4-baa8-f43491c6c1b6"],
Cell[268817, 4151, 1190, 26, 108, "Input",ExpressionUUID->"939668d6-9260-4dcc-85fc-6061f8f50a9e",
 InitializationCell->True],
Cell[270010, 4179, 695, 19, 67, "Input",ExpressionUUID->"5f18c2ea-6fcc-4be2-a115-64ff6f2e6e67",
 InitializationCell->True],
Cell[270708, 4200, 15999, 361, 971, "Input",ExpressionUUID->"71cad961-0c0a-41a6-a17b-fd58a305046f",
 InitializationCell->True],
Cell[286710, 4563, 385, 8, 32, "Input",ExpressionUUID->"034e5f8a-8b44-4064-a9a5-c62d82fe4813"],
Cell[287098, 4573, 521, 12, 45, "Input",ExpressionUUID->"4c3de466-488e-4fa4-ad77-ee00155e7f14",
 InitializationCell->True],
Cell[287622, 4587, 306, 7, 32, "Input",ExpressionUUID->"6dce5872-5ef8-4377-bf9e-7358de761e7f"],
Cell[287931, 4596, 4095, 89, 190, "Input",ExpressionUUID->"1d1c0187-2210-481e-a8eb-ce2b0af45ff3",
 InitializationCell->True],
Cell[292029, 4687, 296, 7, 32, "Input",ExpressionUUID->"a9869aea-6d88-4767-85b9-fff09516c9d7"],
Cell[292328, 4696, 928, 22, 108, "Input",ExpressionUUID->"cc6d0207-e86f-4b22-86e4-a719057b80d7",
 InitializationCell->True],
Cell[293259, 4720, 4757, 109, 190, "Input",ExpressionUUID->"7c3da358-1be3-44cc-846c-3c8d7a3cbdb8",
 InitializationCell->True],
Cell[298019, 4831, 3263, 73, 87, "Input",ExpressionUUID->"596e285b-cd48-42ae-8677-461822214944",
 InitializationCell->True],
Cell[301285, 4906, 280, 7, 32, "Input",ExpressionUUID->"aa29cdb4-6db0-4eb3-b31f-88fbfbf05fce"],
Cell[301568, 4915, 2664, 74, 170, "Input",ExpressionUUID->"bcd46581-21cf-4ed0-98ee-fd50e0e1a1ef",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[304269, 4994, 202, 3, 54, "Subsection",ExpressionUUID->"088099d7-e504-41c9-bb96-2475a14fef8e"],
Cell[304474, 4999, 1976, 49, 129, "Input",ExpressionUUID->"9d497600-a645-4254-a66f-78c9334440fa",
 InitializationCell->True],
Cell[306453, 5050, 2374, 65, 193, "Input",ExpressionUUID->"ef499a9a-935b-4a09-9bd0-2dfd3f018442",
 InitializationCell->True],
Cell[308830, 5117, 6454, 171, 356, "Input",ExpressionUUID->"c89f20d8-b9e0-4699-915e-5e94db1529b6",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[315321, 5293, 197, 3, 54, "Subsection",ExpressionUUID->"5d4d4a41-c2d2-4c48-99b0-dbab5b609ba2"],
Cell[315521, 5298, 867, 18, 67, "Input",ExpressionUUID->"f00c6784-892e-44ef-9c37-f271f3f25ea1",
 InitializationCell->True],
Cell[316391, 5318, 1553, 42, 112, "Input",ExpressionUUID->"6de3953d-9e19-491f-95e1-7e7cabe92e01",
 InitializationCell->True],
Cell[317947, 5362, 5405, 142, 335, "Input",ExpressionUUID->"025ca358-4c33-40bc-b790-8629f76f6f85",
 InitializationCell->True],
Cell[323355, 5506, 720, 18, 46, "Input",ExpressionUUID->"00cd6ca2-212e-4794-aac8-ff6c39a23f95",
 InitializationCell->True],
Cell[324078, 5526, 1217, 30, 67, "Input",ExpressionUUID->"c258b124-4de4-41c8-8ea8-d2b6155b08e9",
 InitializationCell->True],
Cell[325298, 5558, 4003, 102, 265, "Input",ExpressionUUID->"341f5df0-fe73-4910-9214-7028119b5300",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[329338, 5665, 194, 3, 38, "Subsection",ExpressionUUID->"2d5b0b88-abf9-4c30-b815-671f1f9a974c"],
Cell[329535, 5670, 4460, 105, 233, "Input",ExpressionUUID->"a149fdb0-a1c7-4396-a2ed-2ea72a2adc38",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[334044, 5781, 925, 14, 54, "Section",ExpressionUUID->"b7827784-d2fe-4f2f-8e00-31e7c37543bc"],
Cell[CellGroupData[{
Cell[334994, 5799, 245, 4, 54, "Subsection",ExpressionUUID->"f92c4c0e-ba31-4cb8-8641-5463b3690997"],
Cell[335242, 5805, 597, 11, 58, "Text",ExpressionUUID->"44a391ce-9361-4762-a2b3-1530637bb274"],
Cell[CellGroupData[{
Cell[335864, 5820, 216, 3, 45, "Subsubsection",ExpressionUUID->"fb3c3b5e-8ed9-4add-a099-9f8082ffdedb"],
Cell[336083, 5825, 5829, 146, 322, "Input",ExpressionUUID->"fd98ef5b-e064-4bdd-9173-6bddf05dd0b8",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[341949, 5976, 265, 4, 45, "Subsubsection",ExpressionUUID->"ed4acca4-7535-4c55-ad85-23a9ce6f97d4"],
Cell[342217, 5982, 7672, 180, 429, "Input",ExpressionUUID->"d7bbb923-24a6-4f86-817c-a7a155c94282",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[349926, 6167, 221, 4, 45, "Subsubsection",ExpressionUUID->"a68cc1dd-14a0-40fb-b980-88fa34aa931f"],
Cell[350150, 6173, 28732, 663, 1567, "Input",ExpressionUUID->"fb5167de-deb8-46b1-ae9b-51d7ee47fa80",
 InitializationCell->True],
Cell[378885, 6838, 4118, 89, 214, "Input",ExpressionUUID->"c981cf31-95b0-44a1-8f42-45459265ac3b",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[383052, 6933, 472, 8, 54, "Subsection",ExpressionUUID->"58884a20-c9d6-49d9-8240-a52ad1d5e3d3"],
Cell[CellGroupData[{
Cell[383549, 6945, 255, 4, 45, "Subsubsection",ExpressionUUID->"410485d2-4563-4e1a-8451-53a7b97e0858"],
Cell[383807, 6951, 334, 9, 45, "Input",ExpressionUUID->"1405324e-8e91-4977-a1d6-8913f950d7ec",
 InitializationCell->True],
Cell[384144, 6962, 351, 8, 32, "Input",ExpressionUUID->"06d1c276-dd6e-4ea2-bcbc-8d5ffd0ab79f"],
Cell[384498, 6972, 21845, 476, 982, "Input",ExpressionUUID->"e5ac87c0-6ad9-444b-8276-be9d3eae9af0",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[406380, 7453, 200, 3, 45, "Subsubsection",ExpressionUUID->"963f7bdf-755c-4547-b0c0-9e9c93131843"],
Cell[406583, 7458, 16998, 394, 1053, "Input",ExpressionUUID->"3663e5ee-1cfa-454a-bc94-9182ae4c6e5d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[423618, 7857, 250, 4, 45, "Subsubsection",ExpressionUUID->"24dcd086-a3f5-42b7-a5ea-b6d76b89cda3"],
Cell[423871, 7863, 298, 7, 32, "Input",ExpressionUUID->"576c34a8-abff-4272-b758-1b2b19475c3c"],
Cell[424172, 7872, 15639, 381, 940, "Input",ExpressionUUID->"4ba5fbcf-0b65-4f5c-adb0-4765671c8cfc",
 InitializationCell->True],
Cell[439814, 8255, 1196, 29, 91, "Input",ExpressionUUID->"4bb0f5d9-630d-4b88-b689-58d6bf979dce",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[441059, 8290, 297, 4, 54, "Subsection",ExpressionUUID->"7ae7574a-ec2b-446a-9ee9-c02b50ffc371"],
Cell[441359, 8296, 248, 6, 32, "Input",ExpressionUUID->"d912d7ec-b6ab-45ba-82fd-9a7ddbc79c25"],
Cell[441610, 8304, 5383, 132, 294, "Input",ExpressionUUID->"68922893-6795-41da-9b65-be48ff6fd16e",
 InitializationCell->True],
Cell[446996, 8438, 258, 7, 32, "Input",ExpressionUUID->"be3f1c41-cfb8-4a2a-a342-f987b4c767bd"],
Cell[447257, 8447, 303, 8, 32, "Input",ExpressionUUID->"0a75ae51-b9a8-45c1-af00-7b5a5243cf5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447597, 8460, 358, 5, 54, "Subsection",ExpressionUUID->"435d86a7-f38f-4965-b53a-fa7d7f137ba7"],
Cell[447958, 8467, 193, 2, 35, "Text",ExpressionUUID->"ac8ecceb-2fe6-427a-a45b-8b6068ab53b7"],
Cell[448154, 8471, 6641, 139, 350, "Input",ExpressionUUID->"bd9e8250-db24-48bf-b474-8b78194d167f",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[454844, 8616, 263, 4, 54, "Section",ExpressionUUID->"b7e1e050-41c3-4f3b-ad92-a95aa80ccefb"],
Cell[CellGroupData[{
Cell[455132, 8624, 291, 7, 54, "Subsection",ExpressionUUID->"61671527-8ff4-4387-9163-7c1e3f921110"],
Cell[455426, 8633, 23996, 567, 1291, "Input",ExpressionUUID->"8bbef68a-346f-415b-a91d-254c2f6ecc9a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[479459, 9205, 188, 3, 54, "Subsection",ExpressionUUID->"563eb064-f76b-4fc3-a383-5094ce33e813"],
Cell[479650, 9210, 413, 7, 58, "Text",ExpressionUUID->"871421f0-103e-4939-872d-bf23ced194bc"],
Cell[CellGroupData[{
Cell[480088, 9221, 226, 4, 45, "Subsubsection",ExpressionUUID->"2241fb34-9493-4014-b79f-df489ec2a03a"],
Cell[480317, 9227, 3095, 68, 149, "Input",ExpressionUUID->"b128aea3-38b4-43e8-9401-c24def49f8d0",
 InitializationCell->True],
Cell[483415, 9297, 1190, 33, 87, "Input",ExpressionUUID->"487be4f2-8a90-4183-94a7-dee52b612f76",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[484642, 9335, 235, 5, 45, "Subsubsection",ExpressionUUID->"450ec50c-21cb-429f-b5e1-51c7d37d5289"],
Cell[484880, 9342, 365, 8, 32, "Input",ExpressionUUID->"a63e206c-9624-4070-b729-9473e162de34"],
Cell[485248, 9352, 1546, 38, 149, "Input",ExpressionUUID->"23431c4a-12df-4fee-88aa-ba72c5189870",
 InitializationCell->True],
Cell[486797, 9392, 1290, 35, 108, "Input",ExpressionUUID->"58d2a6b9-cbcf-428d-b913-9b56fa9c069b",
 InitializationCell->True],
Cell[488090, 9429, 2234, 61, 149, "Input",ExpressionUUID->"00c9776d-b30e-448b-a0e3-02188b8c77bb",
 InitializationCell->True],
Cell[490327, 9492, 412, 8, 35, "Text",ExpressionUUID->"d2ba1be8-3a2a-468f-8abe-3f405b59511e"],
Cell[490742, 9502, 1231, 25, 67, "Input",ExpressionUUID->"5afe4be0-1e64-4cc3-849f-d21b17e95e16",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[492010, 9532, 269, 4, 45, "Subsubsection",ExpressionUUID->"f60c71de-fa0a-468a-bb94-3111d0903ac9"],
Cell[492282, 9538, 245, 5, 35, "Text",ExpressionUUID->"1230983f-e254-47f1-b201-5d2fc3e08d7d",
 InitializationCell->True],
Cell[492530, 9545, 640, 14, 45, "Input",ExpressionUUID->"a765f928-49c8-4898-a0b4-d1ae398ccc19",
 InitializationCell->True],
Cell[493173, 9561, 361, 6, 35, "Text",ExpressionUUID->"3b49291f-7cdf-4ccd-a0ba-ff095877fa08",
 InitializationCell->True],
Cell[493537, 9569, 554, 14, 67, "Input",ExpressionUUID->"7b976736-6dfc-4331-be9d-5794618bd8ea",
 InitializationCell->True],
Cell[494094, 9585, 5833, 166, 288, "Input",ExpressionUUID->"0bee0208-0f35-4fb8-a10d-4470fa3c6285",
 InitializationCell->True],
Cell[499930, 9753, 362, 6, 35, "Text",ExpressionUUID->"1cbcf22b-3cfe-4114-a27f-0af080cdc678",
 InitializationCell->True],
Cell[500295, 9761, 1021, 26, 87, "Input",ExpressionUUID->"8e65383b-2bf7-4d66-ad67-838b82572a69",
 InitializationCell->True],
Cell[501319, 9789, 4661, 87, 279, "Input",ExpressionUUID->"eb06141c-07d2-4c37-836d-8c4ced674b81",
 InitializationCell->True],
Cell[505983, 9878, 1718, 36, 68, "Input",ExpressionUUID->"cd17faec-fb8a-461f-b95d-4ce271836259",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[507738, 9919, 191, 3, 45, "Subsubsection",ExpressionUUID->"cdd972f0-b3d3-48dc-b2ee-9adf36c71e71"],
Cell[507932, 9924, 544, 15, 32, "Input",ExpressionUUID->"fc2c91ac-779f-46ca-9ac1-fb1505520419"],
Cell[508479, 9941, 4400, 113, 211, "Input",ExpressionUUID->"69ecee5e-7626-4330-848e-1e3efb8a6108",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[512940, 10061, 261, 5, 54, "Section",ExpressionUUID->"21bee6f8-05a6-441e-b6c1-f71abc539285"],
Cell[CellGroupData[{
Cell[513226, 10070, 223, 4, 54, "Subsection",ExpressionUUID->"5c4c0fc9-acec-45a8-8ceb-9879ad97f10d"],
Cell[513452, 10076, 2187, 53, 149, "Input",ExpressionUUID->"9d5866af-8157-4bc7-827d-fbcea953375b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[515676, 10134, 218, 4, 54, "Subsection",ExpressionUUID->"30d7f9e1-7257-4d05-99e6-ca63765019af"],
Cell[515897, 10140, 429, 11, 32, "Input",ExpressionUUID->"242cd9c3-c7a1-4a30-bc5e-220392680c89"],
Cell[516329, 10153, 2327, 63, 196, "Input",ExpressionUUID->"71f41b6e-33c5-4825-95d2-413191e6ec0a",
 InitializationCell->True],
Cell[518659, 10218, 413, 11, 67, "Input",ExpressionUUID->"8b005a18-fcd4-422b-9838-e5e6233f7f5c",
 InitializationCell->True],
Cell[519075, 10231, 5992, 149, 347, "Input",ExpressionUUID->"bb642d14-9894-4ddd-a8e2-2db72eb80c0f",
 InitializationCell->True],
Cell[525070, 10382, 6748, 160, 485, "Input",ExpressionUUID->"f7b32440-6878-479b-98d0-17d1f0b0f595",
 InitializationCell->True],
Cell[531821, 10544, 306, 8, 32, "Input",ExpressionUUID->"5c37687e-9d98-46e5-ba63-0bb941917c32"],
Cell[532130, 10554, 7827, 187, 563, "Input",ExpressionUUID->"5772bb73-3fa7-4125-937d-e49ca95d619c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[539994, 10746, 225, 4, 54, "Subsection",ExpressionUUID->"63a673bf-ee8f-4849-b921-aa8091b70487"],
Cell[540222, 10752, 2134, 54, 129, "Input",ExpressionUUID->"1830426a-3a33-4803-ba17-f6bc47006255",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[542393, 10811, 322, 5, 54, "Subsection",ExpressionUUID->"928efc56-14d0-4e1a-89ba-5b67757cbfd1"],
Cell[542718, 10818, 18301, 473, 1140, "Input",ExpressionUUID->"040af338-6750-4df5-a24a-39c6a3750788",
 InitializationCell->True],
Cell[561022, 11293, 3785, 101, 295, "Input",ExpressionUUID->"ac4a2837-51ad-4acf-81d4-e529b5b97dee",
 InitializationCell->True],
Cell[564810, 11396, 4012, 98, 335, "Input",ExpressionUUID->"a945f853-6d86-4e3b-87e2-0a1cc10d3b6a",
 InitializationCell->True],
Cell[568825, 11496, 1112, 30, 87, "Input",ExpressionUUID->"994637d2-6eb0-4d0d-b809-b4c1ccc81c7e",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[569986, 11532, 305, 5, 68, "Section",ExpressionUUID->"d827e076-6ab5-4142-8459-164e8c75b235"],
Cell[CellGroupData[{
Cell[570316, 11541, 318, 5, 54, "Subsection",ExpressionUUID->"d2b59517-43ff-4c3c-95aa-0dd4424c094c"],
Cell[570637, 11548, 427, 9, 32, "Input",ExpressionUUID->"63fcfceb-90e5-472f-a625-d32949f4ed21"],
Cell[571067, 11559, 6757, 171, 342, "Input",ExpressionUUID->"5e6febdc-4a6a-44b2-a2fa-f67c053381da",
 InitializationCell->True],
Cell[577827, 11732, 352, 8, 32, "Input",ExpressionUUID->"c22448c9-016e-4ca0-841f-60bb921e5a45"],
Cell[578182, 11742, 18654, 370, 726, "Input",ExpressionUUID->"4b6698b9-f54b-4c7f-8be8-4b5e5b298e66",
 InitializationCell->True],
Cell[596839, 12114, 9288, 212, 599, "Input",ExpressionUUID->"69d9be5f-146b-437d-a0fd-fa773d37e4d4",
 InitializationCell->True],
Cell[606130, 12328, 201, 4, 29, "Input",ExpressionUUID->"51468820-ccfd-47dc-8e5a-71ff6410f875"],
Cell[606334, 12334, 10713, 234, 578, "Input",ExpressionUUID->"fc21331a-5cc9-46a5-bee5-50c04037690a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[617084, 12573, 363, 6, 54, "Subsection",ExpressionUUID->"e578289e-806c-417f-817d-85728ea085a3"],
Cell[617450, 12581, 1007, 27, 72, "Input",ExpressionUUID->"7b1672de-02ff-4fbf-bff4-f043589aa02b"],
Cell[618460, 12610, 1379, 33, 68, "Input",ExpressionUUID->"f35c8a5d-c328-4536-a33a-38fc0f557beb",
 InitializationCell->True],
Cell[619842, 12645, 8806, 215, 488, "Input",ExpressionUUID->"71a0505e-fd7b-4c23-a458-e6d795d28dcd",
 InitializationCell->True],
Cell[628651, 12862, 1007, 28, 72, "Input",ExpressionUUID->"b49beaa6-f8c5-4517-916d-1d125e2a872b"],
Cell[629661, 12892, 877, 19, 45, "Input",ExpressionUUID->"204ffee4-26d4-451a-9536-70a9fd6a0893",
 InitializationCell->True],
Cell[630541, 12913, 6038, 147, 238, "Input",ExpressionUUID->"7db838f5-7a64-4284-9155-1c68e8b2309c",
 InitializationCell->True],
Cell[636582, 13062, 2943, 71, 170, "Input",ExpressionUUID->"259dc72d-3de1-4c81-a806-0ebb7ed34b22",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[639574, 13139, 750, 11, 68, "Section",ExpressionUUID->"cfdaff87-ccfe-4194-879d-aa085645a191"],
Cell[640327, 13152, 1537, 42, 131, "Input",ExpressionUUID->"84d301dd-252a-4b94-a532-5522c6192c07",
 InitializationCell->True],
Cell[641867, 13196, 757, 22, 87, "Input",ExpressionUUID->"f4831d8e-86fd-408b-91c4-dd80f1cb4c0e",
 InitializationCell->True],
Cell[642627, 13220, 438, 13, 45, "Input",ExpressionUUID->"8439c640-10e0-45b3-8e0f-e168838cc843",
 InitializationCell->True],
Cell[643068, 13235, 2381, 57, 220, "Input",ExpressionUUID->"9ea0ca5f-cbce-4284-a76b-2508812f991e",
 InitializationCell->True],
Cell[645452, 13294, 1516, 36, 112, "Input",ExpressionUUID->"5f565292-0c64-4423-894a-cb364e0f1664",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[646993, 13334, 696, 12, 54, "Subsection",ExpressionUUID->"b6eb75c3-ade6-45c2-9d34-bed3a8c99a7c"],
Cell[647692, 13348, 504, 12, 32, "Input",ExpressionUUID->"04421028-981a-4e52-a987-4c0417380e59"],
Cell[648199, 13362, 20149, 470, 1338, "Input",ExpressionUUID->"7fcecb45-ceb1-4e77-97c6-63c49e1dbcc0",
 InitializationCell->True],
Cell[668351, 13834, 813, 25, 45, "Input",ExpressionUUID->"b04a3d73-9931-4cdf-8c64-5e3772bb9049",
 InitializationCell->True],
Cell[669167, 13861, 180, 3, 35, "Text",ExpressionUUID->"68947a28-0bc2-4bdc-b982-991f0902d5e5"],
Cell[669350, 13866, 4007, 99, 277, "Input",ExpressionUUID->"4bb47987-7588-43b1-8dda-67cb146dfa5d",
 InitializationCell->True],
Cell[673360, 13967, 195, 3, 35, "Text",ExpressionUUID->"5f6b65b6-49e5-416c-accb-7cd7a0b87c83"],
Cell[673558, 13972, 74603, 1559, 6202, "Input",ExpressionUUID->"70469fdd-020a-4dec-b2a4-9e16dfff3314",
 InitializationCell->True],
Cell[748164, 15533, 2716, 74, 72, "Input",ExpressionUUID->"11901663-6fa4-4b7a-91a0-f12332b0afa7"],
Cell[750883, 15609, 167, 3, 35, "Text",ExpressionUUID->"413e44d3-b23b-40af-826a-7407e982021a"],
Cell[751053, 15614, 169, 3, 35, "Text",ExpressionUUID->"cf542ad0-321f-45eb-91bd-dd0cd052540d"],
Cell[751225, 15619, 1554, 44, 87, "Input",ExpressionUUID->"d1a81c4a-8dce-423d-ae2f-4a59ee8cce22",
 InitializationCell->True],
Cell[752782, 15665, 241, 5, 35, "Text",ExpressionUUID->"16d38e95-8dee-456d-a6a6-ba3840c793e6"],
Cell[753026, 15672, 11919, 256, 1280, "Input",ExpressionUUID->"32fb5a03-ac7b-4cfd-b17d-4a5910239068",
 InitializationCell->True],
Cell[764948, 15930, 78800, 1738, 5672, "Input",ExpressionUUID->"d7361d27-389f-4c5d-831b-c4fb3485b31d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[843785, 17673, 644, 11, 54, "Subsection",ExpressionUUID->"d8327917-99a6-4ae4-9733-225208f20e53"],
Cell[844432, 17686, 398, 7, 32, "Input",ExpressionUUID->"90abaf5b-ff4e-4e0f-bea4-70faa61f04e6"],
Cell[844833, 17695, 456, 10, 48, "Input",ExpressionUUID->"7b800d19-0d6b-4fdc-89c2-72f86638b58d",
 InitializationCell->True],
Cell[845292, 17707, 602, 15, 45, "Input",ExpressionUUID->"4605514b-9245-499a-baf9-ab622ae8cc34",
 InitializationCell->True],
Cell[845897, 17724, 320, 7, 35, "Text",ExpressionUUID->"9d2a8008-9b56-45ff-8da0-0ff4515ee286"],
Cell[CellGroupData[{
Cell[846242, 17735, 186, 3, 45, "Subsubsection",ExpressionUUID->"f5cafb96-a93f-4078-bed1-53264258d563"],
Cell[846431, 17740, 20422, 483, 1104, "Input",ExpressionUUID->"474c4c96-1d6d-4788-9a42-337974bdf5b2",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[866890, 18228, 184, 3, 45, "Subsubsection",ExpressionUUID->"04d6380a-feae-4880-85ae-1606ae3e5c18"],
Cell[867077, 18233, 338, 7, 35, "Text",ExpressionUUID->"ec23b456-da1e-4ee4-ac25-82197e68b6fa"],
Cell[867418, 18242, 332, 8, 32, "Input",ExpressionUUID->"9f4eec53-1d24-4ba3-b27a-9875f04b2cc4"],
Cell[867753, 18252, 801, 21, 109, "Input",ExpressionUUID->"57db0e7c-9581-4449-b9d4-8ca91ea69071",
 InitializationCell->True],
Cell[868557, 18275, 646, 18, 87, "Input",ExpressionUUID->"8dfa67bc-7582-41a9-8f7f-6e74f7cecc42",
 InitializationCell->True],
Cell[869206, 18295, 2893, 78, 184, "Input",ExpressionUUID->"12b828ee-592b-4734-82ee-64b4714bf3dc",
 InitializationCell->True],
Cell[872102, 18375, 2391, 67, 116, "Input",ExpressionUUID->"7686e07f-21d1-4112-b5d6-910b9ebd6a87",
 InitializationCell->True],
Cell[874496, 18444, 517, 9, 58, "Text",ExpressionUUID->"ba2c1d31-5341-4f24-8ffc-16b0369161d3"],
Cell[875016, 18455, 1650, 44, 110, "Input",ExpressionUUID->"34be49d9-c7fa-499a-b1a1-c0a0e7c6657b",
 InitializationCell->True],
Cell[876669, 18501, 27054, 703, 1622, "Input",ExpressionUUID->"66841c53-2c1b-4587-b4c9-416ff408bc14",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[903760, 19209, 187, 3, 37, "Subsubsection",ExpressionUUID->"5df75eb5-ea81-453d-ac21-91a7af80165c"],
Cell[903950, 19214, 172, 3, 35, "Text",ExpressionUUID->"8e186ea3-e4c4-4472-bf11-04c76ee7ad09"],
Cell[904125, 19219, 3144, 75, 151, "Input",ExpressionUUID->"cea66ad3-6e0e-45c8-8eba-2722afd39da0",
 InitializationCell->True],
Cell[907272, 19296, 2566, 58, 211, "Input",ExpressionUUID->"8cbb5c16-ce8f-4a1a-a317-9ae030548181",
 InitializationCell->True],
Cell[909841, 19356, 1344, 32, 129, "Input",ExpressionUUID->"c33a3223-50c3-4813-9625-389653e4dac1",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[911222, 19393, 237, 5, 45, "Subsubsection",ExpressionUUID->"2e7a5851-86b9-4a38-bc8c-56ad61ceb72f"],
Cell[911462, 19400, 1854, 42, 87, "Input",ExpressionUUID->"e5694041-9a92-432c-b345-542a213f64d7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[913353, 19447, 421, 8, 45, "Subsubsection",ExpressionUUID->"f4a6e4ed-2a7e-4ea2-a5ab-353f6949c332"],
Cell[913777, 19457, 963, 25, 108, "Input",ExpressionUUID->"8d990a9f-ebfe-49d6-9a68-a20f73efcb95",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[914777, 19487, 321, 7, 37, "Subsubsection",ExpressionUUID->"7051ce90-18b6-4208-ae99-cceb5142a364"],
Cell[915101, 19496, 346, 7, 35, "Text",ExpressionUUID->"c8d611ca-3e20-42bf-8d62-25f88b722e7a"],
Cell[915450, 19505, 606, 13, 45, "Input",ExpressionUUID->"a8198c3b-d846-41ad-ae7e-8d08552ca38a",
 InitializationCell->True],
Cell[916059, 19520, 2673, 64, 183, "Input",ExpressionUUID->"535fb215-1067-4608-8a3e-ba148f9a9c08",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[918781, 19590, 182, 3, 54, "Subsection",ExpressionUUID->"6652419b-9420-48c6-a33a-8d7731d51bbd"],
Cell[CellGroupData[{
Cell[918988, 19597, 308, 5, 45, "Subsubsection",ExpressionUUID->"409697d1-6594-4069-b258-08f68259a6ae"],
Cell[919299, 19604, 556, 10, 58, "Text",ExpressionUUID->"6361c0eb-3366-4177-88f8-ea877589c215"],
Cell[919858, 19616, 236, 3, 35, "Text",ExpressionUUID->"490861f8-0eff-45b7-9681-bd1eb7658325"],
Cell[920097, 19621, 488, 12, 45, "Input",ExpressionUUID->"3ebda563-4c4d-4fbb-a6b2-0ec523085ad5",
 InitializationCell->True],
Cell[920588, 19635, 1314, 30, 67, "Input",ExpressionUUID->"64b86333-f245-48b4-a652-db025b4b5c13",
 InitializationCell->True],
Cell[921905, 19667, 271, 4, 35, "Text",ExpressionUUID->"11396e2c-5fbd-45ea-8fff-92c675c1c387"],
Cell[922179, 19673, 13712, 322, 709, "Input",ExpressionUUID->"892c5637-36a8-4a98-b54b-edf414849e67",
 InitializationCell->True],
Cell[935894, 19997, 561, 15, 45, "Input",ExpressionUUID->"587f7d86-6d24-4521-b586-f199522696bf",
 InitializationCell->True],
Cell[936458, 20014, 1640, 45, 93, "Input",ExpressionUUID->"89f16ceb-a859-4c1d-99a2-0d1b1bd5666b",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[938159, 20066, 935, 15, 68, "Section",ExpressionUUID->"8bfd21ed-e317-4a38-bb5d-890a8b1bd5c5"],
Cell[CellGroupData[{
Cell[939119, 20085, 238, 4, 54, "Subsection",ExpressionUUID->"dae5dff9-1226-4fb0-bc42-cd16d535fce2"],
Cell[939360, 20091, 1420, 39, 113, "Input",ExpressionUUID->"97bd6ed1-ae2d-4094-b40c-1241243c7b76"],
Cell[940783, 20132, 43791, 938, 1900, "Input",ExpressionUUID->"3a535915-ac0f-4269-9ace-d33438677260"],
Cell[984577, 21072, 1178, 31, 51, "Input",ExpressionUUID->"93016839-1fff-4d70-93a7-89b4df2ee65d"],
Cell[985758, 21105, 3183, 77, 154, "Input",ExpressionUUID->"ad6f652f-dfd0-43d8-aa6a-3d157f1c0289"],
Cell[988944, 21184, 1456, 39, 71, "Input",ExpressionUUID->"8f8abaf6-96d2-453a-af0f-959ee4897eed"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[990449, 21229, 632, 9, 54, "Section",ExpressionUUID->"d157c404-9bd3-4389-8876-ebb9a589ff81"],
Cell[991084, 21240, 993, 19, 108, "Input",ExpressionUUID->"fdd62791-9699-4aea-9439-fb3f5dd1f149",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

